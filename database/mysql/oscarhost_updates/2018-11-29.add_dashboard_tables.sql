DROP PROCEDURE IF EXISTS CREATE_DASHBOARD_TABLES;

DELIMITER $$
CREATE PROCEDURE CREATE_DASHBOARD_TABLES ()
BEGIN

DECLARE dashboard_present TINYINT(1);
DECLARE template_present TINYINT(1);
DECLARE dashboard_entries INT DEFAULT 0;
DECLARE template_entries INT DEFAULT 0;

SELECT EXISTS(SELECT * FROM information_schema.tables where table_schema = DATABASE() AND table_name='dashboard') INTO dashboard_present;
SELECT EXISTS(SELECT * FROM information_schema.tables where table_schema = DATABASE() AND table_name='indicatorTemplate') INTO template_present;


IF dashboard_present AND template_present THEN
SELECT COUNT(*) from dashboard INTO dashboard_entries;
SELECT COUNT(*) from indicatorTemplate INTO template_entries;
END IF;


-- Archive any existing dashboards before we replace with our own.
IF dashboard_entries > 0 AND template_entries > 0 THEN

RENAME TABLE dashboard to dashboard_old;
RENAME TABLE indicatorTemplate to indicatorTemplate_old;

ELSE

IF dashboard_present AND template_present THEN

DROP TABLE dashboard;
DROP TABLE indicatorTemplate;

END IF;
END IF;


CREATE TABLE dashboard (
  id int(11) NOT NULL AUTO_INCREMENT,
  name varchar(255) DEFAULT NULL,
  description varchar(255) DEFAULT NULL,
  creator varchar(11) DEFAULT NULL,
  edited datetime DEFAULT NULL,
  active bit(1) DEFAULT NULL,
  locked bit(1) DEFAULT NULL,
  PRIMARY KEY (id)
);

CREATE TABLE indicatorTemplate (
  id int(11) NOT NULL AUTO_INCREMENT,
  dashboardId int(11) DEFAULT NULL,
  name varchar(255) DEFAULT NULL,
  category varchar(255) DEFAULT NULL,
  subCategory varchar(255) DEFAULT NULL,
  framework varchar(255) DEFAULT NULL,
  frameworkVersion date DEFAULT NULL,
  definition tinytext,
  notes tinytext,
  template mediumtext,
  active bit(1) DEFAULT NULL,
  locked bit(1) DEFAULT NULL,
  shared tinyint(1) DEFAULT NULL,
  metricSetName varchar(255) DEFAULT NULL,
  metricLabel varchar(255) DEFAULT NULL,
  PRIMARY KEY (id)
);

INSERT IGNORE INTO secObjPrivilege (roleUserGroup, objectName, privilege, priority, provider_no) values
  ('admin', '_dashboardDisplay', 'x', 0, '999998'),
  ('admin', '_dashboardDrilldown', 'x', 0, '999998'),
  ('admin', '_dashboardManager', 'x', 0, '999998');


-- Dashboards 2,3 don't work right now, so we will leave them as inactivated

INSERT INTO dashboard VALUES
(1,'BC Billing Dashboard','Optimize Billing','999998','2018-01-30 09:37:54',1,0),
(2,'DoBC PSP Panel - Demographic','Patient Contact, MRP, Active etc','999998','2018-06-13 15:10:04',0,0),
(3,'DoBC CPQI PSP Panel','Polypharmacy, Prevalence of Conditions etc.','999998','2018-06-13 15:10:16',0,0),
(4,'Doctors of BC PSP - Panel 1','','999998','2018-06-13 15:10:51',1,0),
(5,'Doctors of BC PSP - Panel 2','','999998','2018-06-13 15:11:07',1,0),
(6,'Doctors of BC PSP - Panel 3','','999998','2018-06-13 15:11:21',1,0),
(7,'Doctors of BC PSP - Reports','','999998','2018-06-13 15:11:44',1,0);

INSERT INTO indicatorTemplate VALUES
(1,1,'Diabetes Mellitus (G14050)','Billing','CDM Incentive Program','GP Services Committee: Chronic Disease Management Incentives','2016-01-01','Annual chronic care incentive for full service most responsible general practitioner.','\n			Full details here: https://sgp.bc.ca/fee/diabetes-chronic-care-incentive-copy/			\n		','<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<indicatorTemplateXML>\n	<author>Colcamex Resources Inc. for Oscar BC</author>\n	<uid></uid>\n	<heading>\n		<category>Billing</category>\n		<subCategory>CDM Incentive Program</subCategory>\n		<name>Diabetes Mellitus (G14050)</name>\n		<definition>Annual chronic care incentive for full service most responsible general practitioner.</definition>\n		<framework>GP Services Committee: Chronic Disease Management Incentives</framework>\n		<frameworkVersion>01-01-2016</frameworkVersion>\n		<notes>\n			Full details here: https://sgp.bc.ca/fee/diabetes-chronic-care-incentive-copy/			\n		</notes>\n	</heading>\n	<indicatorQuery>\n		<version>10-01-2017</version>\n		<params>\n			<!-- \n				Required parameter provider. Value options are: \n					[ an individual providerNo, or provider range ] ie: value=\"370, 1001\" \n					\"all\" ie: value=\"all\" including null.\n					\"loggedInProvider\" ie:\n				Default is \"loggedInProvider\"\n				Use this parameter in the query as ${provider}\n				This parameter should be used for fetching patient\'s assigned to a MRP.\n				ie: WHERE demographic.provider_no = ${provider}\n			-->\n			<parameter id=\"provider\" name=\"provider_no\" value=\"loggedInProvider\" />\n			<parameter id=\"pstatus\" name=\"patient_status\" value=\"\'%AC%\'\" />\n			<parameter id=\"daysanniversary\" name=\"days_anniversary\" value=\"365\" />\n			<parameter id=\"today\" name=\"today\" value=\"DATE(NOW())\" />\n			<parameter id=\"visitsqualifier\" name=\"visits_qualifier\" value=\"2\" />\n			<parameter id=\"billingStatus\" name=\"billing_status\" value=\"\'%S%\'\" />\n			<parameter id=\"excludeBillingStatus\" name=\"billing_status\" value=\"%D%,%R%,%F%,%N%\" />\n						\n			<parameter id=\"bonusBillingcode\" name=\"billing_code\" value=\"14050\" />			\n			<parameter id=\"phoneBillingcode\" name=\"billing_code\" value=\"14076,14079\" />	\n			<parameter id=\"acpBillingcode\" name=\"billing_code\" value=\"14029\" />		\n			<parameter id=\"visitBillingcode\" name=\"billing_code\" value=\"12100,00100,15300,16100,17100,18100,\n				12101,00101,15301,16101,17101,18101,12120,00120,15320,16120,17120,18120,00103,\n				14090,14091,14094,00114,00115\" />				\n			<parameter id=\"excludeBillingcode\" name=\"billing_code\" value=\"14063\" />							\n			<parameter id=\"excludeDxCode\" name=\"dxresearch_code\" value=\"\'\'\" />\n			<parameter id=\"dxcode\" name=\"dxresearch_code\" value=\"250\" />\n			\n			<parameter id=\"dxcodestatus\" name=\"status\" value=\"\'%A%\'\" />\n			<parameter id=\"patientNameExclude\" name=\"last_name\" value=\"TEST%,BOOP,INTEGRATOR%\" />	\n		</params>\n		\n        <range>\n            <upperLimit id=\"groupBillingcode\" label=\"Group Visit Upper\" name=\"Group Visit Upper\" value=\"13781\" />\n            <lowerLimit id=\"groupBillingcode\" label=\"Group Visit Lower\" name=\"Group Visit Lower\" value=\"13763\" />\n        </range>\n\n		<query>\n			<!-- Indicator SQL Query here -->\n			SELECT			 \n				ROUND( IFNULL( SUM( CASE\n					WHEN d.demographic_no &gt; 0\n					THEN 1\n					ELSE 0\n				END ), 0), 1 ) AS \"Patients up to date\",\n			\n				ROUND( IFNULL( SUM( CASE\n				WHEN ( ABS( DATEDIFF( dxr.start_date, ${today} ) ) &gt;= ${daysanniversary} )  \n						AND ( IFNULL(BILL.service_date, 0) = 0 )\n						AND ( (IFNULL(EXCLUDE_DX.code1,0) = 0) AND (IFNULL(EXCLUDE_DX.code2,0) = 0) )  \n				THEN CASE \n							WHEN IFNULL(VISITS.qualifier,0) = ${visitsqualifier}\n							THEN 1\n							WHEN ( IFNULL(VISITS.qualifier,0) + IFNULL(PHONE.qualifier,0) ) = ${visitsqualifier}\n							THEN 1\n							WHEN ( IFNULL(VISITS.qualifier,0) + IFNULL(GVISIT.qualifier,0) ) = ${visitsqualifier}\n							THEN 1\n							WHEN ( IFNULL(VISITS.qualifier,0) + IFNULL(ACPVISIT.qualifier,0) ) = ${visitsqualifier}\n							THEN 1\n							ELSE 0\n					 END\n				ELSE 0 \n				END ), 0), 1) AS \"Patients billable\",\n			\n				ROUND( IFNULL( SUM( CASE\n				WHEN ( ABS( DATEDIFF( dxr.start_date, ${today} ) ) &gt;= ${daysanniversary} )  \n						AND ( IFNULL(BILL.service_date, 0) = 0 )\n						AND ( (IFNULL(EXCLUDE_DX.code1,0) = 0) AND (IFNULL(EXCLUDE_DX.code2,0) = 0) ) \n						AND IFNULL(VISITS.qualifier,0) &lt; ${visitsqualifier}\n						AND IFNULL(VISITS.qualifier,0) + IFNULL(PHONE.qualifier,0) &lt; ${visitsqualifier}\n						AND IFNULL(VISITS.qualifier,0) + IFNULL(GVISIT.qualifier,0) &lt; ${visitsqualifier}\n						AND IFNULL(VISITS.qualifier,0) + IFNULL(ACPVISIT.qualifier,0) &lt; ${visitsqualifier}\n				THEN 1\n				ELSE 0\n				END ), 0), 1) AS \"Patients recall\" \n\n			FROM demographic d \n			INNER JOIN dxresearch dxr \n			ON ( d.demographic_no = dxr.demographic_no ) \n				LEFT JOIN (\n					SELECT bm.demographic_no, bm.billingstatus, bm.billing_code, bm.service_date\n					FROM billingmaster bm\n					INNER JOIN (\n						SELECT MAX(service_date) AS service, demographic_no AS demographic\n						FROM billingmaster\n						WHERE billing_code = ${bonusBillingcode}\n						AND billingstatus NOT IN ${excludeBillingStatus}\n						AND DATE(service_date) BETWEEN DATE_SUB( ${today}, INTERVAL ${daysanniversary} DAY ) AND ${today}\n						GROUP BY demographic_no\n					) current\n					ON ( current.demographic = bm.demographic_no AND current.service = bm.service_date ) \n					WHERE bm.billing_code = ${bonusBillingcode}\n				) BILL\n				ON(BILL.demographic_no = d.demographic_no)\n				LEFT JOIN (\n					SELECT 	COUNT(demographic_no) AS \'count\',\n							CASE \n								WHEN COUNT(demographic_no) = 1\n								THEN 1\n								WHEN COUNT(demographic_no) > 1\n								THEN 2\n								ELSE 0\n							END AS \'qualifier\',\n							demographic_no, \n							MAX(service_date) AS service\n					FROM billingmaster\n					WHERE billingstatus LIKE ${billingStatus}\n					AND DATE(service_date) BETWEEN DATE_SUB( ${today}, INTERVAL ${daysanniversary} DAY ) AND ${today}\n					AND billing_code IN ${visitBillingcode} \n					GROUP BY demographic_no\n				) VISITS\n				ON (VISITS.demographic_no = d.demographic_no)\n				LEFT JOIN (\n					SELECT 	COUNT(demographic_no) AS \'count\', \n							IF( COUNT(demographic_no) > 0, 1, 0) AS \'qualifier\',\n							demographic_no, \n							MAX(service_date) AS service\n					FROM billingmaster\n					WHERE billingstatus LIKE ${billingStatus}\n					AND DATE( service_date ) BETWEEN DATE_SUB( ${today}, INTERVAL ${daysanniversary} DAY ) AND ${today}	\n					AND billing_code IN ${phoneBillingcode} \n					GROUP BY demographic_no\n				) PHONE\n				ON (PHONE.demographic_no = d.demographic_no)\n				LEFT JOIN (\n					SELECT 	COUNT(demographic_no) AS \'count\', \n							IF( COUNT(demographic_no) > 0, 1, 0) AS \'qualifier\',\n							demographic_no, \n							MAX(service_date) AS service\n					FROM billingmaster\n					WHERE billingstatus LIKE ${billingStatus}\n					AND DATE(service_date) BETWEEN DATE_SUB( ${today}, INTERVAL ${daysanniversary} DAY ) AND ${today}\n					AND billing_code BETWEEN ${lowerLimit.groupBillingcode} AND ${upperLimit.groupBillingcode}	\n					GROUP BY demographic_no\n				) GVISIT\n				ON ( GVISIT.demographic_no = d.demographic_no)\n				LEFT JOIN (\n					SELECT 	COUNT(demographic_no) AS \'count\', \n							IF( COUNT(demographic_no) > 0, 1, 0) AS \'qualifier\',\n							demographic_no, \n							MAX(service_date) AS service\n					FROM billingmaster\n					WHERE billingstatus LIKE ${billingStatus}\n					AND DATE(service_date) BETWEEN DATE_SUB( ${today}, INTERVAL ${daysanniversary} DAY ) AND ${today}\n					AND billing_code = ${acpBillingcode}\n					GROUP BY demographic_no\n				) ACPVISIT\n				ON ( ACPVISIT.demographic_no = d.demographic_no)\n				LEFT JOIN (\n					SELECT 	IFNULL( MIN(dxresearch_code), 0) AS code1, \n							IF( IFNULL( MIN(dxresearch_code), 0) != IFNULL( MAX(dxresearch_code),0 ), MAX(dxresearch_code), 0) AS code2, \n							demographic_no\n					FROM dxresearch\n					WHERE dxresearch_code LIKE ${excludeDxCode}\n					AND `status` LIKE ${dxcodestatus} \n					GROUP BY demographic_no\n				) EXCLUDE_DX\n				ON ( EXCLUDE_DX.demographic_no = d.demographic_no)\n				LEFT JOIN (\n					SELECT billing_code, demographic_no\n					FROM billingmaster bm\n					WHERE billingstatus LIKE ${billingStatus}\n					AND billing_code LIKE ${excludeBillingcode}	\n					GROUP BY demographic_no HAVING COUNT(demographic_no) > -1\n				) EXCLUDE_BILL\n				ON(EXCLUDE_BILL.demographic_no = d.demographic_no )\n			WHERE d.patient_status LIKE ${pstatus} \n			AND dxr.dxresearch_code LIKE ${dxcode} \n			AND dxr.`status` LIKE ${dxcodestatus} \n			AND d.demographic_no > 0 \n			AND d.last_name NOT IN ${patientNameExclude}\n			AND d.provider_no LIKE ${provider}			\n		</query>\n	</indicatorQuery>\n	<drillDownQuery>\n		<version>10-01-2017</version>\n		<params>\n			<parameter id=\"provider\" name=\"provider_no\" value=\"loggedInProvider\" />\n			<parameter id=\"pstatus\" name=\"patient_status\" value=\"\'%AC%\'\" />\n			<parameter id=\"daysanniversary\" name=\"days_anniversary\" value=\"365\" />\n			<parameter id=\"today\" name=\"today\" value=\"DATE(NOW())\" />\n			<parameter id=\"visitsqualifier\" name=\"visits_qualifier\" value=\"2\" />\n			<parameter id=\"billingStatus\" name=\"billing_status\" value=\"\'%S%\'\" />\n			<parameter id=\"excludeBillingStatus\" name=\"billing_status\" value=\"%D%,%R%,%F%,%N%\" />			\n			<parameter id=\"bonusBillingcode\" name=\"billing_code\" value=\"14050\" />			\n			<parameter id=\"phoneBillingcode\" name=\"billing_code\" value=\"14076,14079\" />	\n			<parameter id=\"acpBillingcode\" name=\"billing_code\" value=\"14029\" />		\n			<parameter id=\"visitBillingcode\" name=\"billing_code\" value=\"12100,00100,15300,16100,17100,18100,\n				12101,00101,15301,16101,17101,18101,12120,00120,15320,16120,17120,18120,00103,\n				14090,14091,14094,00114,00115\" />				\n			<parameter id=\"excludeBillingcode\" name=\"billing_code\" value=\"14063\" />							\n			<parameter id=\"excludeDxCode\" name=\"dxresearch_code\" value=\"\'\'\" />\n			<parameter id=\"dxcode\" name=\"dxresearch_code\" value=\"250\" />\n			<parameter id=\"dxcodestatus\" name=\"status\" value=\"\'%A%\'\" />\n			<parameter id=\"patientNameExclude\" name=\"last_name\" value=\"TEST%,BOOP,INTEGRATOR%\" />	\n		</params>\n			\n		<range>\n			<upperLimit id=\"groupBillingcode\" label=\"Group Visit Upper\" name=\"Group Visit Upper\" value=\"13781\" />\n			<lowerLimit id=\"groupBillingcode\" label=\"Group Visit Lower\" name=\"Group Visit Lower\" value=\"13763\" />\n		</range>\n		\n		<displayColumns>\n			<column id=\"demographicNo\" name=\"d.demographic_no\" title=\"Id\" primary=\"true\" />\n			<column id=\"name\" name=\"CONCAT( d.last_name, \', \',d.first_name )\" title=\"Name\" primary=\"false\" />\n			<column id=\"age\" name=\"FLOOR( ABS( DATEDIFF( DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), NOW() ) ) / 365.25 )\" title=\"Age\" primary=\"false\" />\n			<column id=\"gender\" name=\"d.sex\" title=\"Gender\" primary=\"false\" />	\n					\n			<column id=\"billStatus\" name=\"CASE WHEN IFNULL(EXCLUDE_BILL.billing_code,0) &gt; 0\n				THEN \'palliative\' \n				WHEN ( ABS( DATEDIFF( dxr.start_date, ${today} ) ) &gt;= ${daysanniversary} ) AND ( IFNULL(BILL.service_date, 0) = 0 ) AND ( (IFNULL(EXCLUDE_DX.code1,0) = 0) AND (IFNULL(EXCLUDE_DX.code2,0) = 0) ) \n				THEN CASE \n							WHEN IFNULL(VISITS.qualifier,0) = ${visitsqualifier}\n							THEN \'billable\'\n							WHEN ( IFNULL(VISITS.qualifier,0) + IFNULL(PHONE.qualifier,0) ) = ${visitsqualifier}\n							THEN \'billable\'\n							WHEN ( IFNULL(VISITS.qualifier,0) + IFNULL(GVISIT.qualifier,0) ) = ${visitsqualifier}\n							THEN \'billable\'\n							WHEN ( IFNULL( VISITS.qualifier, 0 ) + IFNULL( ACPVISIT.qualifier, 0 ) ) = ${visitsqualifier}\n							THEN \'billable\'\n							ELSE \'recall\'\n					 END\n				ELSE \'-\'\n				END\" title=\"CDM Status\" primary=\"false\" />	\n				\n			<column id=\"lastBillDate\" name=\"IFNULL( DATE_FORMAT( DATE(BILL.service_date), \'%m-%d-%Y\' ), 0)\" title=\"Last Bill\" primary=\"false\" />				\n			<column id=\"dxDate\" name=\"DATE_FORMAT( dxr.start_date , \'%m-%d-%Y\' )\" title=\"Dx Date\" primary=\"false\" />			\n			<column id=\"visitDate\" name=\"IFNULL( DATE_FORMAT(VISITS.service, \'%m-%d-%Y\' ), \'\')\" title=\"Last MD Visit\" primary=\"false\" />\n			<column id=\"phoneDate\" name=\"IFNULL(DATE_FORMAT(PHONE.service, \'%m-%d-%Y\' ), \'\')\" title=\"Last Phone\" primary=\"false\" /> \n			<column id=\"groupDate\" name=\"IFNULL(DATE_FORMAT(GVISIT.service, \'%m-%d-%Y\' ), \'\')\" title=\"Last Grp Visit\" primary=\"false\" />\n			<column id=\"acpDate\" name=\"IFNULL(DATE_FORMAT(ACPVISIT.service, \'%m-%d-%Y\' ), \'\')\" title=\"Last ACP Visit\" primary=\"false\" />\n			\n		</displayColumns>\n		<exportColumns>\n 			<column id=\"demographicNo\" name=\"d.demographic_no\" title=\"Id\" primary=\"true\" />\n			<column id=\"name\" name=\"CONCAT( d.last_name, \', \',d.first_name )\" title=\"Name\" primary=\"false\" />\n			<column id=\"age\" name=\"FLOOR( ABS( DATEDIFF( DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), NOW() ) ) / 365.25 )\" title=\"Age\" primary=\"false\" />\n			<column id=\"gender\" name=\"d.sex\" title=\"Gender\" primary=\"false\" />	\n					\n			<column id=\"billStatus\" name=\"CASE WHEN IFNULL(EXCLUDE_BILL.billing_code,0) &gt; 0\n				THEN \'palliative\' \n				WHEN ( ABS( DATEDIFF( dxr.start_date, ${today} ) ) &gt;= ${daysanniversary} ) AND ( IFNULL(BILL.service_date, 0) = 0 ) AND ( (IFNULL(EXCLUDE_DX.code1,0) = 0) AND (IFNULL(EXCLUDE_DX.code2,0) = 0) ) \n				THEN CASE \n							WHEN IFNULL(VISITS.qualifier,0) = ${visitsqualifier}\n							THEN \'billable\'\n							WHEN ( IFNULL(VISITS.qualifier,0) + IFNULL(PHONE.qualifier,0) ) = ${visitsqualifier}\n							THEN \'billable\'\n							WHEN ( IFNULL(VISITS.qualifier,0) + IFNULL(GVISIT.qualifier,0) ) = ${visitsqualifier}\n							THEN \'billable\'\n							WHEN ( IFNULL( VISITS.qualifier, 0 ) + IFNULL( ACPVISIT.qualifier, 0 ) ) = ${visitsqualifier}\n							THEN \'billable\'\n							ELSE \'recall\'\n					 END\n				ELSE \'-\'\n				END\" title=\"CDM Status\" primary=\"false\" />	\n				\n			<column id=\"lastBillDate\" name=\"IFNULL( DATE_FORMAT( DATE(BILL.service_date), \'%m-%d-%Y\' ), 0)\" title=\"Last Bill\" primary=\"false\" />				\n			<column id=\"dxDate\" name=\"DATE_FORMAT( dxr.start_date , \'%m-%d-%Y\' )\" title=\"Dx Date\" primary=\"false\" />			\n			<column id=\"visitDate\" name=\"IFNULL( DATE_FORMAT(VISITS.service, \'%m-%d-%Y\' ), \'\')\" title=\"Last MD Visit\" primary=\"false\" />\n			<column id=\"phoneDate\" name=\"IFNULL(DATE_FORMAT(PHONE.service, \'%m-%d-%Y\' ), \'\')\" title=\"Last Phone\" primary=\"false\" /> \n			<column id=\"groupDate\" name=\"IFNULL(DATE_FORMAT(GVISIT.service, \'%m-%d-%Y\' ), \'\')\" title=\"Last Grp Visit\" primary=\"false\" />\n			<column id=\"groupDate\" name=\"IFNULL(DATE_FORMAT(ACPVISIT.service, \'%m-%d-%Y\' ), \'\')\" title=\"Last ACP Visit\" primary=\"false\" />			\n		</exportColumns>\n		<query>\n			SELECT *\n			FROM demographic d \n			INNER JOIN dxresearch dxr \n			ON ( d.demographic_no = dxr.demographic_no ) \n				LEFT JOIN (\n					SELECT bm.demographic_no, bm.billingstatus, bm.billing_code, bm.service_date\n					FROM billingmaster bm\n					INNER JOIN (\n						SELECT MAX(service_date) AS service, demographic_no AS demographic\n						FROM billingmaster\n						WHERE billing_code = ${bonusBillingcode}\n						AND billingstatus NOT IN ${excludeBillingStatus}\n						AND DATE(service_date) BETWEEN DATE_SUB( ${today}, INTERVAL ${daysanniversary} DAY ) AND ${today}\n						GROUP BY demographic_no\n					) current\n					ON ( current.demographic = bm.demographic_no AND current.service = bm.service_date ) \n					WHERE bm.billing_code = ${bonusBillingcode}\n				) BILL\n				ON(BILL.demographic_no = d.demographic_no)\n				LEFT JOIN (\n					SELECT 	COUNT(demographic_no) AS \'count\',\n							CASE \n								WHEN COUNT(demographic_no) = 1\n								THEN 1\n								WHEN COUNT(demographic_no) &gt; 1\n								THEN 2\n								ELSE 0\n							END AS \'qualifier\',\n							demographic_no, \n							MAX(service_date) AS service\n					FROM billingmaster\n					WHERE billingstatus LIKE ${billingStatus}\n					AND DATE(service_date) BETWEEN DATE_SUB( ${today}, INTERVAL ${daysanniversary} DAY ) AND ${today}\n					AND billing_code IN ${visitBillingcode} \n					GROUP BY demographic_no\n				) VISITS\n				ON (VISITS.demographic_no = d.demographic_no)\n				LEFT JOIN (\n					SELECT 	COUNT(demographic_no) AS \'count\', \n							IF( COUNT(demographic_no) &gt; 0, 1, 0) AS \'qualifier\',\n							demographic_no, \n							MAX(service_date) AS service\n					FROM billingmaster\n					WHERE billingstatus LIKE ${billingStatus}\n					AND DATE( service_date ) BETWEEN DATE_SUB( ${today}, INTERVAL ${daysanniversary} DAY ) AND ${today}	\n					AND billing_code IN ${phoneBillingcode} \n					GROUP BY demographic_no\n				) PHONE\n				ON (PHONE.demographic_no = d.demographic_no)\n				LEFT JOIN (\n					SELECT 	COUNT(demographic_no) AS \'count\', \n							IF( COUNT(demographic_no) &gt; 0, 1, 0) AS \'qualifier\',\n							demographic_no, \n							MAX(service_date) AS service\n					FROM billingmaster\n					WHERE billingstatus LIKE ${billingStatus}\n					AND DATE(service_date) BETWEEN DATE_SUB( ${today}, INTERVAL ${daysanniversary} DAY ) AND ${today}\n					AND billing_code BETWEEN ${lowerLimit.groupBillingcode} AND ${upperLimit.groupBillingcode}	\n					GROUP BY demographic_no\n				) GVISIT\n				ON ( GVISIT.demographic_no = d.demographic_no)\n				LEFT JOIN (\n					SELECT 	COUNT(demographic_no) AS \'count\', \n							IF( COUNT(demographic_no) &gt; 0, 1, 0) AS \'qualifier\',\n							demographic_no, \n							MAX(service_date) AS service\n					FROM billingmaster\n					WHERE billingstatus LIKE ${billingStatus}\n					AND DATE(service_date) BETWEEN DATE_SUB( ${today}, INTERVAL ${daysanniversary} DAY ) AND ${today}\n					AND billing_code = ${acpBillingcode}\n					GROUP BY demographic_no\n				) ACPVISIT\n				ON ( ACPVISIT.demographic_no = d.demographic_no)\n				LEFT JOIN (\n					SELECT 	IFNULL( MIN(dxresearch_code), 0) AS code1, \n							IF( IFNULL( MIN(dxresearch_code), 0) != IFNULL( MAX(dxresearch_code),0 ), MAX(dxresearch_code), 0) AS code2, \n							demographic_no\n					FROM dxresearch\n					WHERE dxresearch_code LIKE ${excludeDxCode}\n					AND `status` LIKE ${dxcodestatus} \n					GROUP BY demographic_no\n				) EXCLUDE_DX\n				ON ( EXCLUDE_DX.demographic_no = d.demographic_no)\n				LEFT JOIN (\n					SELECT billing_code, demographic_no\n					FROM billingmaster bm\n					WHERE billingstatus LIKE ${billingStatus}\n					AND billing_code LIKE ${excludeBillingcode}	\n					GROUP BY demographic_no HAVING COUNT(demographic_no) &gt; -1\n				) EXCLUDE_BILL\n				ON(EXCLUDE_BILL.demographic_no = d.demographic_no )\n			WHERE d.patient_status LIKE ${pstatus} \n			AND dxr.dxresearch_code LIKE ${dxcode} \n			AND dxr.`status` LIKE ${dxcodestatus} \n			AND d.demographic_no &gt; 0 \n			AND d.last_name NOT IN ${patientNameExclude}\n			AND d.provider_no LIKE ${provider}\n			ORDER BY `CDM Status` DESC			\n		</query>\n	</drillDownQuery>\n	<shared>false</shared>\n	<sharedMetricSetName></sharedMetricSetName>\n	<sharedMetricDataId></sharedMetricDataId>\n	<sharedMappings>\n		<sharedMapping fromLabel=\"\" toLabel=\"\"/>\n	</sharedMappings>\n</indicatorTemplateXML>\n','','\0',0,NULL,NULL),
(2,1,'Heart Failure (G14051)','Billing','CDM Incentive Program','GP Services Committee: Chronic Disease Management Incentives','2016-01-01','Annual chronic care incentive for full service most responsible general practitioner.','\n			Details here: https://sgp.bc.ca/fee/heart-failure-chronic-care-incentive-copy/\n		','<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<indicatorTemplateXML>\n	<author>Colcamex Resources Inc. for Oscar BC</author>\n	<uid></uid>\n	<heading>\n		<category>Billing</category>\n		<subCategory>CDM Incentive Program</subCategory>\n		<name>Heart Failure (G14051)</name>\n		<definition>Annual chronic care incentive for full service most responsible general practitioner.</definition>\n		<framework>GP Services Committee: Chronic Disease Management Incentives</framework>\n		<frameworkVersion>01-01-2016</frameworkVersion>\n		<notes>\n			Details here: https://sgp.bc.ca/fee/heart-failure-chronic-care-incentive-copy/\n		</notes>\n	</heading>\n	<indicatorQuery>\n		<version>10-01-2017</version>\n		<params>\n			<!-- \n				Required parameter provider. Value options are: \n					[ an individual providerNo, or provider range ] ie: value=\"370, 1001\" \n					\"all\" ie: value=\"all\" including null.\n					\"loggedInProvider\" ie:\n				Default is \"loggedInProvider\"\n				Use this parameter in the query as ${provider}\n				This parameter should be used for fetching patient\'s assigned to a MRP.\n				ie: WHERE demographic.provider_no = ${provider}\n			-->\n			<parameter id=\"provider\" name=\"provider_no\" value=\"loggedInProvider\" />\n			<parameter id=\"pstatus\" name=\"patient_status\" value=\"\'%AC%\'\" />\n			<parameter id=\"daysanniversary\" name=\"days_anniversary\" value=\"365\" />\n			<parameter id=\"today\" name=\"today\" value=\"DATE(NOW())\" />\n			<parameter id=\"visitsqualifier\" name=\"visits_qualifier\" value=\"2\" />\n			<parameter id=\"billingStatus\" name=\"billing_status\" value=\"\'%S%\'\" />\n			<parameter id=\"excludeBillingStatus\" name=\"billing_status\" value=\"%D%,%R%,%F%,%N%\" />\n						\n			<parameter id=\"bonusBillingcode\" name=\"billing_code\" value=\"14051\" />			\n			<parameter id=\"phoneBillingcode\" name=\"billing_code\" value=\"14076,14079\" />	\n			<parameter id=\"acpBillingcode\" name=\"billing_code\" value=\"14029\" />			\n			<parameter id=\"visitBillingcode\" name=\"billing_code\" value=\"12100,00100,15300,16100,17100,18100,\n				12101,00101,15301,16101,17101,18101,12120,00120,15320,16120,17120,18120,00103,\n				14090,14091,14094,00114,00115\" />				\n			<parameter id=\"excludeBillingcode\" name=\"billing_code\" value=\"14063\" />							\n			<parameter id=\"excludeDxCode\" name=\"dxresearch_code\" value=\"250,401\" />\n			<parameter id=\"dxcode\" name=\"dxresearch_code\" value=\"428\" />\n			\n			<parameter id=\"dxcodestatus\" name=\"status\" value=\"\'%A%\'\" />\n			<parameter id=\"patientNameExclude\" name=\"last_name\" value=\"TEST%,BOOP,INTEGRATOR%\" />	\n		</params>\n		\n        <range>\n            <upperLimit id=\"groupBillingcode\" label=\"Group Visit Upper\" name=\"Group Visit Upper\" value=\"13781\" />\n            <lowerLimit id=\"groupBillingcode\" label=\"Group Visit Lower\" name=\"Group Visit Lower\" value=\"13763\" />\n        </range>\n\n		<query>\n			<!-- Indicator SQL Query here -->\n			SELECT			 \n				ROUND( IFNULL( SUM( CASE\n					WHEN d.demographic_no &gt; 0\n					THEN 1\n					ELSE 0\n				END ), 0), 1 ) AS \"Patients up to date\",\n			\n				ROUND( IFNULL( SUM( CASE\n				WHEN ( ABS( DATEDIFF( dxr.start_date, ${today} ) ) &gt;= ${daysanniversary} )  \n						AND ( IFNULL(BILL.service_date, 0) = 0 )\n						AND ( (IFNULL(EXCLUDE_DX.code1,0) = 0) AND (IFNULL(EXCLUDE_DX.code2,0) = 0) )  \n				THEN CASE \n							WHEN IFNULL(VISITS.qualifier,0) = ${visitsqualifier}\n							THEN 1\n							WHEN ( IFNULL(VISITS.qualifier,0) + IFNULL(PHONE.qualifier,0) ) = ${visitsqualifier}\n							THEN 1\n							WHEN ( IFNULL(VISITS.qualifier,0) + IFNULL(GVISIT.qualifier,0) ) = ${visitsqualifier}\n							THEN 1\n							WHEN ( IFNULL(VISITS.qualifier,0) + IFNULL(ACPVISIT.qualifier,0) ) = ${visitsqualifier}\n							THEN 1\n							ELSE 0\n					 END\n				ELSE 0 \n				END ),0), 1) AS \"Patients billable\",\n			\n				ROUND( IFNULL( SUM( CASE\n				WHEN ( ABS( DATEDIFF( dxr.start_date, ${today} ) ) &gt;= ${daysanniversary} )  \n						AND ( IFNULL(BILL.service_date, 0) = 0 )\n						AND ( (IFNULL(EXCLUDE_DX.code1,0) = 0) AND (IFNULL(EXCLUDE_DX.code2,0) = 0) ) \n						AND IFNULL(VISITS.qualifier,0) &lt; ${visitsqualifier}\n						AND IFNULL(VISITS.qualifier,0) + IFNULL(PHONE.qualifier,0) &lt; ${visitsqualifier}\n						AND IFNULL(VISITS.qualifier,0) + IFNULL(GVISIT.qualifier,0) &lt; ${visitsqualifier}\n						AND IFNULL(VISITS.qualifier,0) + IFNULL(ACPVISIT.qualifier,0) &lt; ${visitsqualifier}\n				THEN 1\n				ELSE 0\n				END ),0), 1) AS \"Patients recall\" \n\n			FROM demographic d \n			INNER JOIN dxresearch dxr \n			ON ( d.demographic_no = dxr.demographic_no ) \n				LEFT JOIN (\n					SELECT bm.demographic_no, bm.billingstatus, bm.billing_code, bm.service_date\n					FROM billingmaster bm\n					INNER JOIN (\n						SELECT MAX(service_date) AS service, demographic_no AS demographic\n						FROM billingmaster\n						WHERE billing_code = ${bonusBillingcode}\n						AND billingstatus NOT IN ${excludeBillingStatus}\n						AND DATE(service_date) BETWEEN DATE_SUB( ${today}, INTERVAL ${daysanniversary} DAY ) AND ${today}\n						GROUP BY demographic_no\n					) current\n					ON ( current.demographic = bm.demographic_no AND current.service = bm.service_date ) \n					WHERE bm.billing_code = ${bonusBillingcode}\n				) BILL\n				ON(BILL.demographic_no = d.demographic_no)\n				LEFT JOIN (\n					SELECT 	COUNT(demographic_no) AS \'count\',\n							CASE \n								WHEN COUNT(demographic_no) = 1\n								THEN 1\n								WHEN COUNT(demographic_no) > 1\n								THEN 2\n								ELSE 0\n							END AS \'qualifier\',\n							demographic_no, \n							MAX(service_date) AS service\n					FROM billingmaster\n					WHERE billingstatus LIKE ${billingStatus}\n					AND DATE(service_date) BETWEEN DATE_SUB( ${today}, INTERVAL ${daysanniversary} DAY ) AND ${today}\n					AND billing_code IN ${visitBillingcode} \n					GROUP BY demographic_no\n				) VISITS\n				ON (VISITS.demographic_no = d.demographic_no)\n				LEFT JOIN (\n					SELECT 	COUNT(demographic_no) AS \'count\', \n							IF( COUNT(demographic_no) > 0, 1, 0) AS \'qualifier\',\n							demographic_no, \n							MAX(service_date) AS service\n					FROM billingmaster\n					WHERE billingstatus LIKE ${billingStatus}\n					AND DATE( service_date ) BETWEEN DATE_SUB( ${today}, INTERVAL ${daysanniversary} DAY ) AND ${today}	\n					AND billing_code IN ${phoneBillingcode} \n					GROUP BY demographic_no\n				) PHONE\n				ON (PHONE.demographic_no = d.demographic_no)\n				LEFT JOIN (\n					SELECT 	COUNT(demographic_no) AS \'count\', \n							IF( COUNT(demographic_no) > 0, 1, 0) AS \'qualifier\',\n							demographic_no, \n							MAX(service_date) AS service\n					FROM billingmaster\n					WHERE billingstatus LIKE ${billingStatus}\n					AND DATE(service_date) BETWEEN DATE_SUB( ${today}, INTERVAL ${daysanniversary} DAY ) AND ${today}\n					AND billing_code BETWEEN ${lowerLimit.groupBillingcode} AND ${upperLimit.groupBillingcode}	\n					GROUP BY demographic_no\n				) GVISIT\n				ON ( GVISIT.demographic_no = d.demographic_no)\n				LEFT JOIN (\n					SELECT 	COUNT(demographic_no) AS \'count\', \n							IF( COUNT(demographic_no) > 0, 1, 0) AS \'qualifier\',\n							demographic_no, \n							MAX(service_date) AS service\n					FROM billingmaster\n					WHERE billingstatus LIKE ${billingStatus}\n					AND DATE(service_date) BETWEEN DATE_SUB( ${today}, INTERVAL ${daysanniversary} DAY ) AND ${today}\n					AND billing_code = ${acpBillingcode}\n					GROUP BY demographic_no\n				) ACPVISIT\n				ON ( ACPVISIT.demographic_no = d.demographic_no)\n				LEFT JOIN (\n					SELECT 	IFNULL( MIN(dxresearch_code), 0) AS code1, \n							IF( IFNULL( MIN(dxresearch_code), 0) != IFNULL( MAX(dxresearch_code),0 ), MAX(dxresearch_code), 0) AS code2, \n							demographic_no\n					FROM dxresearch\n					WHERE dxresearch_code IN ${excludeDxCode}\n					AND `status` LIKE ${dxcodestatus} \n					GROUP BY demographic_no\n				) EXCLUDE_DX\n				ON ( EXCLUDE_DX.demographic_no = d.demographic_no)\n				LEFT JOIN (\n					SELECT billing_code, demographic_no\n					FROM billingmaster bm\n					WHERE billingstatus LIKE ${billingStatus}\n					AND billing_code LIKE ${excludeBillingcode}	\n					GROUP BY demographic_no HAVING COUNT(demographic_no) > -1\n				) EXCLUDE_BILL\n				ON(EXCLUDE_BILL.demographic_no = d.demographic_no )\n			WHERE d.patient_status LIKE ${pstatus} \n			AND dxr.dxresearch_code LIKE ${dxcode} \n			AND dxr.`status` LIKE ${dxcodestatus} \n			AND d.demographic_no > 0 \n			AND d.last_name NOT IN ${patientNameExclude}\n			AND d.provider_no LIKE ${provider}			\n		</query>\n	</indicatorQuery>\n	<drillDownQuery>\n		<version>10-01-2017</version>\n		<params>\n			<parameter id=\"provider\" name=\"provider_no\" value=\"loggedInProvider\" />\n			<parameter id=\"pstatus\" name=\"patient_status\" value=\"\'%AC%\'\" />\n			<parameter id=\"daysanniversary\" name=\"days_anniversary\" value=\"365\" />\n			<parameter id=\"today\" name=\"today\" value=\"DATE(NOW())\" />\n			<parameter id=\"visitsqualifier\" name=\"visits_qualifier\" value=\"2\" />\n			<parameter id=\"billingStatus\" name=\"billing_status\" value=\"\'%S%\'\" />\n			<parameter id=\"excludeBillingStatus\" name=\"billing_status\" value=\"%D%,%R%,%F%,%N%\" />\n						\n			<parameter id=\"bonusBillingcode\" name=\"billing_code\" value=\"14051\" />			\n			<parameter id=\"phoneBillingcode\" name=\"billing_code\" value=\"14076,14079\" />	\n			<parameter id=\"acpBillingcode\" name=\"billing_code\" value=\"14029\" />			\n			<parameter id=\"visitBillingcode\" name=\"billing_code\" value=\"12100,00100,15300,16100,17100,18100,\n				12101,00101,15301,16101,17101,18101,12120,00120,15320,16120,17120,18120,00103,\n				14090,14091,14094,00114,00115\" />				\n			<parameter id=\"excludeBillingcode\" name=\"billing_code\" value=\"14063\" />							\n			<parameter id=\"excludeDxCode\" name=\"dxresearch_code\" value=\"250,401\" />\n			<parameter id=\"dxcode\" name=\"dxresearch_code\" value=\"428\" />\n			\n			<parameter id=\"dxcodestatus\" name=\"status\" value=\"\'%A%\'\" />\n			<parameter id=\"patientNameExclude\" name=\"last_name\" value=\"TEST%,BOOP,INTEGRATOR%\" />		\n		</params>\n			\n		<range>\n			<upperLimit id=\"groupBillingcode\" label=\"Group Visit Upper\" name=\"Group Visit Upper\" value=\"13781\" />\n			<lowerLimit id=\"groupBillingcode\" label=\"Group Visit Lower\" name=\"Group Visit Lower\" value=\"13763\" />\n		</range>\n		\n		<displayColumns>\n			<column id=\"demographicNo\" name=\"d.demographic_no\" title=\"Id\" primary=\"true\" />\n			<column id=\"name\" name=\"CONCAT( d.last_name, \', \',d.first_name )\" title=\"Name\" primary=\"false\" />\n			<column id=\"age\" name=\"FLOOR( ABS( DATEDIFF( DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), NOW() ) ) / 365.25 )\" title=\"Age\" primary=\"false\" />\n			<column id=\"gender\" name=\"d.sex\" title=\"Gender\" primary=\"false\" />	\n					\n			<column id=\"billStatus\" name=\"CASE WHEN IFNULL(EXCLUDE_BILL.billing_code,0) > 0\n				THEN \'palliative\' \n				WHEN ( ABS( DATEDIFF( dxr.start_date, ${today} ) ) >= ${daysanniversary} )  \n						AND ( IFNULL(BILL.service_date, 0) = 0 )\n						AND ( (IFNULL(EXCLUDE_DX.code1,0) = 0) AND (IFNULL(EXCLUDE_DX.code2,0) = 0) ) \n				THEN CASE \n							WHEN IFNULL(VISITS.qualifier,0) = ${visitsqualifier}\n							THEN \'billable\'\n							WHEN ( IFNULL(VISITS.qualifier,0) + IFNULL(PHONE.qualifier,0) ) = ${visitsqualifier}\n							THEN \'billable\'\n							WHEN ( IFNULL(VISITS.qualifier,0) + IFNULL(GVISIT.qualifier,0) ) = ${visitsqualifier}\n							THEN \'billable\'\n							WHEN ( IFNULL( VISITS.qualifier, 0 ) + IFNULL( ACPVISIT.qualifier, 0 ) ) = ${visitsqualifier}\n							THEN \'billable\'\n							ELSE \'recall\'\n					 END\n				ELSE \'-\'\n				END\" title=\"CDM Status\" primary=\"false\" />	\n				\n			<column id=\"lastBillDate\" name=\"IFNULL( DATE_FORMAT( DATE(BILL.service_date), \'%m-%d-%Y\' ), 0)\" title=\"Last Bill\" primary=\"false\" />				\n			<column id=\"dxDate\" name=\"DATE_FORMAT( dxr.start_date , \'%m-%d-%Y\' )\" title=\"Dx Date\" primary=\"false\" />			\n			<column id=\"visitDate\" name=\"IFNULL( DATE_FORMAT(VISITS.service, \'%m-%d-%Y\' ), \'\')\" title=\"Last MD Visit\" primary=\"false\" />\n			<column id=\"phoneDate\" name=\"IFNULL(DATE_FORMAT(PHONE.service, \'%m-%d-%Y\' ), \'\')\" title=\"Last Phone\" primary=\"false\" /> \n			<column id=\"groupDate\" name=\"IFNULL(DATE_FORMAT(GVISIT.service, \'%m-%d-%Y\' ), \'\')\" title=\"Last Grp Visit\" primary=\"false\" />\n			<column id=\"acpDate\" name=\"IFNULL(DATE_FORMAT(ACPVISIT.service, \'%m-%d-%Y\' ), \'\')\" title=\"Last ACP Visit\" primary=\"false\" />\n			\n		</displayColumns>\n		<exportColumns>\n 			<column id=\"demographicNo\" name=\"d.demographic_no\" title=\"Id\" primary=\"true\" />\n			<column id=\"name\" name=\"CONCAT( d.last_name, \', \',d.first_name )\" title=\"Name\" primary=\"false\" />\n			<column id=\"age\" name=\"FLOOR( ABS( DATEDIFF( DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), NOW() ) ) / 365.25 )\" title=\"Age\" primary=\"false\" />\n			<column id=\"gender\" name=\"d.sex\" title=\"Gender\" primary=\"false\" />	\n					\n			<column id=\"billStatus\" name=\"CASE WHEN IFNULL(EXCLUDE_BILL.billing_code,0) > 0\n				THEN \'palliative\' \n				WHEN ( ABS( DATEDIFF( dxr.start_date, ${today} ) ) >= ${daysanniversary} )  \n						AND ( IFNULL(BILL.service_date, 0) = 0 )\n						AND ( (IFNULL(EXCLUDE_DX.code1,0) = 0) AND (IFNULL(EXCLUDE_DX.code2,0) = 0) ) \n				THEN CASE \n							WHEN IFNULL(VISITS.qualifier,0) = ${visitsqualifier}\n							THEN \'billable\'\n							WHEN ( IFNULL(VISITS.qualifier,0) + IFNULL(PHONE.qualifier,0) ) = ${visitsqualifier}\n							THEN \'billable\'\n							WHEN ( IFNULL(VISITS.qualifier,0) + IFNULL(GVISIT.qualifier,0) ) = ${visitsqualifier}\n							THEN \'billable\'\n							WHEN ( IFNULL( VISITS.qualifier, 0 ) + IFNULL( ACPVISIT.qualifier, 0 ) ) = ${visitsqualifier}\n							THEN \'billable\'\n							ELSE \'recall\'\n					 END\n				ELSE \'-\'\n				END\" title=\"CDM Status\" primary=\"false\" />	\n				\n			<column id=\"lastBillDate\" name=\"IFNULL( DATE_FORMAT( DATE(BILL.service_date), \'%m-%d-%Y\' ), 0)\" title=\"Last Bill\" primary=\"false\" />				\n			<column id=\"dxDate\" name=\"DATE_FORMAT( dxr.start_date , \'%m-%d-%Y\' )\" title=\"Dx Date\" primary=\"false\" />			\n			<column id=\"visitDate\" name=\"IFNULL( DATE_FORMAT(VISITS.service, \'%m-%d-%Y\' ), \'\')\" title=\"Last MD Visit\" primary=\"false\" />\n			<column id=\"phoneDate\" name=\"IFNULL(DATE_FORMAT(PHONE.service, \'%m-%d-%Y\' ), \'\')\" title=\"Last Phone\" primary=\"false\" /> \n			<column id=\"groupDate\" name=\"IFNULL(DATE_FORMAT(GVISIT.service, \'%m-%d-%Y\' ), \'\')\" title=\"Last Grp Visit\" primary=\"false\" />\n			<column id=\"acpDate\" name=\"IFNULL(DATE_FORMAT(ACPVISIT.service, \'%m-%d-%Y\' ), \'\')\" title=\"Last ACP Visit\" primary=\"false\" />\n		</exportColumns>\n		<query>\n			<!-- Drilldown SQL Query here -->\n			SELECT *\n			FROM demographic d \n			INNER JOIN dxresearch dxr \n			ON ( d.demographic_no = dxr.demographic_no ) \n				LEFT JOIN (\n					SELECT bm.demographic_no, bm.billingstatus, bm.billing_code, bm.service_date\n					FROM billingmaster bm\n					INNER JOIN (\n						SELECT MAX(service_date) AS service, demographic_no AS demographic\n						FROM billingmaster\n						WHERE billing_code = ${bonusBillingcode}\n						AND billingstatus NOT IN ${excludeBillingStatus}\n						AND DATE(service_date) BETWEEN DATE_SUB( ${today}, INTERVAL ${daysanniversary} DAY ) AND ${today}\n						GROUP BY demographic_no\n					) current\n					ON ( current.demographic = bm.demographic_no AND current.service = bm.service_date ) \n					WHERE bm.billing_code = ${bonusBillingcode}\n				) BILL\n				ON(BILL.demographic_no = d.demographic_no)\n				LEFT JOIN (\n					SELECT 	COUNT(demographic_no) AS \'count\',\n							CASE \n								WHEN COUNT(demographic_no) = 1\n								THEN 1\n								WHEN COUNT(demographic_no) > 1\n								THEN 2\n								ELSE 0\n							END AS \'qualifier\',\n							demographic_no, \n							MAX(service_date) AS service\n					FROM billingmaster\n					WHERE billingstatus LIKE ${billingStatus}\n					AND DATE(service_date) BETWEEN DATE_SUB( ${today}, INTERVAL ${daysanniversary} DAY ) AND ${today}\n					AND billing_code IN ${visitBillingcode} \n					GROUP BY demographic_no\n				) VISITS\n				ON (VISITS.demographic_no = d.demographic_no)\n				LEFT JOIN (\n					SELECT 	COUNT(demographic_no) AS \'count\', \n							IF( COUNT(demographic_no) > 0, 1, 0) AS \'qualifier\',\n							demographic_no, \n							MAX(service_date) AS service\n					FROM billingmaster\n					WHERE billingstatus LIKE ${billingStatus}\n					AND DATE( service_date ) BETWEEN DATE_SUB( ${today}, INTERVAL ${daysanniversary} DAY ) AND ${today}	\n					AND billing_code IN ${phoneBillingcode} \n					GROUP BY demographic_no\n				) PHONE\n				ON (PHONE.demographic_no = d.demographic_no)\n				LEFT JOIN (\n					SELECT 	COUNT(demographic_no) AS \'count\', \n							IF( COUNT(demographic_no) > 0, 1, 0) AS \'qualifier\',\n							demographic_no, \n							MAX(service_date) AS service\n					FROM billingmaster\n					WHERE billingstatus LIKE ${billingStatus}\n					AND DATE(service_date) BETWEEN DATE_SUB( ${today}, INTERVAL ${daysanniversary} DAY ) AND ${today}\n					AND billing_code BETWEEN ${lowerLimit.groupBillingcode} AND ${upperLimit.groupBillingcode}	\n					GROUP BY demographic_no\n				) GVISIT\n				ON ( GVISIT.demographic_no = d.demographic_no)\n				LEFT JOIN (\n					SELECT 	COUNT(demographic_no) AS \'count\', \n							IF( COUNT(demographic_no) > 0, 1, 0) AS \'qualifier\',\n							demographic_no, \n							MAX(service_date) AS service\n					FROM billingmaster\n					WHERE billingstatus LIKE ${billingStatus}\n					AND DATE(service_date) BETWEEN DATE_SUB( ${today}, INTERVAL ${daysanniversary} DAY ) AND ${today}\n					AND billing_code = ${acpBillingcode}\n					GROUP BY demographic_no\n				) ACPVISIT\n				ON ( ACPVISIT.demographic_no = d.demographic_no)\n				LEFT JOIN (\n					SELECT 	IFNULL( MIN(dxresearch_code), 0) AS code1, \n							IF( IFNULL( MIN(dxresearch_code), 0) != IFNULL( MAX(dxresearch_code),0 ), MAX(dxresearch_code), 0) AS code2, \n							demographic_no\n					FROM dxresearch\n					WHERE dxresearch_code IN ${excludeDxCode}\n					AND `status` LIKE ${dxcodestatus} \n					GROUP BY demographic_no\n				) EXCLUDE_DX\n				ON ( EXCLUDE_DX.demographic_no = d.demographic_no)\n				LEFT JOIN (\n					SELECT billing_code, demographic_no\n					FROM billingmaster bm\n					WHERE billingstatus LIKE ${billingStatus}\n					AND billing_code LIKE ${excludeBillingcode}	\n					GROUP BY demographic_no HAVING COUNT(demographic_no) > -1\n				) EXCLUDE_BILL\n				ON(EXCLUDE_BILL.demographic_no = d.demographic_no )\n			WHERE d.patient_status LIKE ${pstatus} \n			AND dxr.dxresearch_code LIKE ${dxcode} \n			AND dxr.`status` LIKE ${dxcodestatus} \n			AND d.demographic_no > 0 \n			AND d.last_name NOT IN ${patientNameExclude}\n			AND d.provider_no LIKE ${provider}\n			ORDER BY `CDM Status` DESC				\n		</query>\n	</drillDownQuery>\n	<shared>false</shared>\n	<sharedMetricSetName></sharedMetricSetName>\n	<sharedMetricDataId></sharedMetricDataId>\n	<sharedMappings>\n		<sharedMapping fromLabel=\"\" toLabel=\"\"/>\n	</sharedMappings>\n</indicatorTemplateXML>\n','','\0',0,NULL,NULL),
(3,1,'Hypertension (G14052)','Billing','CDM Incentive Program','GP Services Committee: Chronic Disease Management Incentives','2016-01-01','Annual chronic care incentive for full service most responsible general practitioner.','\n			Details here: https://sgp.bc.ca/fee/hypertension-chronic-care-incentive-copy/\n		','<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<indicatorTemplateXML>\n	<author>Colcamex Resources Inc. for Oscar BC</author>\n	<uid></uid>\n	<heading>\n		<category>Billing</category>\n		<subCategory>CDM Incentive Program</subCategory>\n		<name>Hypertension (G14052)</name>\n		<definition>Annual chronic care incentive for full service most responsible general practitioner.</definition>\n		<framework>GP Services Committee: Chronic Disease Management Incentives</framework>\n		<frameworkVersion>01-01-2016</frameworkVersion>\n		<notes>\n			Details here: https://sgp.bc.ca/fee/hypertension-chronic-care-incentive-copy/\n		</notes>\n	</heading>\n	<indicatorQuery>\n		<version>10-01-2017</version>\n		<params>\n			<!-- \n				Required parameter provider. Value options are: \n					[ an individual providerNo, or provider range ] ie: value=\"370, 1001\" \n					\"all\" ie: value=\"all\" including null.\n					\"loggedInProvider\" ie:\n				Default is \"loggedInProvider\"\n				Use this parameter in the query as ${provider}\n				This parameter should be used for fetching patient\'s assigned to a MRP.\n				ie: WHERE demographic.provider_no = ${provider}\n			-->\n			<parameter id=\"provider\" name=\"provider_no\" value=\"loggedInProvider\" />\n			<parameter id=\"pstatus\" name=\"patient_status\" value=\"\'%AC%\'\" />\n			<parameter id=\"daysanniversary\" name=\"days_anniversary\" value=\"365\" />\n			<parameter id=\"today\" name=\"today\" value=\"DATE(NOW())\" />\n			<parameter id=\"visitsqualifier\" name=\"visits_qualifier\" value=\"2\" />\n			<parameter id=\"billingStatus\" name=\"billing_status\" value=\"\'%S%\'\" />\n			<parameter id=\"excludeBillingStatus\" name=\"billing_status\" value=\"%D%,%R%,%F%,%N%\" />\n						\n			<parameter id=\"bonusBillingcode\" name=\"billing_code\" value=\"14052\" />			\n			<parameter id=\"phoneBillingcode\" name=\"billing_code\" value=\"14076,14079\" />	\n			<parameter id=\"acpBillingcode\" name=\"billing_code\" value=\"14029\" />			\n			<parameter id=\"visitBillingcode\" name=\"billing_code\" value=\"12100,00100,15300,16100,17100,18100,\n				12101,00101,15301,16101,17101,18101,12120,00120,15320,16120,17120,18120,00103,\n				14090,14091,14094,00114,00115\" />				\n			<parameter id=\"excludeBillingcode\" name=\"billing_code\" value=\"14063\" />							\n			<parameter id=\"excludeDxCode\" name=\"dxresearch_code\" value=\"428,250\" />\n			<parameter id=\"dxcode\" name=\"dxresearch_code\" value=\"401\" />\n			\n			<parameter id=\"dxcodestatus\" name=\"status\" value=\"\'%A%\'\" />\n			<parameter id=\"patientNameExclude\" name=\"last_name\" value=\"TEST%,BOOP,INTEGRATOR%\" />	\n		</params>\n		\n        <range>\n            <upperLimit id=\"groupBillingcode\" label=\"Group Visit Upper\" name=\"Group Visit Upper\" value=\"13781\" />\n            <lowerLimit id=\"groupBillingcode\" label=\"Group Visit Lower\" name=\"Group Visit Lower\" value=\"13763\" />\n        </range>\n\n		<query>\n			<!-- Indicator SQL Query here -->\n			SELECT			 \n				ROUND( IFNULL( SUM( CASE\n					WHEN d.demographic_no &gt; 0\n					THEN 1\n					ELSE 0\n				END ),0), 1 ) AS \"Patients up to date\",\n			\n				ROUND( IFNULL( SUM( CASE\n				WHEN ( ABS( DATEDIFF( dxr.start_date, ${today} ) ) &gt;= ${daysanniversary} )  \n						AND ( IFNULL(BILL.service_date, 0) = 0 )\n						AND ( (IFNULL(EXCLUDE_DX.code1,0) = 0) AND (IFNULL(EXCLUDE_DX.code2,0) = 0) )  \n				THEN CASE \n							WHEN IFNULL(VISITS.qualifier,0) = ${visitsqualifier}\n							THEN 1\n							WHEN ( IFNULL(VISITS.qualifier,0) + IFNULL(PHONE.qualifier,0) ) = ${visitsqualifier}\n							THEN 1\n							WHEN ( IFNULL(VISITS.qualifier,0) + IFNULL(GVISIT.qualifier,0) ) = ${visitsqualifier}\n							THEN 1\n							WHEN ( IFNULL(VISITS.qualifier,0) + IFNULL(ACPVISIT.qualifier,0) ) = ${visitsqualifier}\n							THEN 1\n							ELSE 0\n					 END\n				ELSE 0 \n				END ),0), 1) AS \"Patients billable\",\n			\n				ROUND( IFNULL(  SUM( CASE\n				WHEN ( ABS( DATEDIFF( dxr.start_date, ${today} ) ) &gt;= ${daysanniversary} )  \n						AND ( IFNULL(BILL.service_date, 0) = 0 )\n						AND ( (IFNULL(EXCLUDE_DX.code1,0) = 0) AND (IFNULL(EXCLUDE_DX.code2,0) = 0) ) \n						AND IFNULL(VISITS.qualifier,0) &lt; ${visitsqualifier}\n						AND IFNULL(VISITS.qualifier,0) + IFNULL(PHONE.qualifier,0) &lt; ${visitsqualifier}\n						AND IFNULL(VISITS.qualifier,0) + IFNULL(GVISIT.qualifier,0) &lt; ${visitsqualifier}\n						AND IFNULL(VISITS.qualifier,0) + IFNULL(ACPVISIT.qualifier,0) &lt; ${visitsqualifier}\n				THEN 1\n				ELSE 0\n				END ),0), 1) AS \"Patients recall\" \n\n			FROM demographic d \n			INNER JOIN dxresearch dxr \n			ON ( d.demographic_no = dxr.demographic_no ) \n				LEFT JOIN (\n					SELECT bm.demographic_no, bm.billingstatus, bm.billing_code, bm.service_date\n					FROM billingmaster bm\n					INNER JOIN (\n						SELECT MAX(service_date) AS service, demographic_no AS demographic\n						FROM billingmaster\n						WHERE billing_code = ${bonusBillingcode}\n						AND billingstatus NOT IN ${excludeBillingStatus}\n						AND DATE(service_date) BETWEEN DATE_SUB( ${today}, INTERVAL ${daysanniversary} DAY ) AND ${today}\n						GROUP BY demographic_no\n					) current\n					ON ( current.demographic = bm.demographic_no AND current.service = bm.service_date ) \n					WHERE bm.billing_code = ${bonusBillingcode}\n				) BILL\n				ON(BILL.demographic_no = d.demographic_no)\n				LEFT JOIN (\n					SELECT 	COUNT(demographic_no) AS \'count\',\n							CASE \n								WHEN COUNT(demographic_no) = 1\n								THEN 1\n								WHEN COUNT(demographic_no) > 1\n								THEN 2\n								ELSE 0\n							END AS \'qualifier\',\n							demographic_no, \n							MAX(service_date) AS service\n					FROM billingmaster\n					WHERE billingstatus LIKE ${billingStatus}\n					AND DATE(service_date) BETWEEN DATE_SUB( ${today}, INTERVAL ${daysanniversary} DAY ) AND ${today}\n					AND billing_code IN ${visitBillingcode} \n					GROUP BY demographic_no\n				) VISITS\n				ON (VISITS.demographic_no = d.demographic_no)\n				LEFT JOIN (\n					SELECT 	COUNT(demographic_no) AS \'count\', \n							IF( COUNT(demographic_no) > 0, 1, 0) AS \'qualifier\',\n							demographic_no, \n							MAX(service_date) AS service\n					FROM billingmaster\n					WHERE billingstatus LIKE ${billingStatus}\n					AND DATE( service_date ) BETWEEN DATE_SUB( ${today}, INTERVAL ${daysanniversary} DAY ) AND ${today}	\n					AND billing_code IN ${phoneBillingcode} \n					GROUP BY demographic_no\n				) PHONE\n				ON (PHONE.demographic_no = d.demographic_no)\n				LEFT JOIN (\n					SELECT 	COUNT(demographic_no) AS \'count\', \n							IF( COUNT(demographic_no) > 0, 1, 0) AS \'qualifier\',\n							demographic_no, \n							MAX(service_date) AS service\n					FROM billingmaster\n					WHERE billingstatus LIKE ${billingStatus}\n					AND DATE(service_date) BETWEEN DATE_SUB( ${today}, INTERVAL ${daysanniversary} DAY ) AND ${today}\n					AND billing_code BETWEEN ${lowerLimit.groupBillingcode} AND ${upperLimit.groupBillingcode}	\n					GROUP BY demographic_no\n				) GVISIT\n				ON ( GVISIT.demographic_no = d.demographic_no)\n				LEFT JOIN (\n					SELECT 	COUNT(demographic_no) AS \'count\', \n							IF( COUNT(demographic_no) > 0, 1, 0) AS \'qualifier\',\n							demographic_no, \n							MAX(service_date) AS service\n					FROM billingmaster\n					WHERE billingstatus LIKE ${billingStatus}\n					AND DATE(service_date) BETWEEN DATE_SUB( ${today}, INTERVAL ${daysanniversary} DAY ) AND ${today}\n					AND billing_code = ${acpBillingcode}\n					GROUP BY demographic_no\n				) ACPVISIT\n				ON ( ACPVISIT.demographic_no = d.demographic_no)\n				LEFT JOIN (\n					SELECT 	IFNULL( MIN(dxresearch_code), 0) AS code1, \n							IF( IFNULL( MIN(dxresearch_code), 0) != IFNULL( MAX(dxresearch_code),0 ), MAX(dxresearch_code), 0) AS code2, \n							demographic_no\n					FROM dxresearch\n					WHERE dxresearch_code IN ${excludeDxCode}\n					AND `status` LIKE ${dxcodestatus} \n					GROUP BY demographic_no\n				) EXCLUDE_DX\n				ON ( EXCLUDE_DX.demographic_no = d.demographic_no)\n				LEFT JOIN (\n					SELECT billing_code, demographic_no\n					FROM billingmaster bm\n					WHERE billingstatus LIKE ${billingStatus}\n					AND billing_code LIKE ${excludeBillingcode}	\n					GROUP BY demographic_no HAVING COUNT(demographic_no) > -1\n				) EXCLUDE_BILL\n				ON(EXCLUDE_BILL.demographic_no = d.demographic_no )\n			WHERE d.patient_status LIKE ${pstatus} \n			AND dxr.dxresearch_code LIKE ${dxcode} \n			AND dxr.`status` LIKE ${dxcodestatus} \n			AND d.demographic_no > 0 \n			AND d.last_name NOT IN ${patientNameExclude}\n			AND d.provider_no LIKE ${provider}			\n		</query>\n	</indicatorQuery>\n	<drillDownQuery>\n		<version>10-01-2017</version>\n		<params>\n			<parameter id=\"provider\" name=\"provider_no\" value=\"loggedInProvider\" />\n			<parameter id=\"pstatus\" name=\"patient_status\" value=\"\'%AC%\'\" />\n			<parameter id=\"daysanniversary\" name=\"days_anniversary\" value=\"365\" />\n			<parameter id=\"today\" name=\"today\" value=\"DATE(NOW())\" />\n			<parameter id=\"visitsqualifier\" name=\"visits_qualifier\" value=\"2\" />\n			<parameter id=\"billingStatus\" name=\"billing_status\" value=\"\'%S%\'\" />\n			<parameter id=\"excludeBillingStatus\" name=\"billing_status\" value=\"%D%,%R%,%F%,%N%\" />\n						\n			<parameter id=\"bonusBillingcode\" name=\"billing_code\" value=\"14052\" />			\n			<parameter id=\"phoneBillingcode\" name=\"billing_code\" value=\"14076,14079\" />	\n			<parameter id=\"acpBillingcode\" name=\"billing_code\" value=\"14029\" />			\n			<parameter id=\"visitBillingcode\" name=\"billing_code\" value=\"12100,00100,15300,16100,17100,18100,\n				12101,00101,15301,16101,17101,18101,12120,00120,15320,16120,17120,18120,00103,\n				14090,14091,14094,00114,00115\" />				\n			<parameter id=\"excludeBillingcode\" name=\"billing_code\" value=\"14063\" />							\n			<parameter id=\"excludeDxCode\" name=\"dxresearch_code\" value=\"428,250\" />\n			<parameter id=\"dxcode\" name=\"dxresearch_code\" value=\"401\" />\n			\n			<parameter id=\"dxcodestatus\" name=\"status\" value=\"\'%A%\'\" />\n			<parameter id=\"patientNameExclude\" name=\"last_name\" value=\"TEST%,BOOP,INTEGRATOR%\" />		\n		</params>\n			\n		<range>\n			<upperLimit id=\"groupBillingcode\" label=\"Group Visit Upper\" name=\"Group Visit Upper\" value=\"13781\" />\n			<lowerLimit id=\"groupBillingcode\" label=\"Group Visit Lower\" name=\"Group Visit Lower\" value=\"13763\" />\n		</range>\n		\n		<displayColumns>\n			<column id=\"demographicNo\" name=\"d.demographic_no\" title=\"Id\" primary=\"true\" />\n			<column id=\"name\" name=\"CONCAT( d.last_name, \', \',d.first_name )\" title=\"Name\" primary=\"false\" />\n			<column id=\"age\" name=\"FLOOR( ABS( DATEDIFF( DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), NOW() ) ) / 365.25 )\" title=\"Age\" primary=\"false\" />\n			<column id=\"gender\" name=\"d.sex\" title=\"Gender\" primary=\"false\" />	\n					\n			<column id=\"billStatus\" name=\"CASE WHEN IFNULL(EXCLUDE_BILL.billing_code,0) > 0\n				THEN \'palliative\' \n				WHEN ( ABS( DATEDIFF( dxr.start_date, ${today} ) ) >= ${daysanniversary} )  \n						AND ( IFNULL(BILL.service_date, 0) = 0 )\n						AND ( (IFNULL(EXCLUDE_DX.code1,0) = 0) AND (IFNULL(EXCLUDE_DX.code2,0) = 0) ) \n				THEN CASE \n							WHEN IFNULL(VISITS.qualifier,0) = ${visitsqualifier}\n							THEN \'billable\'\n							WHEN ( IFNULL(VISITS.qualifier,0) + IFNULL(PHONE.qualifier,0) ) = ${visitsqualifier}\n							THEN \'billable\'\n							WHEN ( IFNULL(VISITS.qualifier,0) + IFNULL(GVISIT.qualifier,0) ) = ${visitsqualifier}\n							THEN \'billable\'\n							WHEN ( IFNULL( VISITS.qualifier, 0 ) + IFNULL( ACPVISIT.qualifier, 0 ) ) = ${visitsqualifier}\n							THEN \'billable\'\n							ELSE \'recall\'\n					 END\n				ELSE \'-\'\n				END\" title=\"CDM Status\" primary=\"false\" />	\n				\n			<column id=\"lastBillDate\" name=\"IFNULL( DATE_FORMAT( DATE(BILL.service_date), \'%m-%d-%Y\' ), 0)\" title=\"Last Bill\" primary=\"false\" />				\n			<column id=\"dxDate\" name=\"DATE_FORMAT( dxr.start_date , \'%m-%d-%Y\' )\" title=\"Dx Date\" primary=\"false\" />			\n			<column id=\"visitDate\" name=\"IFNULL( DATE_FORMAT(VISITS.service, \'%m-%d-%Y\' ), \'\')\" title=\"Last MD Visit\" primary=\"false\" />\n			<column id=\"phoneDate\" name=\"IFNULL(DATE_FORMAT(PHONE.service, \'%m-%d-%Y\' ), \'\')\" title=\"Last Phone\" primary=\"false\" /> \n			<column id=\"groupDate\" name=\"IFNULL(DATE_FORMAT(GVISIT.service, \'%m-%d-%Y\' ), \'\')\" title=\"Last Grp Visit\" primary=\"false\" />\n			<column id=\"acpDate\" name=\"IFNULL(DATE_FORMAT(ACPVISIT.service, \'%m-%d-%Y\' ), \'\')\" title=\"Last ACP Visit\" primary=\"false\" />\n			\n		</displayColumns>\n		<exportColumns>\n 			<column id=\"demographicNo\" name=\"d.demographic_no\" title=\"Id\" primary=\"true\" />\n			<column id=\"name\" name=\"CONCAT( d.last_name, \', \',d.first_name )\" title=\"Name\" primary=\"false\" />\n			<column id=\"age\" name=\"FLOOR( ABS( DATEDIFF( DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), NOW() ) ) / 365.25 )\" title=\"Age\" primary=\"false\" />\n			<column id=\"gender\" name=\"d.sex\" title=\"Gender\" primary=\"false\" />	\n					\n			<column id=\"billStatus\" name=\"CASE WHEN IFNULL(EXCLUDE_BILL.billing_code,0) > 0\n				THEN \'palliative\' \n				WHEN ( ABS( DATEDIFF( dxr.start_date, ${today} ) ) >= ${daysanniversary} )  \n						AND ( IFNULL(BILL.service_date, 0) = 0 )\n						AND ( (IFNULL(EXCLUDE_DX.code1,0) = 0) AND (IFNULL(EXCLUDE_DX.code2,0) = 0) ) \n				THEN CASE \n							WHEN IFNULL(VISITS.qualifier,0) = ${visitsqualifier}\n							THEN \'billable\'\n							WHEN ( IFNULL(VISITS.qualifier,0) + IFNULL(PHONE.qualifier,0) ) = ${visitsqualifier}\n							THEN \'billable\'\n							WHEN ( IFNULL(VISITS.qualifier,0) + IFNULL(GVISIT.qualifier,0) ) = ${visitsqualifier}\n							THEN \'billable\'\n							WHEN ( IFNULL( VISITS.qualifier, 0 ) + IFNULL( ACPVISIT.qualifier, 0 ) ) = ${visitsqualifier}\n							THEN \'billable\'\n							ELSE \'recall\'\n					 END\n				ELSE \'-\'\n				END\" title=\"CDM Status\" primary=\"false\" />	\n				\n			<column id=\"lastBillDate\" name=\"IFNULL( DATE_FORMAT( DATE(BILL.service_date), \'%m-%d-%Y\' ), 0)\" title=\"Last Bill\" primary=\"false\" />				\n			<column id=\"dxDate\" name=\"DATE_FORMAT( dxr.start_date , \'%m-%d-%Y\' )\" title=\"Dx Date\" primary=\"false\" />			\n			<column id=\"visitDate\" name=\"IFNULL( DATE_FORMAT(VISITS.service, \'%m-%d-%Y\' ), \'\')\" title=\"Last MD Visit\" primary=\"false\" />\n			<column id=\"phoneDate\" name=\"IFNULL(DATE_FORMAT(PHONE.service, \'%m-%d-%Y\' ), \'\')\" title=\"Last Phone\" primary=\"false\" /> \n			<column id=\"groupDate\" name=\"IFNULL(DATE_FORMAT(GVISIT.service, \'%m-%d-%Y\' ), \'\')\" title=\"Last Grp Visit\" primary=\"false\" />\n			<column id=\"acpDate\" name=\"IFNULL(DATE_FORMAT(ACPVISIT.service, \'%m-%d-%Y\' ), \'\')\" title=\"Last ACP Visit\" primary=\"false\" />\n		</exportColumns>\n		<query>\n			<!-- Drilldown SQL Query here -->\n			SELECT *\n			FROM demographic d \n			INNER JOIN dxresearch dxr \n			ON ( d.demographic_no = dxr.demographic_no ) \n				LEFT JOIN (\n					SELECT bm.demographic_no, bm.billingstatus, bm.billing_code, bm.service_date\n					FROM billingmaster bm\n					INNER JOIN (\n						SELECT MAX(service_date) AS service, demographic_no AS demographic\n						FROM billingmaster\n						WHERE billing_code = ${bonusBillingcode}\n						AND billingstatus NOT IN ${excludeBillingStatus}\n						AND DATE(service_date) BETWEEN DATE_SUB( ${today}, INTERVAL ${daysanniversary} DAY ) AND ${today}\n						GROUP BY demographic_no\n					) current\n					ON ( current.demographic = bm.demographic_no AND current.service = bm.service_date ) \n					WHERE bm.billing_code = ${bonusBillingcode}\n				) BILL\n				ON(BILL.demographic_no = d.demographic_no)\n				LEFT JOIN (\n					SELECT 	COUNT(demographic_no) AS \'count\',\n							CASE \n								WHEN COUNT(demographic_no) = 1\n								THEN 1\n								WHEN COUNT(demographic_no) > 1\n								THEN 2\n								ELSE 0\n							END AS \'qualifier\',\n							demographic_no, \n							MAX(service_date) AS service\n					FROM billingmaster\n					WHERE billingstatus LIKE ${billingStatus}\n					AND DATE(service_date) BETWEEN DATE_SUB( ${today}, INTERVAL ${daysanniversary} DAY ) AND ${today}\n					AND billing_code IN ${visitBillingcode} \n					GROUP BY demographic_no\n				) VISITS\n				ON (VISITS.demographic_no = d.demographic_no)\n				LEFT JOIN (\n					SELECT 	COUNT(demographic_no) AS \'count\', \n							IF( COUNT(demographic_no) > 0, 1, 0) AS \'qualifier\',\n							demographic_no, \n							MAX(service_date) AS service\n					FROM billingmaster\n					WHERE billingstatus LIKE ${billingStatus}\n					AND DATE( service_date ) BETWEEN DATE_SUB( ${today}, INTERVAL ${daysanniversary} DAY ) AND ${today}	\n					AND billing_code IN ${phoneBillingcode} \n					GROUP BY demographic_no\n				) PHONE\n				ON (PHONE.demographic_no = d.demographic_no)\n				LEFT JOIN (\n					SELECT 	COUNT(demographic_no) AS \'count\', \n							IF( COUNT(demographic_no) > 0, 1, 0) AS \'qualifier\',\n							demographic_no, \n							MAX(service_date) AS service\n					FROM billingmaster\n					WHERE billingstatus LIKE ${billingStatus}\n					AND DATE(service_date) BETWEEN DATE_SUB( ${today}, INTERVAL ${daysanniversary} DAY ) AND ${today}\n					AND billing_code BETWEEN ${lowerLimit.groupBillingcode} AND ${upperLimit.groupBillingcode}	\n					GROUP BY demographic_no\n				) GVISIT\n				ON ( GVISIT.demographic_no = d.demographic_no)\n				LEFT JOIN (\n					SELECT 	COUNT(demographic_no) AS \'count\', \n							IF( COUNT(demographic_no) > 0, 1, 0) AS \'qualifier\',\n							demographic_no, \n							MAX(service_date) AS service\n					FROM billingmaster\n					WHERE billingstatus LIKE ${billingStatus}\n					AND DATE(service_date) BETWEEN DATE_SUB( ${today}, INTERVAL ${daysanniversary} DAY ) AND ${today}\n					AND billing_code = ${acpBillingcode}\n					GROUP BY demographic_no\n				) ACPVISIT\n				ON ( ACPVISIT.demographic_no = d.demographic_no)\n				LEFT JOIN (\n					SELECT 	IFNULL( MIN(dxresearch_code), 0) AS code1, \n							IF( IFNULL( MIN(dxresearch_code), 0) != IFNULL( MAX(dxresearch_code),0 ), MAX(dxresearch_code), 0) AS code2, \n							demographic_no\n					FROM dxresearch\n					WHERE dxresearch_code IN ${excludeDxCode}\n					AND `status` LIKE ${dxcodestatus} \n					GROUP BY demographic_no\n				) EXCLUDE_DX\n				ON ( EXCLUDE_DX.demographic_no = d.demographic_no)\n				LEFT JOIN (\n					SELECT billing_code, demographic_no\n					FROM billingmaster bm\n					WHERE billingstatus LIKE ${billingStatus}\n					AND billing_code LIKE ${excludeBillingcode}	\n					GROUP BY demographic_no HAVING COUNT(demographic_no) > -1\n				) EXCLUDE_BILL\n				ON(EXCLUDE_BILL.demographic_no = d.demographic_no )\n			WHERE d.patient_status LIKE ${pstatus} \n			AND dxr.dxresearch_code LIKE ${dxcode} \n			AND dxr.`status` LIKE ${dxcodestatus} \n			AND d.demographic_no > 0 \n			AND d.last_name NOT IN ${patientNameExclude}\n			AND d.provider_no LIKE ${provider}\n			ORDER BY `CDM Status` DESC				\n		</query>\n	</drillDownQuery>\n	<shared>false</shared>\n	<sharedMetricSetName></sharedMetricSetName>\n	<sharedMetricDataId></sharedMetricDataId>\n	<sharedMappings>\n		<sharedMapping fromLabel=\"\" toLabel=\"\"/>\n	</sharedMappings>\n</indicatorTemplateXML>\n','','\0',0,NULL,NULL),
(4,1,'COPD (G14053)','Billing','CDM Incentive Program','GP Services Committee: Chronic Disease Management Incentives','2016-01-01','Annual chronic care incentive for full service most responsible general practitioner.','\n			Details here: https://sgp.bc.ca/fee/chronic-obstructive-pulmonary-disease-copd-chronic-care-incentive-copy/\n		','<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<indicatorTemplateXML>\n	<author>Colcamex Resources Inc. for Oscar BC</author>\n	<uid></uid>\n	<heading>\n		<category>Billing</category>\n		<subCategory>CDM Incentive Program</subCategory>\n		<name>COPD (G14053)</name>\n		<definition>Annual chronic care incentive for full service most responsible general practitioner.</definition>\n		<framework>GP Services Committee: Chronic Disease Management Incentives</framework>\n		<frameworkVersion>01-01-2016</frameworkVersion>\n		<notes>\n			Details here: https://sgp.bc.ca/fee/chronic-obstructive-pulmonary-disease-copd-chronic-care-incentive-copy/\n		</notes>\n	</heading>\n	<indicatorQuery>\n		<version>10-01-2017</version>\n		<params>\n			<!-- \n				Required parameter provider. Value options are: \n					[ an individual providerNo, or provider range ] ie: value=\"370, 1001\" \n					\"all\" ie: value=\"all\" including null.\n					\"loggedInProvider\" ie:\n				Default is \"loggedInProvider\"\n				Use this parameter in the query as ${provider}\n				This parameter should be used for fetching patient\'s assigned to a MRP.\n				ie: WHERE demographic.provider_no = ${provider}\n			-->\n			<parameter id=\"provider\" name=\"provider_no\" value=\"loggedInProvider\" />\n			<parameter id=\"pstatus\" name=\"patient_status\" value=\"\'%AC%\'\" />\n			<parameter id=\"daysanniversary\" name=\"days_anniversary\" value=\"365\" />\n			<parameter id=\"today\" name=\"today\" value=\"DATE(NOW())\" />\n			<parameter id=\"visitsqualifier\" name=\"visits_qualifier\" value=\"2\" />\n			<parameter id=\"billingStatus\" name=\"billing_status\" value=\"\'%S%\'\" />\n			<parameter id=\"excludeBillingStatus\" name=\"billing_status\" value=\"%D%,%R%,%F%,%N%\" />\n						\n			<parameter id=\"bonusBillingcode\" name=\"billing_code\" value=\"14053\" />			\n			<parameter id=\"phoneBillingcode\" name=\"billing_code\" value=\"14076,14079\" />	\n			<parameter id=\"acpBillingcode\" name=\"billing_code\" value=\"14029\" />			\n			<parameter id=\"visitBillingcode\" name=\"billing_code\" value=\"12100,00100,15300,16100,17100,18100,\n				12101,00101,15301,16101,17101,18101,12120,00120,15320,16120,17120,18120,00103,\n				14090,14091,14094,00114,00115\" />				\n			<parameter id=\"excludeBillingcode\" name=\"billing_code\" value=\"14063\" />							\n			<parameter id=\"excludeDxCode\" name=\"dxresearch_code\" value=\"\'\'\" />\n			<parameter id=\"dxcode\" name=\"dxresearch_code\" value=\"491,492,494,496\" />\n			\n			<parameter id=\"dxcodestatus\" name=\"status\" value=\"\'%A%\'\" />\n			<parameter id=\"patientNameExclude\" name=\"last_name\" value=\"TEST%,BOOP,INTEGRATOR%\" />	\n		</params>\n		\n        <range>\n            <upperLimit id=\"groupBillingcode\" label=\"Group Visit Upper\" name=\"Group Visit Upper\" value=\"13781\" />\n            <lowerLimit id=\"groupBillingcode\" label=\"Group Visit Lower\" name=\"Group Visit Lower\" value=\"13763\" />\n        </range>\n\n		<query>\n			<!-- Indicator SQL Query here -->\n			SELECT			 \n				ROUND( IFNULL( SUM( CASE\n					WHEN d.demographic_no &gt; 0\n					THEN 1\n					ELSE 0\n				END ),0), 1 ) AS \"Patients up to date\",\n			\n				ROUND( IFNULL( SUM( CASE\n				WHEN ( ABS( DATEDIFF( dxr.start_date, ${today} ) ) &gt;= ${daysanniversary} )  \n						AND ( IFNULL(BILL.service_date, 0) = 0 )\n						AND ( (IFNULL(EXCLUDE_DX.code1,0) = 0) AND (IFNULL(EXCLUDE_DX.code2,0) = 0) )  \n				THEN CASE \n							WHEN IFNULL(VISITS.qualifier,0) = ${visitsqualifier}\n							THEN 1\n							WHEN ( IFNULL(VISITS.qualifier,0) + IFNULL(PHONE.qualifier,0) ) = ${visitsqualifier}\n							THEN 1\n							WHEN ( IFNULL(VISITS.qualifier,0) + IFNULL(GVISIT.qualifier,0) ) = ${visitsqualifier}\n							THEN 1\n							WHEN ( IFNULL(VISITS.qualifier,0) + IFNULL(ACPVISIT.qualifier,0) ) = ${visitsqualifier}\n							THEN 1\n							ELSE 0\n					 END\n				ELSE 0 \n				END ),0), 1) AS \"Patients billable\",\n			\n				ROUND( IFNULL( SUM( CASE\n				WHEN ( ABS( DATEDIFF( dxr.start_date, ${today} ) ) &gt;= ${daysanniversary} )  \n						AND ( IFNULL(BILL.service_date, 0) = 0 )\n						AND ( (IFNULL(EXCLUDE_DX.code1,0) = 0) AND (IFNULL(EXCLUDE_DX.code2,0) = 0) ) \n						AND IFNULL(VISITS.qualifier,0) &lt; ${visitsqualifier}\n						AND IFNULL(VISITS.qualifier,0) + IFNULL(PHONE.qualifier,0) &lt; ${visitsqualifier}\n						AND IFNULL(VISITS.qualifier,0) + IFNULL(GVISIT.qualifier,0) &lt; ${visitsqualifier}\n						AND IFNULL(VISITS.qualifier,0) + IFNULL(ACPVISIT.qualifier,0) &lt; ${visitsqualifier}\n				THEN 1\n				ELSE 0\n				END ),0), 1) AS \"Patients recall\" \n\n			FROM demographic d \n			INNER JOIN dxresearch dxr \n			ON ( d.demographic_no = dxr.demographic_no ) \n				LEFT JOIN (\n					SELECT bm.demographic_no, bm.billingstatus, bm.billing_code, bm.service_date\n					FROM billingmaster bm\n					INNER JOIN (\n						SELECT MAX(service_date) AS service, demographic_no AS demographic\n						FROM billingmaster\n						WHERE billing_code = ${bonusBillingcode}\n						AND billingstatus NOT IN ${excludeBillingStatus}\n						AND DATE(service_date) BETWEEN DATE_SUB( ${today}, INTERVAL ${daysanniversary} DAY ) AND ${today}\n						GROUP BY demographic_no\n					) current\n					ON ( current.demographic = bm.demographic_no AND current.service = bm.service_date ) \n					WHERE bm.billing_code = ${bonusBillingcode}\n				) BILL\n				ON(BILL.demographic_no = d.demographic_no)\n				LEFT JOIN (\n					SELECT 	COUNT(demographic_no) AS \'count\',\n							CASE \n								WHEN COUNT(demographic_no) = 1\n								THEN 1\n								WHEN COUNT(demographic_no) > 1\n								THEN 2\n								ELSE 0\n							END AS \'qualifier\',\n							demographic_no, \n							MAX(service_date) AS service\n					FROM billingmaster\n					WHERE billingstatus LIKE ${billingStatus}\n					AND DATE(service_date) BETWEEN DATE_SUB( ${today}, INTERVAL ${daysanniversary} DAY ) AND ${today}\n					AND billing_code IN ${visitBillingcode} \n					GROUP BY demographic_no\n				) VISITS\n				ON (VISITS.demographic_no = d.demographic_no)\n				LEFT JOIN (\n					SELECT 	COUNT(demographic_no) AS \'count\', \n							IF( COUNT(demographic_no) > 0, 1, 0) AS \'qualifier\',\n							demographic_no, \n							MAX(service_date) AS service\n					FROM billingmaster\n					WHERE billingstatus LIKE ${billingStatus}\n					AND DATE( service_date ) BETWEEN DATE_SUB( ${today}, INTERVAL ${daysanniversary} DAY ) AND ${today}	\n					AND billing_code IN ${phoneBillingcode} \n					GROUP BY demographic_no\n				) PHONE\n				ON (PHONE.demographic_no = d.demographic_no)\n				LEFT JOIN (\n					SELECT 	COUNT(demographic_no) AS \'count\', \n							IF( COUNT(demographic_no) > 0, 1, 0) AS \'qualifier\',\n							demographic_no, \n							MAX(service_date) AS service\n					FROM billingmaster\n					WHERE billingstatus LIKE ${billingStatus}\n					AND DATE(service_date) BETWEEN DATE_SUB( ${today}, INTERVAL ${daysanniversary} DAY ) AND ${today}\n					AND billing_code BETWEEN ${lowerLimit.groupBillingcode} AND ${upperLimit.groupBillingcode}	\n					GROUP BY demographic_no\n				) GVISIT\n				ON ( GVISIT.demographic_no = d.demographic_no)\n				LEFT JOIN (\n					SELECT 	COUNT(demographic_no) AS \'count\', \n							IF( COUNT(demographic_no) > 0, 1, 0) AS \'qualifier\',\n							demographic_no, \n							MAX(service_date) AS service\n					FROM billingmaster\n					WHERE billingstatus LIKE ${billingStatus}\n					AND DATE(service_date) BETWEEN DATE_SUB( ${today}, INTERVAL ${daysanniversary} DAY ) AND ${today}\n					AND billing_code = ${acpBillingcode}\n					GROUP BY demographic_no\n				) ACPVISIT\n				ON ( ACPVISIT.demographic_no = d.demographic_no)\n				LEFT JOIN (\n					SELECT 	IFNULL( MIN(dxresearch_code), 0) AS code1, \n							IF( IFNULL( MIN(dxresearch_code), 0) != IFNULL( MAX(dxresearch_code),0 ), MAX(dxresearch_code), 0) AS code2, \n							demographic_no\n					FROM dxresearch\n					WHERE dxresearch_code LIKE ${excludeDxCode}\n					AND `status` LIKE ${dxcodestatus} \n					GROUP BY demographic_no\n				) EXCLUDE_DX\n				ON ( EXCLUDE_DX.demographic_no = d.demographic_no)\n				LEFT JOIN (\n					SELECT billing_code, demographic_no\n					FROM billingmaster bm\n					WHERE billingstatus LIKE ${billingStatus}\n					AND billing_code LIKE ${excludeBillingcode}	\n					GROUP BY demographic_no HAVING COUNT(demographic_no) > -1\n				) EXCLUDE_BILL\n				ON(EXCLUDE_BILL.demographic_no = d.demographic_no )\n			WHERE d.patient_status LIKE ${pstatus} \n			AND dxr.dxresearch_code IN ${dxcode} \n			AND dxr.`status` LIKE ${dxcodestatus} \n			AND d.demographic_no > 0 \n			AND d.last_name NOT IN ${patientNameExclude}\n			AND d.provider_no LIKE ${provider}			\n		</query>\n	</indicatorQuery>\n	<drillDownQuery>\n		<version>10-01-2017</version>\n		<params>\n			<parameter id=\"provider\" name=\"provider_no\" value=\"loggedInProvider\" />\n			<parameter id=\"pstatus\" name=\"patient_status\" value=\"\'%AC%\'\" />\n			<parameter id=\"daysanniversary\" name=\"days_anniversary\" value=\"365\" />\n			<parameter id=\"today\" name=\"today\" value=\"DATE(NOW())\" />\n			<parameter id=\"visitsqualifier\" name=\"visits_qualifier\" value=\"2\" />\n			<parameter id=\"billingStatus\" name=\"billing_status\" value=\"\'%S%\'\" />\n			<parameter id=\"excludeBillingStatus\" name=\"billing_status\" value=\"%D%,%R%,%F%,%N%\" />\n						\n			<parameter id=\"bonusBillingcode\" name=\"billing_code\" value=\"14053\" />			\n			<parameter id=\"phoneBillingcode\" name=\"billing_code\" value=\"14076,14079\" />	\n			<parameter id=\"acpBillingcode\" name=\"billing_code\" value=\"14029\" />			\n			<parameter id=\"visitBillingcode\" name=\"billing_code\" value=\"12100,00100,15300,16100,17100,18100,\n				12101,00101,15301,16101,17101,18101,12120,00120,15320,16120,17120,18120,00103,\n				14090,14091,14094,00114,00115\" />				\n			<parameter id=\"excludeBillingcode\" name=\"billing_code\" value=\"14063\" />							\n			<parameter id=\"excludeDxCode\" name=\"dxresearch_code\" value=\"\'\'\" />\n			<parameter id=\"dxcode\" name=\"dxresearch_code\" value=\"491,492,494,496\" />\n			\n			<parameter id=\"dxcodestatus\" name=\"status\" value=\"\'%A%\'\" />\n			<parameter id=\"patientNameExclude\" name=\"last_name\" value=\"TEST%,BOOP,INTEGRATOR%\" />\n		</params>\n			\n		<range>\n			<upperLimit id=\"groupBillingcode\" label=\"Group Visit Upper\" name=\"Group Visit Upper\" value=\"13781\" />\n			<lowerLimit id=\"groupBillingcode\" label=\"Group Visit Lower\" name=\"Group Visit Lower\" value=\"13763\" />\n		</range>\n		\n		<displayColumns>\n			<column id=\"demographicNo\" name=\"d.demographic_no\" title=\"Id\" primary=\"true\" />\n			<column id=\"name\" name=\"CONCAT( d.last_name, \', \',d.first_name )\" title=\"Name\" primary=\"false\" />\n			<column id=\"age\" name=\"FLOOR( ABS( DATEDIFF( DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), NOW() ) ) / 365.25 )\" title=\"Age\" primary=\"false\" />\n			<column id=\"gender\" name=\"d.sex\" title=\"Gender\" primary=\"false\" />	\n					\n			<column id=\"billStatus\" name=\"CASE WHEN IFNULL(EXCLUDE_BILL.billing_code,0) > 0\n				THEN \'palliative\' \n				WHEN ( ABS( DATEDIFF( dxr.start_date, ${today} ) ) >= ${daysanniversary} )  \n						AND ( IFNULL(BILL.service_date, 0) = 0 )\n						AND ( (IFNULL(EXCLUDE_DX.code1,0) = 0) AND (IFNULL(EXCLUDE_DX.code2,0) = 0) ) \n				THEN CASE \n							WHEN IFNULL(VISITS.qualifier,0) = ${visitsqualifier}\n							THEN \'billable\'\n							WHEN ( IFNULL(VISITS.qualifier,0) + IFNULL(PHONE.qualifier,0) ) = ${visitsqualifier}\n							THEN \'billable\'\n							WHEN ( IFNULL(VISITS.qualifier,0) + IFNULL(GVISIT.qualifier,0) ) = ${visitsqualifier}\n							THEN \'billable\'\n							WHEN ( IFNULL( VISITS.qualifier, 0 ) + IFNULL( ACPVISIT.qualifier, 0 ) ) = ${visitsqualifier}\n							THEN \'billable\'\n							ELSE \'recall\'\n					 END\n				ELSE \'-\'\n				END\" title=\"CDM Status\" primary=\"false\" />	\n				\n			<column id=\"lastBillDate\" name=\"IFNULL( DATE_FORMAT( DATE(BILL.service_date), \'%m-%d-%Y\' ), 0)\" title=\"Last Bill\" primary=\"false\" />				\n			<column id=\"dxDate\" name=\"DATE_FORMAT( dxr.start_date , \'%m-%d-%Y\' )\" title=\"Dx Date\" primary=\"false\" />			\n			<column id=\"visitDate\" name=\"IFNULL( DATE_FORMAT(VISITS.service, \'%m-%d-%Y\' ), \'\')\" title=\"Last MD Visit\" primary=\"false\" />\n			<column id=\"phoneDate\" name=\"IFNULL(DATE_FORMAT(PHONE.service, \'%m-%d-%Y\' ), \'\')\" title=\"Last Phone\" primary=\"false\" /> \n			<column id=\"groupDate\" name=\"IFNULL(DATE_FORMAT(GVISIT.service, \'%m-%d-%Y\' ), \'\')\" title=\"Last Grp Visit\" primary=\"false\" />\n			<column id=\"acpDate\" name=\"IFNULL(DATE_FORMAT(ACPVISIT.service, \'%m-%d-%Y\' ), \'\')\" title=\"Last ACP Visit\" primary=\"false\" />\n			\n		</displayColumns>\n		<exportColumns>\n 			<column id=\"demographicNo\" name=\"d.demographic_no\" title=\"Id\" primary=\"true\" />\n			<column id=\"name\" name=\"CONCAT( d.last_name, \', \',d.first_name )\" title=\"Name\" primary=\"false\" />\n			<column id=\"age\" name=\"FLOOR( ABS( DATEDIFF( DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), NOW() ) ) / 365.25 )\" title=\"Age\" primary=\"false\" />\n			<column id=\"gender\" name=\"d.sex\" title=\"Gender\" primary=\"false\" />	\n					\n			<column id=\"billStatus\" name=\"CASE WHEN IFNULL(EXCLUDE_BILL.billing_code,0) > 0\n				THEN \'palliative\' \n				WHEN ( ABS( DATEDIFF( dxr.start_date, ${today} ) ) >= ${daysanniversary} )  \n						AND ( IFNULL(BILL.service_date, 0) = 0 )\n						AND ( (IFNULL(EXCLUDE_DX.code1,0) = 0) AND (IFNULL(EXCLUDE_DX.code2,0) = 0) ) \n				THEN CASE \n							WHEN IFNULL(VISITS.qualifier,0) = ${visitsqualifier}\n							THEN \'billable\'\n							WHEN ( IFNULL(VISITS.qualifier,0) + IFNULL(PHONE.qualifier,0) ) = ${visitsqualifier}\n							THEN \'billable\'\n							WHEN ( IFNULL(VISITS.qualifier,0) + IFNULL(GVISIT.qualifier,0) ) = ${visitsqualifier}\n							THEN \'billable\'\n							WHEN ( IFNULL( VISITS.qualifier, 0 ) + IFNULL( ACPVISIT.qualifier, 0 ) ) = ${visitsqualifier}\n							THEN \'billable\'\n							ELSE \'recall\'\n					 END\n				ELSE \'-\'\n				END\" title=\"CDM Status\" primary=\"false\" />	\n				\n			<column id=\"lastBillDate\" name=\"IFNULL( DATE_FORMAT( DATE(BILL.service_date), \'%m-%d-%Y\' ), 0)\" title=\"Last Bill\" primary=\"false\" />				\n			<column id=\"dxDate\" name=\"DATE_FORMAT( dxr.start_date , \'%m-%d-%Y\' )\" title=\"Dx Date\" primary=\"false\" />			\n			<column id=\"visitDate\" name=\"IFNULL( DATE_FORMAT(VISITS.service, \'%m-%d-%Y\' ), \'\')\" title=\"Last MD Visit\" primary=\"false\" />\n			<column id=\"phoneDate\" name=\"IFNULL(DATE_FORMAT(PHONE.service, \'%m-%d-%Y\' ), \'\')\" title=\"Last Phone\" primary=\"false\" /> \n			<column id=\"groupDate\" name=\"IFNULL(DATE_FORMAT(GVISIT.service, \'%m-%d-%Y\' ), \'\')\" title=\"Last Grp Visit\" primary=\"false\" />\n			<column id=\"acpDate\" name=\"IFNULL(DATE_FORMAT(ACPVISIT.service, \'%m-%d-%Y\' ), \'\')\" title=\"Last ACP Visit\" primary=\"false\" />\n		</exportColumns>\n		<query>\n			<!-- Drilldown SQL Query here -->\n			SELECT *\n			FROM demographic d \n			INNER JOIN dxresearch dxr \n			ON ( d.demographic_no = dxr.demographic_no ) \n				LEFT JOIN (\n					SELECT bm.demographic_no, bm.billingstatus, bm.billing_code, bm.service_date\n					FROM billingmaster bm\n					INNER JOIN (\n						SELECT MAX(service_date) AS service, demographic_no AS demographic\n						FROM billingmaster\n						WHERE billing_code = ${bonusBillingcode}\n						AND billingstatus NOT IN ${excludeBillingStatus}\n						AND DATE(service_date) BETWEEN DATE_SUB( ${today}, INTERVAL ${daysanniversary} DAY ) AND ${today}\n						GROUP BY demographic_no\n					) current\n					ON ( current.demographic = bm.demographic_no AND current.service = bm.service_date ) \n					WHERE bm.billing_code = ${bonusBillingcode}\n				) BILL\n				ON(BILL.demographic_no = d.demographic_no)\n				LEFT JOIN (\n					SELECT 	COUNT(demographic_no) AS \'count\',\n							CASE \n								WHEN COUNT(demographic_no) = 1\n								THEN 1\n								WHEN COUNT(demographic_no) > 1\n								THEN 2\n								ELSE 0\n							END AS \'qualifier\',\n							demographic_no, \n							MAX(service_date) AS service\n					FROM billingmaster\n					WHERE billingstatus LIKE ${billingStatus}\n					AND DATE(service_date) BETWEEN DATE_SUB( ${today}, INTERVAL ${daysanniversary} DAY ) AND ${today}\n					AND billing_code IN ${visitBillingcode} \n					GROUP BY demographic_no\n				) VISITS\n				ON (VISITS.demographic_no = d.demographic_no)\n				LEFT JOIN (\n					SELECT 	COUNT(demographic_no) AS \'count\', \n							IF( COUNT(demographic_no) > 0, 1, 0) AS \'qualifier\',\n							demographic_no, \n							MAX(service_date) AS service\n					FROM billingmaster\n					WHERE billingstatus LIKE ${billingStatus}\n					AND DATE( service_date ) BETWEEN DATE_SUB( ${today}, INTERVAL ${daysanniversary} DAY ) AND ${today}	\n					AND billing_code IN ${phoneBillingcode} \n					GROUP BY demographic_no\n				) PHONE\n				ON (PHONE.demographic_no = d.demographic_no)\n				LEFT JOIN (\n					SELECT 	COUNT(demographic_no) AS \'count\', \n							IF( COUNT(demographic_no) > 0, 1, 0) AS \'qualifier\',\n							demographic_no, \n							MAX(service_date) AS service\n					FROM billingmaster\n					WHERE billingstatus LIKE ${billingStatus}\n					AND DATE(service_date) BETWEEN DATE_SUB( ${today}, INTERVAL ${daysanniversary} DAY ) AND ${today}\n					AND billing_code BETWEEN ${lowerLimit.groupBillingcode} AND ${upperLimit.groupBillingcode}	\n					GROUP BY demographic_no\n				) GVISIT\n				ON ( GVISIT.demographic_no = d.demographic_no)\n				LEFT JOIN (\n					SELECT 	COUNT(demographic_no) AS \'count\', \n							IF( COUNT(demographic_no) > 0, 1, 0) AS \'qualifier\',\n							demographic_no, \n							MAX(service_date) AS service\n					FROM billingmaster\n					WHERE billingstatus LIKE ${billingStatus}\n					AND DATE(service_date) BETWEEN DATE_SUB( ${today}, INTERVAL ${daysanniversary} DAY ) AND ${today}\n					AND billing_code = ${acpBillingcode}\n					GROUP BY demographic_no\n				) ACPVISIT\n				ON ( ACPVISIT.demographic_no = d.demographic_no)\n				LEFT JOIN (\n					SELECT 	IFNULL( MIN(dxresearch_code), 0) AS code1, \n							IF( IFNULL( MIN(dxresearch_code), 0) != IFNULL( MAX(dxresearch_code),0 ), MAX(dxresearch_code), 0) AS code2, \n							demographic_no\n					FROM dxresearch\n					WHERE dxresearch_code LIKE ${excludeDxCode}\n					AND `status` LIKE ${dxcodestatus} \n					GROUP BY demographic_no\n				) EXCLUDE_DX\n				ON ( EXCLUDE_DX.demographic_no = d.demographic_no)\n				LEFT JOIN (\n					SELECT billing_code, demographic_no\n					FROM billingmaster bm\n					WHERE billingstatus LIKE ${billingStatus}\n					AND billing_code LIKE ${excludeBillingcode}	\n					GROUP BY demographic_no HAVING COUNT(demographic_no) > -1\n				) EXCLUDE_BILL\n				ON(EXCLUDE_BILL.demographic_no = d.demographic_no )\n			WHERE d.patient_status LIKE ${pstatus} \n			AND dxr.dxresearch_code IN ${dxcode} \n			AND dxr.`status` LIKE ${dxcodestatus} \n			AND d.demographic_no > 0 \n			AND d.last_name NOT IN ${patientNameExclude}\n			AND d.provider_no LIKE ${provider}\n			ORDER BY `CDM Status` DESC				\n		</query>\n	</drillDownQuery>\n	<shared>false</shared>\n	<sharedMetricSetName></sharedMetricSetName>\n	<sharedMetricDataId></sharedMetricDataId>\n	<sharedMappings>\n		<sharedMapping fromLabel=\"\" toLabel=\"\"/>\n	</sharedMappings>\n</indicatorTemplateXML>\n','','\0',0,NULL,NULL),
(5,1,'Prevention (14066)  100/yr','Billing','Total/Year: 14066, 14076, 14078 ','GP Services Committee','2016-01-01','Limit 100 Prevention (14066) billings available per MD per calendar year','\n			Details here: https://sgp.bc.ca/fee/personal-health-risk-assessment/\n		','<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<indicatorTemplateXML>\n	<author>Colcamex Resources Inc. for Oscar BC</author>\n	<uid></uid>\n	<heading>\n		<category>Billing</category>\n		<subCategory>Total/Year: 14066, 14076, 14078 </subCategory>\n		<name>Prevention (14066)  100/yr</name>\n		<definition>Limit 100 Prevention (14066) billings available per MD per calendar year</definition>\n		<framework>GP Services Committee</framework>\n		<frameworkVersion>01-01-2016</frameworkVersion>\n		<notes>\n			Details here: https://sgp.bc.ca/fee/personal-health-risk-assessment/\n		</notes>\n	</heading>\n	<indicatorQuery>\n		<version>18-11-2017</version>\n		<params>\n			<!-- \n				Required parameter provider. Value options are: \n					[ an individual providerNo, or provider range ] ie: value=\"370, 1001\" \n					\"all\" ie: value=\"all\" including null.\n					\"loggedInProvider\" ie:\n				Default is \"loggedInProvider\"\n				Use this parameter in the query as ${provider}\n				This parameter should be used for fetching patient\'s assigned to a MRP.\n				ie: WHERE demographic.provider_no = ${provider}\n			-->\n			<parameter id=\"provider\" name=\"provider_no\" value=\"loggedInProvider\" />\n			<parameter id=\"billingcode\" name=\"billing_code\" value=\"14066\" />\n			<parameter id=\"billinglimit\" name=\"billing_limit\" value=\"100\" />\n			<parameter id=\"status\" name=\"billingstatus\" value=\"\'S\'\" />\n		</params>\n\n		<query>\n			SELECT \n				ROUND( IFNULL( SUM( IF(bm.billingmaster_no IS NOT NULL AND bm.billingmaster_no > 0, 1, 0) ), 0),1) AS \'# Billed\',	\n				ROUND( ${billinglimit} - IFNULL( SUM( IF(bm.billingmaster_no IS NOT NULL AND bm.billingmaster_no > 0, 1, 0) ), 0),1 ) AS \'# Remaining\'\n			FROM billingmaster bm\n			LEFT JOIN provider p\n			ON(p.ohip_no = bm.practitioner_no)\n			WHERE billing_code = ${billingcode}\n			AND YEAR(NOW()) = YEAR(createdate)\n			AND billingstatus LIKE ${status}\n			AND p.provider_no IS NOT NULL\n			AND p.provider_no = ${provider}\n		</query>\n	</indicatorQuery>\n	<drillDownQuery>\n		<version>18-11-2017</version>\n		<params>\n			<parameter id=\"provider\" name=\"provider_no\" value=\"loggedInProvider\" />\n			<parameter id=\"billingcode\" name=\"billing_code\" value=\"14066\" />\n			<parameter id=\"billinglimit\" name=\"billing_limit\" value=\"100\" />\n			<parameter id=\"status\" name=\"billingstatus\" value=\"\'S\'\" />\n		</params>\n\n		<displayColumns>\n			<column id=\"demographicNo\" name=\"d.demographic_no\" title=\"Id\" primary=\"true\" />\n			<column id=\"name\" name=\"CONCAT( d.last_name, \', \',d.first_name )\" title=\"Name\" primary=\"false\" />\n			<column id=\"age\" name=\"FLOOR( ABS( DATEDIFF( DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), NOW() ) ) / 365.25 )\" title=\"Age\" primary=\"false\" />\n			<column id=\"gender\" name=\"d.sex\" title=\"Gender\" primary=\"false\" />\n			<column id=\"lastbill\" name=\"IFNULL( DATE_FORMAT( DATE(bm.service_date), \'%m-%d-%Y\' ), 0)\" title=\"Last Bill (m-d-y)\" primary=\"false\" />\n			<column id=\"billingcode\" name=\"bm.billing_code\" title=\"Billing Code\" primary=\"false\" />\n			<column id=\"payee\" name=\"bm.payee_no\" title=\"Payee\" primary=\"false\" />\n			<column id=\"billingprovider\" name=\"bm.practitioner_no\" title=\"Billing Provider\" primary=\"false\" />\n		</displayColumns>\n		<exportColumns>\n			<column id=\"demographicNo\" name=\"d.demographic_no\" title=\"Id\" primary=\"true\" />\n			<column id=\"name\" name=\"CONCAT( d.last_name, \', \',d.first_name )\" title=\"Name\" primary=\"false\" />\n			<column id=\"age\" name=\"FLOOR( ABS( DATEDIFF( DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), NOW() ) ) / 365.25 )\" title=\"Age\" primary=\"false\" />\n			<column id=\"gender\" name=\"d.sex\" title=\"Gender\" primary=\"false\" />\n			<column id=\"lastbill\" name=\"IFNULL( DATE_FORMAT( DATE(bm.service_date), \'%m-%d-%Y\' ), 0)\" title=\"Last Bill (m-d-y)\" primary=\"false\" />\n			<column id=\"billingcode\" name=\"bm.billing_code\" title=\"Billing Code\" primary=\"false\" />\n			<column id=\"payee\" name=\"bm.payee_no\" title=\"Payee\" primary=\"false\" />\n			<column id=\"billingprovider\" name=\"bm.practitioner_no\" title=\"Billing Provider\" primary=\"false\" />\n		</exportColumns>\n		\n		<query>\n			SELECT *\n			FROM billingmaster bm\n			LEFT JOIN provider p\n			ON ( p.ohip_no = bm.practitioner_no )\n			JOIN demographic d\n			ON ( d.demographic_no = bm.demographic_no )\n			WHERE billing_code = ${billingcode}\n			AND YEAR( NOW() ) = YEAR( createdate )\n			AND billingstatus LIKE ${status}\n			AND p.provider_no = ${provider}\n		</query>\n	</drillDownQuery>\n	<shared>false</shared>\n	<sharedMetricSetName></sharedMetricSetName>\n	<sharedMetricDataId></sharedMetricDataId>\n	<sharedMappings>\n		<sharedMapping fromLabel=\"\" toLabel=\"\"/>\n	</sharedMappings>\n</indicatorTemplateXML>','','\0',0,NULL,NULL),
(6,1,'Telephone Management (14076)  1500/yr','Billing','Total/Year: 14066, 14076, 14078 ','GP Services Committee','2016-01-01','Limit 1500 Telephone Management (14076) billings available per MD per calendar year','\n			Details here: https://sgp.bc.ca/fee/personal-health-risk-assessment/\n		','<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<indicatorTemplateXML>\n	<author>Colcamex Resources Inc. for Oscar BC</author>\n	<uid></uid>\n	<heading>\n		<category>Billing</category>\n		<subCategory>Total/Year: 14066, 14076, 14078 </subCategory>\n		<name>Telephone Management (14076)  1500/yr</name>\n		<definition>Limit 1500 Telephone Management (14076) billings available per MD per calendar year</definition>\n		<framework>GP Services Committee</framework>\n		<frameworkVersion>01-01-2016</frameworkVersion>\n		<notes>\n			Details here: https://sgp.bc.ca/fee/personal-health-risk-assessment/\n		</notes>\n	</heading>\n	<indicatorQuery>\n		<version>27-11-2017</version>\n		<params>\n			<!-- \n				Required parameter provider. Value options are: \n					[ an individual providerNo, or provider range ] ie: value=\"370, 1001\" \n					\"all\" ie: value=\"all\" including null.\n					\"loggedInProvider\" ie:\n				Default is \"loggedInProvider\"\n				Use this parameter in the query as ${provider}\n				This parameter should be used for fetching patient\'s assigned to a MRP.\n				ie: WHERE demographic.provider_no = ${provider}\n			-->\n			<parameter id=\"provider\" name=\"provider_no\" value=\"loggedInProvider\" />\n			<parameter id=\"billingcode\" name=\"billing_code\" value=\"14076\" />\n			<parameter id=\"billinglimit\" name=\"billing_limit\" value=\"1500\" />\n			<parameter id=\"status\" name=\"billingstatus\" value=\"\'S\'\" />\n		</params>\n\n		<query>\n			SELECT \n				ROUND( IFNULL( SUM( IF(bm.billingmaster_no IS NOT NULL AND bm.billingmaster_no > 0, 1, 0) ), 0),1) AS \'# Billed\',	\n				ROUND( ${billinglimit} - IFNULL( SUM( IF(bm.billingmaster_no IS NOT NULL AND bm.billingmaster_no > 0, 1, 0) ), 0),1 ) AS \'# Remaining\'\n			FROM billingmaster bm\n			LEFT JOIN provider p\n			ON(p.ohip_no = bm.practitioner_no)\n			WHERE billing_code = ${billingcode}\n			AND YEAR(NOW()) = YEAR(createdate)\n			AND billingstatus LIKE ${status}\n			AND p.provider_no IS NOT NULL\n			AND p.provider_no = ${provider}\n		</query>\n	</indicatorQuery>\n	<drillDownQuery>\n		<version>27-11-2017</version>\n		<params>\n			<parameter id=\"provider\" name=\"provider_no\" value=\"loggedInProvider\" />\n			<parameter id=\"billingcode\" name=\"billing_code\" value=\"14076\" />\n			<parameter id=\"billinglimit\" name=\"billing_limit\" value=\"1500\" />\n			<parameter id=\"status\" name=\"billingstatus\" value=\"\'S\'\" />\n		</params>\n\n		<displayColumns>\n			<column id=\"demographicNo\" name=\"d.demographic_no\" title=\"Id\" primary=\"true\" />\n			<column id=\"name\" name=\"CONCAT( d.last_name, \', \',d.first_name )\" title=\"Name\" primary=\"false\" />\n			<column id=\"age\" name=\"FLOOR( ABS( DATEDIFF( DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), NOW() ) ) / 365.25 )\" title=\"Age\" primary=\"false\" />\n			<column id=\"gender\" name=\"d.sex\" title=\"Gender\" primary=\"false\" />\n			<column id=\"lastbill\" name=\"IFNULL( DATE_FORMAT( DATE(bm.service_date), \'%m-%d-%Y\' ), 0)\" title=\"Last Bill (m-d-y)\" primary=\"false\" />\n			<column id=\"billingcode\" name=\"bm.billing_code\" title=\"Billing Code\" primary=\"false\" />\n			<column id=\"payee\" name=\"bm.payee_no\" title=\"Payee\" primary=\"false\" />\n			<column id=\"billingprovider\" name=\"bm.practitioner_no\" title=\"Billing Provider\" primary=\"false\" />\n		</displayColumns>\n		<exportColumns>\n			<column id=\"demographicNo\" name=\"d.demographic_no\" title=\"Id\" primary=\"true\" />\n			<column id=\"name\" name=\"CONCAT( d.last_name, \', \',d.first_name )\" title=\"Name\" primary=\"false\" />\n			<column id=\"age\" name=\"FLOOR( ABS( DATEDIFF( DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), NOW() ) ) / 365.25 )\" title=\"Age\" primary=\"false\" />\n			<column id=\"gender\" name=\"d.sex\" title=\"Gender\" primary=\"false\" />\n			<column id=\"lastbill\" name=\"IFNULL( DATE_FORMAT( DATE(bm.service_date), \'%m-%d-%Y\' ), 0)\" title=\"Last Bill (m-d-y)\" primary=\"false\" />\n			<column id=\"billingcode\" name=\"bm.billing_code\" title=\"Billing Code\" primary=\"false\" />\n			<column id=\"payee\" name=\"bm.payee_no\" title=\"Payee\" primary=\"false\" />\n			<column id=\"billingprovider\" name=\"bm.practitioner_no\" title=\"Billing Provider\" primary=\"false\" />\n		</exportColumns>\n		\n		<query>\n			SELECT *\n			FROM billingmaster bm\n			LEFT JOIN provider p\n			ON ( p.ohip_no = bm.practitioner_no )\n			JOIN demographic d\n			ON ( d.demographic_no = bm.demographic_no )\n			WHERE billing_code = ${billingcode}\n			AND YEAR( NOW() ) = YEAR( createdate )\n			AND billingstatus LIKE ${status}\n			AND p.provider_no = ${provider}\n		</query>\n	</drillDownQuery>\n	<shared>false</shared>\n	<sharedMetricSetName></sharedMetricSetName>\n	<sharedMetricDataId></sharedMetricDataId>\n	<sharedMappings>\n		<sharedMapping fromLabel=\"\" toLabel=\"\"/>\n	</sharedMappings>\n</indicatorTemplateXML>','','\0',0,NULL,NULL),
(7,1,'Email/Text/Telephone (14078)  200/yr','Billing','Total/Year: 14066, 14076, 14078 ','GP Services Committee','2016-01-01','Limit 200 Email/Text/Telephone Medical Advice Relay Fee (14078) billings available per MD per calendar year','\n			Details here: https://sgp.bc.ca/fee/personal-health-risk-assessment/\n		','<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<indicatorTemplateXML>\n	<author>Colcamex Resources Inc. for Oscar BC</author>\n	<uid></uid>\n	<heading>\n		<category>Billing</category>\n		<subCategory>Total/Year: 14066, 14076, 14078 </subCategory>\n		<name>Email/Text/Telephone (14078)  200/yr</name>\n		<definition>Limit 200 Email/Text/Telephone Medical Advice Relay Fee (14078) billings available per MD per calendar year</definition>\n		<framework>GP Services Committee</framework>\n		<frameworkVersion>01-01-2016</frameworkVersion>\n		<notes>\n			Details here: https://sgp.bc.ca/fee/personal-health-risk-assessment/\n		</notes>\n	</heading>\n	<indicatorQuery>\n		<version>27-11-2017</version>\n		<params>\n			<!-- \n				Required parameter provider. Value options are: \n					[ an individual providerNo, or provider range ] ie: value=\"370, 1001\" \n					\"all\" ie: value=\"all\" including null.\n					\"loggedInProvider\" ie:\n				Default is \"loggedInProvider\"\n				Use this parameter in the query as ${provider}\n				This parameter should be used for fetching patient\'s assigned to a MRP.\n				ie: WHERE demographic.provider_no = ${provider}\n			-->\n			<parameter id=\"provider\" name=\"provider_no\" value=\"loggedInProvider\" />\n			<parameter id=\"billingcode\" name=\"billing_code\" value=\"14078\" />\n			<parameter id=\"billinglimit\" name=\"billing_limit\" value=\"200\" />\n			<parameter id=\"status\" name=\"billingstatus\" value=\"\'S\'\" />\n		</params>\n\n		<query>\n			SELECT \n				ROUND( IFNULL( SUM( IF(bm.billingmaster_no IS NOT NULL AND bm.billingmaster_no > 0, 1, 0) ), 0),1) AS \'# Billed\',	\n				ROUND( ${billinglimit} - IFNULL( SUM( IF(bm.billingmaster_no IS NOT NULL AND bm.billingmaster_no > 0, 1, 0) ), 0),1 ) AS \'# Remaining\'\n			FROM billingmaster bm\n			LEFT JOIN provider p\n			ON(p.ohip_no = bm.practitioner_no)\n			WHERE billing_code = ${billingcode}\n			AND YEAR(NOW()) = YEAR(createdate)\n			AND billingstatus LIKE ${status}\n			AND p.provider_no IS NOT NULL\n			AND p.provider_no = ${provider}\n		</query>\n	</indicatorQuery>\n	<drillDownQuery>\n		<version>27-11-2017</version>\n		<params>\n			<parameter id=\"provider\" name=\"provider_no\" value=\"loggedInProvider\" />\n			<parameter id=\"billingcode\" name=\"billing_code\" value=\"14078\" />\n			<parameter id=\"billinglimit\" name=\"billing_limit\" value=\"200\" />\n			<parameter id=\"status\" name=\"billingstatus\" value=\"\'S\'\" />\n		</params>\n\n		<displayColumns>\n			<column id=\"demographicNo\" name=\"d.demographic_no\" title=\"Id\" primary=\"true\" />\n			<column id=\"name\" name=\"CONCAT( d.last_name, \', \',d.first_name )\" title=\"Name\" primary=\"false\" />\n			<column id=\"age\" name=\"FLOOR( ABS( DATEDIFF( DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), NOW() ) ) / 365.25 )\" title=\"Age\" primary=\"false\" />\n			<column id=\"gender\" name=\"d.sex\" title=\"Gender\" primary=\"false\" />\n			<column id=\"lastbill\" name=\"IFNULL( DATE_FORMAT( DATE(bm.service_date), \'%m-%d-%Y\' ), 0)\" title=\"Last Bill (m-d-y)\" primary=\"false\" />\n			<column id=\"billingcode\" name=\"bm.billing_code\" title=\"Billing Code\" primary=\"false\" />\n			<column id=\"payee\" name=\"bm.payee_no\" title=\"Payee\" primary=\"false\" />\n			<column id=\"billingprovider\" name=\"bm.practitioner_no\" title=\"Billing Provider\" primary=\"false\" />\n		</displayColumns>\n		<exportColumns>\n			<column id=\"demographicNo\" name=\"d.demographic_no\" title=\"Id\" primary=\"true\" />\n			<column id=\"name\" name=\"CONCAT( d.last_name, \', \',d.first_name )\" title=\"Name\" primary=\"false\" />\n			<column id=\"age\" name=\"FLOOR( ABS( DATEDIFF( DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), NOW() ) ) / 365.25 )\" title=\"Age\" primary=\"false\" />\n			<column id=\"gender\" name=\"d.sex\" title=\"Gender\" primary=\"false\" />\n			<column id=\"lastbill\" name=\"IFNULL( DATE_FORMAT( DATE(bm.service_date), \'%m-%d-%Y\' ), 0)\" title=\"Last Bill (m-d-y)\" primary=\"false\" />\n			<column id=\"billingcode\" name=\"bm.billing_code\" title=\"Billing Code\" primary=\"false\" />\n			<column id=\"payee\" name=\"bm.payee_no\" title=\"Payee\" primary=\"false\" />\n			<column id=\"billingprovider\" name=\"bm.practitioner_no\" title=\"Billing Provider\" primary=\"false\" />\n		</exportColumns>\n		\n		<query>\n			SELECT *\n			FROM billingmaster bm\n			LEFT JOIN provider p\n			ON ( p.ohip_no = bm.practitioner_no )\n			JOIN demographic d\n			ON ( d.demographic_no = bm.demographic_no )\n			WHERE billing_code = ${billingcode}\n			AND YEAR( NOW() ) = YEAR( createdate )\n			AND billingstatus LIKE ${status}\n			AND p.provider_no = ${provider}\n		</query>\n	</drillDownQuery>\n	<shared>false</shared>\n	<sharedMetricSetName></sharedMetricSetName>\n	<sharedMetricDataId></sharedMetricDataId>\n	<sharedMappings>\n		<sharedMapping fromLabel=\"\" toLabel=\"\"/>\n	</sharedMappings>\n</indicatorTemplateXML>','','\0',0,NULL,NULL),
(8,2,'Active Patients Report','General','Patient Population','DoBC CPQI PSP Panel','2017-08-02','# of patients that have been seen in the last 3 years in comparison to # all active patients','\n		  i) # of active patients that have been seen in the last 3 year\n		  ii) # of active patients not seen in the last 3 years\n		','<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<indicatorTemplateXML>\n	<author>OSCAR BC</author>\n	<uid></uid>\n	<heading>\n		<category>General</category>\n		<subCategory>Patient Population</subCategory>\n		<name>Active Patients Report</name>\n		<definition># of patients that have been seen in the last 3 years in comparison to # all active patients</definition>\n		<framework>DoBC CPQI PSP Panel</framework>\n		<frameworkVersion>08-02-2017</frameworkVersion>\n		<notes>\n		  i) # of active patients that have been seen in the last 3 year\n		  ii) # of active patients not seen in the last 3 years\n		</notes>\n	</heading>\n	<indicatorQuery>\n		<version>03-13-2018</version>\n		<params>\n			<!-- \n				Use this parameter in the query as ${provider}\n				This parameter should be used for fetching patient\'s assigned to a MRP.\n				ie: WHERE demographic.provider_no = ${provider}\n			-->\n			<parameter id=\"provider\" name=\"provider_no\" value=\"loggedInProvider\" />\n			<parameter id=\"pstatus\" name=\"Patient Status\" value=\"\'AC\'\" />\n		</params>\n		<query>\n		  <!-- Indicator SQL Query here -->\nSELECT\n	SUM(fin.THREE) AS \"% Active, Seen within 3 years\",\n	SUM(fin.ALL_PATIENTS)-SUM(fin.THREE) AS \"% Active, Not seen within 3 years\"\nFROM (\n	SELECT\n		IF( DATE_SUB(CURDATE() , INTERVAL 3 YEAR) &lt;= DATE( MAX(cmn.observation_date) ) ,1 ,0 ) AS THREE, \n		IF( TRUE, 1, 0) AS ALL_PATIENTS\n	FROM demographic d\n	LEFT JOIN casemgmt_note cmn\n	ON (  d.demographic_no = cmn.demographic_no AND cmn.signed = 1 AND cmn.provider_no != \'-1\'  )\n	WHERE d.provider_no LIKE ${provider}\n	AND d.patient_status LIKE ${pstatus}\n	GROUP BY d.demographic_no HAVING count(d.demographic_no) > -1\n) fin;\n		</query>\n	</indicatorQuery>\n	<drillDownQuery>\n		<version>03-13-2018</version>\n		<params>\n			<parameter id=\"provider\" name=\"provider_no\" value=\"loggedInProvider\" />	\n			<parameter id=\"pstatus\" name=\"Patient Status\" value=\"\'AC\'\" />\n		</params>\n		<displayColumns>\n			<column id=\"demographic\" name=\"d.demographic_no\" title=\"Patient Id\" primary=\"true\" />\n			<column id=\"name\" name=\"CONCAT( d.last_name, \', \', d.first_name )\" title=\"Patient Name\" primary=\"false\" />\n			<column id=\"dob\" name=\"DATE_FORMAT( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth), \'%m-%d-%Y\' )\" title=\"Date of Birth (mm-dd-yy)\" primary=\"false\" />\n			<column id=\"age\" name=\"TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )\" title=\"Age\" primary=\"false\" />	\n			<column id=\"lastEncounter\" name=\"IF(MAX(cmn.observation_date) IS NOT NULL,MAX(cmn.observation_date),\'\')\" title=\"Last Encounter\" primary=\"false\" />\n			<column id=\"patientStatus\" name=\"d.patient_status\" title=\"Patient Status\" primary=\"false\" />\n		</displayColumns>\n		<exportColumns>\n			<column id=\"demographic\" name=\"d.demographic_no\" title=\"Patient Id\" primary=\"true\" />\n			<column id=\"name\" name=\"CONCAT( d.last_name, \', \', d.first_name )\" title=\"Patient Name\" primary=\"false\" />\n			<column id=\"dob\" name=\"DATE_FORMAT( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth), \'%m-%d-%Y\' )\" title=\"Date of Birth (mm-dd-yy)\" primary=\"false\" />\n			<column id=\"age\" name=\"TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )\" title=\"Age\" primary=\"false\" />	\n			<column id=\"lastEncounter\" name=\"IF(MAX(cmn.observation_date) IS NOT NULL,MAX(cmn.observation_date),\'\')\" title=\"Last Encounter\" primary=\"false\" />\n			<column id=\"patientStatus\" name=\"d.patient_status\" title=\"Patient Status\" primary=\"false\" />\n		</exportColumns>\n		<query>\n			<!-- Drilldown SQL Query here -->\nSELECT\n    d.*,\n    d.patient_status AS pt_status,\n    max(cmn.observation_date) as last_encounter\nFROM demographic d\nLEFT JOIN casemgmt_note cmn\nON (  d.demographic_no = cmn.demographic_no AND cmn.signed = 1 AND cmn.provider_no != \'-1\'  )\nWHERE d.provider_no LIKE ${provider}\nAND d.patient_status LIKE ${pstatus}\nGROUP BY d.demographic_no HAVING count(d.demographic_no) > -1\nORDER BY MAX(cmn.observation_date) ASC\n		</query>\n	</drillDownQuery>\n</indicatorTemplateXML>\n','\0','\0',0,NULL,NULL),
(9,2,'Age and Gender Histogram Report','General','Patient Population Histogram','DoBC CPQI PSP Panel','2017-08-02','Age and Gender Histogram report (5 year intervals)','\n		  Age and Gender Histogram report (5 year intervals)\n		','<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<indicatorTemplateXML>\n	<author>OSCAR BC</author>\n	<uid></uid>\n	<heading>\n		<category>General</category>\n		<subCategory>Patient Population Histogram</subCategory>\n		<name>Age and Gender Histogram Report</name>\n		<definition>Age and Gender Histogram report (5 year intervals)</definition>\n		<framework>DoBC CPQI PSP Panel</framework>\n		<frameworkVersion>08-02-2017</frameworkVersion>\n		<notes>\n		  Age and Gender Histogram report (5 year intervals)\n		</notes>\n	</heading>\n	<indicatorQuery>\n		<version>03-13-2018</version>\n		<params>\n			<!-- \n				Use this parameter in the query as ${provider}\n				This parameter should be used for fetching patient\'s assigned to a MRP.\n				ie: WHERE demographic.provider_no = ${provider}\n			-->\n			<parameter id=\"provider\" name=\"provider_no\" value=\"loggedInProvider\" />\n			<parameter id=\"pstatus\" name=\"Patient Status\" value=\"\'AC\'\" />\n		</params>\n		<query>\n		  <!-- Indicator SQL Query here -->\nSELECT\n	IF( COUNT(fin.patient) &gt; 0, SUM( CASE WHEN (fin.gender = \'M\' AND (0 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(fin.year,\'-\',fin.month,\'-\',fin.day) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(fin.year,\'-\',fin.month,\'-\',fin.day) ), CURDATE() ) &lt; 20 )) THEN 1 ELSE 0 END) , 0) AS \"M0-19\",\n	IF( COUNT(fin.patient) &gt; 0, SUM( CASE WHEN (fin.gender = \'M\' AND (20 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(fin.year,\'-\',fin.month,\'-\',fin.day) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(fin.year,\'-\',fin.month,\'-\',fin.day) ), CURDATE() ) &lt; 60 )) THEN 1 ELSE 0 END) , 0) AS \"M20-59\",\n	IF( COUNT(fin.patient) &gt; 0, SUM( CASE WHEN (fin.gender = \'M\' AND (60 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(fin.year,\'-\',fin.month,\'-\',fin.day) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(fin.year,\'-\',fin.month,\'-\',fin.day) ), CURDATE() ) &lt; 999 )) THEN 1 ELSE 0 END) , 0) AS \"M60+\",\n	IF( COUNT(fin.patient) &gt; 0, SUM( CASE WHEN (fin.gender = \'F\' AND (0 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(fin.year,\'-\',fin.month,\'-\',fin.day) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(fin.year,\'-\',fin.month,\'-\',fin.day) ), CURDATE() ) &lt; 20 )) THEN 1 ELSE 0 END) , 0) AS \"F0-19\",\n	IF( COUNT(fin.patient) &gt; 0, SUM( CASE WHEN (fin.gender = \'F\' AND (20 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(fin.year,\'-\',fin.month,\'-\',fin.day) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(fin.year,\'-\',fin.month,\'-\',fin.day) ), CURDATE() ) &lt; 60 )) THEN 1 ELSE 0 END) , 0) AS \"F20-59\",\n	IF( COUNT(fin.patient) &gt; 0, SUM( CASE WHEN (fin.gender = \'F\' AND (60 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(fin.year,\'-\',fin.month,\'-\',fin.day) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(fin.year,\'-\',fin.month,\'-\',fin.day) ), CURDATE() ) &lt; 999 )) THEN 1 ELSE 0 END) , 0) AS \"F60+\"\nFROM (\nSELECT\nd.demographic_no as patient, d.year_of_birth as year, d.month_of_birth as month, d.date_of_birth as day, d.sex as gender\nFROM\ndemographic d\nWHERE d.provider_no LIKE ${provider}\nAND d.patient_status LIKE ${pstatus}\n) fin;\n		</query>\n	</indicatorQuery>\n	<drillDownQuery>\n		<version>03-13-2018</version>\n		<params>\n			<parameter id=\"provider\" name=\"provider_no\" value=\"loggedInProvider\" />	\n			<parameter id=\"pstatus\" name=\"Patient Status\" value=\"\'AC\'\" />\n		</params>\n		<displayColumns>\n			<column id=\'M0-4\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'M\' AND (0 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 5 )) THEN 1 ELSE 0 END) , 0)\" title=\"M0-4\" primary=\"false\" />\n			<column id=\'M5-9\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'M\' AND (5 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 10 )) THEN 1 ELSE 0 END) , 0)\" title=\"M5-9\" primary=\"false\" />\n			<column id=\'M10-14\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'M\' AND (10 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 15 )) THEN 1 ELSE 0 END) , 0)\" title=\"M10-14\" primary=\"false\" />\n			<column id=\'M15-20\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'M\' AND (15 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 20 )) THEN 1 ELSE 0 END) , 0)\" title=\"M15-19\" primary=\"false\" />\n			<column id=\'M20-24\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'M\' AND (20 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 25 )) THEN 1 ELSE 0 END) , 0)\" title=\"M20-29\" primary=\"false\" />\n			<column id=\'M25-29\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'M\' AND (25 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 30 )) THEN 1 ELSE 0 END) , 0)\" title=\"M20-29\" primary=\"false\" />\n			<column id=\'M30-34\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'M\' AND (30 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 35 )) THEN 1 ELSE 0 END) , 0)\" title=\"M30-34\" primary=\"false\" />\n			<column id=\'M35-39\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'M\' AND (35 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 40 )) THEN 1 ELSE 0 END) , 0)\" title=\"M35-39\" primary=\"false\" />\n			<column id=\'M40-44\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'M\' AND (40 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 45 )) THEN 1 ELSE 0 END) , 0)\" title=\"M40-44\" primary=\"false\" />\n			<column id=\'M45-49\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'M\' AND (45 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 50 )) THEN 1 ELSE 0 END) , 0)\" title=\"M45-49\" primary=\"false\" />\n			<column id=\'M50-54\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'M\' AND (50 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 55 )) THEN 1 ELSE 0 END) , 0)\" title=\"M50-54\" primary=\"false\" />\n			<column id=\'M55-59\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'M\' AND (55 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 60 )) THEN 1 ELSE 0 END) , 0)\" title=\"M55-59\" primary=\"false\" />\n			<column id=\'M60-64\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'M\' AND (60 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 65 )) THEN 1 ELSE 0 END) , 0)\" title=\"M60-64\" primary=\"false\" />\n			<column id=\'M65-69\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'M\' AND (65 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 70 )) THEN 1 ELSE 0 END) , 0)\" title=\"M65-69\" primary=\"false\" />\n			<column id=\'M70-74\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'M\' AND (70 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 75 )) THEN 1 ELSE 0 END) , 0)\" title=\"M70-74\" primary=\"false\" />\n			<column id=\'M75-79\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'M\' AND (75 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 80 )) THEN 1 ELSE 0 END) , 0)\" title=\"M75-79\" primary=\"false\" />\n			<column id=\'M80-84\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'M\' AND (80 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 85 )) THEN 1 ELSE 0 END) , 0)\" title=\"M80-84\" primary=\"false\" />\n			<column id=\'M85-89\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'M\' AND (85 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 90 )) THEN 1 ELSE 0 END) , 0)\" title=\"M85-89\" primary=\"false\" />\n			<column id=\'M90-94\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'M\' AND (90 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 95 )) THEN 1 ELSE 0 END) , 0)\" title=\"M90-94\" primary=\"false\" />\n			<column id=\'M95-99\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'M\' AND (95 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 100 )) THEN 1 ELSE 0 END) , 0)\" title=\"M95-99\" primary=\"false\" />\n			<column id=\'M100-104\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'M\' AND (100 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 105 )) THEN 1 ELSE 0 END) , 0)\" title=\"M100-104\" primary=\"false\" />\n			<column id=\'M105-109\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'M\' AND (105 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 110 )) THEN 1 ELSE 0 END) , 0)\" title=\"M105-109\" primary=\"false\" />\n			<column id=\'M110-114\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'M\' AND (110 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 115 )) THEN 1 ELSE 0 END) , 0)\" title=\"M110-114\" primary=\"false\" />\n			<column id=\'M115-119\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'M\' AND (115 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 120 )) THEN 1 ELSE 0 END) , 0)\" title=\"M115-119\" primary=\"false\" />\n			<column id=\'M120-124\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'M\' AND (120 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 125 )) THEN 1 ELSE 0 END) , 0)\" title=\"M120-124\" primary=\"false\" />\n			<column id=\'M125+\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'M\' AND (125 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 999 )) THEN 1 ELSE 0 END) , 0)\" title=\"M125+\" primary=\"false\" />\n			\n			<column id=\'F0-4\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'F\' AND (0 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 5 )) THEN 1 ELSE 0 END) , 0)\" title=\"F0-4\" primary=\"false\" />\n			<column id=\'F5-9\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'F\' AND (5 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 10 )) THEN 1 ELSE 0 END) , 0)\" title=\"F5-9\" primary=\"false\" />\n			<column id=\'F10-14\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'F\' AND (10 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 15 )) THEN 1 ELSE 0 END) , 0)\" title=\"F10-14\" primary=\"false\" />\n			<column id=\'F15-20\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'F\' AND (15 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 20 )) THEN 1 ELSE 0 END) , 0)\" title=\"F15-19\" primary=\"false\" />\n			<column id=\'F20-24\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'F\' AND (20 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 25 )) THEN 1 ELSE 0 END) , 0)\" title=\"F20-29\" primary=\"false\" />\n			<column id=\'F25-29\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'F\' AND (25 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 30 )) THEN 1 ELSE 0 END) , 0)\" title=\"F20-29\" primary=\"false\" />\n			<column id=\'F30-34\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'F\' AND (30 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 35 )) THEN 1 ELSE 0 END) , 0)\" title=\"F30-34\" primary=\"false\" />\n			<column id=\'F35-39\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'F\' AND (35 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 40 )) THEN 1 ELSE 0 END) , 0)\" title=\"F35-39\" primary=\"false\" />\n			<column id=\'F40-44\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'F\' AND (40 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 45 )) THEN 1 ELSE 0 END) , 0)\" title=\"F40-44\" primary=\"false\" />\n			<column id=\'F45-49\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'F\' AND (45 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 50 )) THEN 1 ELSE 0 END) , 0)\" title=\"F45-49\" primary=\"false\" />\n			<column id=\'F50-54\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'F\' AND (50 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 55 )) THEN 1 ELSE 0 END) , 0)\" title=\"F50-54\" primary=\"false\" />\n			<column id=\'F55-59\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'F\' AND (55 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 60 )) THEN 1 ELSE 0 END) , 0)\" title=\"F55-59\" primary=\"false\" />\n			<column id=\'F60-64\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'F\' AND (60 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 65 )) THEN 1 ELSE 0 END) , 0)\" title=\"F60-64\" primary=\"false\" />\n			<column id=\'F65-69\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'F\' AND (65 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 70 )) THEN 1 ELSE 0 END) , 0)\" title=\"F65-69\" primary=\"false\" />\n			<column id=\'F70-74\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'F\' AND (70 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 75 )) THEN 1 ELSE 0 END) , 0)\" title=\"F70-74\" primary=\"false\" />\n			<column id=\'F75-79\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'F\' AND (75 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 80 )) THEN 1 ELSE 0 END) , 0)\" title=\"F75-79\" primary=\"false\" />\n			<column id=\'F80-84\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'F\' AND (80 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 85 )) THEN 1 ELSE 0 END) , 0)\" title=\"F80-84\" primary=\"false\" />\n			<column id=\'F85-89\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'F\' AND (85 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 90 )) THEN 1 ELSE 0 END) , 0)\" title=\"F85-89\" primary=\"false\" />\n			<column id=\'F90-94\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'F\' AND (90 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 95 )) THEN 1 ELSE 0 END) , 0)\" title=\"F90-94\" primary=\"false\" />\n			<column id=\'F95-99\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'F\' AND (95 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 100 )) THEN 1 ELSE 0 END) , 0)\" title=\"F95-99\" primary=\"false\" />\n			<column id=\'F100-104\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'F\' AND (100 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 105 )) THEN 1 ELSE 0 END) , 0)\" title=\"F100-104\" primary=\"false\" />\n			<column id=\'F105-109\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'F\' AND (105 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 110 )) THEN 1 ELSE 0 END) , 0)\" title=\"F105-109\" primary=\"false\" />\n			<column id=\'F110-114\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'F\' AND (110 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 115 )) THEN 1 ELSE 0 END) , 0)\" title=\"F110-114\" primary=\"false\" />\n			<column id=\'F115-119\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'F\' AND (115 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 120 )) THEN 1 ELSE 0 END) , 0)\" title=\"F115-119\" primary=\"false\" />\n			<column id=\'F120-124\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'F\' AND (120 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 125 )) THEN 1 ELSE 0 END) , 0)\" title=\"F120-124\" primary=\"false\" />\n			<column id=\'F125+\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'F\' AND (125 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 999 )) THEN 1 ELSE 0 END) , 0)\" title=\"F125+\" primary=\"false\" />\n			\n		</displayColumns>\n		<exportColumns>\n			<column id=\'M0-4\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'M\' AND (0 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 5 )) THEN 1 ELSE 0 END) , 0)\" title=\"M0-4\" primary=\"false\" />\n			<column id=\'M5-9\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'M\' AND (5 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 10 )) THEN 1 ELSE 0 END) , 0)\" title=\"M5-9\" primary=\"false\" />\n			<column id=\'M10-14\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'M\' AND (10 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 15 )) THEN 1 ELSE 0 END) , 0)\" title=\"M10-14\" primary=\"false\" />\n			<column id=\'M15-20\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'M\' AND (15 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 20 )) THEN 1 ELSE 0 END) , 0)\" title=\"M15-19\" primary=\"false\" />\n			<column id=\'M20-24\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'M\' AND (20 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 25 )) THEN 1 ELSE 0 END) , 0)\" title=\"M20-29\" primary=\"false\" />\n			<column id=\'M25-29\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'M\' AND (25 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 30 )) THEN 1 ELSE 0 END) , 0)\" title=\"M20-29\" primary=\"false\" />\n			<column id=\'M30-34\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'M\' AND (30 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 35 )) THEN 1 ELSE 0 END) , 0)\" title=\"M30-34\" primary=\"false\" />\n			<column id=\'M35-39\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'M\' AND (35 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 40 )) THEN 1 ELSE 0 END) , 0)\" title=\"M35-39\" primary=\"false\" />\n			<column id=\'M40-44\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'M\' AND (40 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 45 )) THEN 1 ELSE 0 END) , 0)\" title=\"M40-44\" primary=\"false\" />\n			<column id=\'M45-49\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'M\' AND (45 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 50 )) THEN 1 ELSE 0 END) , 0)\" title=\"M45-49\" primary=\"false\" />\n			<column id=\'M50-54\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'M\' AND (50 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 55 )) THEN 1 ELSE 0 END) , 0)\" title=\"M50-54\" primary=\"false\" />\n			<column id=\'M55-59\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'M\' AND (55 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 60 )) THEN 1 ELSE 0 END) , 0)\" title=\"M55-59\" primary=\"false\" />\n			<column id=\'M60-64\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'M\' AND (60 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 65 )) THEN 1 ELSE 0 END) , 0)\" title=\"M60-64\" primary=\"false\" />\n			<column id=\'M65-69\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'M\' AND (65 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 70 )) THEN 1 ELSE 0 END) , 0)\" title=\"M65-69\" primary=\"false\" />\n			<column id=\'M70-74\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'M\' AND (70 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 75 )) THEN 1 ELSE 0 END) , 0)\" title=\"M70-74\" primary=\"false\" />\n			<column id=\'M75-79\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'M\' AND (75 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 80 )) THEN 1 ELSE 0 END) , 0)\" title=\"M75-79\" primary=\"false\" />\n			<column id=\'M80-84\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'M\' AND (80 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 85 )) THEN 1 ELSE 0 END) , 0)\" title=\"M80-84\" primary=\"false\" />\n			<column id=\'M85-89\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'M\' AND (85 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 90 )) THEN 1 ELSE 0 END) , 0)\" title=\"M85-89\" primary=\"false\" />\n			<column id=\'M90-94\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'M\' AND (90 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 95 )) THEN 1 ELSE 0 END) , 0)\" title=\"M90-94\" primary=\"false\" />\n			<column id=\'M95-99\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'M\' AND (95 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 100 )) THEN 1 ELSE 0 END) , 0)\" title=\"M95-99\" primary=\"false\" />\n			<column id=\'M100-104\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'M\' AND (100 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 105 )) THEN 1 ELSE 0 END) , 0)\" title=\"M100-104\" primary=\"false\" />\n			<column id=\'M105-109\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'M\' AND (105 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 110 )) THEN 1 ELSE 0 END) , 0)\" title=\"M105-109\" primary=\"false\" />\n			<column id=\'M110-114\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'M\' AND (110 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 115 )) THEN 1 ELSE 0 END) , 0)\" title=\"M110-114\" primary=\"false\" />\n			<column id=\'M115-119\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'M\' AND (115 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 120 )) THEN 1 ELSE 0 END) , 0)\" title=\"M115-119\" primary=\"false\" />\n			<column id=\'M120-124\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'M\' AND (120 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 125 )) THEN 1 ELSE 0 END) , 0)\" title=\"M120-124\" primary=\"false\" />\n			<column id=\'M125+\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'M\' AND (125 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 999 )) THEN 1 ELSE 0 END) , 0)\" title=\"M125+\" primary=\"false\" />\n			\n			<column id=\'F0-4\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'F\' AND (0 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 5 )) THEN 1 ELSE 0 END) , 0)\" title=\"F0-4\" primary=\"false\" />\n			<column id=\'F5-9\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'F\' AND (5 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 10 )) THEN 1 ELSE 0 END) , 0)\" title=\"F5-9\" primary=\"false\" />\n			<column id=\'F10-14\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'F\' AND (10 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 15 )) THEN 1 ELSE 0 END) , 0)\" title=\"F10-14\" primary=\"false\" />\n			<column id=\'F15-20\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'F\' AND (15 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 20 )) THEN 1 ELSE 0 END) , 0)\" title=\"F15-19\" primary=\"false\" />\n			<column id=\'F20-24\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'F\' AND (20 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 25 )) THEN 1 ELSE 0 END) , 0)\" title=\"F20-29\" primary=\"false\" />\n			<column id=\'F25-29\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'F\' AND (25 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 30 )) THEN 1 ELSE 0 END) , 0)\" title=\"F20-29\" primary=\"false\" />\n			<column id=\'F30-34\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'F\' AND (30 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 35 )) THEN 1 ELSE 0 END) , 0)\" title=\"F30-34\" primary=\"false\" />\n			<column id=\'F35-39\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'F\' AND (35 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 40 )) THEN 1 ELSE 0 END) , 0)\" title=\"F35-39\" primary=\"false\" />\n			<column id=\'F40-44\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'F\' AND (40 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 45 )) THEN 1 ELSE 0 END) , 0)\" title=\"F40-44\" primary=\"false\" />\n			<column id=\'F45-49\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'F\' AND (45 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 50 )) THEN 1 ELSE 0 END) , 0)\" title=\"F45-49\" primary=\"false\" />\n			<column id=\'F50-54\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'F\' AND (50 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 55 )) THEN 1 ELSE 0 END) , 0)\" title=\"F50-54\" primary=\"false\" />\n			<column id=\'F55-59\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'F\' AND (55 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 60 )) THEN 1 ELSE 0 END) , 0)\" title=\"F55-59\" primary=\"false\" />\n			<column id=\'F60-64\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'F\' AND (60 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 65 )) THEN 1 ELSE 0 END) , 0)\" title=\"F60-64\" primary=\"false\" />\n			<column id=\'F65-69\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'F\' AND (65 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 70 )) THEN 1 ELSE 0 END) , 0)\" title=\"F65-69\" primary=\"false\" />\n			<column id=\'F70-74\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'F\' AND (70 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 75 )) THEN 1 ELSE 0 END) , 0)\" title=\"F70-74\" primary=\"false\" />\n			<column id=\'F75-79\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'F\' AND (75 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 80 )) THEN 1 ELSE 0 END) , 0)\" title=\"F75-79\" primary=\"false\" />\n			<column id=\'F80-84\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'F\' AND (80 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 85 )) THEN 1 ELSE 0 END) , 0)\" title=\"F80-84\" primary=\"false\" />\n			<column id=\'F85-89\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'F\' AND (85 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 90 )) THEN 1 ELSE 0 END) , 0)\" title=\"F85-89\" primary=\"false\" />\n			<column id=\'F90-94\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'F\' AND (90 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 95 )) THEN 1 ELSE 0 END) , 0)\" title=\"F90-94\" primary=\"false\" />\n			<column id=\'F95-99\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'F\' AND (95 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 100 )) THEN 1 ELSE 0 END) , 0)\" title=\"F95-99\" primary=\"false\" />\n			<column id=\'F100-104\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'F\' AND (100 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 105 )) THEN 1 ELSE 0 END) , 0)\" title=\"F100-104\" primary=\"false\" />\n			<column id=\'F105-109\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'F\' AND (105 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 110 )) THEN 1 ELSE 0 END) , 0)\" title=\"F105-109\" primary=\"false\" />\n			<column id=\'F110-114\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'F\' AND (110 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 115 )) THEN 1 ELSE 0 END) , 0)\" title=\"F110-114\" primary=\"false\" />\n			<column id=\'F115-119\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'F\' AND (115 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 120 )) THEN 1 ELSE 0 END) , 0)\" title=\"F115-119\" primary=\"false\" />\n			<column id=\'F120-124\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'F\' AND (120 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 125 )) THEN 1 ELSE 0 END) , 0)\" title=\"F120-124\" primary=\"false\" />\n			<column id=\'F125+\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'F\' AND (125 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 999 )) THEN 1 ELSE 0 END) , 0)\" title=\"F125+\" primary=\"false\" />\n		</exportColumns>\n		<query>\n			<!-- Drilldown SQL Query here -->\nSELECT\n    d.*,\n    d.patient_status AS pt_status\nFROM demographic d\nWHERE d.provider_no LIKE ${provider}\nAND d.patient_status LIKE ${pstatus}\n		</query>\n	</drillDownQuery>\n</indicatorTemplateXML>\n','\0','\0',0,NULL,NULL),
(10,2,'No Assigned Primary','General','Patient Population','DoBC CPQI PSP Panel','2017-08-02','# of active patients without an assigned primary\n		','\n		  i)  # of active patients without an assigned primary\n		  ii) # all active patients for all providers\n		','<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<indicatorTemplateXML>\n	<author>OSCAR BC</author>\n	<uid></uid>\n	<heading>\n		<category>General</category>\n		<subCategory>Patient Population</subCategory>\n		<name>No Assigned Primary</name>\n		<definition># of active patients without an assigned primary\n		</definition>\n		<framework>DoBC CPQI PSP Panel</framework>\n		<frameworkVersion>08-02-2017</frameworkVersion>\n		<notes>\n		  i)  # of active patients without an assigned primary\n		  ii) # all active patients for all providers\n		</notes>\n	</heading>\n	<indicatorQuery>\n		<version>03-13-2018</version>\n		<params>\n			<!-- \n				Use this parameter in the query as ${provider}\n				This parameter should be used for fetching patient\'s assigned to a MRP.\n				ie: WHERE demographic.provider_no = ${provider}\n			-->\n			<parameter id=\"provider\" name=\"provider_no\" value=\"loggedInProvider\" />\n			<parameter id=\"pstatus\" name=\"Patient Status\" value=\"\'AC\'\" />\n		</params>\n		<query>\n		  <!-- Indicator SQL Query here -->\nSELECT\n	SUM(fin.NO_ASSIGNED_PRIMARY) AS \"% Active, No Assigned Primary\",\n	SUM(fin.OTHER_PATIENTS) AS \"% Active, Assigned Primary\"\nFROM (\n	SELECT\n		IF( d.provider_no IS NULL OR d.provider_no = \'\' OR p.provider_no IS NULL ,1 ,0 ) AS NO_ASSIGNED_PRIMARY,\n		IF( d.provider_no IS NOT NULL AND d.provider_no != \'\' AND p.provider_no is NOT NULL,1 ,0 ) AS OTHER_PATIENTS\n	FROM demographic d\n	LEFT JOIN provider p\n	ON d.provider_no = p.provider_no\n	WHERE d.patient_status LIKE ${pstatus}\n) fin;\n		</query>\n	</indicatorQuery>\n	<drillDownQuery>\n		<version>03-13-2018</version>\n		<params>\n			<parameter id=\"provider\" name=\"provider_no\" value=\"loggedInProvider\" />	\n			<parameter id=\"pstatus\" name=\"Patient Status\" value=\"\'AC\'\" />\n		</params>\n		<displayColumns>\n			<column id=\"demographic\" name=\"d.demographic_no\" title=\"Patient Id\" primary=\"true\" />\n			<column id=\"name\" name=\"CONCAT( d.last_name, \', \', d.first_name )\" title=\"Patient Name\" primary=\"false\" />\n			<column id=\"dob\" name=\"DATE_FORMAT( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth), \'%m-%d-%Y\' )\" title=\"Date of Birth (mm-dd-yy)\" primary=\"false\" />\n			<column id=\"age\" name=\"TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )\" title=\"Age\" primary=\"false\" />\n			<column id=\"phone\" name=\"d.phone\" title=\"Phone#\" primary=\"false\" />\n			<column id=\"provider\" name=\"d.provider_no\" title=\"Missing/Invalid Provider\" primary=\"false\" />\n		</displayColumns>\n		<exportColumns>\n			<column id=\"demographic\" name=\"d.demographic_no\" title=\"Patient Id\" primary=\"true\" />\n			<column id=\"name\" name=\"CONCAT( d.last_name, \', \', d.first_name )\" title=\"Patient Name\" primary=\"false\" />\n			<column id=\"dob\" name=\"DATE_FORMAT( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth), \'%m-%d-%Y\' )\" title=\"Date of Birth (mm-dd-yy)\" primary=\"false\" />\n			<column id=\"age\" name=\"TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )\" title=\"Age\" primary=\"false\" />\n			<column id=\"phone\" name=\"d.phone\" title=\"Phone#\" primary=\"false\" />\n			<column id=\"provider\" name=\"d.provider_no\" title=\"Missing/Invalid Provider\" primary=\"false\" />\n\n		</exportColumns>\n		<query>\n			<!-- Drilldown SQL Query here -->\nSELECT\nd.*\nFROM demographic d\nLEFT JOIN provider p\nON d.provider_no = p.provider_no\nWHERE d.patient_status LIKE ${pstatus}\nAND (d.provider_no IS NULL OR d.provider_no = \'\' OR p.provider_no IS NULL)\nORDER BY d.provider_no DESC;\n		</query>\n	</drillDownQuery>\n</indicatorTemplateXML>\n','\0','\0',0,NULL,NULL),
(11,2,'Patient Contact','General','Patient Population','DoBC CPQI PSP Panel','2017-08-02','# of active patients with contact information in comparison to # all active patients\n		','\n		  i)  # of active patients without contact information\n		  ii) # of active patients with contact information\n		','<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<indicatorTemplateXML>\n	<author>OSCAR BC</author>\n	<uid></uid>\n	<heading>\n		<category>General</category>\n		<subCategory>Patient Population</subCategory>\n		<name>Patient Contact</name>\n		<definition># of active patients with contact information in comparison to # all active patients\n		</definition>\n		<framework>DoBC CPQI PSP Panel</framework>\n		<frameworkVersion>08-02-2017</frameworkVersion>\n		<notes>\n		  i)  # of active patients without contact information\n		  ii) # of active patients with contact information\n		</notes>\n	</heading>\n	<indicatorQuery>\n		<version>03-13-2018</version>\n		<params>\n			<!-- \n				Use this parameter in the query as ${provider}\n				This parameter should be used for fetching patient\'s assigned to a MRP.\n				ie: WHERE demographic.provider_no = ${provider}\n			-->\n			<parameter id=\"provider\" name=\"provider_no\" value=\"loggedInProvider\" />\n			<parameter id=\"pstatus\" name=\"Patient Status\" value=\"\'AC\'\" />\n		</params>\n		<query>\n		  <!-- Indicator SQL Query here -->\nSELECT\n	SUM(fin.NO_CONTACT_INFO) AS \"% Active, No Contact Information\",\n	SUM(fin.HAS_CONTACT_INFO) AS \"% Active, With Contact Information\"\nFROM (\n	SELECT\n		IF( LENGTH(phone) &lt; LENGTH(\"###-###-####\") AND LENGTH(phone2) &lt; LENGTH(\"###-###-####\" ) ,1 ,0 ) AS NO_CONTACT_INFO,\n		IF( NOT(LENGTH(phone) &lt; LENGTH(\"###-###-####\") AND LENGTH(phone2) &lt; LENGTH(\"###-###-####\" )) ,1 ,0 ) AS HAS_CONTACT_INFO\n	FROM demographic d\n	WHERE d.provider_no LIKE ${provider}\n	AND d.patient_status LIKE ${pstatus}\n) fin;\n		</query>\n	</indicatorQuery>\n	<drillDownQuery>\n		<version>03-13-2018</version>\n		<params>\n			<parameter id=\"provider\" name=\"provider_no\" value=\"loggedInProvider\" />	\n			<parameter id=\"pstatus\" name=\"Patient Status\" value=\"\'AC\'\" />\n		</params>\n		<displayColumns>\n			<column id=\"demographic\" name=\"d.demographic_no\" title=\"Patient Id\" primary=\"true\" />\n			<column id=\"name\" name=\"CONCAT( d.last_name, \', \', d.first_name )\" title=\"Patient Name\" primary=\"false\" />\n			<column id=\"dob\" name=\"DATE_FORMAT( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth), \'%m-%d-%Y\' )\" title=\"Date of Birth (mm-dd-yy)\" primary=\"false\" />\n			<column id=\"age\" name=\"TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )\" title=\"Age\" primary=\"false\" />\n			<column id=\"phone\" name=\"d.phone\" title=\"Phone#\" primary=\"false\" />\n\n		</displayColumns>\n		<exportColumns>\n			<column id=\"demographic\" name=\"d.demographic_no\" title=\"Patient Id\" primary=\"true\" />\n			<column id=\"name\" name=\"CONCAT( d.last_name, \', \', d.first_name )\" title=\"Patient Name\" primary=\"false\" />\n			<column id=\"dob\" name=\"DATE_FORMAT( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth), \'%m-%d-%Y\' )\" title=\"Date of Birth (mm-dd-yy)\" primary=\"false\" />\n			<column id=\"age\" name=\"TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )\" title=\"Age\" primary=\"false\" />\n			<column id=\"phone\" name=\"d.phone\" title=\"Phone#\" primary=\"false\" />\n\n		</exportColumns>\n		<query>\n			<!-- Drilldown SQL Query here -->\nSELECT\nd.*\nFROM demographic d\nWHERE d.provider_no LIKE ${provider}\nAND d.patient_status LIKE ${pstatus}\nAND (LENGTH(phone) &lt; LENGTH(\"###-###-####\") AND LENGTH(phone2) &lt; LENGTH(\"###-###-####\" ));\n		</query>\n	</drillDownQuery>\n</indicatorTemplateXML>\n','\0','\0',0,NULL,NULL),
(12,3,'Active Patients','General','Patient Population','DoBC CPQI PSP Panel','2017-08-02','% of active patients in the practice last seen < 3 years, 3-5 years, 5+ years and never seen.','','<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<indicatorTemplateXML>\n	<author>OSCAR BC</author>\n	<uid></uid>\n	<heading>\n		<category>General</category>\n		<subCategory>Patient Population</subCategory>\n		<name>Active Patients</name>\n		<definition>% of active patients in the practice last seen &lt; 3 years, 3-5 years, 5+ years and never seen.</definition>\n		<framework>DoBC CPQI PSP Panel</framework>\n		<frameworkVersion>08-02-2017</frameworkVersion>\n		<notes></notes>\n	</heading>\n	<indicatorQuery>\n		<version>03-13-2018</version>\n		<params>\n			<!-- \n				Use this parameter in the query as ${provider}\n				This parameter should be used for fetching patient\'s assigned to a MRP.\n				ie: WHERE demographic.provider_no = ${provider}\n			-->\n			<parameter id=\"provider\" name=\"provider_no\" value=\"loggedInProvider\" />\n			<parameter id=\"pstatus\" name=\"Patient Status\" value=\"\'AC\'\" />\n		</params>\n		<query>\n		  <!-- Indicator SQL Query here -->\nSELECT\n	SUM(fin.THREE) AS \"% Active, Seen within 3 years\",\n	SUM(fin.FIVETHREE) AS \"% Active, Seen 3-5 years ago\",\n	SUM(fin.FIVEPLUS) AS \"% Active, not seen in 5+ years\",\n	SUM(fin.NONE) AS \"% Active, no documented encounter\"\nFROM (\n	SELECT\n		IF( DATE_SUB(CURDATE() , INTERVAL 3 YEAR) &lt;= DATE( MAX(cmn.observation_date) ) ,1 ,0 ) AS THREE, \n		IF(  DATE_SUB(CURDATE() , INTERVAL 5 YEAR) &lt;= DATE( MAX(cmn.observation_date) ) AND\n		DATE( MAX(cmn.observation_date) ) &lt; DATE_SUB(CURDATE(), INTERVAL 3 YEAR), 1,0 ) AS FIVETHREE,\n		IF( DATE( MAX( cmn.observation_date ) ) &lt; DATE_SUB(CURDATE() , INTERVAL 5 YEAR) ,1 ,0 ) AS FIVEPLUS,\n		IF( cmn.note_id IS NULL ,1, 0 ) AS NONE\n	FROM demographic d\n	LEFT JOIN casemgmt_note cmn\n	ON (  d.demographic_no = cmn.demographic_no AND cmn.signed = 1 AND cmn.provider_no != \'-1\'  )\n	WHERE d.provider_no LIKE ${provider}\n	AND d.patient_status LIKE ${pstatus}\n	GROUP BY d.demographic_no HAVING count(d.demographic_no) > -1\n) fin;\n		</query>\n	</indicatorQuery>\n	<drillDownQuery>\n		<version>03-13-2018</version>\n		<params>\n			<parameter id=\"provider\" name=\"provider_no\" value=\"loggedInProvider\" />	\n			<parameter id=\"pstatus\" name=\"Patient Status\" value=\"\'AC\'\" />\n		</params>\n		<displayColumns>\n			<column id=\"demographic\" name=\"d.demographic_no\" title=\"Patient Id\" primary=\"true\" />\n			<column id=\"name\" name=\"CONCAT( d.last_name, \', \', d.first_name )\" title=\"Patient Name\" primary=\"false\" />\n			<column id=\"dob\" name=\"DATE_FORMAT( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth), \'%m-%d-%Y\' )\" title=\"Date of Birth (mm-dd-yy)\" primary=\"false\" />\n			<column id=\"age\" name=\"TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )\" title=\"Age\" primary=\"false\" />	\n			<column id=\"lastEncounter\" name=\"IF(MAX(cmn.observation_date) IS NOT NULL,MAX(cmn.observation_date),\'\')\" title=\"Last Encounter\" primary=\"false\" />\n			<column id=\"patientStatus\" name=\"d.patient_status\" title=\"Patient Status\" primary=\"false\" />\n		</displayColumns>\n		<exportColumns>\n			<column id=\"demographic\" name=\"d.demographic_no\" title=\"Patient Id\" primary=\"true\" />\n			<column id=\"name\" name=\"CONCAT( d.last_name, \', \', d.first_name )\" title=\"Patient Name\" primary=\"false\" />\n			<column id=\"dob\" name=\"DATE_FORMAT( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth), \'%m-%d-%Y\' )\" title=\"Date of Birth (mm-dd-yy)\" primary=\"false\" />\n			<column id=\"age\" name=\"TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )\" title=\"Age\" primary=\"false\" />	\n			<column id=\"lastEncounter\" name=\"IF(MAX(cmn.observation_date) IS NOT NULL,MAX(cmn.observation_date),\'\')\" title=\"Last Encounter\" primary=\"false\" />\n			<column id=\"patientStatus\" name=\"d.patient_status\" title=\"Patient Status\" primary=\"false\" />\n		</exportColumns>\n		<query>\n			<!-- Drilldown SQL Query here -->\nSELECT\n    d.*,\n    d.patient_status AS pt_status,\n    max(cmn.observation_date) as last_encounter\nFROM demographic d\nLEFT JOIN casemgmt_note cmn\nON (  d.demographic_no = cmn.demographic_no AND cmn.signed = 1 AND cmn.provider_no != \'-1\'  )\nWHERE d.provider_no LIKE ${provider}\nAND d.patient_status LIKE ${pstatus}\nGROUP BY d.demographic_no HAVING count(d.demographic_no) > -1			\n		</query>\n	</drillDownQuery>\n	<shared>false</shared>\n	<sharedMetricSetName>Home - Patient status</sharedMetricSetName>\n	<sharedMetricDataId>Status</sharedMetricDataId>\n	<sharedMappings>\n		<sharedMapping fromLabel=\"% Active, Seen within 3 years\" toLabel=\"Active, seen within 3 years\"/>\n		<sharedMapping fromLabel=\"% Active, Seen 3-5 years ago\" toLabel=\"Active, seen within 3-5 yrs\"/>\n		<sharedMapping fromLabel=\"% Active, not seen in 5+ years\" toLabel=\"Active, not seen in 5+ yrs\"/>\n	</sharedMappings>	\n</indicatorTemplateXML>\n','\0','\0',0,NULL,NULL),
(13,NULL,'Chronic Pain Prevalence','CDM','Chronic Pain','DoBC CPQI PSP Panel','2017-08-02','% of active patients in the practice coded with Chronic Pain.','\ni) Pain patients: \"Patient Status: Active\nAND has a Current Problem List/Profile item code of 82423001, 373621006 OR starting with 338.4, 338.2, 3384, 3382\"\nii) Other patients: \"Patient Status: Active\nAND does not have a Current Problem List/Profile item','<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<indicatorTemplateXML>\n	<author>OSCAR BC</author>\n	<uid></uid>\n	<heading>\n		<category>CDM</category>\n		<subCategory>Chronic Pain</subCategory>\n		<name>Chronic Pain Prevalence</name>\n		<definition>% of active patients in the practice coded with Chronic Pain.</definition>\n		<framework>DoBC CPQI PSP Panel</framework>\n		<frameworkVersion>08-02-2017</frameworkVersion>\n		<notes>\ni) Pain patients: \"Patient Status: Active\nAND has a Current Problem List/Profile item code of 82423001, 373621006 OR starting with 338.4, 338.2, 3384, 3382\"\nii) Other patients: \"Patient Status: Active\nAND does not have a Current Problem List/Profile item code of 82423001, 373621006 OR starting with 338.4, 338.2, 3384, 3382\"\n		</notes>\n	</heading>\n	<indicatorQuery>\n		<version>03-13-2018</version>\n		<params>\n			<!-- \n				Required parameter provider. Value options are: \n					[ an individual providerNo, or provider range ] ie: value=\"370, 1001\" \n					\"all\" ie: value=\"all\" including null.\n					\"loggedInProvider\" ie:\n				Default is \"loggedInProvider\"\n				Use this parameter in the query as ${provider}\n				This parameter should be used for fetching patient\'s assigned to a MRP.\n				ie: WHERE demographic.provider_no = ${provider}\n			-->\n			<parameter id=\"provider\" name=\"provider_no\" value=\"loggedInProvider\" />\n			<parameter id=\"pstatus\" name=\"Patient Status\" value=\"\'AC\'\" />\n			<parameter id=\"dxcodesICD\" name=\"Dx Codes (ICD)\" value=\"338.4, 338.2, 3384, 3382\" />\n			<parameter id=\"dxcodesSysICD\" name=\"DX CodeSystem (ICD)\" value=\"\'icd9\'\" />\n			<parameter id=\"dxcodesSnoMed\" name=\"Dx Codes (SnoMed)\" value=\"82423001, 373621006\" />\n			<parameter id=\"dxcodesSysSnoMed\" name=\"Dx CodeSystem (SnoMed)\" value=\"\'snomed%\'\" />\n		</params>\n		<query>\n			<!-- Indicator SQL Query here -->\nSELECT\n -- PERCENT OF TOTAL PATIENTS NOTED AS ACTIVE WITH CURRENT CHRONIC PAIN\n IF( COUNT(fin.patient) > 0, SUM( IF( dxresearch_code is not NULL , 1, 0) ) , 0 ) AS \"% Active, Current Chronic Pain\",\n -- PERCENT OF TOTAL PATIENTS NOTED AS ACTIVE WITHOUT CURRENT CHRONIC PAIN\n IF( COUNT(fin.patient) > 0, SUM( IF( dxresearch_code is NULL , 1, 0) ) , 0 ) AS \"% Active, No Current Chronic Pain\"\nFROM (\n SELECT d.demographic_no AS patient, d.patient_status AS pt_status, dxresearch_code\n FROM demographic d\n LEFT JOIN (\n  SELECT demographic_no, dxresearch_code, count(dxresearch_code)\n  FROM dxresearch\n  WHERE status=\'A\' AND\n  (\n   (LEFT(dxresearch_code, 5) IN (\'338.4\', \'338.2\') AND coding_system = ${dxcodesSysICD}) OR\n   (LEFT(dxresearch_code, 4) IN (\'3384\', \'3382\') AND coding_system = ${dxcodesSysICD}) OR\n   (dxresearch_code IN (\'82423001\', \'373621006\') AND coding_system LIKE ${dxcodesSysSnoMed})\n   )\n  GROUP BY demographic_no\n  ORDER BY demographic_no\n ) problems\n ON d.demographic_no = problems.demographic_no\n WHERE d.provider_no LIKE ${provider} AND d.patient_status = ${pstatus}\n) fin\n		</query>\n	</indicatorQuery>\n	<drillDownQuery>\n		<version>03-13-2018</version>\n		<params>\n			<parameter id=\"provider\" name=\"provider_no\" value=\"loggedInProvider\" />	\n			<parameter id=\"pstatus\" name=\"Patient Status\" value=\"\'AC\'\" />\n			<parameter id=\"dxcodesICD\" name=\"Dx Codes (ICD)\" value=\"338.4, 338.2, 3384, 3382\" />\n			<parameter id=\"dxcodesSysICD\" name=\"DX CodeSystem (ICD)\" value=\"\'icd9\'\" />\n			<parameter id=\"dxcodesSnoMed\" name=\"Dx Codes (SnoMed)\" value=\"82423001, 373621006\" />\n			<parameter id=\"dxcodesSysSnoMed\" name=\"Dx CodeSystem (SnoMed)\" value=\"\'snomed%\'\" />\n		</params>\n		<displayColumns>\n			<column id=\"demographic\" name=\"d.demographic_no\" title=\"Patient Id\" primary=\"true\" />\n			<column id=\"name\" name=\"CONCAT( d.last_name, \', \', d.first_name )\" title=\"Patient Name\" primary=\"false\" />\n			<column id=\"dob\" name=\"DATE_FORMAT( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth), \'%m-%d-%Y\' )\" title=\"Date of Birth (mm-dd-yy)\" primary=\"false\" />\n			<column id=\"age\" name=\"TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )\" title=\"Age\" primary=\"false\" />\n			<column id=\"dxcode\" title=\"Dx System/Code\" name=\"CONCAT(MIN(dxr.coding_system),\'/\',MIN(dxr.dxresearch_code),IF( MIN(dxr.dxresearch_code) != MAX(dxr.dxresearch_code),CONCAT( \' &amp; \', MAX(dxr.coding_system), \'/\', MAX(dxr.dxresearch_code) ),\'\') )\" primary=\"false\" />\n		</displayColumns>\n		<exportColumns>\n			<column id=\"demographic\" name=\"d.demographic_no\" title=\"Patient Id\" primary=\"true\" />\n			<column id=\"name\" name=\"CONCAT( d.last_name, \', \', d.first_name )\" title=\"Patient Name\" primary=\"false\" />\n			<column id=\"dob\" name=\"DATE_FORMAT( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth), \'%m-%d-%Y\' )\" title=\"Date of Birth (mm-dd-yy)\" primary=\"false\" />\n			<column id=\"age\" name=\"TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )\" title=\"Age\" primary=\"false\" />\n			<column id=\"dxcode\" title=\"Dx System/Code\" name=\"CONCAT(MIN(dxr.coding_system),\'/\',MIN(dxr.dxresearch_code),IF( MIN(dxr.dxresearch_code) != MAX(dxr.dxresearch_code),CONCAT( \' &amp; \', MAX(dxr.coding_system), \'/\', MAX(dxr.dxresearch_code) ),\'\') )\" primary=\"false\" />\n		</exportColumns>\n		<query>\n			<!-- Drilldown SQL Query here -->\nSELECT\n*			\nFROM demographic d\nLEFT JOIN dxresearch dxr\nON d.demographic_no = dxr.demographic_no\nWHERE d.patient_status=${pstatus}\nAND\n(\n (LEFT(dxr.dxresearch_code, 5) IN (\'338.4\', \'338.2\') AND dxr.coding_system = ${dxcodesSysICD}) OR\n (LEFT(dxr.dxresearch_code, 4) IN (\'3384\', \'3382\') AND dxr.coding_system = ${dxcodesSysICD}) OR\n (dxr.dxresearch_code IN (\'82423001\', \'373621006\') AND dxr.coding_system LIKE ${dxcodesSysSnoMed})\n )\nAND dxr.status = \'A\'\nAND d.provider_no LIKE ${provider}\nGROUP BY d.demographic_no\nORDER BY COUNT(d.demographic_no) DESC, d.demographic_no\n		</query>\n	</drillDownQuery>\n</indicatorTemplateXML>\n','\0','\0',0,NULL,NULL),
(14,NULL,'Consider Chronic Pain','CDM','Chronic Pain','DoBC CPQI PSP Panel','2017-08-02','\n			Patients with pain dx in 2+ bills or 2+ visit encounters within last 3 years or on Opioid medication\n		','\n		  Created for Doctors of BC\n		  i) Pain dx in 2+ bills: \"Patient Status: Active\nAND does not have a Current Problem List/Profile item code of 82423001, 373621006 OR starting with 338.4\nAND with >=2 Bills with the ICD9 diagnosis code of 338.4 in the las','<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<indicatorTemplateXML>\n	<author>OSCAR BC</author>\n	<uid></uid>\n	<heading>\n		<category>CDM</category>\n		<subCategory>Chronic Pain</subCategory>\n		<name>Consider Chronic Pain</name>\n		<definition>\n			Patients with pain dx in 2+ bills or 2+ visit encounters within last 3 years or on Opioid medication\n		</definition>\n		<framework>DoBC CPQI PSP Panel</framework>\n		<frameworkVersion>08-02-2017</frameworkVersion>\n		<notes>\n		  Created for Doctors of BC\n		  i) Pain dx in 2+ bills: \"Patient Status: Active\nAND does not have a Current Problem List/Profile item code of 82423001, 373621006 OR starting with 338.4\nAND with &gt;=2 Bills with the ICD9 diagnosis code of 338.4 in the last 3 years\"\n		  ii) Pain dx in 2+ visits: \"Patient Status: Active\nAND does not have a Current Problem List/Profile item code of 82423001, 373621006 OR starting with 338.4\nAND with &gt;=2 Visit Encounters with the ICD9 diagnosis code of 338.4 in the last 3 years\"\n		  iii) Opioid medication: \"Patient Status: Active\nAND does not have a Current Problem List/Profile item code of 82423001, 373621006 OR starting with 338.4\nAND with &gt;=1 Active Current Medication with ATC Code/Class of N02A\"\n		</notes>\n	</heading>\n	<indicatorQuery>\n		<version>03-13-2018</version>\n		<params>\n			<parameter id=\"provider\" name=\"Provider Number\" value=\"loggedInProvider\" />\n			<parameter id=\"active\" name=\"Active Patients\" value=\"\'AC\'\" />\n			<parameter id=\"dxcodesICD\" name=\"Dx Codes (ICD)\" value=\"338.2,338.4\" />\n			<parameter id=\"dxcodesICD2\" name=\"Dx Codes (ICD)\" value=\"3382,3384\" />\n                        <parameter id=\"dxcodesSysICD\" name=\"DX CodeSystem (ICD)\" value=\"\'icd9\'\" />\n                        <parameter id=\"dxcodesSnoMed\" name=\"Dx Codes (SnoMed)\" value=\"82423001, 373621006\" />\n                        <parameter id=\"dxcodesSysSnoMed\" name=\"Dx CodeSystem (SnoMed)\" value=\"\'snomed%\'\" />\n			<parameter id=\"billingCode\" name=\"ICD9 Billing Code\" value=\"338.2,338.4\" />\n			<parameter id=\"billingCode2\" name=\"ICD9 Billing Code\" value=\"3382,3384\" />\n			<parameter id=\"numOfBills\" name=\"Number of ICD9 338.4 Bills\" value=\"2\" />\n			<parameter id=\"numOfVisits\" name=\"Number of Visit Encounters coded 338.4/ICD9\" value=\"2\" />\n			<parameter id=\"drug\" name=\"ATC Code/Class\" value=\"\'N02A%\'\" />\n			<parameter id=\"numOfMeds\" name=\"Opioid Medications\" value=\"1\" />\n		</params>\n		<range>\n			<lowerLimit id=\"billingdate\" label=\"From Date\" name=\"Date\" value=\"DATE_SUB( NOW(), INTERVAL 3 YEAR )\" />\n			<upperLimit id=\"billingdate\" label=\"Date Today\" name=\"Date\" value=\"NOW()\" />\n			<lowerLimit id=\"visitdate\" label=\"From Date\" name=\"Date\" value=\"DATE_SUB( NOW(), INTERVAL 3 YEAR )\" />\n			<upperLimit id=\"visitdate\" label=\"Date Today\" name=\"Date\" value=\"NOW()\" />\n		</range>\n		<query>\nSELECT\n  IF ( COUNT(fin.patient) &gt; 0, SUM( CASE WHEN (fin.dx IS NULL AND fin.billcount &gt;= ${numOfBills}) THEN 1 ELSE 0 END ) , 0) AS \"Pain dx in ${numOfBills}+ bills\",\n  IF ( COUNT(fin.patient) &gt; 0, SUM( CASE WHEN (fin.dx IS NULL AND fin.visitcount &gt;= ${numOfVisits}) THEN 1 ELSE 0 END ) , 0) AS \"Pain dx in ${numOfVisits}+ visits\",\n  IF ( COUNT(fin.patient) &gt; 0, SUM( CASE WHEN (fin.dx IS NULL AND fin.medcount &gt;= ${numOfMeds} ) THEN 1 ELSE 0 END ) , 0) AS \"Opioid Meds &gt;= ${numOfMeds}\"\nFROM ( \n  SELECT \n    d.demographic_no AS patient, \n    BILLING.billcount AS billcount,\n    VISIT.visitcount AS visitcount,\n    MEDS.numOfMeds AS medcount,\n    dxr.dxresearch_code AS dx,\n    dxr.coding_system AS dxs\n  FROM demographic d \n  LEFT JOIN (\n    SELECT demographic_no, dxresearch_code, coding_system, count(dxresearch_code)\n    FROM dxresearch\n    WHERE status=\'A\' AND\n    (\n      (LEFT(dxresearch_code,5) IN ${dxcodesICD} AND coding_system = ${dxcodesSysICD}) OR\n      (LEFT(dxresearch_code,4) IN ${dxcodesICD2} AND coding_system = ${dxcodesSysICD}) OR\n      (dxresearch_code IN ${dxcodesSnoMed} AND coding_system LIKE ${dxcodesSysSnoMed})\n    )\n    GROUP BY demographic_no\n    ORDER BY demographic_no\n  ) dxr\n  ON d.demographic_no = dxr.demographic_no\n  -- Billed 338.4 in last 3 years\n  LEFT JOIN (\n    SELECT b.demographic_no as demographic_no, b.dx_code1 as dxcode1, b.dx_code2 as dxcode2, b.dx_code3 as dxcode3, count(b.demographic_no) as billcount\n    FROM billingmaster b\n    WHERE LEFT(b.dx_code1,5) IN ${billingCode} OR LEFT(b.dx_code2,5) IN ${billingCode} OR LEFT(b.dx_code3,5) IN ${billingCode}\n    OR LEFT(b.dx_code1,4) IN ${billingCode2} OR LEFT(b.dx_code2,4) IN ${billingCode2} OR LEFT(b.dx_code3,4) IN ${billingCode2}\n    AND DATE(b.createdate) > ${lowerLimit.billingdate}\n    AND b.demographic_no > 0\n    GROUP BY b.demographic_no HAVING COUNT(b.demographic_no) > -1\n  ) BILLING\n  ON (d.demographic_no = BILLING.demographic_no)  \n  -- Coded 338.4 during visit encounter in last 3 years\n  LEFT JOIN(\n    SELECT ASSIGNED.demographic_no as demographic_no, observation_date as visitdate, uuid, count(ASSIGNED.demographic_no) as visitcount\n    FROM casemgmt_note note\n    INNER JOIN (\n      SELECT note_id, CODED.demo_no as demographic_no FROM casemgmt_issue_notes\n      INNER JOIN (\n        SELECT ci.id as id, ci.update_date, ci.demographic_no demo_no FROM issue i\n        INNER JOIN casemgmt_issue ci\n        ON i.issue_id = ci.issue_id\n        WHERE\n	(i.type like ${dxcodesSysICD} and LEFT(i.code,5) IN ${dxcodesICD}) OR\n	(i.type like ${dxcodesSysICD} and LEFT(i.code,4) IN ${dxcodesICD2}) OR\n	(i.type like ${dxcodesSysSnoMed} and i.code IN ${dxcodesSnoMed})\n      ) CODED\n      ON (casemgmt_issue_notes.id = CODED.id)\n      ORDER BY CODED.demo_no\n    ) ASSIGNED\n    ON note.note_id = ASSIGNED.note_id AND\n    -- GET LAST REVISION OF NOTE\n    note.note_id= (SELECT MAX(cmn.note_id) FROM casemgmt_note cmn WHERE cmn.uuid = note.uuid) AND\n    DATE(note.observation_date) > ${lowerLimit.visitdate}\n    GROUP BY demographic_no\n    ORDER BY demographic_no\n  ) VISIT\n  ON (d.demographic_no = VISIT.demographic_no)  \n  -- Opioid medications\n  LEFT JOIN (\n    SELECT dr.demographic_no, count(DISTINCT dr.atc) AS numOfMeds FROM drugs AS dr\n    WHERE dr.archived = 0 AND dr.ATC LIKE ${drug}\n    AND (dr.long_term OR (dr.rx_date &lt;= NOW() AND (DATE_ADD(dr.rx_date, INTERVAL(DATEDIFF(dr.end_date,dr.rx_date)*1.0) DAY)) >= NOW()))\n    GROUP BY dr.demographic_no\n  ) MEDS\n  ON (d.demographic_no = MEDS.demographic_no) \n  WHERE d.patient_status LIKE ${active}\n  AND d.demographic_no > 0\n  AND d.provider_no LIKE ${provider} \n) fin\n		</query>\n	</indicatorQuery>\n	<drillDownQuery>\n		<version>03-13-2018</version>\n		<params>\n			<parameter id=\"provider\" name=\"Provider Number\" value=\"loggedInProvider\" />\n			<parameter id=\"active\" name=\"Active Patients\" value=\"\'AC\'\" />\n			<parameter id=\"dxcodesICD\" name=\"Dx Codes (ICD)\" value=\"338.2,338.4\" />\n			<parameter id=\"dxcodesICD2\" name=\"Dx Codes (ICD)\" value=\"3382,3384\" />\n                        <parameter id=\"dxcodesSysICD\" name=\"DX CodeSystem (ICD)\" value=\"\'icd9\'\" />\n                        <parameter id=\"dxcodesSnoMed\" name=\"Dx Codes (SnoMed)\" value=\"82423001, 373621006\" />\n                        <parameter id=\"dxcodesSysSnoMed\" name=\"Dx CodeSystem (SnoMed)\" value=\"\'snomed%\'\" />\n			<parameter id=\"billingCode\" name=\"ICD9 Billing Code\" value=\"338.2,338.4\" />\n			<parameter id=\"billingCode2\" name=\"ICD9 Billing Code\" value=\"3382,3384\" />\n			<parameter id=\"numOfBills\" name=\"Number of ICD9 338.4 Bills\" value=\"2\" />\n			<parameter id=\"numOfVisits\" name=\"Number of Visit Encounters coded 338.4/ICD9\" value=\"2\" />\n			<parameter id=\"drug\" name=\"ATC Code/Class\" value=\"\'N02A%\'\" />\n			<parameter id=\"numOfMeds\" name=\"Opioid Medications\" value=\"1\" />\n		</params>\n		\n		<range>\n			<lowerLimit id=\"billingdate\" label=\"From Date\" name=\"Date\" value=\"DATE_SUB( NOW(), INTERVAL 3 YEAR )\" />\n			<upperLimit id=\"billingdate\" label=\"Date Today\" name=\"Date\" value=\"NOW()\" />\n			<lowerLimit id=\"visitdate\" label=\"From Date\" name=\"Date\" value=\"DATE_SUB( NOW(), INTERVAL 3 YEAR )\" />\n			<upperLimit id=\"visitdate\" label=\"Date Today\" name=\"Date\" value=\"NOW()\" />\n		</range>\n		\n		<displayColumns>\n			<column id=\"demographic\" name=\"d.demographic_no\" title=\"Patient Id\" primary=\"true\" />\n			<column id=\"name\" name=\"CONCAT( d.last_name, \', \', d.first_name )\" title=\"Patient Name\" primary=\"false\" />\n			<column id=\"dob\" name=\"DATE_FORMAT( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth), \'%m-%d-%Y\' )\" title=\"Date of Birth\" primary=\"false\" />\n			<column id=\"age\" name=\"FLOOR( ABS( DATEDIFF( DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), NOW() ) ) / 365.25 )\" title=\"Age\" primary=\"false\" />\n			<column id=\"billings\" name=\"IFNULL( BILLING.billcount, \'0\')\" title=\"Billings\" primary=\"false\" />\n			<column id=\"visits\" name=\"IFNULL( VISIT.visitcount, \'0\')\" title=\"Visits\" primary=\"false\" />\n			<column id=\"numOfMeds\" name=\"IFNULL( MEDS.numOfMeds, \'NA\')\" title=\"Opioid Medications\" primary=\"false\" />\n		</displayColumns>\n		\n		<exportColumns>\n			<column id=\"demographic\" name=\"d.demographic_no\" title=\"Patient Id\" primary=\"true\" />\n			<column id=\"name\" name=\"CONCAT( d.last_name, \', \', d.first_name )\" title=\"Patient Name\" primary=\"false\" />\n			<column id=\"dob\" name=\"DATE_FORMAT( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth), \'%m-%d-%Y\' )\" title=\"Date of Birth\" primary=\"false\" />\n			<column id=\"age\" name=\"FLOOR( ABS( DATEDIFF( DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), NOW() ) ) / 365.25 )\" title=\"Age\" primary=\"false\" />\n			<column id=\"billings\" name=\"IFNULL( BILLING.billcount, \'0\')\" title=\"Billings\" primary=\"false\" />\n			<column id=\"visits\" name=\"IFNULL( VISIT.visitcount, \'0\')\" title=\"Visits\" primary=\"false\" />\n			<column id=\"numOfMeds\" name=\"IFNULL( MEDS.numOfMeds, \'NA\')\" title=\"Opioid Medications\" primary=\"false\" />\n		</exportColumns>\n		<query>	\n  SELECT *	\n  FROM demographic d \n  LEFT JOIN (\n    SELECT demographic_no, dxresearch_code, coding_system, count(dxresearch_code)\n    FROM dxresearch\n    WHERE status=\'A\' AND\n    (\n      (LEFT(dxresearch_code,5) IN ${dxcodesICD} AND coding_system = ${dxcodesSysICD}) OR\n      (LEFT(dxresearch_code,4) IN ${dxcodesICD2} AND coding_system = ${dxcodesSysICD}) OR\n      (dxresearch_code IN ${dxcodesSnoMed} AND coding_system LIKE ${dxcodesSysSnoMed})\n    )\n    GROUP BY demographic_no\n    ORDER BY demographic_no\n  ) dxr\n  ON d.demographic_no = dxr.demographic_no\n  -- Billed 338.4 in last 3 years\n  LEFT JOIN (\n    SELECT b.demographic_no as demographic_no, b.dx_code1 as dxcode1, b.dx_code2 as dxcode2, b.dx_code3 as dxcode3, count(b.demographic_no) as billcount\n    FROM billingmaster b\n    WHERE LEFT(b.dx_code1,5) IN ${billingCode} OR LEFT(b.dx_code2,5) IN ${billingCode} OR LEFT(b.dx_code3,5) IN ${billingCode}\n    OR LEFT(b.dx_code1,4) IN ${billingCode2} OR LEFT(b.dx_code2,4) IN ${billingCode2} OR LEFT(b.dx_code3,4) IN ${billingCode2}\n    AND DATE(b.createdate) > ${lowerLimit.billingdate}\n    AND b.demographic_no > 0\n    GROUP BY b.demographic_no HAVING COUNT(b.demographic_no) > -1\n  ) BILLING\n  ON (d.demographic_no = BILLING.demographic_no)  \n  -- Coded 338.4 during visit encounter in last 3 years\n  LEFT JOIN(\n    SELECT ASSIGNED.demographic_no as demographic_no, observation_date as visitdate, uuid, count(ASSIGNED.demographic_no) as visitcount\n    FROM casemgmt_note note\n    INNER JOIN (\n      SELECT note_id, CODED.demo_no as demographic_no FROM casemgmt_issue_notes\n      INNER JOIN (\n        SELECT ci.id as id, ci.update_date, ci.demographic_no demo_no FROM issue i\n        INNER JOIN casemgmt_issue ci\n        ON i.issue_id = ci.issue_id\n        WHERE\n	(i.type like ${dxcodesSysICD} and LEFT(i.code,5) IN ${dxcodesICD}) OR\n	(i.type like ${dxcodesSysICD} and LEFT(i.code,4) IN ${dxcodesICD2}) OR\n	(i.type like ${dxcodesSysSnoMed} and i.code IN ${dxcodesSnoMed})\n      ) CODED\n      ON (casemgmt_issue_notes.id = CODED.id)\n      ORDER BY CODED.demo_no\n    ) ASSIGNED\n    ON note.note_id = ASSIGNED.note_id AND\n    -- GET LAST REVISION OF NOTE\n    note.note_id= (SELECT MAX(cmn.note_id) FROM casemgmt_note cmn WHERE cmn.uuid = note.uuid) AND\n    DATE(note.observation_date) > ${lowerLimit.visitdate}\n    GROUP BY demographic_no\n    ORDER BY demographic_no\n  ) VISIT\n  ON (d.demographic_no = VISIT.demographic_no)  \n  -- Opioid medications\n  LEFT JOIN (\n    SELECT dr.demographic_no, count(DISTINCT dr.atc) AS numOfMeds FROM drugs AS dr\n    WHERE dr.archived = 0 AND dr.ATC LIKE ${drug}\n    AND (dr.long_term OR (dr.rx_date &lt;= NOW() AND (DATE_ADD(dr.rx_date, INTERVAL(DATEDIFF(dr.end_date,dr.rx_date)*1.0) DAY)) >= NOW()))\n    GROUP BY dr.demographic_no\n  ) MEDS\n  ON (d.demographic_no = MEDS.demographic_no) \n  WHERE d.patient_status LIKE ${active}\n  AND d.demographic_no > 0\n  AND ( dxr.dxresearch_code IS NULL AND ((BILLING.billcount IS NOT NULL AND BILLING.billcount &gt;= ${numOfBills}) OR (VISIT.visitcount IS NOT NULL AND VISIT.visitcount &gt;= ${numOfVisits}) OR (MEDS.numOfMeds IS NOT NULL AND MEDS.numOfMeds &gt;= ${numOfMeds})))\n  AND d.provider_no LIKE ${provider}\n  ORDER BY d.demographic_no\n		</query>\n	</drillDownQuery>\n</indicatorTemplateXML>\n','\0','\0',0,NULL,NULL),
(15,3,'Consider COPD','CDM','COPD','DoBC CPQI PSP Panel','2017-08-02','\n			Patients with COPD dx in 2+ bills or 2+ visit encounters within last 3 years or FEV1/FVC < 0.7\n		','\n		  Created for Doctors of BC\n		  i) COPD dx in 2+ bills: \"Patient Status: Active\nAND does not have a Current Problem List/Profile item code of 32398004, 63480004, 61937009, 74417001, 185086009, 49158009, 12295008, 13645005   OR starting with 490-492, 49','<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<indicatorTemplateXML>\n	<author>OSCAR BC</author>\n	<uid></uid>\n	<heading>\n		<category>CDM</category>\n		<subCategory>COPD</subCategory>\n		<name>Consider COPD</name>\n		<definition>\n			Patients with COPD dx in 2+ bills or 2+ visit encounters within last 3 years or FEV1/FVC &lt; 0.7\n		</definition>\n		<framework>DoBC CPQI PSP Panel</framework>\n		<frameworkVersion>08-02-2017</frameworkVersion>\n		<notes>\n		  Created for Doctors of BC\n		  i) COPD dx in 2+ bills: \"Patient Status: Active\nAND does not have a Current Problem List/Profile item code of 32398004, 63480004, 61937009, 74417001, 185086009, 49158009, 12295008, 13645005   OR starting with 490-492, 494, 496\nAND with &gt;=2 Bills with the ICD9 diagnosis code of  490-492, 494, 496 in the last 3 years\"\n		  ii) COPD dx in 2+ visits: \"Patient Status: Active\nAND does not have a Current Problem List/Profile item code of 32398004, 63480004, 61937009, 74417001, 185086009, 49158009, 12295008, 13645005   OR starting with 490-492, 494, 496\nAND with &gt;=2 Visit Encounters with the ICD9 diagnosis code of  490-492, 494, 496 in the last 3 years\"\n		  iii) FEV1/FVC &lt; 0.7: \"Patient Status: Active\nAND does not have a Current Problem List/Profile item code of 32398004, 63480004, 61937009, 74417001, 185086009, 49158009, 12295008, 13645005   OR starting with 490-492, 494, 496\nAND has a FEV1/FVC Ratio &lt; 0.7  ((In Wolf, ExamBookmarkCode of \"\"CODP_FEV1FEVr\"\" value &lt; 0.7) OR (In MA, an observatino of \"\"FEV1/FEV Ratio\"\" value &lt; 0.7))\"\n		</notes>\n	</heading>\n	<indicatorQuery>\n		<version>03-13-2018</version>\n		<params>\n			<parameter id=\"provider\" name=\"Provider Number\" value=\"loggedInProvider\" />\n			<parameter id=\"active\" name=\"Active Patients\" value=\"\'AC\'\" />\n			<parameter id=\"dxcodesICD\" name=\"Dx Codes (ICD)\" value=\"490,491,492,494,496\" />\n                        <parameter id=\"dxcodesSysICD\" name=\"DX CodeSystem (ICD)\" value=\"\'icd9\'\" />\n                        <parameter id=\"dxcodesSnoMed\" name=\"Dx Codes (SnoMed)\" value=\"32398004, 63480004,61937009,74417001,185086009,49158009,12295008,13645005\" />\n                        <parameter id=\"dxcodesSysSnoMed\" name=\"Dx CodeSystem (SnoMed)\" value=\"\'snomed%\'\" />\n			<parameter id=\"billingCode\" name=\"ICD9 Billing Code\" value=\"490,491,492,494,496\" />\n			<parameter id=\"numOfBills\" name=\"Number of ICD9 490,491,492,494,496 Bills\" value=\"2\" />\n			<parameter id=\"numOfVisits\" name=\"Number of Visit Encounters coded 490,491,492,494,496/ICD9\" value=\"2\" />\n			<parameter id=\"fev1_fvc\" name=\"FEV1/FVC Result\" value=\"0.7\" />\n		</params>\n		<range>\n			<lowerLimit id=\"billingdate\" label=\"From Date\" name=\"Date\" value=\"DATE_SUB( NOW(), INTERVAL 3 YEAR )\" />\n			<upperLimit id=\"billingdate\" label=\"Date Today\" name=\"Date\" value=\"NOW()\" />\n			<lowerLimit id=\"visitdate\" label=\"From Date\" name=\"Date\" value=\"DATE_SUB( NOW(), INTERVAL 3 YEAR )\" />\n			<upperLimit id=\"visitdate\" label=\"Date Today\" name=\"Date\" value=\"NOW()\" />\n		</range>\n		<query>\nSELECT\n  IF ( COUNT(fin.patient) &gt; 0, SUM( CASE WHEN (fin.dx IS NULL AND fin.billcount &gt;= ${numOfBills}) THEN 1 ELSE 0 END ) , 0) AS \"COPD dx in ${numOfBills}+ bills\",\n  IF ( COUNT(fin.patient) &gt; 0, SUM( CASE WHEN (fin.dx IS NULL AND fin.visitcount &gt;= ${numOfVisits}) THEN 1 ELSE 0 END ) , 0) AS \"COPD dx in ${numOfVisits}+ visits\",\n  IF ( COUNT(fin.patient) &gt; 0, SUM( CASE WHEN (fin.dx IS NULL AND (fin.fev1_fvc &lt; ${fev1_fvc} OR (fin.fev1_fvc &gt; 1 AND fin.fev1_fvc &lt; 100*${fev1_fvc}))) THEN 1 ELSE 0 END ) , 0) AS \"FEV1/FVC &lt; ${fev1_fvc}%\"\nFROM ( \n  SELECT \n    d.demographic_no AS patient, \n    BILLING.billcount AS billcount,\n    VISIT.visitcount AS visitcount,\n    OBS.fev1_fvc AS fev1_fvc,\n    dxr.dxresearch_code AS dx,\n    dxr.coding_system AS dxs\n  FROM demographic d \n  LEFT JOIN (\n    SELECT demographic_no, dxresearch_code, coding_system, count(dxresearch_code)\n    FROM dxresearch\n    WHERE status=\'A\' AND\n    (\n      (LEFT(dxresearch_code,3) IN ${dxcodesICD} AND coding_system = ${dxcodesSysICD}) OR\n      (dxresearch_code IN ${dxcodesSnoMed} AND coding_system LIKE ${dxcodesSysSnoMed})\n    )\n    GROUP BY demographic_no\n    ORDER BY demographic_no\n  ) dxr\n  ON d.demographic_no = dxr.demographic_no\n  -- Billed 490,491,492,494,496 in last 3 years\n  LEFT JOIN (\n    SELECT b.demographic_no AS demographic_no, b.dx_code1 AS dxcode1, b.dx_code2 AS dxcode2, b.dx_code3 AS dxcode3, count(b.demographic_no) AS billcount\n    FROM billingmaster b\n    WHERE b.dx_code1 IN ${billingCode} OR b.dx_code2 IN ${billingCode} OR b.dx_code3 IN ${billingCode}\n    AND DATE(b.createdate) > ${lowerLimit.billingdate}\n    AND b.demographic_no > 0\n    GROUP BY b.demographic_no HAVING COUNT(b.demographic_no) > -1\n  ) BILLING\n  ON (d.demographic_no = BILLING.demographic_no)  \n  -- Coded 490,491,492,494,496 during visit encounter in last 3 years\n  LEFT JOIN(\n    SELECT ASSIGNED.demographic_no AS demographic_no, observation_date AS visitdate, uuid, count(ASSIGNED.demographic_no) AS visitcount\n    FROM casemgmt_note note\n    INNER JOIN (\n      SELECT note_id, CODED.demo_no AS demographic_no FROM casemgmt_issue_notes\n      INNER JOIN (\n        SELECT ci.id AS id, ci.update_date, ci.demographic_no demo_no FROM issue i\n        INNER JOIN casemgmt_issue ci\n        ON i.issue_id = ci.issue_id\n        WHERE\n	(i.type LIKE ${dxcodesSysICD} and LEFT(i.code,3) IN ${dxcodesICD}) OR\n	(i.type LIKE ${dxcodesSysSnoMed} and i.code IN ${dxcodesSnoMed})\n      ) CODED\n      ON (casemgmt_issue_notes.id = CODED.id)\n      ORDER BY CODED.demo_no\n    ) ASSIGNED\n    ON note.note_id = ASSIGNED.note_id AND\n    -- GET LAST REVISION OF NOTE\n    note.note_id= (SELECT MAX(cmn.note_id) FROM casemgmt_note cmn WHERE cmn.uuid = note.uuid) AND\n    DATE(note.observation_date) > ${lowerLimit.visitdate}\n    GROUP BY demographic_no\n    ORDER BY demographic_no\n  ) VISIT\n  ON (d.demographic_no = VISIT.demographic_no)  \n  -- FEV1/FVC measurement\n  LEFT JOIN ( \n    SELECT m.demographicNo AS demographic_no, m.dataField AS fev1_fvc, MAX(m.dateObserved) AS dateObserved\n    FROM measurements m\n    WHERE m.type = \'FEV1\'\n    AND m.demographicNo > 0\n    GROUP BY m.demographicNo\n  ) OBS\n  ON (d.demographic_no = OBS.demographic_no) \n  WHERE d.patient_status LIKE ${active}\n  AND d.demographic_no > 0\n  AND d.provider_no LIKE ${provider} \n) fin\n		</query>\n	</indicatorQuery>\n	<drillDownQuery>\n		<version>03-13-2018</version>\n		<params>\n			<parameter id=\"provider\" name=\"Provider Number\" value=\"loggedInProvider\" />\n			<parameter id=\"active\" name=\"Active Patients\" value=\"\'AC\'\" />\n			<parameter id=\"dxcodesICD\" name=\"Dx Codes (ICD)\" value=\"490,491,492,494,496\" />\n                        <parameter id=\"dxcodesSysICD\" name=\"DX CodeSystem (ICD)\" value=\"\'icd9\'\" />\n                        <parameter id=\"dxcodesSnoMed\" name=\"Dx Codes (SnoMed)\" value=\"32398004, 63480004,61937009,74417001,185086009,49158009,12295008,13645005\" />\n                        <parameter id=\"dxcodesSysSnoMed\" name=\"Dx CodeSystem (SnoMed)\" value=\"\'snomed%\'\" />\n			<parameter id=\"billingCode\" name=\"ICD9 Billing Code\" value=\"490,491,492,494,496\" />\n			<parameter id=\"numOfBills\" name=\"Number of ICD9 490,491,492,494,496 Bills\" value=\"2\" />\n			<parameter id=\"numOfVisits\" name=\"Number of Visit Encounters coded 490,491,492,494,496/ICD9\" value=\"2\" />\n			<parameter id=\"fev1_fvc\" name=\"FEV1/FVC Result\" value=\"0.7\" />\n		</params>\n		\n		<range>\n			<lowerLimit id=\"billingdate\" label=\"From Date\" name=\"Date\" value=\"DATE_SUB( NOW(), INTERVAL 3 YEAR )\" />\n			<upperLimit id=\"billingdate\" label=\"Date Today\" name=\"Date\" value=\"NOW()\" />\n			<lowerLimit id=\"visitdate\" label=\"From Date\" name=\"Date\" value=\"DATE_SUB( NOW(), INTERVAL 3 YEAR )\" />\n			<upperLimit id=\"visitdate\" label=\"Date Today\" name=\"Date\" value=\"NOW()\" />\n		</range>\n		\n		<displayColumns>\n			<column id=\"demographic\" name=\"d.demographic_no\" title=\"Patient Id\" primary=\"true\" />\n			<column id=\"name\" name=\"CONCAT( d.last_name, \', \', d.first_name )\" title=\"Patient Name\" primary=\"false\" />\n			<column id=\"dob\" name=\"DATE_FORMAT( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth), \'%m-%d-%Y\' )\" title=\"Date of Birth\" primary=\"false\" />\n			<column id=\"age\" name=\"FLOOR( ABS( DATEDIFF( DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), NOW() ) ) / 365.25 )\" title=\"Age\" primary=\"false\" />\n			<column id=\"billings\" name=\"IFNULL( BILLING.billcount, \'0\')\" title=\"Billings\" primary=\"false\" />\n			<column id=\"visits\" name=\"IFNULL( VISIT.visitcount, \'0\')\" title=\"Visits\" primary=\"false\" />\n			<column id=\"fev1_fvc\" name=\"IFNULL( OBS.fev1_fvc, \'NA\')\" title=\"FEV1/FVC\" primary=\"false\" />\n		</displayColumns>\n		\n		<exportColumns>\n			<column id=\"demographic\" name=\"d.demographic_no\" title=\"Patient Id\" primary=\"true\" />\n			<column id=\"name\" name=\"CONCAT( d.last_name, \', \', d.first_name )\" title=\"Patient Name\" primary=\"false\" />\n			<column id=\"dob\" name=\"DATE_FORMAT( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth), \'%m-%d-%Y\' )\" title=\"Date of Birth\" primary=\"false\" />\n			<column id=\"age\" name=\"FLOOR( ABS( DATEDIFF( DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), NOW() ) ) / 365.25 )\" title=\"Age\" primary=\"false\" />\n			<column id=\"billings\" name=\"IFNULL( BILLING.billcount, \'0\')\" title=\"Billings\" primary=\"false\" />\n			<column id=\"visits\" name=\"IFNULL( VISIT.visitcount, \'0\')\" title=\"Visits\" primary=\"false\" />\n			<column id=\"fev1_fvc\" name=\"IFNULL( OBS.fev1_fvc, \'NA\')\" title=\"FEV1/FVC\" primary=\"false\" />\n		</exportColumns>\n		<query>	\n  SELECT *	\n  FROM demographic d \n  LEFT JOIN (\n    SELECT demographic_no, dxresearch_code, coding_system, count(dxresearch_code)\n    FROM dxresearch\n    WHERE status=\'A\' AND\n    (\n      (LEFT(dxresearch_code,3) IN ${dxcodesICD} AND coding_system = ${dxcodesSysICD}) OR\n      (dxresearch_code IN ${dxcodesSnoMed} AND coding_system LIKE ${dxcodesSysSnoMed})\n    )\n    GROUP BY demographic_no\n    ORDER BY demographic_no\n  ) dxr\n  ON d.demographic_no = dxr.demographic_no\n  -- Billed 490,491,492,494,496 in last 3 years\n  LEFT JOIN (\n    SELECT b.demographic_no AS demographic_no, b.dx_code1 AS dxcode1, b.dx_code2 AS dxcode2, b.dx_code3 AS dxcode3, count(b.demographic_no) AS billcount\n    FROM billingmaster b\n    WHERE b.dx_code1 IN ${billingCode} OR b.dx_code2 IN ${billingCode} OR b.dx_code3 IN ${billingCode}\n    AND DATE(b.createdate) > ${lowerLimit.billingdate}\n    AND b.demographic_no > 0\n    GROUP BY b.demographic_no HAVING COUNT(b.demographic_no) > -1\n  ) BILLING\n  ON (d.demographic_no = BILLING.demographic_no)  \n  -- Coded 490,491,492,494,496 during visit encounter in last 3 years\n  LEFT JOIN(\n    SELECT ASSIGNED.demographic_no AS demographic_no, observation_date AS visitdate, uuid, count(ASSIGNED.demographic_no) AS visitcount\n    FROM casemgmt_note note\n    INNER JOIN (\n      SELECT note_id, CODED.demo_no AS demographic_no FROM casemgmt_issue_notes\n      INNER JOIN (\n        SELECT ci.id AS id, ci.update_date, ci.demographic_no demo_no FROM issue i\n        INNER JOIN casemgmt_issue ci\n        ON i.issue_id = ci.issue_id\n        WHERE\n	(i.type LIKE ${dxcodesSysICD} and LEFT(i.code,3) IN ${dxcodesICD}) OR\n	(i.type LIKE ${dxcodesSysSnoMed} and i.code IN ${dxcodesSnoMed})\n      ) CODED\n      ON (casemgmt_issue_notes.id = CODED.id)\n      ORDER BY CODED.demo_no\n    ) ASSIGNED\n    ON note.note_id = ASSIGNED.note_id AND\n    -- GET LAST REVISION OF NOTE\n    note.note_id= (SELECT MAX(cmn.note_id) FROM casemgmt_note cmn WHERE cmn.uuid = note.uuid) AND\n    DATE(note.observation_date) > ${lowerLimit.visitdate}\n    GROUP BY demographic_no\n    ORDER BY demographic_no\n  ) VISIT\n  ON (d.demographic_no = VISIT.demographic_no)  \n  -- FEV1/FVC measurement\n  LEFT JOIN ( \n    SELECT m.demographicNo AS demographic_no, m.dataField AS fev1_fvc, MAX(m.dateObserved) AS dateObserved\n    FROM measurements m\n    WHERE m.type = \'FEV1\'\n    AND m.demographicNo > 0\n    GROUP BY m.demographicNo\n  ) OBS\n  ON (d.demographic_no = OBS.demographic_no) \n  WHERE d.patient_status LIKE ${active}\n  AND d.demographic_no > 0\n  AND ( dxr.dxresearch_code IS NULL AND (OBS.fev1_fvc IS NOT NULL AND (OBS.fev1_fvc &lt; ${fev1_fvc} OR (OBS.fev1_fvc &gt; 1 AND OBS.fev1_fvc &lt; 100*${fev1_fvc})) OR (BILLING.billcount IS NOT NULL AND BILLING.billcount &gt;= ${numOfBills}) OR (VISIT.visitcount IS NOT NULL AND VISIT.visitcount &gt;= ${numOfVisits})))\n  AND d.provider_no LIKE ${provider}\n  ORDER BY d.demographic_no\n		</query>\n	</drillDownQuery>\n</indicatorTemplateXML>\n','\0','\0',0,NULL,NULL),
(16,3,'COPD Prevalence','CDM','COPD','DoBC CPQI PSP Panel','2017-08-02','% of active patients in the practice coded with COPD.','\ni) COPD patients: \"Patient Status: Active\nAND has a Current Problem List/Profile item code of 32398004, 63480004, 61937009, 74417001, 185086009, 49158009, 12295008, 13645005   OR starting with 490-492, 494, 496\"\nii) Other patients: \"Patient Status: Activ','<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<indicatorTemplateXML>\n	<author>OSCAR BC</author>\n	<uid></uid>\n	<heading>\n		<category>CDM</category>\n		<subCategory>COPD</subCategory>\n		<name>COPD Prevalence</name>\n		<definition>% of active patients in the practice coded with COPD.</definition>\n		<framework>DoBC CPQI PSP Panel</framework>\n		<frameworkVersion>08-02-2017</frameworkVersion>\n		<notes>\ni) COPD patients: \"Patient Status: Active\nAND has a Current Problem List/Profile item code of 32398004, 63480004, 61937009, 74417001, 185086009, 49158009, 12295008, 13645005   OR starting with 490-492, 494, 496\"\nii) Other patients: \"Patient Status: Active\nAND does not have a Current Problem List/Profile item code of 32398004, 63480004, 61937009, 74417001, 185086009, 49158009, 12295008, 13645005   OR starting with 490-492, 494, 496\"\n		</notes>\n	</heading>\n	<indicatorQuery>\n		<version>03-13-2018</version>\n		<params>\n			<!-- \n				Required parameter provider. Value options are: \n					[ an individual providerNo, or provider range ] ie: value=\"370, 1001\" \n					\"all\" ie: value=\"all\" including null.\n					\"loggedInProvider\" ie:\n				Default is \"loggedInProvider\"\n				Use this parameter in the query as ${provider}\n				This parameter should be used for fetching patient\'s assigned to a MRP.\n				ie: WHERE demographic.provider_no = ${provider}\n			-->\n			<parameter id=\"provider\" name=\"provider_no\" value=\"loggedInProvider\" />\n			<parameter id=\"pstatus\" name=\"Patient Status\" value=\"\'AC\'\" />\n			<parameter id=\"dxcodesICD\" name=\"Dx Codes (ICD)\" value=\"490, 491, 492, 494, 496\" />\n			<parameter id=\"dxcodesSysICD\" name=\"DX CodeSystem (ICD)\" value=\"\'icd9\'\" />\n			<parameter id=\"dxcodesSnoMed\" name=\"Dx Codes (SnoMed)\" value=\"32398004, 63480004, 61937009, 74417001, 185086009, 49158009, 12295008, 13645005\" />\n			<parameter id=\"dxcodesSysSnoMed\" name=\"Dx CodeSystem (SnoMed)\" value=\"\'snomed%\'\" />\n		</params>\n		<query>\n			<!-- Indicator SQL Query here -->\nSELECT\n -- PERCENT OF TOTAL PATIENTS NOTED AS ACTIVE WITH CURRENT COPD\n IF( COUNT(fin.patient) > 0, SUM( IF( dxresearch_code is not NULL , 1, 0) ) , 0 ) AS \"% Active, Current COPD\",\n -- PERCENT OF TOTAL PATIENTS NOTED AS ACTIVE WITHOUT CURRENT COPD\n IF( COUNT(fin.patient) > 0, SUM( IF( dxresearch_code is NULL , 1, 0) ) , 0 ) AS \"% Active, No Current COPD\"\nFROM (\n SELECT d.demographic_no AS patient, d.patient_status AS pt_status, dxresearch_code\n FROM demographic d\n LEFT JOIN (\n  SELECT demographic_no, dxresearch_code, count(dxresearch_code)\n  FROM dxresearch\n  WHERE status=\'A\' AND\n  (\n   (LEFT(dxresearch_code, 3) IN (\'490\', \'491\', \'492\', \'494\', \'496\') AND coding_system = ${dxcodesSysICD}) OR\n   (dxresearch_code IN (\'32398004\', \'63480004\', \'61937009\', \'74417001\', \'185086009\', \'49158009\', \'12295008\', \'13645005\') AND coding_system LIKE ${dxcodesSysSnoMed})\n   )\n  GROUP BY demographic_no\n  ORDER BY demographic_no\n ) problems\n ON d.demographic_no = problems.demographic_no\n WHERE d.provider_no LIKE ${provider} AND d.patient_status = ${pstatus}\n) fin\n		</query>\n	</indicatorQuery>\n	<drillDownQuery>\n		<version>03-13-2018</version>\n		<params>\n			<parameter id=\"provider\" name=\"provider_no\" value=\"loggedInProvider\" />	\n			<parameter id=\"pstatus\" name=\"Patient Status\" value=\"\'AC\'\" />\n			<parameter id=\"dxcodesICD\" name=\"Dx Codes (ICD)\" value=\"490, 491, 492, 494, 496\" />\n			<parameter id=\"dxcodesSysICD\" name=\"DX CodeSystem (ICD)\" value=\"\'icd9\'\" />\n			<parameter id=\"dxcodesSnoMed\" name=\"Dx Codes (SnoMed)\" value=\"32398004, 63480004, 61937009, 74417001, 185086009, 49158009, 12295008, 13645005\" />\n			<parameter id=\"dxcodesSysSnoMed\" name=\"Dx CodeSystem (SnoMed)\" value=\"\'snomed%\'\" />\n		</params>\n		<displayColumns>\n			<column id=\"demographic\" name=\"d.demographic_no\" title=\"Patient Id\" primary=\"true\" />\n			<column id=\"name\" name=\"CONCAT( d.last_name, \', \', d.first_name )\" title=\"Patient Name\" primary=\"false\" />\n			<column id=\"dob\" name=\"DATE_FORMAT( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth), \'%m-%d-%Y\' )\" title=\"Date of Birth (mm-dd-yy)\" primary=\"false\" />\n			<column id=\"age\" name=\"TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )\" title=\"Age\" primary=\"false\" />\n			<column id=\"dxcode\" title=\"Dx System/Code\" name=\"CONCAT(MIN(dxr.coding_system),\'/\',MIN(dxr.dxresearch_code),IF( MIN(dxr.dxresearch_code) != MAX(dxr.dxresearch_code),CONCAT( \' &amp; \', MAX(dxr.coding_system), \'/\', MAX(dxr.dxresearch_code) ),\'\') )\" primary=\"false\" />\n		</displayColumns>\n		<exportColumns>\n			<column id=\"demographic\" name=\"d.demographic_no\" title=\"Patient Id\" primary=\"true\" />\n			<column id=\"name\" name=\"CONCAT( d.last_name, \', \', d.first_name )\" title=\"Patient Name\" primary=\"false\" />\n			<column id=\"dob\" name=\"DATE_FORMAT( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth), \'%m-%d-%Y\' )\" title=\"Date of Birth (mm-dd-yy)\" primary=\"false\" />\n			<column id=\"age\" name=\"TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )\" title=\"Age\" primary=\"false\" />\n			<column id=\"dxcode\" title=\"Dx System/Code\" name=\"CONCAT(MIN(dxr.coding_system),\'/\',MIN(dxr.dxresearch_code),IF( MIN(dxr.dxresearch_code) != MAX(dxr.dxresearch_code),CONCAT( \' &amp; \', MAX(dxr.coding_system), \'/\', MAX(dxr.dxresearch_code) ),\'\') )\" primary=\"false\" />\n		</exportColumns>\n		<query>\n			<!-- Drilldown SQL Query here -->\nSELECT\n*			\nFROM demographic d\nLEFT JOIN dxresearch dxr\nON d.demographic_no = dxr.demographic_no\nWHERE d.patient_status=${pstatus}\nAND\n(\n (LEFT(dxr.dxresearch_code, 3) IN (\'490\', \'491\', \'492\', \'494\', \'496\') AND dxr.coding_system = ${dxcodesSysICD}) OR\n (dxr.dxresearch_code IN (\'32398004\', \'63480004\', \'61937009\', \'74417001\', \'185086009\', \'49158009\', \'12295008\', \'13645005\') AND dxr.coding_system LIKE ${dxcodesSysSnoMed})\n )\nAND dxr.status = \'A\'\nAND d.provider_no LIKE ${provider}\nGROUP BY d.demographic_no\nORDER BY COUNT(d.demographic_no) DESC, d.demographic_no\n		</query>\n	</drillDownQuery>\n</indicatorTemplateXML>\n','\0','\0',0,NULL,NULL),
(17,3,'Consider Diabetes','CDM','Diabetes','DoBC CPQI PSP Panel','2017-08-02','\n			Patients with diabetes dx in 2+ bills or 2+ visit encounters within last 3 years or most recent glycemic control in the last 12 months was > 7%\n		','\n		  Created for Doctors of BC\n		  i) Diabetes dx in 2+ bills: Active Patient Status AND does not have a Current Problem List/Profile item code of 73211009 OR starting with 250 AND with >= 2 Bills with the ICD9 diagnosis code of 250 in the last 3 years.\n	','<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<indicatorTemplateXML>\n	<author>OSCAR BC</author>\n	<uid></uid>\n	<heading>\n		<category>CDM</category>\n		<subCategory>Diabetes</subCategory>\n		<name>Consider Diabetes</name>\n		<definition>\n			Patients with diabetes dx in 2+ bills or 2+ visit encounters within last 3 years or most recent glycemic control in the last 12 months was &gt; 7%\n		</definition>\n		<framework>DoBC CPQI PSP Panel</framework>\n		<frameworkVersion>08-02-2017</frameworkVersion>\n		<notes>\n		  Created for Doctors of BC\n		  i) Diabetes dx in 2+ bills: Active Patient Status AND does not have a Current Problem List/Profile item code of 73211009 OR starting with 250 AND with &gt;= 2 Bills with the ICD9 diagnosis code of 250 in the last 3 years.\n		  ii) Diabetes dx in 2+ visits: Active Patient Status AND does not have a Current Problem List/Profile item code of 73211009 OR stating with 250 AND with &gt;= 2 Visit Encounters with the ICD9 diagnosis code of 250 in the last 3 years.\n		  iii) HbA1C or Glucose Fasting &gt; 7%: Active Patient Status AND does not have a Current Problem List/Profile item code of 73211009 OR starting with 250 AND WITH a most recent HbA1c [&gt; 7% OR (&gt; 0.07 AND NOT &gt; 1)] OR Fasting Glucose &gt; 7% in the past 1 year.\n		</notes>\n	</heading>\n	<indicatorQuery>\n		<version>03-13-2018</version>\n		<params>\n			<parameter id=\"provider\" name=\"Provider Number\" value=\"loggedInProvider\" />\n			<parameter id=\"active\" name=\"Active Patients\" value=\"\'AC\'\" />\n			<parameter id=\"dxcodesICD\" name=\"Dx Codes (ICD)\" value=\"\'250%\'\" />\n                        <parameter id=\"dxcodesSysICD\" name=\"DX CodeSystem (ICD)\" value=\"\'icd9\'\" />\n                        <parameter id=\"dxcodesSnoMed\" name=\"Dx Codes (SnoMed)\" value=\"\'73211009\'\" />\n                        <parameter id=\"dxcodesSysSnoMed\" name=\"Dx CodeSystem (SnoMed)\" value=\"\'snomed%\'\" />\n			<parameter id=\"billingCode\" name=\"ICD9 Billing Code\" value=\"250\" />\n			<parameter id=\"numOfBills\" name=\"Number of ICD9 250 Bills\" value=\"2\" />\n			<parameter id=\"numOfVisits\" name=\"Number of Visit Encounters coded 250/ICD9\" value=\"2\" />\n			<parameter id=\"a1c\" name=\"HbA1c Result\" value=\"7.0\" />\n			<parameter id=\"fbs\" name=\"Fasting Glucose Result\" value=\"7.0\" />\n		</params>\n		<range>\n			<lowerLimit id=\"billingdate\" label=\"From Date\" name=\"Date\" value=\"DATE_SUB( NOW(), INTERVAL 3 YEAR )\" />\n			<upperLimit id=\"billingdate\" label=\"Date Today\" name=\"Date\" value=\"NOW()\" />\n			<lowerLimit id=\"visitdate\" label=\"From Date\" name=\"Date\" value=\"DATE_SUB( NOW(), INTERVAL 3 YEAR )\" />\n                        <upperLimit id=\"visitdate\" label=\"Date Today\" name=\"Date\" value=\"NOW()\" />\n			<lowerLimit id=\"labdate\" label=\"From Date\" name=\"Date\" value=\"DATE_SUB( NOW(), INTERVAL 12 MONTH )\" />\n			<upperLimit id=\"labdate\" label=\"Date Today\" name=\"Date\" value=\"NOW()\" />\n		</range>\n		<query>\nSELECT\n  IF ( COUNT(fin.patient) &gt; 0, SUM( CASE WHEN (fin.billcount &gt;= ${numOfBills} AND fin.dx IS NULL) THEN 1 ELSE 0 END ) , 0) AS \"Diabetes dx in ${numOfBills}+ bills\",\n  IF ( COUNT(fin.patient) &gt; 0, SUM( CASE WHEN (fin.dx IS NULL AND fin.visitcount &gt;= ${numOfVisits}) THEN 1 ELSE 0 END ) , 0) AS \"Diabetes dx in ${numOfVisits}+ visits\",\n  IF ( COUNT(fin.patient) &gt; 0, SUM( CASE WHEN ((fin.hba1c &gt; ${a1c} OR (fin.hba1c &gt; 0.01*${a1c} and fin.hba1c &lt; 1) OR fin.fbs &gt; ${fbs} ) AND (fin.dx IS NULL)) THEN 1 ELSE 0 END ) , 0) AS \"HbA1C or Glucose Fasting &gt; ${a1c}%\"\nFROM ( \n  SELECT \n    d.demographic_no AS patient, \n    BILLING.billcount AS billcount,\n    VISIT.visitcount AS visitcount,\n    A1C.dataField AS hba1c,\n    FBS.dataField AS fbs,\n    dxr.dxresearch_code AS dx,\n    dxr.coding_system AS dxs\n  FROM demographic d \n  LEFT JOIN (\n    SELECT demographic_no, dxresearch_code, coding_system, count(dxresearch_code)\n    FROM dxresearch\n    WHERE status=\'A\' AND\n    (\n      (dxresearch_code LIKE ${dxcodesICD} AND coding_system = ${dxcodesSysICD}) OR\n      (dxresearch_code = ${dxcodesSnoMed} AND coding_system LIKE ${dxcodesSysSnoMed})\n    )\n    GROUP BY demographic_no\n    ORDER BY demographic_no\n  ) dxr\n  ON d.demographic_no = dxr.demographic_no\n  -- Billed 250 in last 3 years\n  LEFT JOIN (\n    SELECT b.demographic_no as demographic_no, b.dx_code1 as dxcode1, b.dx_code2 as dxcode2, b.dx_code3 as dxcode3, count(b.demographic_no) as billcount\n    FROM billingmaster b\n    WHERE b.dx_code1 = ${billingCode} OR b.dx_code2 = ${billingCode} OR b.dx_code3 = ${billingCode}\n    AND DATE(b.createdate) > ${lowerLimit.billingdate}\n    AND b.demographic_no > 0\n    GROUP BY b.demographic_no HAVING COUNT(b.demographic_no) > -1\n  ) BILLING\n  ON (d.demographic_no = BILLING.demographic_no)\n  -- Coded 250 during visit encounter in last 3 years\n  LEFT JOIN(\n    SELECT ASSIGNED.demographic_no AS demographic_no, observation_date AS visitdate, uuid, count(ASSIGNED.demographic_no) AS visitcount\n    FROM casemgmt_note note\n    INNER JOIN (\n      SELECT note_id, CODED.demo_no AS demographic_no FROM casemgmt_issue_notes\n      INNER JOIN (\n        SELECT ci.id AS id, ci.update_date, ci.demographic_no demo_no FROM issue i\n        INNER JOIN casemgmt_issue ci\n        ON i.issue_id = ci.issue_id\n        WHERE\n        (i.type LIKE ${dxcodesSysICD} and i.code LIKE ${dxcodesICD}) OR\n        (i.type LIKE ${dxcodesSysSnoMed} and i.code = ${dxcodesSnoMed})\n      ) CODED\n      ON (casemgmt_issue_notes.id = CODED.id)\n      ORDER BY CODED.demo_no\n    ) ASSIGNED\n    ON note.note_id = ASSIGNED.note_id AND\n    -- GET LAST REVISION OF NOTE\n    note.note_id= (SELECT MAX(cmn.note_id) FROM casemgmt_note cmn WHERE cmn.uuid = note.uuid) AND\n    DATE(note.observation_date) > ${lowerLimit.visitdate}\n    GROUP BY demographic_no\n    ORDER BY demographic_no\n  ) VISIT\n  ON (d.demographic_no = VISIT.demographic_no)\n  -- HbA1C measurement\n  LEFT JOIN ( \n    SELECT m.dataField, m.demographicNo as demographic_no\n    FROM measurements m\n    WHERE m.type = \'A1C\'\n    AND DATE(m.dateObserved) > ${lowerLimit.labdate}\n    AND m.demographicNo > 0\n    GROUP BY m.demographicNo HAVING COUNT(m.demographicNo) > -1\n  ) A1C \n  ON (d.demographic_no = A1C.demographic_no) \n  -- Fasting Glucose measurement\n  LEFT JOIN ( \n    SELECT m.dataField, m.demographicNo as demographic_no\n    FROM measurements m\n    WHERE m.type = \'FBS\'\n    AND DATE(m.dateObserved) > ${lowerLimit.labdate}\n    AND m.demographicNo > 0\n    GROUP BY m.demographicNo HAVING COUNT(m.demographicNo) > -1\n  ) FBS \n  ON (d.demographic_no = FBS.demographic_no) \n  WHERE d.patient_status LIKE ${active}\n  AND d.demographic_no > 0\n  AND d.provider_no LIKE ${provider} \n) fin\n		</query>\n	</indicatorQuery>\n	<drillDownQuery>\n		<version>03-13-2018</version>\n		<params>\n			<parameter id=\"provider\" name=\"Provider Number\" value=\"loggedInProvider\" />\n			<parameter id=\"active\" name=\"Active Patients\" value=\"\'AC\'\" />\n			<parameter id=\"dxcodesICD\" name=\"Dx Codes (ICD)\" value=\"\'250%\'\" />\n                        <parameter id=\"dxcodesSysICD\" name=\"DX CodeSystem (ICD)\" value=\"\'icd9\'\" />\n                        <parameter id=\"dxcodesSnoMed\" name=\"Dx Codes (SnoMed)\" value=\"\'73211009\'\" />\n                        <parameter id=\"dxcodesSysSnoMed\" name=\"Dx CodeSystem (SnoMed)\" value=\"\'snomed%\'\" />\n			<parameter id=\"billingCode\" name=\"ICD9 Billing Code\" value=\"250\" />\n			<parameter id=\"numOfBills\" name=\"Number of ICD9 250 Bills\" value=\"2\" />\n			<parameter id=\"numOfVisits\" name=\"Number of ICD9 250 Visits\" value=\"2\" />\n			<parameter id=\"a1c\" name=\"HbA1c Result\" value=\"7.0\" />\n			<parameter id=\"fbs\" name=\"Fasting Glucose Result\" value=\"7.0\" />\n		</params>\n		\n		<range>\n			<lowerLimit id=\"billingdate\" label=\"From Date\" name=\"Date\" value=\"DATE_SUB( NOW(), INTERVAL 3 YEAR )\" />\n			<upperLimit id=\"billingdate\" label=\"Date Today\" name=\"Date\" value=\"NOW()\" />\n			<lowerLimit id=\"visitdate\" label=\"From Date\" name=\"Date\" value=\"DATE_SUB( NOW(), INTERVAL 3 YEAR )\" />\n                        <upperLimit id=\"visitdate\" label=\"Date Today\" name=\"Date\" value=\"NOW()\" />\n			<lowerLimit id=\"labdate\" label=\"From Date\" name=\"Date\" value=\"DATE_SUB( NOW(), INTERVAL 12 MONTH )\" />\n			<upperLimit id=\"labdate\" label=\"Date Today\" name=\"Date\" value=\"NOW()\" />\n		</range>\n		\n		<displayColumns>\n			<column id=\"demographic\" name=\"d.demographic_no\" title=\"Patient Id\" primary=\"true\" />\n			<column id=\"name\" name=\"CONCAT( d.last_name, \', \', d.first_name )\" title=\"Patient Name\" primary=\"false\" />\n			<column id=\"dob\" name=\"DATE_FORMAT( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth), \'%m-%d-%Y\' )\" title=\"Date of Birth (mm-dd-yy)\" primary=\"false\" />\n			<column id=\"age\" name=\"FLOOR( ABS( DATEDIFF( DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), NOW() ) ) / 365.25 )\" title=\"Age\" primary=\"false\" />\n			<column id=\"billings\" name=\"IFNULL( BILLING.billcount, \'\')\" title=\"Billings\" primary=\"false\" />\n			<column id=\"visits\" name=\"IFNULL( VISIT.visitcount, \'0\')\" title=\"Visits\" primary=\"false\" />\n			<column id=\"a1c\" name=\"IFNULL( A1C.dataField, \'\')\" title=\"HbA1C\" primary=\"false\" />\n			<column id=\"a1cDate\" name=\"IFNULL( DATE_FORMAT( A1C.dateObserved, \'%m-%d-%Y\' ), \'\')\" title=\"HbA1C Test Date (mm-dd-yyyy)\" primary=\"false\" />\n			<column id=\"fbs\" name=\"IFNULL( FBS.dataField, \'\')\" title=\"FBS\" primary=\"false\" />\n			<column id=\"fbsDate\" name=\"IFNULL( DATE_FORMAT( FBS.dateObserved, \'%m-%d-%Y\' ), \'\')\" title=\"FBS Test Date (mm-dd-yyyy)\" primary=\"false\" />\n		</displayColumns>\n		\n		<exportColumns>\n			<column id=\"demographic\" name=\"d.demographic_no\" title=\"Patient Id\" primary=\"true\" />\n			<column id=\"name\" name=\"CONCAT( d.last_name, \', \', d.first_name )\" title=\"Patient Name\" primary=\"false\" />\n			<column id=\"dob\" name=\"DATE_FORMAT( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth), \'%m-%d-%Y\' )\" title=\"Date of Birth (mm-dd-yy)\" primary=\"false\" />\n			<column id=\"age\" name=\"FLOOR( ABS( DATEDIFF( DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), NOW() ) ) / 365.25 )\" title=\"Age\" primary=\"false\" />\n			<column id=\"billings\" name=\"IFNULL( BILLING.billcount, \'\')\" title=\"Billings\" primary=\"false\" />\n			<column id=\"visits\" name=\"IFNULL( VISIT.visitcount, \'0\')\" title=\"Visits\" primary=\"false\" />\n			<column id=\"a1c\" name=\"IFNULL( A1C.dataField, \'\')\" title=\"HbA1C\" primary=\"false\" />\n			<column id=\"a1cDate\" name=\"IFNULL( DATE_FORMAT( A1C.dateObserved, \'%m-%d-%Y\' ), \'\')\" title=\"Test Date (mm-dd-yyyy)\" primary=\"false\" />\n			<column id=\"fbs\" name=\"IFNULL( FBS.dataField, \'\')\" title=\"FBS\" primary=\"false\" />\n			<column id=\"fbsDate\" name=\"IFNULL( DATE_FORMAT( FBS.dateObserved, \'%m-%d-%Y\' ), \'\')\" title=\"FBS Test Date (mm-dd-yyyy)\" primary=\"false\" />\n		</exportColumns>\n		<query>	\n  SELECT *	\n  FROM demographic d \n  LEFT JOIN (\n    SELECT demographic_no, dxresearch_code, coding_system, count(dxresearch_code)\n    FROM dxresearch\n    WHERE status != \'D\' AND\n    (\n      (dxresearch_code LIKE ${dxcodesICD} AND coding_system = ${dxcodesSysICD}) OR\n      (dxresearch_code = ${dxcodesSnoMed} AND coding_system LIKE ${dxcodesSysSnoMed})\n    )\n    GROUP BY demographic_no\n    ORDER BY demographic_no\n  ) dxr\n  ON d.demographic_no = dxr.demographic_no\n  -- Billed 250 in last 3 years\n  LEFT JOIN (\n    SELECT b.demographic_no as demographic_no, b.dx_code1 as dxcode1, b.dx_code2 as dxcode2, b.dx_code3 as dxcode3, count(b.demographic_no) as billcount\n    FROM billingmaster b\n    WHERE b.dx_code1 = ${billingCode} OR b.dx_code2 = ${billingCode} OR b.dx_code3 = ${billingCode}\n    AND DATE(b.createdate) > ${lowerLimit.billingdate}\n    AND b.demographic_no > 0\n    GROUP BY b.demographic_no HAVING COUNT(b.demographic_no) > -1\n  ) BILLING\n  ON (d.demographic_no = BILLING.demographic_no)\n  -- Coded 250 during visit encounter in last 3 years\n  LEFT JOIN(\n    SELECT ASSIGNED.demographic_no AS demographic_no, observation_date AS visitdate, uuid, count(ASSIGNED.demographic_no) AS visitcount\n    FROM casemgmt_note note\n    INNER JOIN (\n      SELECT note_id, CODED.demo_no AS demographic_no FROM casemgmt_issue_notes\n      INNER JOIN (\n        SELECT ci.id AS id, ci.update_date, ci.demographic_no demo_no FROM issue i\n        INNER JOIN casemgmt_issue ci\n        ON i.issue_id = ci.issue_id\n        WHERE\n        (i.type LIKE ${dxcodesSysICD} and i.code LIKE ${dxcodesICD}) OR\n        (i.type LIKE ${dxcodesSysSnoMed} and i.code = ${dxcodesSnoMed})\n      ) CODED\n      ON (casemgmt_issue_notes.id = CODED.id)\n      ORDER BY CODED.demo_no\n    ) ASSIGNED\n    ON note.note_id = ASSIGNED.note_id AND\n    -- GET LAST REVISION OF NOTE\n    note.note_id= (SELECT MAX(cmn.note_id) FROM casemgmt_note cmn WHERE cmn.uuid = note.uuid) AND\n    DATE(note.observation_date) > ${lowerLimit.visitdate}\n    GROUP BY demographic_no\n    ORDER BY demographic_no\n  ) VISIT\n  ON (d.demographic_no = VISIT.demographic_no)\n  -- HbA1C measurement\n  LEFT JOIN ( \n    SELECT m.dataField as dataField, m.demographicNo as demographic_no, m.dateObserved as dateObserved\n    FROM measurements m\n    WHERE m.type = \'A1C\'\n    AND DATE(m.dateObserved) > ${lowerLimit.labdate}\n    AND m.demographicNo > 0\n    GROUP BY m.demographicNo HAVING COUNT(m.demographicNo) > -1\n  ) A1C \n  ON (d.demographic_no = A1C.demographic_no) \n  -- Fasting Glucose measurement\n  LEFT JOIN ( \n    SELECT m.dataField as dataField, m.demographicNo as demographic_no, m.dateObserved as dateObserved\n    FROM measurements m\n    WHERE m.type = \'FBS\'\n    AND DATE(m.dateObserved) > ${lowerLimit.labdate}\n    AND m.demographicNo > 0\n    GROUP BY m.demographicNo HAVING COUNT(m.demographicNo) > -1\n  ) FBS \n  ON (d.demographic_no = FBS.demographic_no) \n  WHERE d.patient_status LIKE ${active}\n  AND d.demographic_no > 0\n  AND ( dxr.dxresearch_code IS NULL AND ( (BILLING.billcount IS NOT NULL AND BILLING.billcount &gt;= ${numOfBills})  OR (VISIT.visitcount IS NOT NULL AND VISIT.visitcount &gt;= ${numOfVisits}) OR (A1C.dataField IS NOT NULL AND (A1C.dataField &gt; ${a1c} OR (A1C.dataField &gt; 0.01*${a1c} AND A1C.dataField &lt; 1))) OR ( FBS.dataField IS NOT NULL AND FBS.dataField &gt; ${fbs} ) ) )\n  AND d.provider_no LIKE ${provider}\n  ORDER BY d.demographic_no\n		</query>\n	</drillDownQuery>\n</indicatorTemplateXML>\n','\0','\0',0,NULL,NULL),
(18,3,'Diabetes Prevalence','CDM','Diabetes','DoBC CPQI PSP Panel','2017-08-02','% of active patients in the practice coded with Diabetes.','\ni) Diabetes patients: \"Patient Status: Active\nAND has a Current Problem List/Profile item code of 73211009 OR starting with 250\"\nii) Other patients: \"Patient Status: Active\nAND does not have a Current Problem List/Profile item code of 73211009 OR startin','<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<indicatorTemplateXML>\n	<author>OSCAR BC</author>\n	<uid></uid>\n	<heading>\n		<category>CDM</category>\n		<subCategory>Diabetes</subCategory>\n		<name>Diabetes Prevalence</name>\n		<definition>% of active patients in the practice coded with Diabetes.</definition>\n		<framework>DoBC CPQI PSP Panel</framework>\n		<frameworkVersion>08-02-2017</frameworkVersion>\n		<notes>\ni) Diabetes patients: \"Patient Status: Active\nAND has a Current Problem List/Profile item code of 73211009 OR starting with 250\"\nii) Other patients: \"Patient Status: Active\nAND does not have a Current Problem List/Profile item code of 73211009 OR starting with 250\"\n		</notes>\n	</heading>\n	<indicatorQuery>\n		<version>03-13-2018</version>\n		<params>\n			<!-- \n				Required parameter provider. Value options are: \n					[ an individual providerNo, or provider range ] ie: value=\"370, 1001\" \n					\"all\" ie: value=\"all\" including null.\n					\"loggedInProvider\" ie:\n				Default is \"loggedInProvider\"\n				Use this parameter in the query as ${provider}\n				This parameter should be used for fetching patient\'s assigned to a MRP.\n				ie: WHERE demographic.provider_no = ${provider}\n			-->\n			<parameter id=\"provider\" name=\"provider_no\" value=\"loggedInProvider\" />\n			<parameter id=\"pstatus\" name=\"Patient Status\" value=\"\'AC\'\" />\n			<parameter id=\"dxcodesICD\" name=\"Dx Codes (ICD)\" value=\"250\" />\n			<parameter id=\"dxcodesSysICD\" name=\"DX CodeSystem (ICD)\" value=\"\'icd9\'\" />\n			<parameter id=\"dxcodesSnoMed\" name=\"Dx Codes (SnoMed)\" value=\"73211009\" />\n			<parameter id=\"dxcodesSysSnoMed\" name=\"Dx CodeSystem (SnoMed)\" value=\"\'snomed%\'\" />\n		</params>\n		<query>\n			<!-- Indicator SQL Query here -->\nSELECT\n -- PERCENT OF TOTAL PATIENTS NOTED AS ACTIVE WITH CURRENT DIABETES\n IF( COUNT(fin.patient) > 0, SUM( IF( dxresearch_code is not NULL , 1, 0) ) , 0 ) AS \"% Active, Current Diabetes\",\n -- PERCENT OF TOTAL PATIENTS NOTED AS ACTIVE WITHOUT CURRENT DIABETES\n IF( COUNT(fin.patient) > 0, SUM( IF( dxresearch_code is NULL , 1, 0) ) , 0 ) AS \"% Active, No Current Diabetes\"\nFROM (\n SELECT d.demographic_no AS patient, d.patient_status AS pt_status, dxresearch_code\n FROM demographic d\n LEFT JOIN (\n  SELECT demographic_no, dxresearch_code, count(dxresearch_code)\n  FROM dxresearch\n  WHERE status=\'A\' AND\n  (\n   (LEFT(dxresearch_code, 3) IN (\'250\') AND coding_system = ${dxcodesSysICD}) OR\n   (dxresearch_code IN (\'73211009\') AND coding_system LIKE ${dxcodesSysSnoMed})\n   )\n  GROUP BY demographic_no\n  ORDER BY demographic_no\n ) problems\n ON d.demographic_no = problems.demographic_no\n WHERE d.provider_no LIKE ${provider} AND d.patient_status = ${pstatus}\n) fin\n		</query>\n	</indicatorQuery>\n	<drillDownQuery>\n		<version>03-13-2018</version>\n		<params>\n			<parameter id=\"provider\" name=\"provider_no\" value=\"loggedInProvider\" />	\n			<parameter id=\"pstatus\" name=\"Patient Status\" value=\"\'AC\'\" />\n			<parameter id=\"dxcodesICD\" name=\"Dx Codes (ICD)\" value=\"250\" />\n			<parameter id=\"dxcodesSysICD\" name=\"DX CodeSystem (ICD)\" value=\"\'icd9\'\" />\n			<parameter id=\"dxcodesSnoMed\" name=\"Dx Codes (SnoMed)\" value=\"73211009\" />\n			<parameter id=\"dxcodesSysSnoMed\" name=\"Dx CodeSystem (SnoMed)\" value=\"\'snomed%\'\" />\n		</params>\n		<displayColumns>\n			<column id=\"demographic\" name=\"d.demographic_no\" title=\"Patient Id\" primary=\"true\" />\n			<column id=\"name\" name=\"CONCAT( d.last_name, \', \', d.first_name )\" title=\"Patient Name\" primary=\"false\" />\n			<column id=\"dob\" name=\"DATE_FORMAT( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth), \'%m-%d-%Y\' )\" title=\"Date of Birth (mm-dd-yy)\" primary=\"false\" />\n			<column id=\"age\" name=\"TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )\" title=\"Age\" primary=\"false\" />\n			<column id=\"dxcode\" title=\"Dx System/Code\" name=\"CONCAT(MIN(dxr.coding_system),\'/\',MIN(dxr.dxresearch_code),IF( MIN(dxr.dxresearch_code) != MAX(dxr.dxresearch_code),CONCAT( \' &amp; \', MAX(dxr.coding_system), \'/\', MAX(dxr.dxresearch_code) ),\'\') )\" primary=\"false\" />\n		</displayColumns>\n		<exportColumns>\n			<column id=\"demographic\" name=\"d.demographic_no\" title=\"Patient Id\" primary=\"true\" />\n			<column id=\"name\" name=\"CONCAT( d.last_name, \', \', d.first_name )\" title=\"Patient Name\" primary=\"false\" />\n			<column id=\"dob\" name=\"DATE_FORMAT( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth), \'%m-%d-%Y\' )\" title=\"Date of Birth (mm-dd-yy)\" primary=\"false\" />\n			<column id=\"age\" name=\"TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )\" title=\"Age\" primary=\"false\" />\n			<column id=\"dxcode\" title=\"Dx System/Code\" name=\"CONCAT(MIN(dxr.coding_system),\'/\',MIN(dxr.dxresearch_code),IF( MIN(dxr.dxresearch_code) != MAX(dxr.dxresearch_code),CONCAT( \' &amp; \', MAX(dxr.coding_system), \'/\', MAX(dxr.dxresearch_code) ),\'\') )\" primary=\"false\" />\n		</exportColumns>\n		<query>\n			<!-- Drilldown SQL Query here -->\nSELECT\n*			\nFROM demographic d\nLEFT JOIN dxresearch dxr\nON d.demographic_no = dxr.demographic_no\nWHERE d.patient_status=${pstatus}\nAND\n(\n (LEFT(dxr.dxresearch_code, 3) IN (\'250\') AND dxr.coding_system = ${dxcodesSysICD}) OR\n (dxr.dxresearch_code IN (\'73211009\') AND dxr.coding_system LIKE ${dxcodesSysSnoMed})\n )\nAND dxr.status = \'A\'\nAND d.provider_no LIKE ${provider}\nGROUP BY d.demographic_no\nORDER BY COUNT(d.demographic_no) DESC, d.demographic_no\n		</query>\n	</drillDownQuery>\n</indicatorTemplateXML>\n','\0','\0',0,NULL,NULL),
(19,3,'Heart Failure Prevalence','CDM','Heart Failure','DoBC CPQI PSP Panel','2017-08-02','% of active patients in the practice coded with Heart Failure.','\ni) HF patients: \"Patient Status: Active\nAND has a Current Problem List/Profile item code of 84114007 OR starting with 428\"\nii) Other patients: \"Patient Status: Active\nAND does not have a Current Problem List/Profile item code of 84114007 OR starting with','<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<indicatorTemplateXML>\n	<author>OSCAR BC</author>\n	<uid></uid>\n	<heading>\n		<category>CDM</category>\n		<subCategory>Heart Failure</subCategory>\n		<name>Heart Failure Prevalence</name>\n		<definition>% of active patients in the practice coded with Heart Failure.</definition>\n		<framework>DoBC CPQI PSP Panel</framework>\n		<frameworkVersion>08-02-2017</frameworkVersion>\n		<notes>\ni) HF patients: \"Patient Status: Active\nAND has a Current Problem List/Profile item code of 84114007 OR starting with 428\"\nii) Other patients: \"Patient Status: Active\nAND does not have a Current Problem List/Profile item code of 84114007 OR starting with 428\"\n		</notes>\n	</heading>\n	<indicatorQuery>\n		<version>03-13-2018</version>\n		<params>\n			<!-- \n				Required parameter provider. Value options are: \n					[ an individual providerNo, or provider range ] ie: value=\"370, 1001\" \n					\"all\" ie: value=\"all\" including null.\n					\"loggedInProvider\" ie:\n				Default is \"loggedInProvider\"\n				Use this parameter in the query as ${provider}\n				This parameter should be used for fetching patient\'s assigned to a MRP.\n				ie: WHERE demographic.provider_no = ${provider}\n			-->\n			<parameter id=\"provider\" name=\"provider_no\" value=\"loggedInProvider\" />\n			<parameter id=\"pstatus\" name=\"Patient Status\" value=\"\'AC\'\" />\n			<parameter id=\"dxcodesICD\" name=\"Dx Codes (ICD)\" value=\"428\" />\n			<parameter id=\"dxcodesSysICD\" name=\"DX CodeSystem (ICD)\" value=\"\'icd9\'\" />\n			<parameter id=\"dxcodesSnoMed\" name=\"Dx Codes (SnoMed)\" value=\"84114007\" />\n			<parameter id=\"dxcodesSysSnoMed\" name=\"Dx CodeSystem (SnoMed)\" value=\"\'snomed%\'\" />\n		</params>\n		<query>\n			<!-- Indicator SQL Query here -->\nSELECT\n -- PERCENT OF TOTAL PATIENTS NOTED AS ACTIVE WITH CURRENT HEART FAILURE\n IF( COUNT(fin.patient) > 0, SUM( IF( dxresearch_code is not NULL , 1, 0) ) , 0 ) AS \"% Active, Current Heart Failure\",\n -- PERCENT OF TOTAL PATIENTS NOTED AS ACTIVE WITHOUT CURRENT HEART FAILURE\n IF( COUNT(fin.patient) > 0, SUM( IF( dxresearch_code is NULL , 1, 0) ) , 0 ) AS \"% Active, No Current Heart Failure\"\nFROM (\n SELECT d.demographic_no AS patient, d.patient_status AS pt_status, dxresearch_code\n FROM demographic d\n LEFT JOIN (\n  SELECT demographic_no, dxresearch_code, count(dxresearch_code)\n  FROM dxresearch\n  WHERE status=\'A\' AND\n  (\n   (LEFT(dxresearch_code, 3) IN (\'428\') AND coding_system = ${dxcodesSysICD}) OR\n   (dxresearch_code IN (\'84114007\') AND coding_system LIKE ${dxcodesSysSnoMed})\n   )\n  GROUP BY demographic_no\n  ORDER BY demographic_no\n ) problems\n ON d.demographic_no = problems.demographic_no\n WHERE d.provider_no LIKE ${provider} AND d.patient_status = ${pstatus}\n) fin\n		</query>\n	</indicatorQuery>\n	<drillDownQuery>\n		<version>03-13-2018</version>\n		<params>\n			<parameter id=\"provider\" name=\"provider_no\" value=\"loggedInProvider\" />	\n			<parameter id=\"pstatus\" name=\"Patient Status\" value=\"\'AC\'\" />\n			<parameter id=\"dxcodesICD\" name=\"Dx Codes (ICD)\" value=\"428\" />\n			<parameter id=\"dxcodesSysICD\" name=\"DX CodeSystem (ICD)\" value=\"\'icd9\'\" />\n			<parameter id=\"dxcodesSnoMed\" name=\"Dx Codes (SnoMed)\" value=\"84114007\" />\n			<parameter id=\"dxcodesSysSnoMed\" name=\"Dx CodeSystem (SnoMed)\" value=\"\'snomed%\'\" />\n		</params>\n		<displayColumns>\n			<column id=\"demographic\" name=\"d.demographic_no\" title=\"Patient Id\" primary=\"true\" />\n			<column id=\"name\" name=\"CONCAT( d.last_name, \', \', d.first_name )\" title=\"Patient Name\" primary=\"false\" />\n			<column id=\"dob\" name=\"DATE_FORMAT( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth), \'%m-%d-%Y\' )\" title=\"Date of Birth (mm-dd-yy)\" primary=\"false\" />\n			<column id=\"age\" name=\"TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )\" title=\"Age\" primary=\"false\" />\n			<column id=\"dxcode\" title=\"Dx System/Code\" name=\"CONCAT(MIN(dxr.coding_system),\'/\',MIN(dxr.dxresearch_code),IF( MIN(dxr.dxresearch_code) != MAX(dxr.dxresearch_code),CONCAT( \' &amp; \', MAX(dxr.coding_system), \'/\', MAX(dxr.dxresearch_code) ),\'\') )\" primary=\"false\" />\n		</displayColumns>\n		<exportColumns>\n			<column id=\"demographic\" name=\"d.demographic_no\" title=\"Patient Id\" primary=\"true\" />\n			<column id=\"name\" name=\"CONCAT( d.last_name, \', \', d.first_name )\" title=\"Patient Name\" primary=\"false\" />\n			<column id=\"dob\" name=\"DATE_FORMAT( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth), \'%m-%d-%Y\' )\" title=\"Date of Birth (mm-dd-yy)\" primary=\"false\" />\n			<column id=\"age\" name=\"TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )\" title=\"Age\" primary=\"false\" />\n			<column id=\"dxcode\" title=\"Dx System/Code\" name=\"CONCAT(MIN(dxr.coding_system),\'/\',MIN(dxr.dxresearch_code),IF( MIN(dxr.dxresearch_code) != MAX(dxr.dxresearch_code),CONCAT( \' &amp; \', MAX(dxr.coding_system), \'/\', MAX(dxr.dxresearch_code) ),\'\') )\" primary=\"false\" />\n		</exportColumns>\n		<query>\n			<!-- Drilldown SQL Query here -->\nSELECT\n*			\nFROM demographic d\nLEFT JOIN dxresearch dxr\nON d.demographic_no = dxr.demographic_no\nWHERE d.patient_status=${pstatus}\nAND\n(\n (LEFT(dxr.dxresearch_code, 3) IN (\'428\') AND dxr.coding_system = ${dxcodesSysICD}) OR\n (dxr.dxresearch_code IN (\'84114007\') AND dxr.coding_system LIKE ${dxcodesSysSnoMed})\n )\nAND dxr.status = \'A\'\nAND d.provider_no LIKE ${provider}\nGROUP BY d.demographic_no\nORDER BY COUNT(d.demographic_no) DESC, d.demographic_no\n		</query>\n	</drillDownQuery>\n</indicatorTemplateXML>\n','\0','\0',0,NULL,NULL),
(20,3,'Consider Heart Failure','CDM','Heart Failure','DoBC CPQI PSP Panel','2017-08-02','\n			Patients with heart failure dx in 2+ bills or 2+ visit encounters within last 3 years or LVEF < 40\n		','\n		  Created for Doctors of BC\n		  i) HF dx in 2+ bills: \"Patient Status: Active\nAND does not have a Current Problem List/Profile item code of 84114007 OR starting with 428\nAND with >=2 Bills with the ICD9 diagnosis code of 428 in the last 3 years\"\n		  ii','<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<indicatorTemplateXML>\n	<author>OSCAR BC</author>\n	<uid></uid>\n	<heading>\n		<category>CDM</category>\n		<subCategory>Heart Failure</subCategory>\n		<name>Consider Heart Failure</name>\n		<definition>\n			Patients with heart failure dx in 2+ bills or 2+ visit encounters within last 3 years or LVEF &lt; 40\n		</definition>\n		<framework>DoBC CPQI PSP Panel</framework>\n		<frameworkVersion>08-02-2017</frameworkVersion>\n		<notes>\n		  Created for Doctors of BC\n		  i) HF dx in 2+ bills: \"Patient Status: Active\nAND does not have a Current Problem List/Profile item code of 84114007 OR starting with 428\nAND with &gt;=2 Bills with the ICD9 diagnosis code of 428 in the last 3 years\"\n		  ii) HF dx in 2+ visits: \"Patient Status: Active\nAND does not have a Current Problem List/Profile item code of 84114007 OR starting with 428\nAND with &gt;=2 Visit Encounters with the ICD9 diagnosis code of 428 in the last 3 years\"\n		  iii) LVEF &lt; 40: \"Patient Status: Active AND does not have a Current Problem List/Profile item code of 84114007 OR starting with 428\nAND has an LVEF (Left ventrical ejection fraction) observation and value &lt; 40 ((In MA, an observation of \"\"LVEF\"\" &lt; 40) OR (In Wolf, a bookmarkexamcode of \"\"P_EF_HF_LVEF\"\" &lt; 40))\"\n		</notes>\n	</heading>\n	<indicatorQuery>\n		<version>03-13-2018</version>\n		<params>\n			<parameter id=\"provider\" name=\"Provider Number\" value=\"loggedInProvider\" />\n			<parameter id=\"active\" name=\"Active Patients\" value=\"\'AC\'\" />\n			<parameter id=\"dxcodesICD\" name=\"Dx Codes (ICD)\" value=\"\'428%\'\" />\n                        <parameter id=\"dxcodesSysICD\" name=\"DX CodeSystem (ICD)\" value=\"\'icd9\'\" />\n                        <parameter id=\"dxcodesSnoMed\" name=\"Dx Codes (SnoMed)\" value=\"\'84114007\'\" />\n                        <parameter id=\"dxcodesSysSnoMed\" name=\"Dx CodeSystem (SnoMed)\" value=\"\'snomed%\'\" />\n			<parameter id=\"billingCode\" name=\"ICD9 Billing Code\" value=\"428\" />\n			<parameter id=\"numOfBills\" name=\"Number of ICD9 428 Bills\" value=\"2\" />\n			<parameter id=\"numOfVisits\" name=\"Number of Visit Encounters coded 428/ICD9\" value=\"2\" />\n			<parameter id=\"lvef\" name=\"LVEF Result\" value=\"40\" />\n		</params>\n		<range>\n			<lowerLimit id=\"billingdate\" label=\"From Date\" name=\"Date\" value=\"DATE_SUB( NOW(), INTERVAL 3 YEAR )\" />\n			<upperLimit id=\"billingdate\" label=\"Date Today\" name=\"Date\" value=\"NOW()\" />\n			<lowerLimit id=\"visitdate\" label=\"From Date\" name=\"Date\" value=\"DATE_SUB( NOW(), INTERVAL 3 YEAR )\" />\n			<upperLimit id=\"visitdate\" label=\"Date Today\" name=\"Date\" value=\"NOW()\" />\n		</range>\n		<query>\nSELECT\n  IF ( COUNT(fin.patient) &gt; 0, SUM( CASE WHEN (fin.dx IS NULL AND fin.billcount &gt;= ${numOfBills}) THEN 1 ELSE 0 END ) , 0) AS \"HF dx in ${numOfBills}+ bills\",\n  IF ( COUNT(fin.patient) &gt; 0, SUM( CASE WHEN (fin.dx IS NULL AND fin.visitcount &gt;= ${numOfVisits}) THEN 1 ELSE 0 END ) , 0) AS \"HF dx in ${numOfVisits}+ visits\",\n  IF ( COUNT(fin.patient) &gt; 0, SUM( CASE WHEN (fin.dx IS NULL AND fin.lvef &lt; ${lvef} ) THEN 1 ELSE 0 END ) , 0) AS \"LVEF &lt; ${lvef}%\"\nFROM ( \n  SELECT \n    d.demographic_no AS patient, \n    BILLING.billcount AS billcount,\n    VISIT.visitcount AS visitcount,\n    OBS.lvef AS lvef,\n    dxr.dxresearch_code AS dx,\n    dxr.coding_system AS dxs\n  FROM demographic d \n  LEFT JOIN (\n    SELECT demographic_no, dxresearch_code, coding_system, count(dxresearch_code)\n    FROM dxresearch\n    WHERE status=\'A\' AND\n    (\n      (dxresearch_code LIKE ${dxcodesICD} AND coding_system = ${dxcodesSysICD}) OR\n      (dxresearch_code = ${dxcodesSnoMed} AND coding_system LIKE ${dxcodesSysSnoMed})\n    )\n    GROUP BY demographic_no\n    ORDER BY demographic_no\n  ) dxr\n  ON d.demographic_no = dxr.demographic_no\n  -- Billed 428 in last 3 years\n  LEFT JOIN (\n    SELECT b.demographic_no as demographic_no, b.dx_code1 as dxcode1, b.dx_code2 as dxcode2, b.dx_code3 as dxcode3, count(b.demographic_no) as billcount\n    FROM billingmaster b\n    WHERE b.dx_code1 = ${billingCode} OR b.dx_code2 = ${billingCode} OR b.dx_code3 = ${billingCode}\n    AND DATE(b.createdate) > ${lowerLimit.billingdate}\n    AND b.demographic_no > 0\n    GROUP BY b.demographic_no HAVING COUNT(b.demographic_no) > -1\n  ) BILLING\n  ON (d.demographic_no = BILLING.demographic_no)  \n  -- Coded 428 during visit encounter in last 3 years\n  LEFT JOIN(\n    SELECT ASSIGNED.demographic_no as demographic_no, observation_date as visitdate, uuid, count(ASSIGNED.demographic_no) as visitcount\n    FROM casemgmt_note note\n    INNER JOIN (\n      SELECT note_id, CODED.demo_no as demographic_no FROM casemgmt_issue_notes\n      INNER JOIN (\n        SELECT ci.id as id, ci.update_date, ci.demographic_no demo_no FROM issue i\n        INNER JOIN casemgmt_issue ci\n        ON i.issue_id = ci.issue_id\n        WHERE\n	(i.type like ${dxcodesSysICD} and i.code like ${dxcodesICD}) OR\n	(i.type like ${dxcodesSysSnoMed} and i.code = ${dxcodesSnoMed})\n      ) CODED\n      ON (casemgmt_issue_notes.id = CODED.id)\n      ORDER BY CODED.demo_no\n    ) ASSIGNED\n    ON note.note_id = ASSIGNED.note_id AND\n    -- GET LAST REVISION OF NOTE\n    note.note_id= (SELECT MAX(cmn.note_id) FROM casemgmt_note cmn WHERE cmn.uuid = note.uuid) AND\n    DATE(note.observation_date) > ${lowerLimit.visitdate}\n    GROUP BY demographic_no\n    ORDER BY demographic_no\n  ) VISIT\n  ON (d.demographic_no = VISIT.demographic_no)  \n  -- LVEF measurement\n  LEFT JOIN ( \n    SELECT m.demographicNo as demographic_no, m.dataField as lvef, MAX(m.dateObserved) as dateObserved\n    FROM measurements m\n    WHERE m.type = \'LVEF\'\n    AND m.demographicNo > 0\n    GROUP BY m.demographicNo\n  ) OBS\n  ON (d.demographic_no = OBS.demographic_no) \n  WHERE d.patient_status LIKE ${active}\n  AND d.demographic_no > 0\n  AND d.provider_no LIKE ${provider} \n) fin\n		</query>\n	</indicatorQuery>\n	<drillDownQuery>\n		<version>03-13-2018</version>\n		<params>\n			<parameter id=\"provider\" name=\"Provider Number\" value=\"loggedInProvider\" />\n			<parameter id=\"active\" name=\"Active Patients\" value=\"\'AC\'\" />\n			<parameter id=\"dxcodesICD\" name=\"Dx Codes (ICD)\" value=\"\'428%\'\" />\n                        <parameter id=\"dxcodesSysICD\" name=\"DX CodeSystem (ICD)\" value=\"\'icd9\'\" />\n                        <parameter id=\"dxcodesSnoMed\" name=\"Dx Codes (SnoMed)\" value=\"\'84114007\'\" />\n                        <parameter id=\"dxcodesSysSnoMed\" name=\"Dx CodeSystem (SnoMed)\" value=\"\'snomed%\'\" />\n			<parameter id=\"billingCode\" name=\"ICD9 Billing Code\" value=\"428\" />\n			<parameter id=\"numOfBills\" name=\"Number of ICD9 428 Bills\" value=\"2\" />\n			<parameter id=\"numOfVisits\" name=\"Number of Visit Encounters coded 428/ICD9\" value=\"2\" />\n			<parameter id=\"lvef\" name=\"LVEF Result\" value=\"40\" />\n		</params>\n		\n		<range>\n			<lowerLimit id=\"billingdate\" label=\"From Date\" name=\"Date\" value=\"DATE_SUB( NOW(), INTERVAL 3 YEAR )\" />\n			<upperLimit id=\"billingdate\" label=\"Date Today\" name=\"Date\" value=\"NOW()\" />\n			<lowerLimit id=\"visitdate\" label=\"From Date\" name=\"Date\" value=\"DATE_SUB( NOW(), INTERVAL 3 YEAR )\" />\n			<upperLimit id=\"visitdate\" label=\"Date Today\" name=\"Date\" value=\"NOW()\" />\n		</range>\n		\n		<displayColumns>\n			<column id=\"demographic\" name=\"d.demographic_no\" title=\"Patient Id\" primary=\"true\" />\n			<column id=\"name\" name=\"CONCAT( d.last_name, \', \', d.first_name )\" title=\"Patient Name\" primary=\"false\" />\n			<column id=\"dob\" name=\"DATE_FORMAT( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth), \'%m-%d-%Y\' )\" title=\"Date of Birth\" primary=\"false\" />\n			<column id=\"age\" name=\"FLOOR( ABS( DATEDIFF( DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), NOW() ) ) / 365.25 )\" title=\"Age\" primary=\"false\" />\n			<column id=\"billings\" name=\"IFNULL( BILLING.billcount, \'0\')\" title=\"Billings\" primary=\"false\" />\n			<column id=\"visits\" name=\"IFNULL( VISIT.visitcount, \'0\')\" title=\"Visits\" primary=\"false\" />\n			<column id=\"lvef\" name=\"IFNULL( OBS.lvef, \'NA\')\" title=\"LVEF\" primary=\"false\" />\n		</displayColumns>\n		\n		<exportColumns>\n			<column id=\"demographic\" name=\"d.demographic_no\" title=\"Patient Id\" primary=\"true\" />\n			<column id=\"name\" name=\"CONCAT( d.last_name, \', \', d.first_name )\" title=\"Patient Name\" primary=\"false\" />\n			<column id=\"dob\" name=\"DATE_FORMAT( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth), \'%m-%d-%Y\' )\" title=\"Date of Birth\" primary=\"false\" />\n			<column id=\"age\" name=\"FLOOR( ABS( DATEDIFF( DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), NOW() ) ) / 365.25 )\" title=\"Age\" primary=\"false\" />\n			<column id=\"billings\" name=\"IFNULL( BILLING.billcount, \'0\')\" title=\"Billings\" primary=\"false\" />\n			<column id=\"visits\" name=\"IFNULL( VISIT.visitcount, \'0\')\" title=\"Visits\" primary=\"false\" />\n			<column id=\"lvef\" name=\"IFNULL( OBS.lvef, \'NA\')\" title=\"LVEF\" primary=\"false\" />\n		</exportColumns>\n		<query>	\n  SELECT *	\n  FROM demographic d \n  LEFT JOIN (\n    SELECT demographic_no, dxresearch_code, coding_system, count(dxresearch_code)\n    FROM dxresearch\n    WHERE status=\'A\' AND\n    (\n      (dxresearch_code LIKE ${dxcodesICD} AND coding_system = ${dxcodesSysICD}) OR\n      (dxresearch_code = ${dxcodesSnoMed} AND coding_system LIKE ${dxcodesSysSnoMed})\n    )\n    GROUP BY demographic_no\n    ORDER BY demographic_no\n  ) dxr\n  ON d.demographic_no = dxr.demographic_no\n  -- Billed 428 in last 3 years\n  LEFT JOIN (\n    SELECT b.demographic_no as demographic_no, b.dx_code1 as dxcode1, b.dx_code2 as dxcode2, b.dx_code3 as dxcode3, count(b.demographic_no) as billcount\n    FROM billingmaster b\n    WHERE b.dx_code1 = ${billingCode} OR b.dx_code2 = ${billingCode} OR b.dx_code3 = ${billingCode}\n    AND DATE(b.createdate) > ${lowerLimit.billingdate}\n    AND b.demographic_no > 0\n    GROUP BY b.demographic_no HAVING COUNT(b.demographic_no) > -1\n  ) BILLING\n  ON (d.demographic_no = BILLING.demographic_no)  \n  -- Coded 428 during visit encounter in last 3 years\n  LEFT JOIN(\n    SELECT ASSIGNED.demographic_no as demographic_no, observation_date as visitdate, uuid, count(ASSIGNED.demographic_no) as visitcount\n    FROM casemgmt_note note\n    INNER JOIN (\n      SELECT note_id, CODED.demo_no as demographic_no FROM casemgmt_issue_notes\n      INNER JOIN (\n        SELECT ci.id as id, ci.update_date, ci.demographic_no demo_no FROM issue i\n        INNER JOIN casemgmt_issue ci\n        ON i.issue_id = ci.issue_id\n        WHERE\n	(i.type like ${dxcodesSysICD} and i.code like ${dxcodesICD}) OR\n	(i.type like ${dxcodesSysSnoMed} and i.code = ${dxcodesSnoMed})\n      ) CODED\n      ON (casemgmt_issue_notes.id = CODED.id)\n      ORDER BY CODED.demo_no\n    ) ASSIGNED\n    ON note.note_id = ASSIGNED.note_id AND\n    -- GET LAST REVISION OF NOTE\n    note.note_id= (SELECT MAX(cmn.note_id) FROM casemgmt_note cmn WHERE cmn.uuid = note.uuid) AND\n    DATE(note.observation_date) > ${lowerLimit.visitdate}\n    GROUP BY demographic_no\n    ORDER BY demographic_no\n  ) VISIT\n  ON (d.demographic_no = VISIT.demographic_no)  \n  -- LVEF measurement\n  LEFT JOIN ( \n    SELECT m.demographicNo as demographic_no, m.dataField as lvef, MAX(m.dateObserved) as dateObserved\n    FROM measurements m\n    WHERE m.type = \'LVEF\'\n    AND m.demographicNo > 0\n    GROUP BY m.demographicNo\n  ) OBS\n  ON (d.demographic_no = OBS.demographic_no) \n  WHERE d.patient_status LIKE ${active}\n  AND d.demographic_no > 0\n  AND ( dxr.dxresearch_code IS NULL AND ((BILLING.billcount IS NOT NULL AND BILLING.billcount &gt;= ${numOfBills}) OR (VISIT.visitcount IS NOT NULL AND VISIT.visitcount &gt;= ${numOfVisits}) OR (OBS.lvef IS NOT NULL AND OBS.lvef &lt; ${lvef})))\n  AND d.provider_no LIKE ${provider}\n  ORDER BY d.demographic_no\n		</query>\n	</drillDownQuery>\n</indicatorTemplateXML>\n','\0','\0',0,NULL,NULL),
(21,3,'Consider Hypertension','CDM','Hypertension','DoBC CPQI PSP Panel','2017-08-02','\n			Patients with hypertension dx in 2+ bills or 2+ visits within last 3 years or most recent BP > 140/90\n		','\n		  Created for Doctors of BC\n		  i) HTN dx in 2+ bills: Active Patient Status AND does not have a Current Problem List/Profile item code of 38341003 OR starting with 401 AND with >= 2 Bills with the ICD9 diagnosis code of 401 in the last 3 years.\n		  ii','<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<indicatorTemplateXML>\n	<author>OSCAR BC</author>\n	<uid></uid>\n	<heading>\n		<category>CDM</category>\n		<subCategory>Hypertension</subCategory>\n		<name>Consider Hypertension</name>\n		<definition>\n			Patients with hypertension dx in 2+ bills or 2+ visits within last 3 years or most recent BP &gt; 140/90\n		</definition>\n		<framework>DoBC CPQI PSP Panel</framework>\n		<frameworkVersion>08-02-2017</frameworkVersion>\n		<notes>\n		  Created for Doctors of BC\n		  i) HTN dx in 2+ bills: Active Patient Status AND does not have a Current Problem List/Profile item code of 38341003 OR starting with 401 AND with &gt;= 2 Bills with the ICD9 diagnosis code of 401 in the last 3 years.\n		  ii) HTN dx in 2+ visits: Active Patient Status AND does not have a Current Problem List/Profile item code of 38341003 OR stating with 401 AND with &gt;= 2 Visit Encounters with the ICD9 diagnosis code of 401 in the last 3 years.\n		  iii) BP &gt; 140/90: Active Patient Status AND does not have a Current Problem List/Profile item code of 38341003 OR starting with 401 AND WITH a most recent most recent Blood Pressure observation &gt; 140/90 OR 2+ Blood Pressure documented &gt; 140/90 in the last 2 years.\n		</notes>\n	</heading>\n	<indicatorQuery>\n		<version>03-13-2018</version>\n		<params>\n			<parameter id=\"provider\" name=\"Provider Number\" value=\"loggedInProvider\" />\n			<parameter id=\"active\" name=\"Active Patients\" value=\"\'AC\'\" />\n			<parameter id=\"dxcodesICD\" name=\"Dx Codes (ICD)\" value=\"\'401%\'\" />\n                        <parameter id=\"dxcodesSysICD\" name=\"DX CodeSystem (ICD)\" value=\"\'icd9\'\" />\n                        <parameter id=\"dxcodesSnoMed\" name=\"Dx Codes (SnoMed)\" value=\"\'38341003\'\" />\n                        <parameter id=\"dxcodesSysSnoMed\" name=\"Dx CodeSystem (SnoMed)\" value=\"\'snomed%\'\" />\n			<parameter id=\"billingCode\" name=\"ICD9 Billing Code\" value=\"401\" />\n			<parameter id=\"numOfBills\" name=\"Number of ICD9 401 Bills\" value=\"2\" />\n			<parameter id=\"numOfVisits\" name=\"Number of Visit Encounters coded 401/ICD9\" value=\"2\" />\n			<parameter id=\"numOfBPs\" name=\"Number of BP measurements\" value=\"2\" />\n		</params>\n		<range>\n			<lowerLimit id=\"billingdate\" label=\"From Date\" name=\"Date\" value=\"DATE_SUB( NOW(), INTERVAL 3 YEAR )\" />\n			<upperLimit id=\"billingdate\" label=\"Date Today\" name=\"Date\" value=\"NOW()\" />\n			<lowerLimit id=\"visitdate\" label=\"From Date\" name=\"Date\" value=\"DATE_SUB( NOW(), INTERVAL 3 YEAR )\" />\n                        <upperLimit id=\"visitdate\" label=\"Date Today\" name=\"Date\" value=\"NOW()\" />\n			<lowerLimit id=\"labdate\" label=\"From Date\" name=\"Date\" value=\"DATE_SUB( NOW(), INTERVAL 2 YEAR )\" />\n			<upperLimit id=\"labdate\" label=\"Date Today\" name=\"Date\" value=\"NOW()\" />\n		</range>\n		<query>\nSELECT\n  IF ( COUNT(fin.patient) &gt; 0, SUM( CASE WHEN (fin.dx IS NULL AND fin.billcount &gt;= ${numOfBills}) THEN 1 ELSE 0 END ) , 0) AS \"HTN dx in ${numOfBills}+ bills\",\n  IF ( COUNT(fin.patient) &gt; 0, SUM( CASE WHEN (fin.dx IS NULL AND fin.visitcount &gt;= ${numOfVisits}) THEN 1 ELSE 0 END ) , 0) AS \"HTN dx in ${numOfVisits}+ visits\",\n\n  IF ( COUNT(fin.patient) &gt; 0, SUM( CASE WHEN (fin.dx IS NULL AND ((fin.lastBP REGEXP \'1[4-9][1-9]/[0-9]{1,3}\' OR fin.lastBP REGEXP \'2[0-9][0-9]/[0-9]{1,3}\' OR\n      fin.lastBP REGEXP \'[0-9]{1,3}/9[1-9]{1}\' OR fin.lastBP REGEXP \'[0-9]{1,3}/1[0-9]{2}\') OR (fin.countBP &gt;= ${numOfBPs})) ) THEN 1 ELSE 0 END ) , 0) AS \"BP &gt; 140/90\"\nFROM ( \n  SELECT \n    d.demographic_no AS patient, \n    BILLING.billcount AS billcount,\n    VISIT.visitcount AS visitcount,\n    LAST.bp AS lastBP,\n    BP2.countBP AS countBP,\n    dxr.dxresearch_code AS dx,\n    dxr.coding_system AS dxs\n  FROM demographic d \n  LEFT JOIN (\n    SELECT demographic_no, dxresearch_code, coding_system, count(dxresearch_code)\n    FROM dxresearch\n    WHERE status=\'A\' AND\n    (\n      (dxresearch_code LIKE ${dxcodesICD} AND coding_system = ${dxcodesSysICD}) OR\n      (dxresearch_code = ${dxcodesSnoMed} AND coding_system LIKE ${dxcodesSysSnoMed})\n    )\n    GROUP BY demographic_no\n    ORDER BY demographic_no\n  ) dxr\n  ON d.demographic_no = dxr.demographic_no\n  -- Billed 401 in last 3 years\n  LEFT JOIN (\n    SELECT b.demographic_no as demographic_no, b.dx_code1 as dxcode1, b.dx_code2 as dxcode2, b.dx_code3 as dxcode3, count(b.demographic_no) as billcount\n    FROM billingmaster b\n    WHERE b.dx_code1 = ${billingCode} OR b.dx_code2 = ${billingCode} OR b.dx_code3 = ${billingCode}\n    AND DATE(b.createdate) > ${lowerLimit.billingdate}\n    AND b.demographic_no > 0\n    GROUP BY b.demographic_no HAVING COUNT(b.demographic_no) > -1\n  ) BILLING\n  ON (d.demographic_no = BILLING.demographic_no)\n  -- Coded 401 during visit encounter in last 3 years\n  LEFT JOIN(\n    SELECT ASSIGNED.demographic_no AS demographic_no, observation_date AS visitdate, uuid, count(ASSIGNED.demographic_no) AS visitcount\n    FROM casemgmt_note note\n    INNER JOIN (\n      SELECT note_id, CODED.demo_no AS demographic_no FROM casemgmt_issue_notes\n      INNER JOIN (\n        SELECT ci.id AS id, ci.update_date, ci.demographic_no demo_no FROM issue i\n        INNER JOIN casemgmt_issue ci\n        ON i.issue_id = ci.issue_id\n        WHERE\n        (i.type LIKE ${dxcodesSysICD} and i.code LIKE ${dxcodesICD}) OR\n        (i.type LIKE ${dxcodesSysSnoMed} and i.code = ${dxcodesSnoMed})\n      ) CODED\n      ON (casemgmt_issue_notes.id = CODED.id)\n      ORDER BY CODED.demo_no\n    ) ASSIGNED\n    ON note.note_id = ASSIGNED.note_id AND\n    -- GET LAST REVISION OF NOTE\n    note.note_id= (SELECT MAX(cmn.note_id) FROM casemgmt_note cmn WHERE cmn.uuid = note.uuid) AND\n    DATE(note.observation_date) > ${lowerLimit.visitdate}\n    GROUP BY demographic_no\n    ORDER BY demographic_no\n  ) VISIT\n  ON (d.demographic_no = VISIT.demographic_no)\n  -- Last BP measurement\n  LEFT JOIN ( \n    SELECT m.demographicNo as demographic_no, m.dataField as bp, MAX(m.dateObserved) as dateObserved\n    FROM measurements m\n    WHERE m.type = \'BP\'\n    AND m.demographicNo > 0\n    GROUP BY m.demographicNo\n  ) LAST\n  ON (d.demographic_no = LAST.demographic_no) \n  -- Two of more BP > 140/90 in last two years\n  LEFT JOIN ( \n    SELECT m.demographicNo as demographic_no, m.dataField as bp, count(m.dataField) as countBP\n    FROM measurements m\n    WHERE m.type = \'BP\'\n    AND DATE(m.dateObserved) > ${lowerLimit.labdate}\n    AND (m.dataField REGEXP \'1[4-9][1-9]/[0-9]{1,3}\' OR m.dataField REGEXP \'2[0-9][0-9]/[0-9]{1,3}\' OR\n      m.dataField REGEXP \'[0-9]{1,3}/9[1-9]{1}\' OR m.datafield REGEXP \'[0-9]{1,3}/1[0-9]{2}\')\n    AND m.demographicNo > 0\n    GROUP BY m.demographicNo HAVING COUNT(m.demographicNo) > -1\n  ) BP2\n  ON (d.demographic_no = BP2.demographic_no) \n  WHERE d.patient_status LIKE ${active}\n  AND d.demographic_no > 0\n  AND d.provider_no LIKE ${provider} \n) fin\n		</query>\n	</indicatorQuery>\n	<drillDownQuery>\n		<version>03-13-2018</version>\n		<params>\n			<parameter id=\"provider\" name=\"Provider Number\" value=\"loggedInProvider\" />\n			<parameter id=\"active\" name=\"Active Patients\" value=\"\'AC\'\" />\n			<parameter id=\"dxcodesICD\" name=\"Dx Codes (ICD)\" value=\"\'401%\'\" />\n                        <parameter id=\"dxcodesSysICD\" name=\"DX CodeSystem (ICD)\" value=\"\'icd9\'\" />\n                        <parameter id=\"dxcodesSnoMed\" name=\"Dx Codes (SnoMed)\" value=\"\'38341003\'\" />\n                        <parameter id=\"dxcodesSysSnoMed\" name=\"Dx CodeSystem (SnoMed)\" value=\"\'snomed%\'\" />\n			<parameter id=\"numOfBills\" name=\"Number of ICD9 401 Bills\" value=\"2\" />\n			<parameter id=\"numOfVisits\" name=\"Number of ICD9 401 Visit Encounters\" value=\"2\" />\n			<parameter id=\"numOfBPs\" name=\"Number of BP measurements\" value=\"2\" />\n			<parameter id=\"billingCode\" name=\"ICD9 Billing Code\" value=\"401\" />\n		</params>\n		\n		<range>\n			<lowerLimit id=\"billingdate\" label=\"From Date\" name=\"Date\" value=\"DATE_SUB( NOW(), INTERVAL 3 YEAR )\" />\n			<upperLimit id=\"billingdate\" label=\"Date Today\" name=\"Date\" value=\"NOW()\" />\n			<lowerLimit id=\"visitdate\" label=\"From Date\" name=\"Date\" value=\"DATE_SUB( NOW(), INTERVAL 3 YEAR )\" />\n                        <upperLimit id=\"visitdate\" label=\"Date Today\" name=\"Date\" value=\"NOW()\" />\n			<lowerLimit id=\"labdate\" label=\"From Date\" name=\"Date\" value=\"DATE_SUB( NOW(), INTERVAL 2 YEAR )\" />\n			<upperLimit id=\"labdate\" label=\"Date Today\" name=\"Date\" value=\"NOW()\" />\n		</range>\n		\n		<displayColumns>\n			<column id=\"demographic\" name=\"d.demographic_no\" title=\"Patient Id\" primary=\"true\" />\n			<column id=\"name\" name=\"CONCAT( d.last_name, \', \', d.first_name )\" title=\"Patient Name\" primary=\"false\" />\n			<column id=\"dob\" name=\"DATE_FORMAT( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth), \'%m-%d-%Y\' )\" title=\"Date of Birth\" primary=\"false\" />\n			<column id=\"age\" name=\"FLOOR( ABS( DATEDIFF( DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), NOW() ) ) / 365.25 )\" title=\"Age\" primary=\"false\" />\n			<column id=\"billings\" name=\"IFNULL( BILLING.billcount, \'0\')\" title=\"Billings\" primary=\"false\" />\n			<column id=\"visits\" name=\"IFNULL( VISIT.visitcount, \'0\')\" title=\"Visits\" primary=\"false\" />\n			<column id=\"lastBP\" name=\"IFNULL( LAST.bp, \'NA\')\" title=\"Last BP\" primary=\"false\" />\n			<column id=\"testDateBP\" name=\"IFNULL( DATE_FORMAT( LAST.dateObserved, \'%m-%d-%Y\' ), \'NA\')\" title=\"Date (yyyy-mm-dd)\" primary=\"false\" />\n			<column id=\"numBPs\" name=\"IFNULL( BP2.countBP, \'0\')\" title=\"BPs>140/90 Last 2yrs\" primary=\"false\" />\n		</displayColumns>\n		\n		<exportColumns>\n			<column id=\"demographic\" name=\"d.demographic_no\" title=\"Patient Id\" primary=\"true\" />\n			<column id=\"name\" name=\"CONCAT( d.last_name, \', \', d.first_name )\" title=\"Patient Name\" primary=\"false\" />\n			<column id=\"dob\" name=\"DATE_FORMAT( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth), \'%m-%d-%Y\' )\" title=\"Date of Birth\" primary=\"false\" />\n			<column id=\"age\" name=\"FLOOR( ABS( DATEDIFF( DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), NOW() ) ) / 365.25 )\" title=\"Age\" primary=\"false\" />\n			<column id=\"billings\" name=\"IFNULL( BILLING.billcount, \'0\')\" title=\"Billings\" primary=\"false\" />\n			<column id=\"visits\" name=\"IFNULL( VISIT.visitcount, \'0\')\" title=\"Visits\" primary=\"false\" />\n			<column id=\"lastBP\" name=\"IFNULL( LAST.bp, \'\')\" title=\"Last BP\" primary=\"false\" />\n			<column id=\"testDateBP\" name=\"IFNULL( DATE_FORMAT( LAST.dateObserved, \'%m-%d-%Y\' ), \'\')\" title=\"Date (yyyy-mm-dd)\" primary=\"false\" />\n			<column id=\"numBPs\" name=\"IFNULL( BP2.countBP, \'0\')\" title=\"BPs>140/90 Last 2yrs\" primary=\"false\" />\n		</exportColumns>\n		<query>	\np  SELECT *	\n  FROM demographic d \n  LEFT JOIN (\n    SELECT demographic_no, dxresearch_code, coding_system, count(dxresearch_code)\n    FROM dxresearch\n    WHERE status=\'A\' AND\n    (\n      (dxresearch_code LIKE ${dxcodesICD} AND coding_system = ${dxcodesSysICD}) OR\n      (dxresearch_code = ${dxcodesSnoMed} AND coding_system LIKE ${dxcodesSysSnoMed})\n    )\n    GROUP BY demographic_no\n    ORDER BY demographic_no\n  ) dxr\n  ON d.demographic_no = dxr.demographic_no\n  -- Billed 401 in last 3 years\n  LEFT JOIN (\n    SELECT b.demographic_no as demographic_no, b.dx_code1 as dxcode1, b.dx_code2 as dxcode2, b.dx_code3 as dxcode3, count(b.demographic_no) as billcount\n    FROM billingmaster b\n    WHERE b.dx_code1 = ${billingCode} OR b.dx_code2 = ${billingCode} OR b.dx_code3 = ${billingCode}\n    AND DATE(b.createdate) > ${lowerLimit.billingdate}\n    AND b.demographic_no > 0\n    GROUP BY b.demographic_no HAVING COUNT(b.demographic_no) > -1\n  ) BILLING\n  ON (d.demographic_no = BILLING.demographic_no)  \n  -- Coded 401 during visit encounter in last 3 years\n  LEFT JOIN(\n    SELECT ASSIGNED.demographic_no AS demographic_no, observation_date AS visitdate, uuid, count(ASSIGNED.demographic_no) AS visitcount\n    FROM casemgmt_note note\n    INNER JOIN (\n      SELECT note_id, CODED.demo_no AS demographic_no FROM casemgmt_issue_notes\n      INNER JOIN (\n        SELECT ci.id AS id, ci.update_date, ci.demographic_no demo_no FROM issue i\n        INNER JOIN casemgmt_issue ci\n        ON i.issue_id = ci.issue_id\n        WHERE\n        (i.type LIKE ${dxcodesSysICD} and i.code LIKE ${dxcodesICD}) OR\n        (i.type LIKE ${dxcodesSysSnoMed} and i.code = ${dxcodesSnoMed})\n      ) CODED\n      ON (casemgmt_issue_notes.id = CODED.id)\n      ORDER BY CODED.demo_no\n    ) ASSIGNED\n    ON note.note_id = ASSIGNED.note_id AND\n    -- GET LAST REVISION OF NOTE\n    note.note_id= (SELECT MAX(cmn.note_id) FROM casemgmt_note cmn WHERE cmn.uuid = note.uuid) AND\n    DATE(note.observation_date) > ${lowerLimit.visitdate}\n    GROUP BY demographic_no\n    ORDER BY demographic_no\n  ) VISIT\n  ON (d.demographic_no = VISIT.demographic_no)\n  -- Last BP measurement\n  LEFT JOIN ( \n    SELECT m.demographicNo as demographic_no, m.dataField as bp, MAX(m.dateObserved) as dateObserved\n    FROM measurements m\n    WHERE m.type = \'BP\'\n    AND m.demographicNo > 0\n    GROUP BY m.demographicNo\n  ) LAST\n  ON (d.demographic_no = LAST.demographic_no) \n  -- Two of more BP > 140/90 in last two years\n  LEFT JOIN ( \n    SELECT m.demographicNo as demographic_no, m.dataField as bp, count(m.dataField) as countBP\n    FROM measurements m\n    WHERE m.type = \'BP\'\n    AND DATE(m.dateObserved) > ${lowerLimit.labdate}\n    AND (m.dataField REGEXP \'1[4-9][1-9]/[0-9]{1,3}\' OR m.dataField REGEXP \'2[0-9][0-9]/[0-9]{1,3}\' OR\n      m.dataField REGEXP \'[0-9]{1,3}/9[1-9]{1}\' OR m.datafield REGEXP \'[0-9]{1,3}/1[0-9]{2}\')\n    AND m.demographicNo > 0\n    GROUP BY m.demographicNo HAVING COUNT(m.demographicNo) > -1\n  ) BP2\n  ON (d.demographic_no = BP2.demographic_no) \n  WHERE d.patient_status LIKE ${active}\n  AND d.demographic_no > 0\n  AND d.provider_no LIKE ${provider}\n  AND ( dxr.dxresearch_code IS NULL AND (\n  (BILLING.billcount IS NOT NULL AND BILLING.billcount &gt;= ${numOfBills}) OR\n  (VISIT.visitcount IS NOT NULL AND VISIT.visitcount &gt;= ${numOfVisits}) OR\n  (LAST.bp REGEXP \'1[4-9][1-9]/[0-9]{1,3}\' OR LAST.bp REGEXP \'2[0-9][0-9]/[0-9]{1,3}\' OR\n  LAST.bp REGEXP \'[0-9]{1,3}/9[1-9]{1}\' OR LAST.bp REGEXP \'[0-9]{1,3}/1[0-9]{2}\') OR\n  (BP2.countBP IS NOT NULL AND BP2.countBP &gt; ${numOfBPs})))\n  ORDER BY d.demographic_no\n		</query>\n	</drillDownQuery>\n</indicatorTemplateXML>\n','\0','\0',0,NULL,NULL),
(22,3,'Hypertension Prevalence','CDM','Hypertension','DoBC CPQI PSP Panel','2017-08-02','% of active patients in the practice coded with Hypertension.','\ni) HTN patients: \"Patient Status: Active\nAND has a Current Problem List/Profile item code of 38341003 OR starting with 401\"\nii) Other patients: \"Patient Status: Active\nAND does not have a Current Problem List/Profile item code of 38341003 OR starting wit','<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<indicatorTemplateXML>\n	<author>OSCAR BC</author>\n	<uid></uid>\n	<heading>\n		<category>CDM</category>\n		<subCategory>Hypertension</subCategory>\n		<name>Hypertension Prevalence</name>\n		<definition>% of active patients in the practice coded with Hypertension.</definition>\n		<framework>DoBC CPQI PSP Panel</framework>\n		<frameworkVersion>08-02-2017</frameworkVersion>\n		<notes>\ni) HTN patients: \"Patient Status: Active\nAND has a Current Problem List/Profile item code of 38341003 OR starting with 401\"\nii) Other patients: \"Patient Status: Active\nAND does not have a Current Problem List/Profile item code of 38341003 OR starting with 401\"\n		</notes>\n	</heading>\n	<indicatorQuery>\n		<version>03-13-2018</version>\n		<params>\n			<!-- \n				Required parameter provider. Value options are: \n					[ an individual providerNo, or provider range ] ie: value=\"370, 1001\" \n					\"all\" ie: value=\"all\" including null.\n					\"loggedInProvider\" ie:\n				Default is \"loggedInProvider\"\n				Use this parameter in the query as ${provider}\n				This parameter should be used for fetching patient\'s assigned to a MRP.\n				ie: WHERE demographic.provider_no = ${provider}\n			-->\n			<parameter id=\"provider\" name=\"provider_no\" value=\"loggedInProvider\" />\n			<parameter id=\"pstatus\" name=\"Patient Status\" value=\"\'AC\'\" />\n			<parameter id=\"dxcodesICD\" name=\"Dx Codes (ICD)\" value=\"401\" />\n			<parameter id=\"dxcodesSysICD\" name=\"DX CodeSystem (ICD)\" value=\"\'icd9\'\" />\n			<parameter id=\"dxcodesSnoMed\" name=\"Dx Codes (SnoMed)\" value=\"38341003\" />\n			<parameter id=\"dxcodesSysSnoMed\" name=\"Dx CodeSystem (SnoMed)\" value=\"\'snomed%\'\" />\n		</params>\n		<query>\n			<!-- Indicator SQL Query here -->\nSELECT\n -- PERCENT OF TOTAL PATIENTS NOTED AS ACTIVE WITH CURRENT HYPERTENSION\n IF( COUNT(fin.patient) > 0, SUM( IF( dxresearch_code is not NULL , 1, 0) ) , 0 ) AS \"% Active, Current Hypertension\",\n -- PERCENT OF TOTAL PATIENTS NOTED AS ACTIVE WITHOUT CURRENT HYPERTENSION\n IF( COUNT(fin.patient) > 0, SUM( IF( dxresearch_code is NULL , 1, 0) ) , 0 ) AS \"% Active, No Current Hypertension\"\nFROM (\n SELECT d.demographic_no AS patient, d.patient_status AS pt_status, dxresearch_code\n FROM demographic d\n LEFT JOIN (\n  SELECT demographic_no, dxresearch_code, count(dxresearch_code)\n  FROM dxresearch\n  WHERE status=\'A\' AND\n  (\n   (LEFT(dxresearch_code, 3) IN (\'401\') AND coding_system = ${dxcodesSysICD}) OR\n   (dxresearch_code IN (\'38341003\') AND coding_system LIKE ${dxcodesSysSnoMed})\n   )\n  GROUP BY demographic_no\n  ORDER BY demographic_no\n ) problems\n ON d.demographic_no = problems.demographic_no\n WHERE d.provider_no LIKE ${provider} AND d.patient_status = ${pstatus}\n) fin\n		</query>\n	</indicatorQuery>\n	<drillDownQuery>\n		<version>03-13-2018</version>\n		<params>\n			<parameter id=\"provider\" name=\"provider_no\" value=\"loggedInProvider\" />	\n			<parameter id=\"pstatus\" name=\"Patient Status\" value=\"\'AC\'\" />\n			<parameter id=\"dxcodesICD\" name=\"Dx Codes (ICD)\" value=\"401\" />\n			<parameter id=\"dxcodesSysICD\" name=\"DX CodeSystem (ICD)\" value=\"\'icd9\'\" />\n			<parameter id=\"dxcodesSnoMed\" name=\"Dx Codes (SnoMed)\" value=\"38341003\" />\n			<parameter id=\"dxcodesSysSnoMed\" name=\"Dx CodeSystem (SnoMed)\" value=\"\'snomed%\'\" />\n		</params>\n		<displayColumns>\n			<column id=\"demographic\" name=\"d.demographic_no\" title=\"Patient Id\" primary=\"true\" />\n			<column id=\"name\" name=\"CONCAT( d.last_name, \', \', d.first_name )\" title=\"Patient Name\" primary=\"false\" />\n			<column id=\"dob\" name=\"DATE_FORMAT( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth), \'%m-%d-%Y\' )\" title=\"Date of Birth (mm-dd-yy)\" primary=\"false\" />\n			<column id=\"age\" name=\"TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )\" title=\"Age\" primary=\"false\" />\n			<column id=\"dxcode\" title=\"Dx System/Code\" name=\"CONCAT(MIN(dxr.coding_system),\'/\',MIN(dxr.dxresearch_code),IF( MIN(dxr.dxresearch_code) != MAX(dxr.dxresearch_code),CONCAT( \' &amp; \', MAX(dxr.coding_system), \'/\', MAX(dxr.dxresearch_code) ),\'\') )\" primary=\"false\" />\n		</displayColumns>\n		<exportColumns>\n			<column id=\"demographic\" name=\"d.demographic_no\" title=\"Patient Id\" primary=\"true\" />\n			<column id=\"name\" name=\"CONCAT( d.last_name, \', \', d.first_name )\" title=\"Patient Name\" primary=\"false\" />\n			<column id=\"dob\" name=\"DATE_FORMAT( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth), \'%m-%d-%Y\' )\" title=\"Date of Birth (mm-dd-yy)\" primary=\"false\" />\n			<column id=\"age\" name=\"TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )\" title=\"Age\" primary=\"false\" />\n			<column id=\"dxcode\" title=\"Dx System/Code\" name=\"CONCAT(MIN(dxr.coding_system),\'/\',MIN(dxr.dxresearch_code),IF( MIN(dxr.dxresearch_code) != MAX(dxr.dxresearch_code),CONCAT( \' &amp; \', MAX(dxr.coding_system), \'/\', MAX(dxr.dxresearch_code) ),\'\') )\" primary=\"false\" />\n		</exportColumns>\n		<query>\n			<!-- Drilldown SQL Query here -->\nSELECT\n*			\nFROM demographic d\nLEFT JOIN dxresearch dxr\nON d.demographic_no = dxr.demographic_no\nWHERE d.patient_status=${pstatus}\nAND\n(\n (LEFT(dxr.dxresearch_code, 3) IN (\'401\') AND dxr.coding_system = ${dxcodesSysICD}) OR\n (dxr.dxresearch_code IN (\'38341003\') AND dxr.coding_system LIKE ${dxcodesSysSnoMed})\n )\nAND dxr.status = \'A\'\nAND d.provider_no LIKE ${provider}\nGROUP BY d.demographic_no\nORDER BY COUNT(d.demographic_no) DESC, d.demographic_no\n		</query>\n	</drillDownQuery>\n</indicatorTemplateXML>\n','\0','\0',0,NULL,NULL),
(23,3,'Active Med Count','Home','Polypharmacy','DoBC CPQI PSP Panel','2017-08-02','% of active patients with an active continuous medication count of 0, 1-4, 5-9 or 10+.','','<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<indicatorTemplateXML>\n	<author>OSCAR BC</author>\n	<uid></uid>\n	<heading>\n		<category>Home</category>\n		<subCategory>Polypharmacy</subCategory>\n		<name>Active Med Count</name>\n		<definition>% of active patients with an active continuous medication count of 0, 1-4, 5-9 or 10+.</definition>\n		<framework>DoBC CPQI PSP Panel</framework>\n		<frameworkVersion>08-02-2017</frameworkVersion>\n		<notes></notes>\n	</heading>\n	<indicatorQuery>\n		<version>03-13-2018</version>\n		<params>\n			<!-- \n				Use this parameter in the query as ${provider}\n				This parameter should be used for fetching patient\'s assigned to a MRP.\n				ie: WHERE demographic.provider_no = ${provider}\n			-->\n			<parameter id=\"provider\" name=\"provider_no\" value=\"loggedInProvider\" />\n			<parameter id=\"pstatus\" name=\"Patient Status\" value=\"\'AC\'\" />\n		</params>\n		<query>\n			<!-- Indicator SQL Query here -->\nSELECT\nIF( COUNT(patient) > 0,\nSUM( IF(patient_status = ${pstatus} AND med_COUNT >= 10,1,0)),0) AS \'10+ meds\',\nIF( COUNT(patient) > 0,\nSUM( IF(patient_status = ${pstatus} AND med_COUNT BETWEEN 5 AND 9, 1, 0)),0) AS \'5-9 meds\',\nIF( COUNT(patient) > 0,\nSUM( IF(patient_status = ${pstatus} AND med_COUNT BETWEEN 1 AND 4, 1, 0)),0) AS \'1-4 meds\',\nIF( COUNT(patient) > 0,\nSUM( IF(patient_status = ${pstatus} AND med_COUNT = 0,1,0)),0) AS \'0 meds\'\nFROM (\nSELECT d.demographic_no AS patient, d.patient_status, COUNT(DISTINCT meds.regional_identifier) AS med_count\nFROM demographic d LEFT JOIN(\nSELECT dr.demographic_no, dr.regional_identifier FROM drugs AS dr\nWHERE dr.archived = 0 AND dr.regional_identifier IS NOT NULL AND\ndr.regional_identifier != \'\' AND rx_date &lt;= NOW() AND\n(DATE_ADD(dr.rx_date, INTERVAL(DATEDIFF(dr.end_date,dr.rx_date)*1.0)\nDAY)) >= NOW() ORDER BY dr.demographic_no) meds\non (d.demographic_no = meds.demographic_no) where d.provider_no LIKE ${provider}\nGROUP BY d.demographic_no\nORDER BY COUNT(DISTINCT meds.regional_identifier) DESC\n) counts\n		</query>\n	</indicatorQuery>\n	<drillDownQuery>\n		<version>03-13-2018</version>\n		<params>\n			<parameter id=\"provider\" name=\"provider_no\" value=\"loggedInProvider\" />	\n			<parameter id=\"pstatus\" name=\"Patient Status\" value=\"\'AC\'\" />\n		</params>\n		<displayColumns>\n			<column id=\"demographic\" name=\"demographic_no\" title=\"Patient Id\" primary=\"true\" />\n			<column id=\"name\" name=\"CONCAT( last_name, \', \', first_name )\" title=\"Patient Name\" primary=\"false\" />\n			<column id=\"dob\" name=\"DATE_FORMAT( CONCAT(year_of_birth,\'-\',month_of_birth,\'-\',date_of_birth), \'%m-%d-%Y\' )\" title=\"Date of Birth (mm-dd-yy)\" primary=\"false\" />\n			<column id=\"age\" name=\"TIMESTAMPDIFF(YEAR, DATE( CONCAT(year_of_birth,\'-\',month_of_birth,\'-\',date_of_birth) ), CURDATE() )\" title=\"Age\" primary=\"false\" />\n			<column id=\"activeMedCount\" name=\"counts.med_count\" title=\"Active Med Count\" primary=\"false\" />\n			<column id=\"patientStatus\" name=\"patient_status\" title=\"Patient Status\" primary=\"false\" />\n		</displayColumns>\n		<exportColumns>\n			<column id=\"demographic\" name=\"demographic_no\" title=\"Patient Id\" primary=\"true\" />\n			<column id=\"name\" name=\"CONCAT( last_name, \', \', first_name )\" title=\"Patient Name\" primary=\"false\" />\n			<column id=\"dob\" name=\"DATE_FORMAT( CONCAT(year_of_birth,\'-\',month_of_birth,\'-\',date_of_birth), \'%m-%d-%Y\' )\" title=\"Date of Birth (mm-dd-yy)\" primary=\"false\" />\n			<column id=\"age\" name=\"TIMESTAMPDIFF(YEAR, DATE( CONCAT(year_of_birth,\'-\',month_of_birth,\'-\',date_of_birth) ), CURDATE() )\" title=\"Age\" primary=\"false\" />\n			<column id=\"activeMedCount\" name=\"counts.med_count\" title=\"Active Med Count\" primary=\"false\" />\n			<column id=\"patientStatus\" name=\"patient_status\" title=\"Patient Status\" primary=\"false\" />\n		</exportColumns>\n		<query>\n			<!-- Drilldown SQL Query here -->\nSELECT demographic_no, patient_status, counts.med_count\nFROM\n  (SELECT d.*, COUNT(DISTINCT meds.regional_identifier) AS med_count\n  FROM demographic d\n  LEFT JOIN(\n    SELECT dr.demographic_no, dr.regional_identifier FROM drugs AS dr\n    WHERE dr.archived = 0 AND dr.regional_identifier IS NOT NULL AND\n      dr.regional_identifier != \'\' AND rx_date &lt;= NOW() AND\n      (DATE_ADD(dr.rx_date, INTERVAL(DATEDIFF(dr.end_date,dr.rx_date)*1.0)\n      DAY)) >= NOW()\n    ORDER BY dr.demographic_no\n    ) meds\n  ON (d.demographic_no = meds.demographic_no) where d.provider_no LIKE ${provider}\n  GROUP BY d.demographic_no\n  ORDER BY COUNT(DISTINCT meds.regional_identifier) DESC ,\n    d.demographic_no ASC\n  ) counts\nWHERE patient_status=${pstatus} AND med_count > 0\n		</query>\n	</drillDownQuery>\n	<shared>false</shared>\n	<sharedMetricSetName>General - Polypharmacy</sharedMetricSetName>\n	<sharedMetricDataId></sharedMetricDataId>\n	<sharedMappings>\n		<sharedMapping fromLabel=\"10+ meds\" toLabel=\"10+ Rx\"/>\n		<sharedMapping fromLabel=\"5-9 meds\" toLabel=\"5-9 Rx\"/>\n		<sharedMapping fromLabel=\"1-4 meds\" toLabel=\"1-4 Rx\"/>\n		<sharedMapping fromLabel=\"0 meds\" toLabel=\"0 Rx\"/>\n	</sharedMappings>	\n</indicatorTemplateXML>\n','\0','\0',0,NULL,NULL),
(24,4,'Active Patients','General','Patient Population','DoBC CPQI PSP Panel','2017-08-02','% of active patients in the practice last seen < 3 years, 3-5 years, 5+ years and never seen.','','<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<indicatorTemplateXML>\n	<author>OSCAR BC</author>\n	<uid></uid>\n	<heading>\n		<category>General</category>\n		<subCategory>Patient Population</subCategory>\n		<name>Active Patients</name>\n		<definition>% of active patients in the practice last seen &lt; 3 years, 3-5 years, 5+ years and never seen.</definition>\n		<framework>DoBC CPQI PSP Panel</framework>\n		<frameworkVersion>08-02-2017</frameworkVersion>\n		<notes></notes>\n	</heading>\n	<indicatorQuery>\n		<version>03-13-2018</version>\n		<params>\n			<!-- \n				Use this parameter in the query as ${provider}\n				This parameter should be used for fetching patient\'s assigned to a MRP.\n				ie: WHERE demographic.provider_no = ${provider}\n			-->\n			<parameter id=\"provider\" name=\"provider_no\" value=\"loggedInProvider\" />\n			<parameter id=\"pstatus\" name=\"Patient Status\" value=\"\'AC\'\" />\n		</params>\n		<query>\n		  <!-- Indicator SQL Query here -->\nSELECT\n	SUM(fin.THREE) AS \"% Active, Seen within 3 years\",\n	SUM(fin.FIVETHREE) AS \"% Active, Seen 3-5 years ago\",\n	SUM(fin.FIVEPLUS) AS \"% Active, not seen in 5+ years\",\n	SUM(fin.NONE) AS \"% Active, no documented encounter\"\nFROM (\n	SELECT\n		IF( DATE_SUB(CURDATE() , INTERVAL 3 YEAR) &lt;= DATE( MAX(cmn.observation_date) ) ,1 ,0 ) AS THREE, \n		IF(  DATE_SUB(CURDATE() , INTERVAL 5 YEAR) &lt;= DATE( MAX(cmn.observation_date) ) AND\n		DATE( MAX(cmn.observation_date) ) &lt; DATE_SUB(CURDATE(), INTERVAL 3 YEAR), 1,0 ) AS FIVETHREE,\n		IF( DATE( MAX( cmn.observation_date ) ) &lt; DATE_SUB(CURDATE() , INTERVAL 5 YEAR) ,1 ,0 ) AS FIVEPLUS,\n		IF( cmn.note_id IS NULL ,1, 0 ) AS NONE\n	FROM demographic d\n	LEFT JOIN casemgmt_note cmn\n	ON (  d.demographic_no = cmn.demographic_no AND cmn.signed = 1 AND cmn.provider_no != \'-1\'  )\n	WHERE d.provider_no LIKE ${provider}\n	AND d.patient_status LIKE ${pstatus}\n	GROUP BY d.demographic_no HAVING count(d.demographic_no) > -1\n) fin;\n		</query>\n	</indicatorQuery>\n	<drillDownQuery>\n		<version>03-13-2018</version>\n		<params>\n			<parameter id=\"provider\" name=\"provider_no\" value=\"loggedInProvider\" />	\n			<parameter id=\"pstatus\" name=\"Patient Status\" value=\"\'AC\'\" />\n		</params>\n		<displayColumns>\n			<column id=\"demographic\" name=\"d.demographic_no\" title=\"Patient Id\" primary=\"true\" />\n			<column id=\"name\" name=\"CONCAT( d.last_name, \', \', d.first_name )\" title=\"Patient Name\" primary=\"false\" />\n			<column id=\"dob\" name=\"DATE_FORMAT( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth), \'%m-%d-%Y\' )\" title=\"Date of Birth (mm-dd-yy)\" primary=\"false\" />\n			<column id=\"age\" name=\"TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )\" title=\"Age\" primary=\"false\" />	\n			<column id=\"lastEncounter\" name=\"IF(MAX(cmn.observation_date) IS NOT NULL,MAX(cmn.observation_date),\'\')\" title=\"Last Encounter\" primary=\"false\" />\n			<column id=\"patientStatus\" name=\"d.patient_status\" title=\"Patient Status\" primary=\"false\" />\n		</displayColumns>\n		<exportColumns>\n			<column id=\"demographic\" name=\"d.demographic_no\" title=\"Patient Id\" primary=\"true\" />\n			<column id=\"name\" name=\"CONCAT( d.last_name, \', \', d.first_name )\" title=\"Patient Name\" primary=\"false\" />\n			<column id=\"dob\" name=\"DATE_FORMAT( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth), \'%m-%d-%Y\' )\" title=\"Date of Birth (mm-dd-yy)\" primary=\"false\" />\n			<column id=\"age\" name=\"TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )\" title=\"Age\" primary=\"false\" />	\n			<column id=\"lastEncounter\" name=\"IF(MAX(cmn.observation_date) IS NOT NULL,MAX(cmn.observation_date),\'\')\" title=\"Last Encounter\" primary=\"false\" />\n			<column id=\"patientStatus\" name=\"d.patient_status\" title=\"Patient Status\" primary=\"false\" />\n		</exportColumns>\n		<query>\n			<!-- Drilldown SQL Query here -->\nSELECT\n    d.*,\n    d.patient_status AS pt_status,\n    max(cmn.observation_date) as last_encounter\nFROM demographic d\nLEFT JOIN casemgmt_note cmn\nON (  d.demographic_no = cmn.demographic_no AND cmn.signed = 1 AND cmn.provider_no != \'-1\'  )\nWHERE d.provider_no LIKE ${provider}\nAND d.patient_status LIKE ${pstatus}\nGROUP BY d.demographic_no HAVING count(d.demographic_no) > -1			\n		</query>\n	</drillDownQuery>\n	<shared>false</shared>\n	<sharedMetricSetName>Home - Patient status</sharedMetricSetName>\n	<sharedMetricDataId>Status</sharedMetricDataId>\n	<sharedMappings>\n		<sharedMapping fromLabel=\"% Active, Seen within 3 years\" toLabel=\"Active, seen within 3 years\"/>\n		<sharedMapping fromLabel=\"% Active, Seen 3-5 years ago\" toLabel=\"Active, seen within 3-5 yrs\"/>\n		<sharedMapping fromLabel=\"% Active, not seen in 5+ years\" toLabel=\"Active, not seen in 5+ yrs\"/>\n	</sharedMappings>	\n</indicatorTemplateXML>\n','','\0',0,NULL,NULL),
(25,4,'Consider Chronic Pain','CDM','Chronic Pain','DoBC CPQI PSP Panel','2017-08-02','\n			Patients with pain dx in 2+ bills or 2+ visit encounters within last 3 years or on Opioid medication\n		','\n		  Created for Doctors of BC\n		  i) Pain dx in 2+ bills: \"Patient Status: Active\nAND does not have a Current Problem List/Profile item code of 82423001, 373621006 OR starting with 338.4, 338.2, 3384, 3382\nAND with >= 2 Bills with the ICD9 diagnosis code','<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<indicatorTemplateXML>\n	<author>OSCAR BC</author>\n	<uid></uid>\n	<heading>\n		<category>CDM</category>\n		<subCategory>Chronic Pain</subCategory>\n		<name>Consider Chronic Pain</name>\n		<definition>\n			Patients with pain dx in 2+ bills or 2+ visit encounters within last 3 years or on Opioid medication\n		</definition>\n		<framework>DoBC CPQI PSP Panel</framework>\n		<frameworkVersion>08-02-2017</frameworkVersion>\n		<notes>\n		  Created for Doctors of BC\n		  i) Pain dx in 2+ bills: \"Patient Status: Active\nAND does not have a Current Problem List/Profile item code of 82423001, 373621006 OR starting with 338.4, 338.2, 3384, 3382\nAND with >= 2 Bills with the ICD9 diagnosis code starting with 338.4, 338.2, 3384 OR 3382 in the last 3 years\"\n		  ii) Pain dx in 2+ visits: \"Patient Status: Active\nAND does not have a Current Problem List/Profile item code of 82423001, 373621006 OR starting with 338.4, 338.2, 3384, 3382\nAND with >= 2 Visit Encounters with Snomed diagnosis code 82423001, 373621006 or the ICD9 diagnosis code starting with 338.4, 338.2, 3384 OR 3382 in the last 3 years\"\n		  iii) Opioid medication: \"Patient Status: Active\nAND does not have a Current Problem List/Profile item code of 82423001, 373621006 OR starting with 338.4, 338.2, 3384, 3382\nAND with >= 1 Active Current Medication with ATC Code/Class of N02A\"\n		</notes>\n	</heading>\n	<indicatorQuery>\n		<version>03-13-2018</version>\n		<params>\n			<parameter id=\"provider\" name=\"Provider Number\" value=\"loggedInProvider\" />\n			<parameter id=\"active\" name=\"Active Patients\" value=\"\'AC\'\" />\n			<parameter id=\"dxcodesICD\" name=\"Dx Codes (ICD)\" value=\"338.2,338.4\" />\n			<parameter id=\"dxcodesICD2\" name=\"Dx Codes (ICD)\" value=\"3382,3384\" />\n                        <parameter id=\"dxcodesSysICD\" name=\"DX CodeSystem (ICD)\" value=\"\'icd9\'\" />\n                        <parameter id=\"dxcodesSnoMed\" name=\"Dx Codes (SnoMed)\" value=\"82423001, 373621006\" />\n                        <parameter id=\"dxcodesSysSnoMed\" name=\"Dx CodeSystem (SnoMed)\" value=\"\'snomed%\'\" />\n			<parameter id=\"billingCode\" name=\"ICD9 Billing Code\" value=\"338.2,338.4\" />\n			<parameter id=\"billingCode2\" name=\"ICD9 Billing Code\" value=\"3382,3384\" />\n			<parameter id=\"numOfBills\" name=\"Number of ICD9 338.4 Bills\" value=\"2\" />\n			<parameter id=\"numOfVisits\" name=\"Number of Visit Encounters coded 338.4/ICD9\" value=\"2\" />\n			<parameter id=\"drug\" name=\"ATC Code/Class\" value=\"\'N02A%\'\" />\n			<parameter id=\"numOfMeds\" name=\"Opioid Medications\" value=\"1\" />\n		</params>\n		<range>\n			<lowerLimit id=\"billingdate\" label=\"From Date\" name=\"Date\" value=\"DATE_SUB( NOW(), INTERVAL 3 YEAR )\" />\n			<upperLimit id=\"billingdate\" label=\"Date Today\" name=\"Date\" value=\"NOW()\" />\n			<lowerLimit id=\"visitdate\" label=\"From Date\" name=\"Date\" value=\"DATE_SUB( NOW(), INTERVAL 3 YEAR )\" />\n			<upperLimit id=\"visitdate\" label=\"Date Today\" name=\"Date\" value=\"NOW()\" />\n		</range>\n		<query>\nSELECT\n  IF ( COUNT(fin.patient) &gt; 0, SUM( CASE WHEN (fin.dx IS NULL AND fin.billcount &gt;= ${numOfBills}) THEN 1 ELSE 0 END ) , 0) AS \"Pain dx in ${numOfBills}+ bills\",\n  IF ( COUNT(fin.patient) &gt; 0, SUM( CASE WHEN (fin.dx IS NULL AND fin.visitcount &gt;= ${numOfVisits}) THEN 1 ELSE 0 END ) , 0) AS \"Pain dx in ${numOfVisits}+ visits\",\n  IF ( COUNT(fin.patient) &gt; 0, SUM( CASE WHEN (fin.dx IS NULL AND fin.medcount &gt;= ${numOfMeds} ) THEN 1 ELSE 0 END ) , 0) AS \"Opioid Meds &gt;= ${numOfMeds}\"\nFROM ( \n  SELECT \n    d.demographic_no AS patient, \n    BILLING.billcount AS billcount,\n    VISIT.visitcount AS visitcount,\n    MEDS.numOfMeds AS medcount,\n    dxr.dxresearch_code AS dx,\n    dxr.coding_system AS dxs\n  FROM demographic d \n  LEFT JOIN (\n    SELECT demographic_no, dxresearch_code, coding_system, count(dxresearch_code)\n    FROM dxresearch\n    WHERE status=\'A\' AND\n    (\n      (LEFT(dxresearch_code,5) IN ${dxcodesICD} AND coding_system = ${dxcodesSysICD}) OR\n      (LEFT(dxresearch_code,4) IN ${dxcodesICD2} AND coding_system = ${dxcodesSysICD}) OR\n      (dxresearch_code IN ${dxcodesSnoMed} AND coding_system LIKE ${dxcodesSysSnoMed})\n    )\n    GROUP BY demographic_no\n    ORDER BY demographic_no\n  ) dxr\n  ON d.demographic_no = dxr.demographic_no\n  -- Billed 338.4 in last 3 years\n  LEFT JOIN (\n    SELECT b.demographic_no as demographic_no, b.dx_code1 as dxcode1, b.dx_code2 as dxcode2, b.dx_code3 as dxcode3, count(b.demographic_no) as billcount\n    FROM billingmaster b\n    WHERE LEFT(b.dx_code1,5) IN ${billingCode} OR LEFT(b.dx_code2,5) IN ${billingCode} OR LEFT(b.dx_code3,5) IN ${billingCode}\n    OR LEFT(b.dx_code1,4) IN ${billingCode2} OR LEFT(b.dx_code2,4) IN ${billingCode2} OR LEFT(b.dx_code3,4) IN ${billingCode2}\n    AND DATE(b.createdate) > ${lowerLimit.billingdate}\n    AND b.demographic_no > 0\n    GROUP BY b.demographic_no HAVING COUNT(b.demographic_no) > -1\n  ) BILLING\n  ON (d.demographic_no = BILLING.demographic_no)  \n  -- Coded 338.4 during visit encounter in last 3 years\n  LEFT JOIN(\n    SELECT ASSIGNED.demographic_no as demographic_no, observation_date as visitdate, uuid, count(ASSIGNED.demographic_no) as visitcount\n    FROM casemgmt_note note\n    INNER JOIN (\n      SELECT note_id, CODED.demo_no as demographic_no FROM casemgmt_issue_notes\n      INNER JOIN (\n        SELECT ci.id as id, ci.update_date, ci.demographic_no demo_no FROM issue i\n        INNER JOIN casemgmt_issue ci\n        ON i.issue_id = ci.issue_id\n        WHERE\n	(i.type like ${dxcodesSysICD} and LEFT(i.code,5) IN ${dxcodesICD}) OR\n	(i.type like ${dxcodesSysICD} and LEFT(i.code,4) IN ${dxcodesICD2}) OR\n	(i.type like ${dxcodesSysSnoMed} and i.code IN ${dxcodesSnoMed})\n      ) CODED\n      ON (casemgmt_issue_notes.id = CODED.id)\n      ORDER BY CODED.demo_no\n    ) ASSIGNED\n    ON note.note_id = ASSIGNED.note_id AND\n    -- GET LAST REVISION OF NOTE\n    note.note_id= (SELECT MAX(cmn.note_id) FROM casemgmt_note cmn WHERE cmn.uuid = note.uuid) AND\n    DATE(note.observation_date) > ${lowerLimit.visitdate}\n    GROUP BY demographic_no\n    ORDER BY demographic_no\n  ) VISIT\n  ON (d.demographic_no = VISIT.demographic_no)  \n  -- Opioid medications\n  LEFT JOIN (\n    SELECT dr.demographic_no, count(DISTINCT dr.atc) AS numOfMeds FROM drugs AS dr\n    WHERE dr.archived = 0 AND dr.ATC LIKE ${drug}\n    AND (dr.long_term OR (dr.rx_date &lt;= NOW() AND (DATE_ADD(dr.rx_date, INTERVAL(DATEDIFF(dr.end_date,dr.rx_date)*1.0) DAY)) >= NOW()))\n    GROUP BY dr.demographic_no\n  ) MEDS\n  ON (d.demographic_no = MEDS.demographic_no) \n  WHERE d.patient_status LIKE ${active}\n  AND d.demographic_no > 0\n  AND d.provider_no LIKE ${provider} \n) fin\n		</query>\n	</indicatorQuery>\n	<drillDownQuery>\n		<version>03-13-2018</version>\n		<params>\n			<parameter id=\"provider\" name=\"Provider Number\" value=\"loggedInProvider\" />\n			<parameter id=\"active\" name=\"Active Patients\" value=\"\'AC\'\" />\n			<parameter id=\"dxcodesICD\" name=\"Dx Codes (ICD)\" value=\"338.2,338.4\" />\n			<parameter id=\"dxcodesICD2\" name=\"Dx Codes (ICD)\" value=\"3382,3384\" />\n                        <parameter id=\"dxcodesSysICD\" name=\"DX CodeSystem (ICD)\" value=\"\'icd9\'\" />\n                        <parameter id=\"dxcodesSnoMed\" name=\"Dx Codes (SnoMed)\" value=\"82423001, 373621006\" />\n                        <parameter id=\"dxcodesSysSnoMed\" name=\"Dx CodeSystem (SnoMed)\" value=\"\'snomed%\'\" />\n			<parameter id=\"billingCode\" name=\"ICD9 Billing Code\" value=\"338.2,338.4\" />\n			<parameter id=\"billingCode2\" name=\"ICD9 Billing Code\" value=\"3382,3384\" />\n			<parameter id=\"numOfBills\" name=\"Number of ICD9 338.4 Bills\" value=\"2\" />\n			<parameter id=\"numOfVisits\" name=\"Number of Visit Encounters coded 338.4/ICD9\" value=\"2\" />\n			<parameter id=\"drug\" name=\"ATC Code/Class\" value=\"\'N02A%\'\" />\n			<parameter id=\"numOfMeds\" name=\"Opioid Medications\" value=\"1\" />\n		</params>\n		\n		<range>\n			<lowerLimit id=\"billingdate\" label=\"From Date\" name=\"Date\" value=\"DATE_SUB( NOW(), INTERVAL 3 YEAR )\" />\n			<upperLimit id=\"billingdate\" label=\"Date Today\" name=\"Date\" value=\"NOW()\" />\n			<lowerLimit id=\"visitdate\" label=\"From Date\" name=\"Date\" value=\"DATE_SUB( NOW(), INTERVAL 3 YEAR )\" />\n			<upperLimit id=\"visitdate\" label=\"Date Today\" name=\"Date\" value=\"NOW()\" />\n		</range>\n		\n		<displayColumns>\n			<column id=\"demographic\" name=\"d.demographic_no\" title=\"Patient Id\" primary=\"true\" />\n			<column id=\"name\" name=\"CONCAT( d.last_name, \', \', d.first_name )\" title=\"Patient Name\" primary=\"false\" />\n			<column id=\"dob\" name=\"DATE_FORMAT( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth), \'%m-%d-%Y\' )\" title=\"Date of Birth\" primary=\"false\" />\n			<column id=\"age\" name=\"TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )\" title=\"Age\" primary=\"false\" />\n			<column id=\"billings\" name=\"IFNULL( BILLING.billcount, \'0\')\" title=\"Billings\" primary=\"false\" />\n			<column id=\"visits\" name=\"IFNULL( VISIT.visitcount, \'0\')\" title=\"Visits\" primary=\"false\" />\n			<column id=\"numOfMeds\" name=\"IFNULL( MEDS.numOfMeds, \'NA\')\" title=\"Opioid Medications\" primary=\"false\" />\n		</displayColumns>\n		\n		<exportColumns>\n			<column id=\"demographic\" name=\"d.demographic_no\" title=\"Patient Id\" primary=\"true\" />\n                        <column id=\"firstName\" name=\"d.first_name\" title=\"First Name\" primary=\"false\" />\n                        <column id=\"lastName\" name=\"d.last_name\" title=\"Last Name\" primary=\"false\" />\n			<column id=\"dob\" name=\"DATE_FORMAT( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth), \'%m-%d-%Y\' )\" title=\"Date of Birth\" primary=\"false\" />\n			<column id=\"age\" name=\"TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )\" title=\"Age\" primary=\"false\" />\n			<column id=\"billings\" name=\"IFNULL( BILLING.billcount, \'0\')\" title=\"Billings\" primary=\"false\" />\n			<column id=\"visits\" name=\"IFNULL( VISIT.visitcount, \'0\')\" title=\"Visits\" primary=\"false\" />\n			<column id=\"numOfMeds\" name=\"IFNULL( MEDS.numOfMeds, \'NA\')\" title=\"Opioid Medications\" primary=\"false\" />\n		</exportColumns>\n		<query>	\n  SELECT *	\n  FROM demographic d \n  LEFT JOIN (\n    SELECT demographic_no, dxresearch_code, coding_system, count(dxresearch_code)\n    FROM dxresearch\n    WHERE status=\'A\' AND\n    (\n      (LEFT(dxresearch_code,5) IN ${dxcodesICD} AND coding_system = ${dxcodesSysICD}) OR\n      (LEFT(dxresearch_code,4) IN ${dxcodesICD2} AND coding_system = ${dxcodesSysICD}) OR\n      (dxresearch_code IN ${dxcodesSnoMed} AND coding_system LIKE ${dxcodesSysSnoMed})\n    )\n    GROUP BY demographic_no\n    ORDER BY demographic_no\n  ) dxr\n  ON d.demographic_no = dxr.demographic_no\n  -- Billed 338.4 in last 3 years\n  LEFT JOIN (\n    SELECT b.demographic_no as demographic_no, b.dx_code1 as dxcode1, b.dx_code2 as dxcode2, b.dx_code3 as dxcode3, count(b.demographic_no) as billcount\n    FROM billingmaster b\n    WHERE LEFT(b.dx_code1,5) IN ${billingCode} OR LEFT(b.dx_code2,5) IN ${billingCode} OR LEFT(b.dx_code3,5) IN ${billingCode}\n    OR LEFT(b.dx_code1,4) IN ${billingCode2} OR LEFT(b.dx_code2,4) IN ${billingCode2} OR LEFT(b.dx_code3,4) IN ${billingCode2}\n    AND DATE(b.createdate) > ${lowerLimit.billingdate}\n    AND b.demographic_no > 0\n    GROUP BY b.demographic_no HAVING COUNT(b.demographic_no) > -1\n  ) BILLING\n  ON (d.demographic_no = BILLING.demographic_no)  \n  -- Coded 338.4 during visit encounter in last 3 years\n  LEFT JOIN(\n    SELECT ASSIGNED.demographic_no as demographic_no, observation_date as visitdate, uuid, count(ASSIGNED.demographic_no) as visitcount\n    FROM casemgmt_note note\n    INNER JOIN (\n      SELECT note_id, CODED.demo_no as demographic_no FROM casemgmt_issue_notes\n      INNER JOIN (\n        SELECT ci.id as id, ci.update_date, ci.demographic_no demo_no FROM issue i\n        INNER JOIN casemgmt_issue ci\n        ON i.issue_id = ci.issue_id\n        WHERE\n	(i.type like ${dxcodesSysICD} and LEFT(i.code,5) IN ${dxcodesICD}) OR\n	(i.type like ${dxcodesSysICD} and LEFT(i.code,4) IN ${dxcodesICD2}) OR\n	(i.type like ${dxcodesSysSnoMed} and i.code IN ${dxcodesSnoMed})\n      ) CODED\n      ON (casemgmt_issue_notes.id = CODED.id)\n      ORDER BY CODED.demo_no\n    ) ASSIGNED\n    ON note.note_id = ASSIGNED.note_id AND\n    -- GET LAST REVISION OF NOTE\n    note.note_id= (SELECT MAX(cmn.note_id) FROM casemgmt_note cmn WHERE cmn.uuid = note.uuid) AND\n    DATE(note.observation_date) > ${lowerLimit.visitdate}\n    GROUP BY demographic_no\n    ORDER BY demographic_no\n  ) VISIT\n  ON (d.demographic_no = VISIT.demographic_no)  \n  -- Opioid medications\n  LEFT JOIN (\n    SELECT dr.demographic_no, count(DISTINCT dr.atc) AS numOfMeds FROM drugs AS dr\n    WHERE dr.archived = 0 AND dr.ATC LIKE ${drug}\n    AND (dr.long_term OR (dr.rx_date &lt;= NOW() AND (DATE_ADD(dr.rx_date, INTERVAL(DATEDIFF(dr.end_date,dr.rx_date)*1.0) DAY)) >= NOW()))\n    GROUP BY dr.demographic_no\n  ) MEDS\n  ON (d.demographic_no = MEDS.demographic_no) \n  WHERE d.patient_status LIKE ${active}\n  AND d.demographic_no > 0\n  AND ( dxr.dxresearch_code IS NULL AND ((BILLING.billcount IS NOT NULL AND BILLING.billcount &gt;= ${numOfBills}) OR (VISIT.visitcount IS NOT NULL AND VISIT.visitcount &gt;= ${numOfVisits}) OR (MEDS.numOfMeds IS NOT NULL AND MEDS.numOfMeds &gt;= ${numOfMeds})))\n  AND d.provider_no LIKE ${provider}\n  ORDER BY d.demographic_no\n		</query>\n	</drillDownQuery>\n</indicatorTemplateXML>\n','','\0',0,NULL,NULL),
(26,4,'Chronic Pain Prevalence','CDM','Chronic Pain','DoBC CPQI PSP Panel','2017-08-02','% of active patients in the practice coded with Chronic Pain.','\ni) Pain patients: \"Patient Status: Active\nAND has a Current Problem List/Profile item code of 82423001, 373621006 OR starting with 338.4, 338.2, 3384, 3382\"\nii) Other patients: \"Patient Status: Active\nAND does not have a Current Problem List/Profile item','<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<indicatorTemplateXML>\n	<author>OSCAR BC</author>\n	<uid></uid>\n	<heading>\n		<category>CDM</category>\n		<subCategory>Chronic Pain</subCategory>\n		<name>Chronic Pain Prevalence</name>\n		<definition>% of active patients in the practice coded with Chronic Pain.</definition>\n		<framework>DoBC CPQI PSP Panel</framework>\n		<frameworkVersion>08-02-2017</frameworkVersion>\n		<notes>\ni) Pain patients: \"Patient Status: Active\nAND has a Current Problem List/Profile item code of 82423001, 373621006 OR starting with 338.4, 338.2, 3384, 3382\"\nii) Other patients: \"Patient Status: Active\nAND does not have a Current Problem List/Profile item code of 82423001, 373621006 OR starting with 338.4, 338.2, 3384, 3382\"\n		</notes>\n	</heading>\n	<indicatorQuery>\n		<version>03-13-2018</version>\n		<params>\n			<!-- \n				Required parameter provider. Value options are: \n					[ an individual providerNo, or provider range ] ie: value=\"370, 1001\" \n					\"all\" ie: value=\"all\" including null.\n					\"loggedInProvider\" ie:\n				Default is \"loggedInProvider\"\n				Use this parameter in the query as ${provider}\n				This parameter should be used for fetching patient\'s assigned to a MRP.\n				ie: WHERE demographic.provider_no = ${provider}\n			-->\n			<parameter id=\"provider\" name=\"provider_no\" value=\"loggedInProvider\" />\n			<parameter id=\"pstatus\" name=\"Patient Status\" value=\"\'AC\'\" />\n			<parameter id=\"dxcodesICD\" name=\"Dx Codes (ICD)\" value=\"338.4,338.2,3384,3382\" />\n			<parameter id=\"dxcodesSysICD\" name=\"DX CodeSystem (ICD)\" value=\"\'icd9\'\" />\n			<parameter id=\"dxcodesSnoMed\" name=\"Dx Codes (SnoMed)\" value=\"82423001,373621006\" />\n			<parameter id=\"dxcodesSysSnoMed\" name=\"Dx CodeSystem (SnoMed)\" value=\"\'snomed%\'\" />\n		</params>\n		<query>\n			<!-- Indicator SQL Query here -->\nSELECT\n -- PERCENT OF TOTAL PATIENTS NOTED AS ACTIVE WITH CURRENT CHRONIC PAIN\n IF( COUNT(fin.patient) > 0, SUM( IF( dxresearch_code is not NULL , 1, 0) ) , 0 ) AS \"% Active, Current Chronic Pain\",\n -- PERCENT OF TOTAL PATIENTS NOTED AS ACTIVE WITHOUT CURRENT CHRONIC PAIN\n IF( COUNT(fin.patient) > 0, SUM( IF( dxresearch_code is NULL , 1, 0) ) , 0 ) AS \"% Active, No Current Chronic Pain\"\nFROM (\n SELECT d.demographic_no AS patient, d.patient_status AS pt_status, dxresearch_code\n FROM demographic d\n LEFT JOIN (\n  SELECT demographic_no, dxresearch_code, count(dxresearch_code)\n  FROM dxresearch\n  WHERE status=\'A\' AND\n  (\n   (LEFT(dxresearch_code, 5) IN (\'338.4\', \'338.2\') AND coding_system = ${dxcodesSysICD}) OR\n   (LEFT(dxresearch_code, 4) IN (\'3384\', \'3382\') AND coding_system = ${dxcodesSysICD}) OR\n   (dxresearch_code IN (\'82423001\', \'373621006\') AND coding_system LIKE ${dxcodesSysSnoMed})\n   )\n  GROUP BY demographic_no\n  ORDER BY demographic_no\n ) problems\n ON d.demographic_no = problems.demographic_no\n WHERE d.provider_no LIKE ${provider} AND d.patient_status = ${pstatus}\n) fin\n		</query>\n	</indicatorQuery>\n	<drillDownQuery>\n		<version>03-13-2018</version>\n		<params>\n			<parameter id=\"provider\" name=\"provider_no\" value=\"loggedInProvider\" />	\n			<parameter id=\"pstatus\" name=\"Patient Status\" value=\"\'AC\'\" />\n			<parameter id=\"dxcodesICD\" name=\"Dx Codes (ICD)\" value=\"338.4,338.2,3384,3382\" />\n			<parameter id=\"dxcodesSysICD\" name=\"DX CodeSystem (ICD)\" value=\"\'icd9\'\" />\n			<parameter id=\"dxcodesSnoMed\" name=\"Dx Codes (SnoMed)\" value=\"82423001,373621006\" />\n			<parameter id=\"dxcodesSysSnoMed\" name=\"Dx CodeSystem (SnoMed)\" value=\"\'snomed%\'\" />\n		</params>\n		<displayColumns>\n			<column id=\"demographic\" name=\"d.demographic_no\" title=\"Patient Id\" primary=\"true\" />\n			<column id=\"name\" name=\"CONCAT( d.last_name, \', \', d.first_name )\" title=\"Patient Name\" primary=\"false\" />\n			<column id=\"dob\" name=\"DATE_FORMAT( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth), \'%m-%d-%Y\' )\" title=\"Date of Birth (mm-dd-yy)\" primary=\"false\" />\n			<column id=\"age\" name=\"TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )\" title=\"Age\" primary=\"false\" />\n			<column id=\"dxcode\" title=\"Dx System/Code\" name=\"CONCAT(MIN(dxr.coding_system),\'/\',MIN(dxr.dxresearch_code),IF( MIN(dxr.dxresearch_code) != MAX(dxr.dxresearch_code),CONCAT( \' &amp; \', MAX(dxr.coding_system), \'/\', MAX(dxr.dxresearch_code) ),\'\') )\" primary=\"false\" />\n		</displayColumns>\n		<exportColumns>\n			<column id=\"demographic\" name=\"d.demographic_no\" title=\"Patient Id\" primary=\"true\" />\n			<column id=\"firstName\" name=\"d.first_name\" title=\"First Name\" primary=\"false\" />\n			<column id=\"lastName\" name=\"d.last_name\" title=\"Last Name\" primary=\"false\" />\n			<column id=\"dob\" name=\"DATE_FORMAT( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth), \'%m-%d-%Y\' )\" title=\"Date of Birth (mm-dd-yy)\" primary=\"false\" />\n			<column id=\"age\" name=\"TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )\" title=\"Age\" primary=\"false\" />\n			<column id=\"dxcode\" title=\"Dx System/Code\" name=\"CONCAT(MIN(dxr.coding_system),\'/\',MIN(dxr.dxresearch_code),IF( MIN(dxr.dxresearch_code) != MAX(dxr.dxresearch_code),CONCAT( \' &amp; \', MAX(dxr.coding_system), \'/\', MAX(dxr.dxresearch_code) ),\'\') )\" primary=\"false\" />\n		</exportColumns>\n		<query>\n			<!-- Drilldown SQL Query here -->\nSELECT\n*			\nFROM demographic d\nLEFT JOIN dxresearch dxr\nON d.demographic_no = dxr.demographic_no\nWHERE d.patient_status=${pstatus}\nAND\n(\n (LEFT(dxr.dxresearch_code, 5) IN (\'338.4\', \'338.2\') AND dxr.coding_system = ${dxcodesSysICD}) OR\n (LEFT(dxr.dxresearch_code, 4) IN (\'3384\', \'3382\') AND dxr.coding_system = ${dxcodesSysICD}) OR\n (dxr.dxresearch_code IN (\'82423001\', \'373621006\') AND dxr.coding_system LIKE ${dxcodesSysSnoMed})\n )\nAND dxr.status = \'A\'\nAND d.provider_no LIKE ${provider}\nGROUP BY d.demographic_no\nORDER BY COUNT(d.demographic_no) DESC, d.demographic_no\n		</query>\n	</drillDownQuery>\n</indicatorTemplateXML>\n','','\0',0,NULL,NULL),
(27,4,'Consider COPD','CDM','COPD','DoBC CPQI PSP Panel','2017-08-02','\n			Patients with COPD dx in 2+ bills or 2+ visit encounters within last 3 years or FEV1/FVC < 0.7 OR Current Tiotroprium medication\n		','\n		  Created for Doctors of BC\n		  i) COPD dx in 2+ bills: \"Patient Status: Active\nAND does not have a Current Problem List/Profile item code of 32398004, 63480004, 61937009, 74417001, 185086009, 49158009, 12295008, 13645005   OR starting with 490-492, 49','<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<indicatorTemplateXML>\n	<author>OSCAR BC</author>\n	<uid></uid>\n	<heading>\n		<category>CDM</category>\n		<subCategory>COPD</subCategory>\n		<name>Consider COPD</name>\n		<definition>\n			Patients with COPD dx in 2+ bills or 2+ visit encounters within last 3 years or FEV1/FVC &lt; 0.7 OR Current Tiotroprium medication\n		</definition>\n		<framework>DoBC CPQI PSP Panel</framework>\n		<frameworkVersion>08-02-2017</frameworkVersion>\n		<notes>\n		  Created for Doctors of BC\n		  i) COPD dx in 2+ bills: \"Patient Status: Active\nAND does not have a Current Problem List/Profile item code of 32398004, 63480004, 61937009, 74417001, 185086009, 49158009, 12295008, 13645005   OR starting with 490-492, 494, 496\nAND with >= 2 Bills with the ICD9 diagnosis code starting with  490-492, 494, 496 in the last 3 years\"\n		  ii) COPD dx in 2+ visits: \"Patient Status: Active\nAND does not have a Current Problem List/Profile item code of 32398004, 63480004, 61937009, 74417001, 185086009, 49158009, 12295008, 13645005   OR starting with 490-492, 494, 496\nAND with >= 2 Visit Encounters with Snomed diagnosis code 32398004, 63480004, 61937009, 74417001, 185086009, 49158009, 12295008, 13645005 or the ICD9 diagnosis code starting with 490-492, 494, 496 in the last 3 years\"\n		  iii) \"Patient Status: Active\nAND does not have a Current Problem List/Profile item code of 32398004, 63480004, 61937009, 74417001, 185086009, 49158009, 12295008, 13645005   OR starting with 490-492, 494, 496\nAND has a FEV1 &lt; 0.7 OR Current Tiotroprium medication (ATC code R03BB04)\"\n		</notes>\n	</heading>\n	<indicatorQuery>\n		<version>03-13-2018</version>\n		<params>\n			<parameter id=\"provider\" name=\"Provider Number\" value=\"loggedInProvider\" />\n			<parameter id=\"active\" name=\"Active Patients\" value=\"\'AC\'\" />\n			<parameter id=\"dxcodesICD\" name=\"Dx Codes (ICD)\" value=\"490,491,492,494,496\" />\n                        <parameter id=\"dxcodesSysICD\" name=\"DX CodeSystem (ICD)\" value=\"\'icd9\'\" />\n                        <parameter id=\"dxcodesSnoMed\" name=\"Dx Codes (SnoMed)\" value=\"32398004, 63480004,61937009,74417001,185086009,49158009,12295008,13645005\" />\n                        <parameter id=\"dxcodesSysSnoMed\" name=\"Dx CodeSystem (SnoMed)\" value=\"\'snomed%\'\" />\n			<parameter id=\"billingCode\" name=\"ICD9 Billing Code\" value=\"490,491,492,494,496\" />\n			<parameter id=\"numOfBills\" name=\"Number of ICD9 490,491,492,494,496 Bills\" value=\"2\" />\n			<parameter id=\"numOfVisits\" name=\"Number of Visit Encounters coded 490,491,492,494,496/ICD9\" value=\"2\" />\n			<parameter id=\"fev1_fvc\" name=\"FEV1/FVC Result\" value=\"0.7\" />\n			<parameter id=\"drug\" name=\"ATC Code/Class\" value=\"\'R03BB04\'\" />\n			<parameter id=\"numOfMeds\" name=\"Opioid Medications\" value=\"1\" />			\n		</params>\n		<range>\n			<lowerLimit id=\"billingdate\" label=\"From Date\" name=\"Date\" value=\"DATE_SUB( NOW(), INTERVAL 3 YEAR )\" />\n			<upperLimit id=\"billingdate\" label=\"Date Today\" name=\"Date\" value=\"NOW()\" />\n			<lowerLimit id=\"visitdate\" label=\"From Date\" name=\"Date\" value=\"DATE_SUB( NOW(), INTERVAL 3 YEAR )\" />\n			<upperLimit id=\"visitdate\" label=\"Date Today\" name=\"Date\" value=\"NOW()\" />\n		</range>\n		<query>\nSELECT\n  IF ( COUNT(fin.patient) &gt; 0, SUM( CASE WHEN (fin.dx IS NULL AND fin.billcount &gt;= ${numOfBills}) THEN 1 ELSE 0 END ) , 0) AS \"COPD dx in ${numOfBills}+ bills\",\n  IF ( COUNT(fin.patient) &gt; 0, SUM( CASE WHEN (fin.dx IS NULL AND fin.visitcount &gt;= ${numOfVisits}) THEN 1 ELSE 0 END ) , 0) AS \"COPD dx in ${numOfVisits}+ visits\",\n  IF ( COUNT(fin.patient) &gt; 0, SUM( CASE WHEN (fin.dx IS NULL AND (fin.fev1_fvc &lt; ${fev1_fvc} OR (fin.fev1_fvc &gt; 1 AND fin.fev1_fvc &lt; 100*${fev1_fvc}) OR fin.medcount &gt;= ${numOfMeds})) THEN 1 ELSE 0 END ) , 0) AS \"FEV1/FVC &lt; ${fev1_fvc}% OR Tiotroprium\"\nFROM ( \n  SELECT \n    d.demographic_no AS patient, \n    BILLING.billcount AS billcount,\n    VISIT.visitcount AS visitcount,\n    OBS.fev1_fvc AS fev1_fvc,\n    MEDS.numOfMeds as medcount,\n    dxr.dxresearch_code AS dx,\n    dxr.coding_system AS dxs\n  FROM demographic d \n  LEFT JOIN (\n    SELECT demographic_no, dxresearch_code, coding_system, count(dxresearch_code)\n    FROM dxresearch\n    WHERE status=\'A\' AND\n    (\n      (LEFT(dxresearch_code,3) IN ${dxcodesICD} AND coding_system = ${dxcodesSysICD}) OR\n      (dxresearch_code IN ${dxcodesSnoMed} AND coding_system LIKE ${dxcodesSysSnoMed})\n    )\n    GROUP BY demographic_no\n    ORDER BY demographic_no\n  ) dxr\n  ON d.demographic_no = dxr.demographic_no\n  -- Billed 490,491,492,494,496 in last 3 years\n  LEFT JOIN (\n    SELECT b.demographic_no AS demographic_no, b.dx_code1 AS dxcode1, b.dx_code2 AS dxcode2, b.dx_code3 AS dxcode3, count(b.demographic_no) AS billcount\n    FROM billingmaster b\n    WHERE b.dx_code1 IN ${billingCode} OR b.dx_code2 IN ${billingCode} OR b.dx_code3 IN ${billingCode}\n    AND DATE(b.createdate) > ${lowerLimit.billingdate}\n    AND b.demographic_no > 0\n    GROUP BY b.demographic_no HAVING COUNT(b.demographic_no) > -1\n  ) BILLING\n  ON (d.demographic_no = BILLING.demographic_no)  \n  -- Coded 490,491,492,494,496 during visit encounter in last 3 years\n  LEFT JOIN(\n    SELECT ASSIGNED.demographic_no AS demographic_no, observation_date AS visitdate, uuid, count(ASSIGNED.demographic_no) AS visitcount\n    FROM casemgmt_note note\n    INNER JOIN (\n      SELECT note_id, CODED.demo_no AS demographic_no FROM casemgmt_issue_notes\n      INNER JOIN (\n        SELECT ci.id AS id, ci.update_date, ci.demographic_no demo_no FROM issue i\n        INNER JOIN casemgmt_issue ci\n        ON i.issue_id = ci.issue_id\n        WHERE\n	(i.type LIKE ${dxcodesSysICD} and LEFT(i.code,3) IN ${dxcodesICD}) OR\n	(i.type LIKE ${dxcodesSysSnoMed} and i.code IN ${dxcodesSnoMed})\n      ) CODED\n      ON (casemgmt_issue_notes.id = CODED.id)\n      ORDER BY CODED.demo_no\n    ) ASSIGNED\n    ON note.note_id = ASSIGNED.note_id AND\n    -- GET LAST REVISION OF NOTE\n    note.note_id= (SELECT MAX(cmn.note_id) FROM casemgmt_note cmn WHERE cmn.uuid = note.uuid) AND\n    DATE(note.observation_date) > ${lowerLimit.visitdate}\n    GROUP BY demographic_no\n    ORDER BY demographic_no\n  ) VISIT\n  ON (d.demographic_no = VISIT.demographic_no)  \n  -- FEV1/FVC measurement\n  LEFT JOIN (\n    SELECT m.demographicNo AS demographic_no, m.dataField AS fev1_fvc, m.dateObserved AS dateObserved\n    FROM measurements m\n    INNER JOIN (\n      SELECT demographicNo, MAX(dateObserved) AS dateObserved\n      FROM measurements\n      WHERE type = \'FEV1\'\n      GROUP BY demographicNo\n    ) mlast\n    ON m.demographicNo = mlast.demographicNo\n    WHERE m.type = \'FEV1\'\n    AND m.dateObserved = mlast.dateObserved\n    AND m.demographicNo &gt; 0\n    GROUP BY m.demographicNo\n  ) OBS\n  ON (d.demographic_no = OBS.demographic_no)\n  LEFT JOIN (\n    SELECT dr.demographic_no, count(DISTINCT dr.atc) AS numOfMeds FROM drugs AS dr\n    WHERE dr.archived = 0 AND dr.ATC LIKE ${drug}\n    AND (dr.long_term OR (dr.rx_date &lt;= NOW() AND (DATE_ADD(dr.rx_date, INTERVAL(DATEDIFF(dr.end_date,dr.rx_date)*1.0) DAY)) >= NOW()))\n    GROUP BY dr.demographic_no\n  ) MEDS\n  ON (d.demographic_no = MEDS.demographic_no)  \n  WHERE d.patient_status LIKE ${active}\n  AND d.demographic_no > 0\n  AND d.provider_no LIKE ${provider} \n) fin\n		</query>\n	</indicatorQuery>\n	<drillDownQuery>\n		<version>03-13-2018</version>\n		<params>\n			<parameter id=\"provider\" name=\"Provider Number\" value=\"loggedInProvider\" />\n			<parameter id=\"active\" name=\"Active Patients\" value=\"\'AC\'\" />\n			<parameter id=\"dxcodesICD\" name=\"Dx Codes (ICD)\" value=\"490,491,492,494,496\" />\n                        <parameter id=\"dxcodesSysICD\" name=\"DX CodeSystem (ICD)\" value=\"\'icd9\'\" />\n                        <parameter id=\"dxcodesSnoMed\" name=\"Dx Codes (SnoMed)\" value=\"32398004, 63480004,61937009,74417001,185086009,49158009,12295008,13645005\" />\n                        <parameter id=\"dxcodesSysSnoMed\" name=\"Dx CodeSystem (SnoMed)\" value=\"\'snomed%\'\" />\n			<parameter id=\"billingCode\" name=\"ICD9 Billing Code\" value=\"490,491,492,494,496\" />\n			<parameter id=\"numOfBills\" name=\"Number of ICD9 490,491,492,494,496 Bills\" value=\"2\" />\n			<parameter id=\"numOfVisits\" name=\"Number of Visit Encounters coded 490,491,492,494,496/ICD9\" value=\"2\" />\n			<parameter id=\"fev1_fvc\" name=\"FEV1/FVC Result\" value=\"0.7\" />\n			<parameter id=\"drug\" name=\"ATC Code/Class\" value=\"\'R03BB04\'\" />\n			<parameter id=\"numOfMeds\" name=\"Opioid Medications\" value=\"1\" />			\n		</params>\n		\n		<range>\n			<lowerLimit id=\"billingdate\" label=\"From Date\" name=\"Date\" value=\"DATE_SUB( NOW(), INTERVAL 3 YEAR )\" />\n			<upperLimit id=\"billingdate\" label=\"Date Today\" name=\"Date\" value=\"NOW()\" />\n			<lowerLimit id=\"visitdate\" label=\"From Date\" name=\"Date\" value=\"DATE_SUB( NOW(), INTERVAL 3 YEAR )\" />\n			<upperLimit id=\"visitdate\" label=\"Date Today\" name=\"Date\" value=\"NOW()\" />\n		</range>\n		\n		<displayColumns>\n			<column id=\"demographic\" name=\"d.demographic_no\" title=\"Patient Id\" primary=\"true\" />\n			<column id=\"name\" name=\"CONCAT( d.last_name, \', \', d.first_name )\" title=\"Patient Name\" primary=\"false\" />\n			<column id=\"dob\" name=\"DATE_FORMAT( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth), \'%m-%d-%Y\' )\" title=\"Date of Birth\" primary=\"false\" />\n			<column id=\"age\" name=\"TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )\" title=\"Age\" primary=\"false\" />\n			<column id=\"billings\" name=\"IFNULL( BILLING.billcount, \'0\')\" title=\"Billings\" primary=\"false\" />\n			<column id=\"visits\" name=\"IFNULL( VISIT.visitcount, \'0\')\" title=\"Visits\" primary=\"false\" />\n			<column id=\"fev1_fvc\" name=\"IFNULL( OBS.fev1_fvc, \'NA\')\" title=\"FEV1/FVC\" primary=\"false\" />\n			<column id=\"numOfMeds\" name=\"IFNULL( MEDS.numOfMeds, \'NA\')\" title=\"Tiotroprium Medications\" primary=\"false\" />			\n		</displayColumns>\n		\n		<exportColumns>\n			<column id=\"demographic\" name=\"d.demographic_no\" title=\"Patient Id\" primary=\"true\" />\n                        <column id=\"firstName\" name=\"d.first_name\" title=\"First Name\" primary=\"false\" />\n                        <column id=\"lastName\" name=\"d.last_name\" title=\"Last Name\" primary=\"false\" />\n			<column id=\"dob\" name=\"DATE_FORMAT( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth), \'%m-%d-%Y\' )\" title=\"Date of Birth\" primary=\"false\" />\n			<column id=\"age\" name=\"TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )\" title=\"Age\" primary=\"false\" />\n			<column id=\"billings\" name=\"IFNULL( BILLING.billcount, \'0\')\" title=\"Billings\" primary=\"false\" />\n			<column id=\"visits\" name=\"IFNULL( VISIT.visitcount, \'0\')\" title=\"Visits\" primary=\"false\" />\n			<column id=\"fev1_fvc\" name=\"IFNULL( OBS.fev1_fvc, \'NA\')\" title=\"FEV1/FVC\" primary=\"false\" />\n			<column id=\"numOfMeds\" name=\"IFNULL( MEDS.numOfMeds, \'NA\')\" title=\"Tiotroprium Medications\" primary=\"false\" />			\n		</exportColumns>\n		<query>	\n  SELECT *	\n  FROM demographic d \n  LEFT JOIN (\n    SELECT demographic_no, dxresearch_code, coding_system, count(dxresearch_code)\n    FROM dxresearch\n    WHERE status=\'A\' AND\n    (\n      (LEFT(dxresearch_code,3) IN ${dxcodesICD} AND coding_system = ${dxcodesSysICD}) OR\n      (dxresearch_code IN ${dxcodesSnoMed} AND coding_system LIKE ${dxcodesSysSnoMed})\n    )\n    GROUP BY demographic_no\n    ORDER BY demographic_no\n  ) dxr\n  ON d.demographic_no = dxr.demographic_no\n  -- Billed 490,491,492,494,496 in last 3 years\n  LEFT JOIN (\n    SELECT b.demographic_no AS demographic_no, b.dx_code1 AS dxcode1, b.dx_code2 AS dxcode2, b.dx_code3 AS dxcode3, count(b.demographic_no) AS billcount\n    FROM billingmaster b\n    WHERE b.dx_code1 IN ${billingCode} OR b.dx_code2 IN ${billingCode} OR b.dx_code3 IN ${billingCode}\n    AND DATE(b.createdate) > ${lowerLimit.billingdate}\n    AND b.demographic_no > 0\n    GROUP BY b.demographic_no HAVING COUNT(b.demographic_no) > -1\n  ) BILLING\n  ON (d.demographic_no = BILLING.demographic_no)  \n  -- Coded 490,491,492,494,496 during visit encounter in last 3 years\n  LEFT JOIN(\n    SELECT ASSIGNED.demographic_no AS demographic_no, observation_date AS visitdate, uuid, count(ASSIGNED.demographic_no) AS visitcount\n    FROM casemgmt_note note\n    INNER JOIN (\n      SELECT note_id, CODED.demo_no AS demographic_no FROM casemgmt_issue_notes\n      INNER JOIN (\n        SELECT ci.id AS id, ci.update_date, ci.demographic_no demo_no FROM issue i\n        INNER JOIN casemgmt_issue ci\n        ON i.issue_id = ci.issue_id\n        WHERE\n	(i.type LIKE ${dxcodesSysICD} and LEFT(i.code,3) IN ${dxcodesICD}) OR\n	(i.type LIKE ${dxcodesSysSnoMed} and i.code IN ${dxcodesSnoMed})\n      ) CODED\n      ON (casemgmt_issue_notes.id = CODED.id)\n      ORDER BY CODED.demo_no\n    ) ASSIGNED\n    ON note.note_id = ASSIGNED.note_id AND\n    -- GET LAST REVISION OF NOTE\n    note.note_id= (SELECT MAX(cmn.note_id) FROM casemgmt_note cmn WHERE cmn.uuid = note.uuid) AND\n    DATE(note.observation_date) > ${lowerLimit.visitdate}\n    GROUP BY demographic_no\n    ORDER BY demographic_no\n  ) VISIT\n  ON (d.demographic_no = VISIT.demographic_no)  \n  -- FEV1/FVC measurement\n  LEFT JOIN (\n    SELECT m.demographicNo AS demographic_no, m.dataField AS fev1_fvc, m.dateObserved AS dateObserved\n    FROM measurements m\n    INNER JOIN (\n      SELECT demographicNo, MAX(dateObserved) AS dateObserved\n      FROM measurements\n      WHERE type = \'FEV1\'\n      GROUP BY demographicNo\n    ) mlast\n    ON m.demographicNo = mlast.demographicNo\n    WHERE m.type = \'FEV1\'\n    AND m.dateObserved = mlast.dateObserved\n    AND m.demographicNo &gt; 0\n    GROUP BY m.demographicNo\n  ) OBS\n  ON (d.demographic_no = OBS.demographic_no)\n  LEFT JOIN (\n    SELECT dr.demographic_no, count(DISTINCT dr.atc) AS numOfMeds FROM drugs AS dr\n    WHERE dr.archived = 0 AND dr.ATC LIKE ${drug}\n    AND (dr.long_term OR (dr.rx_date &lt;= NOW() AND (DATE_ADD(dr.rx_date, INTERVAL(DATEDIFF(dr.end_date,dr.rx_date)*1.0) DAY)) >= NOW()))\n    GROUP BY dr.demographic_no\n  ) MEDS\n  ON (d.demographic_no = MEDS.demographic_no)  \n  WHERE d.patient_status LIKE ${active}\n  AND d.demographic_no > 0\n  AND dxr.dxresearch_code IS NULL AND (  (BILLING.billcount IS NOT NULL AND BILLING.billcount &gt;= ${numOfBills}) OR (VISIT.visitcount IS NOT NULL AND VISIT.visitcount &gt;= ${numOfVisits}) OR (OBS.fev1_fvc IS NOT NULL AND (OBS.fev1_fvc &lt; ${fev1_fvc} OR (OBS.fev1_fvc &gt; 1 AND OBS.fev1_fvc &lt; 100*${fev1_fvc}))) OR (MEDS.numOfMeds IS NOT NULL AND MEDS.numOfMeds &gt;= ${numOfMeds}))\n  AND d.provider_no LIKE ${provider}\n  ORDER BY d.demographic_no\n		</query>\n	</drillDownQuery>\n</indicatorTemplateXML>\n','','\0',0,NULL,NULL),
(28,4,'COPD Prevalence','CDM','COPD','DoBC CPQI PSP Panel','2017-08-02','% of active patients in the practice coded with COPD.','\ni) COPD patients: \"Patient Status: Active\nAND has a Current Problem List/Profile item code of 32398004, 63480004, 61937009, 74417001, 185086009, 49158009, 12295008, 13645005   OR starting with 490-492, 494, 496\"\nii) Other patients: \"Patient Status: Activ','<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<indicatorTemplateXML>\n	<author>OSCAR BC</author>\n	<uid></uid>\n	<heading>\n		<category>CDM</category>\n		<subCategory>COPD</subCategory>\n		<name>COPD Prevalence</name>\n		<definition>% of active patients in the practice coded with COPD.</definition>\n		<framework>DoBC CPQI PSP Panel</framework>\n		<frameworkVersion>08-02-2017</frameworkVersion>\n		<notes>\ni) COPD patients: \"Patient Status: Active\nAND has a Current Problem List/Profile item code of 32398004, 63480004, 61937009, 74417001, 185086009, 49158009, 12295008, 13645005   OR starting with 490-492, 494, 496\"\nii) Other patients: \"Patient Status: Active\nAND does not have a Current Problem List/Profile item code of 32398004, 63480004, 61937009, 74417001, 185086009, 49158009, 12295008, 13645005   OR starting with 490-492, 494, 496\"\n		</notes>\n	</heading>\n	<indicatorQuery>\n		<version>03-13-2018</version>\n		<params>\n			<!-- \n				Required parameter provider. Value options are: \n					[ an individual providerNo, or provider range ] ie: value=\"370, 1001\" \n					\"all\" ie: value=\"all\" including null.\n					\"loggedInProvider\" ie:\n				Default is \"loggedInProvider\"\n				Use this parameter in the query as ${provider}\n				This parameter should be used for fetching patient\'s assigned to a MRP.\n				ie: WHERE demographic.provider_no = ${provider}\n			-->\n			<parameter id=\"provider\" name=\"provider_no\" value=\"loggedInProvider\" />\n			<parameter id=\"pstatus\" name=\"Patient Status\" value=\"\'AC\'\" />\n			<parameter id=\"dxcodesICD\" name=\"Dx Codes (ICD)\" value=\"490,491,492,494,496\" />\n			<parameter id=\"dxcodesSysICD\" name=\"DX CodeSystem (ICD)\" value=\"\'icd9\'\" />\n			<parameter id=\"dxcodesSnoMed\" name=\"Dx Codes (SnoMed)\" value=\"32398004,63480004,61937009,74417001,185086009,49158009,12295008,13645005\" />\n			<parameter id=\"dxcodesSysSnoMed\" name=\"Dx CodeSystem (SnoMed)\" value=\"\'snomed%\'\" />\n		</params>\n		<query>\n			<!-- Indicator SQL Query here -->\nSELECT\n -- PERCENT OF TOTAL PATIENTS NOTED AS ACTIVE WITH CURRENT COPD\n IF( COUNT(fin.patient) > 0, SUM( IF( dxresearch_code is not NULL , 1, 0) ) , 0 ) AS \"% Active, Current COPD\",\n -- PERCENT OF TOTAL PATIENTS NOTED AS ACTIVE WITHOUT CURRENT COPD\n IF( COUNT(fin.patient) > 0, SUM( IF( dxresearch_code is NULL , 1, 0) ) , 0 ) AS \"% Active, No Current COPD\"\nFROM (\n SELECT d.demographic_no AS patient, d.patient_status AS pt_status, dxresearch_code\n FROM demographic d\n LEFT JOIN (\n  SELECT demographic_no, dxresearch_code, count(dxresearch_code)\n  FROM dxresearch\n  WHERE status=\'A\' AND\n  (\n   (LEFT(dxresearch_code, 3) IN (\'490\', \'491\', \'492\', \'494\', \'496\') AND coding_system = ${dxcodesSysICD}) OR\n   (dxresearch_code IN (\'32398004\', \'63480004\', \'61937009\', \'74417001\', \'185086009\', \'49158009\', \'12295008\', \'13645005\') AND coding_system LIKE ${dxcodesSysSnoMed})\n   )\n  GROUP BY demographic_no\n  ORDER BY demographic_no\n ) problems\n ON d.demographic_no = problems.demographic_no\n WHERE d.provider_no LIKE ${provider} AND d.patient_status = ${pstatus}\n) fin\n		</query>\n	</indicatorQuery>\n	<drillDownQuery>\n		<version>03-13-2018</version>\n		<params>\n			<parameter id=\"provider\" name=\"provider_no\" value=\"loggedInProvider\" />	\n			<parameter id=\"pstatus\" name=\"Patient Status\" value=\"\'AC\'\" />\n			<parameter id=\"dxcodesICD\" name=\"Dx Codes (ICD)\" value=\"490,491,492,494,496\" />\n			<parameter id=\"dxcodesSysICD\" name=\"DX CodeSystem (ICD)\" value=\"\'icd9\'\" />\n			<parameter id=\"dxcodesSnoMed\" name=\"Dx Codes (SnoMed)\" value=\"32398004,63480004,61937009,74417001,185086009,49158009,12295008,13645005\" />\n			<parameter id=\"dxcodesSysSnoMed\" name=\"Dx CodeSystem (SnoMed)\" value=\"\'snomed%\'\" />\n		</params>\n		<displayColumns>\n			<column id=\"demographic\" name=\"d.demographic_no\" title=\"Patient Id\" primary=\"true\" />\n			<column id=\"name\" name=\"CONCAT( d.last_name, \', \', d.first_name )\" title=\"Patient Name\" primary=\"false\" />\n			<column id=\"dob\" name=\"DATE_FORMAT( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth), \'%m-%d-%Y\' )\" title=\"Date of Birth (mm-dd-yy)\" primary=\"false\" />\n			<column id=\"age\" name=\"TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )\" title=\"Age\" primary=\"false\" />\n			<column id=\"dxcode\" title=\"Dx System/Code\" name=\"CONCAT(MIN(dxr.coding_system),\'/\',MIN(dxr.dxresearch_code),IF( MIN(dxr.dxresearch_code) != MAX(dxr.dxresearch_code),CONCAT( \' &amp; \', MAX(dxr.coding_system), \'/\', MAX(dxr.dxresearch_code) ),\'\') )\" primary=\"false\" />\n		</displayColumns>\n		<exportColumns>\n			<column id=\"demographic\" name=\"d.demographic_no\" title=\"Patient Id\" primary=\"true\" />\n			<column id=\"firstName\" name=\"d.first_name\" title=\"First Name\" primary=\"false\" />\n			<column id=\"lastName\" name=\"d.last_name\" title=\"Last Name\" primary=\"false\" />\n			<column id=\"dob\" name=\"DATE_FORMAT( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth), \'%m-%d-%Y\' )\" title=\"Date of Birth (mm-dd-yy)\" primary=\"false\" />\n			<column id=\"age\" name=\"TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )\" title=\"Age\" primary=\"false\" />\n			<column id=\"dxcode\" title=\"Dx System/Code\" name=\"CONCAT(MIN(dxr.coding_system),\'/\',MIN(dxr.dxresearch_code),IF( MIN(dxr.dxresearch_code) != MAX(dxr.dxresearch_code),CONCAT( \' &amp; \', MAX(dxr.coding_system), \'/\', MAX(dxr.dxresearch_code) ),\'\') )\" primary=\"false\" />\n		</exportColumns>\n		<query>\n			<!-- Drilldown SQL Query here -->\nSELECT\n*			\nFROM demographic d\nLEFT JOIN dxresearch dxr\nON d.demographic_no = dxr.demographic_no\nWHERE d.patient_status=${pstatus}\nAND\n(\n (LEFT(dxr.dxresearch_code, 3) IN (\'490\', \'491\', \'492\', \'494\', \'496\') AND dxr.coding_system = ${dxcodesSysICD}) OR\n (dxr.dxresearch_code IN (\'32398004\', \'63480004\', \'61937009\', \'74417001\', \'185086009\', \'49158009\', \'12295008\', \'13645005\') AND dxr.coding_system LIKE ${dxcodesSysSnoMed})\n )\nAND dxr.status = \'A\'\nAND d.provider_no LIKE ${provider}\nGROUP BY d.demographic_no\nORDER BY COUNT(d.demographic_no) DESC, d.demographic_no\n		</query>\n	</drillDownQuery>\n</indicatorTemplateXML>\n','','\0',0,NULL,NULL),
(29,4,'Consider Diabetes','CDM','Diabetes','DoBC CPQI PSP Panel','2017-08-02','\n		  Patients with diabetes dx in 2+ bills or 2+ visit\n		  encounters within last 3 years or most recent HbA1C\n		  >= 6.5% or Glucose Fasting > 7% or current\n		  Insulin (ATC code A10A) or Oral hypoglycemics (ATC\n		  code A10B) medication\n		','\n		  Created for Doctors of BC\n		  i) Diabetes dx in 2+ bills: \"Patient Status: Active\nAND does not have a Current Problem List/Profile item code of 73211009 OR starting with 250\nAND with >= 2 Bills with the ICD9 diagnosis code starting with 250 in the la','<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<indicatorTemplateXML>\n	<author>OSCAR BC</author>\n	<uid></uid>\n	<heading>\n		<category>CDM</category>\n		<subCategory>Diabetes</subCategory>\n		<name>Consider Diabetes</name>\n		<definition>\n		  Patients with diabetes dx in 2+ bills or 2+ visit\n		  encounters within last 3 years or most recent HbA1C\n		  &gt;= 6.5% or Glucose Fasting &gt; 7% or current\n		  Insulin (ATC code A10A) or Oral hypoglycemics (ATC\n		  code A10B) medication\n		</definition>\n		<framework>DoBC CPQI PSP Panel</framework>\n		<frameworkVersion>08-02-2017</frameworkVersion>\n		<notes>\n		  Created for Doctors of BC\n		  i) Diabetes dx in 2+ bills: \"Patient Status: Active\nAND does not have a Current Problem List/Profile item code of 73211009 OR starting with 250\nAND with >= 2 Bills with the ICD9 diagnosis code starting with 250 in the last 3 years\"\n		  ii) Diabetes dx in 2+ visits: \"Patient Status: Active\nAND does not have a Current Problem List/Profile item code of 73211009 OR starting with 250\nAND with >= 2 Visit Encounters with Snomed diagnosis code 73211009 or the ICD9 diagnosis code starting with 250 in the last 3 years\"\n                  iii) HbA1C >= 6.5% or Glucose Fasting > 7% or\n                  current Insulin (ATC code A10A) or Oral\n                  hypoglycemics (ATC code A10B) medication: \"Patient\n                  Status: Active AND does not have a Current Problem\n                  List/Profile item code of 73211009 OR starting with\n                  250 AND ( (WITH a most recent [HbA1c >= 6.5% OR (>=\n                  0.065 AND NOT > 1)] OR [Fasting Glucose > 7%] in the\n                  past 1 year) OR (with two or more HbA1c >= 6.5% in\n                  last 5 years) OR (current medication with ATC code\n                  starting with A10A or A10B) )\"\n		</notes>\n	</heading>\n	<indicatorQuery>\n		<version>03-13-2018</version>\n		<params>\n			<parameter id=\"provider\" name=\"Provider Number\" value=\"loggedInProvider\" />\n			<parameter id=\"active\" name=\"Active Patients\" value=\"\'AC\'\" />\n			<parameter id=\"dxcodesICD\" name=\"Dx Codes (ICD)\" value=\"\'250%\'\" />\n                        <parameter id=\"dxcodesSysICD\" name=\"DX CodeSystem (ICD)\" value=\"\'icd9\'\" />\n                        <parameter id=\"dxcodesSnoMed\" name=\"Dx Codes (SnoMed)\" value=\"\'73211009\'\" />\n                        <parameter id=\"dxcodesSysSnoMed\" name=\"Dx CodeSystem (SnoMed)\" value=\"\'snomed%\'\" />\n			<parameter id=\"billingCode\" name=\"ICD9 Billing Code\" value=\"250\" />\n			<parameter id=\"numOfBills\" name=\"Number of ICD9 250 Bills\" value=\"2\" />\n			<parameter id=\"numOfVisits\" name=\"Number of Visit Encounters coded 250/ICD9\" value=\"2\" />\n                        <parameter id=\"obs1Name\" name=\"Obs 1 Name\" value=\"\'A1C\'\" />\n                        <parameter id=\"obs1Result\" name=\"Obs 1 Result\" value=\"6.5\" />\n                        <parameter id=\"obs2Name\" name=\"Obs 2 Name\" value=\"\'FBS\'\" />\n                        <parameter id=\"obs2Result\" name=\"Obs 2 Result\" value=\"7.0\" />\n                        <parameter id=\"numOfObs\" name=\"Number of measurements\" value=\"2\" />\n                        <parameter id=\"drugs\" name=\"ATC Code/Class\" value=\"A10A,A10B\" />\n                        <parameter id=\"numOfMeds\" name=\"Heart Failure Medications\" value=\"1\" />			\n		</params>\n		<range>\n			<lowerLimit id=\"billingdate\" label=\"From Date\" name=\"Date\" value=\"DATE_SUB( NOW(), INTERVAL 3 YEAR )\" />\n			<upperLimit id=\"billingdate\" label=\"Date Today\" name=\"Date\" value=\"NOW()\" />\n			<lowerLimit id=\"visitdate\" label=\"From Date\" name=\"Date\" value=\"DATE_SUB( NOW(), INTERVAL 3 YEAR )\" />\n                        <upperLimit id=\"visitdate\" label=\"Date Today\" name=\"Date\" value=\"NOW()\" />\n			<lowerLimit id=\"labdatelast\" label=\"From Date\" name=\"Date\" value=\"DATE_SUB( NOW(), INTERVAL 12 MONTH )\" />\n			<upperLimit id=\"labdatelast\" label=\"Date Today\" name=\"Date\" value=\"NOW()\" />\n			<lowerLimit id=\"labdateObs\" label=\"From Date\" name=\"Date\" value=\"DATE_SUB( NOW(), INTERVAL 5 YEAR )\" />\n			<upperLimit id=\"labdateObs\" label=\"Date Today\" name=\"Date\" value=\"NOW()\" />\n		</range>\n		<query>\nSELECT\n  IF ( COUNT(fin.patient) &gt; 0, SUM( CASE WHEN (fin.dx IS NULL AND fin.billcount &gt;= ${numOfBills}) THEN 1 ELSE 0 END ) , 0) AS \"Diabetes dx in ${numOfBills}+ bills\",\n  IF ( COUNT(fin.patient) &gt; 0, SUM( CASE WHEN (fin.dx IS NULL AND fin.visitcount &gt;= ${numOfVisits}) THEN 1 ELSE 0 END ) , 0) AS \"Diabetes dx in ${numOfVisits}+ visits\",\n  IF ( COUNT(fin.patient) &gt; 0, SUM( CASE WHEN (fin.dx IS NULL AND\n  (fin.result1 &gt; ${obs1Result} OR (fin.result1 &gt; 0.01*${obs1Result} AND fin.result1 &lt; 1) OR fin.result2 &gt; ${obs2Result} OR fin.cntResult1 &gt;= ${numOfObs} OR fin.medcount &gt;= ${numOfMeds})\n  ) THEN 1 ELSE 0 END ) , 0) AS \"Diabetes Obs/Medication\"\nFROM ( \n  SELECT \n    d.demographic_no AS patient, \n    BILLING.billcount AS billcount,\n    VISIT.visitcount AS visitcount,\n    OBS1LAST.result AS result1,\n    OBS2LAST.result AS result2,\n    OBS1CNT.countOBS AS cntResult1,\n    MEDS.numOfMeds AS medcount,\n    dxr.dxresearch_code AS dx,\n    dxr.coding_system AS dxs\n  FROM demographic d \n  LEFT JOIN (\n    SELECT demographic_no, dxresearch_code, coding_system, COUNT(dxresearch_code)\n    FROM dxresearch\n    WHERE status=\'A\' AND\n    (\n      (dxresearch_code LIKE ${dxcodesICD} AND coding_system = ${dxcodesSysICD}) OR\n      (dxresearch_code = ${dxcodesSnoMed} AND coding_system LIKE ${dxcodesSysSnoMed})\n    )\n    GROUP BY demographic_no\n    ORDER BY demographic_no\n  ) dxr\n  ON d.demographic_no = dxr.demographic_no\n  -- Billed 250 in last 3 years\n  LEFT JOIN (\n    SELECT b.demographic_no AS demographic_no, b.dx_code1 AS dxcode1, b.dx_code2 AS dxcode2, b.dx_code3 AS dxcode3, COUNT(b.demographic_no) AS billcount\n    FROM billingmaster b\n    WHERE b.dx_code1 = ${billingCode} OR b.dx_code2 = ${billingCode} OR b.dx_code3 = ${billingCode}\n    AND DATE(b.createdate) > ${lowerLimit.billingdate}\n    AND b.demographic_no > 0\n    GROUP BY b.demographic_no HAVING COUNT(b.demographic_no) > -1\n  ) BILLING\n  ON (d.demographic_no = BILLING.demographic_no)\n  -- Coded 250 during visit encounter in last 3 years\n  LEFT JOIN(\n    SELECT ASSIGNED.demographic_no AS demographic_no, observation_date AS visitdate, uuid, COUNT(ASSIGNED.demographic_no) AS visitcount\n    FROM casemgmt_note note\n    INNER JOIN (\n      SELECT note_id, CODED.demo_no AS demographic_no FROM casemgmt_issue_notes\n      INNER JOIN (\n        SELECT ci.id AS id, ci.update_date, ci.demographic_no demo_no FROM issue i\n        INNER JOIN casemgmt_issue ci\n        ON i.issue_id = ci.issue_id\n        WHERE\n        (i.type LIKE ${dxcodesSysICD} AND i.code LIKE ${dxcodesICD}) OR\n        (i.type LIKE ${dxcodesSysSnoMed} AND i.code = ${dxcodesSnoMed})\n      ) CODED\n      ON (casemgmt_issue_notes.id = CODED.id)\n      ORDER BY CODED.demo_no\n    ) ASSIGNED\n    ON note.note_id = ASSIGNED.note_id AND\n    -- GET LAST REVISION OF NOTE\n    note.note_id= (SELECT MAX(cmn.note_id) FROM casemgmt_note cmn WHERE cmn.uuid = note.uuid) AND\n    DATE(note.observation_date) > ${lowerLimit.visitdate}\n    GROUP BY demographic_no\n    ORDER BY demographic_no\n  ) VISIT\n  ON (d.demographic_no = VISIT.demographic_no)\n  -- HbA1C measurement\n  LEFT JOIN ( \n    SELECT m.demographicNo AS demographic_no, m.dataField AS result, m.dateObserved AS dateObserved\n    FROM measurements m\n    INNER JOIN (\n      SELECT demographicNo, MAX(dateObserved) AS dateObserved\n      FROM measurements\n      WHERE type = ${obs1Name}\n      GROUP BY demographicNo\n    ) mlast\n    ON m.demographicNo = mlast.demographicNo\n    WHERE m.type = ${obs1Name}\n    AND m.dateObserved = mlast.dateObserved\n    AND DATE(m.dateObserved) &gt; ${lowerLimit.labdatelast}\n    AND m.demographicNo &gt; 0\n  ) OBS1LAST\n  ON (d.demographic_no = OBS1LAST.demographic_no) \n  -- Fasting Glucose measurement\n  LEFT JOIN ( \n    SELECT m.demographicNo AS demographic_no, m.dataField AS result, m.dateObserved AS dateObserved\n    FROM measurements m\n    INNER JOIN (\n      SELECT demographicNo, MAX(dateObserved) AS dateObserved\n      FROM measurements\n      WHERE type = ${obs2Name}\n      GROUP BY demographicNo\n    ) mlast\n    ON m.demographicNo = mlast.demographicNo\n    WHERE m.type = ${obs2Name}\n    AND m.dateObserved = mlast.dateObserved\n    AND DATE(m.dateObserved) &gt; ${lowerLimit.labdatelast}\n    AND m.demographicNo &gt; 0\n  ) OBS2LAST\n  ON (d.demographic_no = OBS2LAST.demographic_no)\n  LEFT JOIN ( \n    SELECT m.demographicNo AS demographic_no, m.dataField, COUNT(m.dataField) AS countOBS\n    FROM measurements m\n    WHERE m.type = ${obs1Name}\n    AND m.dataField &gt;= ${obs1Result}\n    AND DATE(m.dateObserved) &gt; ${lowerLimit.labdateObs}\n    AND m.demographicNo &gt; 0\n    GROUP BY m.demographicNo HAVING COUNT(m.demographicNo) &gt; -1\n  ) OBS1CNT\n  ON (d.demographic_no = OBS1CNT.demographic_no)  \n  LEFT JOIN (\n    SELECT dr.demographic_no, COUNT(DISTINCT dr.atc) AS numOfMeds FROM drugs AS dr\n--    WHERE dr.archived = 0 AND LEFT(dr.ATC,4) IN ${drugs}\n    WHERE dr.archived = 0 AND dr.ATC LIKE \'A10%\'\n    AND (dr.long_term OR (dr.rx_date &lt;= NOW() AND (DATE_ADD(dr.rx_date, INTERVAL(DATEDIFF(dr.end_date,dr.rx_date)*1.0) DAY)) >= NOW()))\n    GROUP BY dr.demographic_no\n  ) MEDS\n  ON (d.demographic_no = MEDS.demographic_no)\n  WHERE d.patient_status LIKE ${active}\n  AND d.demographic_no > 0\n  AND d.provider_no LIKE ${provider} \n) fin\n		</query>\n	</indicatorQuery>\n	<drillDownQuery>\n		<version>03-13-2018</version>\n		<params>\n			<parameter id=\"provider\" name=\"Provider Number\" value=\"loggedInProvider\" />\n			<parameter id=\"active\" name=\"Active Patients\" value=\"\'AC\'\" />\n			<parameter id=\"dxcodesICD\" name=\"Dx Codes (ICD)\" value=\"\'250%\'\" />\n                        <parameter id=\"dxcodesSysICD\" name=\"DX CodeSystem (ICD)\" value=\"\'icd9\'\" />\n                        <parameter id=\"dxcodesSnoMed\" name=\"Dx Codes (SnoMed)\" value=\"\'73211009\'\" />\n                        <parameter id=\"dxcodesSysSnoMed\" name=\"Dx CodeSystem (SnoMed)\" value=\"\'snomed%\'\" />\n			<parameter id=\"billingCode\" name=\"ICD9 Billing Code\" value=\"250\" />\n			<parameter id=\"numOfBills\" name=\"Number of ICD9 250 Bills\" value=\"2\" />\n			<parameter id=\"numOfVisits\" name=\"Number of ICD9 250 Visits\" value=\"2\" />\n                        <parameter id=\"obs1Name\" name=\"Obs 1 Name\" value=\"\'A1C\'\" />\n                        <parameter id=\"obs1Result\" name=\"Obs 1 Result\" value=\"6.5\" />\n                        <parameter id=\"obs2Name\" name=\"Obs 2 Name\" value=\"\'FBS\'\" />\n                        <parameter id=\"obs2Result\" name=\"Obs 2 Result\" value=\"7.0\" />\n                        <parameter id=\"numOfObs\" name=\"Number of measurements\" value=\"2\" />\n                        <parameter id=\"drugs\" name=\"ATC Code/Class\" value=\"A10A,A10B\" />\n                        <parameter id=\"numOfMeds\" name=\"Diabetes Medications\" value=\"1\" />			\n		</params>\n		\n		<range>\n			<lowerLimit id=\"billingdate\" label=\"From Date\" name=\"Date\" value=\"DATE_SUB( NOW(), INTERVAL 3 YEAR )\" />\n			<upperLimit id=\"billingdate\" label=\"Date Today\" name=\"Date\" value=\"NOW()\" />\n			<lowerLimit id=\"visitdate\" label=\"From Date\" name=\"Date\" value=\"DATE_SUB( NOW(), INTERVAL 3 YEAR )\" />\n                        <upperLimit id=\"visitdate\" label=\"Date Today\" name=\"Date\" value=\"NOW()\" />\n			<lowerLimit id=\"labdatelast\" label=\"From Date\" name=\"Date\" value=\"DATE_SUB( NOW(), INTERVAL 12 MONTH )\" />\n			<upperLimit id=\"labdatelast\" label=\"Date Today\" name=\"Date\" value=\"NOW()\" />\n			<lowerLimit id=\"labdateObs\" label=\"From Date\" name=\"Date\" value=\"DATE_SUB( NOW(), INTERVAL 5 YEAR )\" />\n			<upperLimit id=\"labdateObs\" label=\"Date Today\" name=\"Date\" value=\"NOW()\" />\n		</range>\n		\n		<displayColumns>\n			<column id=\"demographic\" name=\"d.demographic_no\" title=\"Patient Id\" primary=\"true\" />\n			<column id=\"name\" name=\"CONCAT( d.last_name, \', \', d.first_name )\" title=\"Patient Name\" primary=\"false\" />\n			<column id=\"dob\" name=\"DATE_FORMAT( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth), \'%m-%d-%Y\' )\" title=\"Date of Birth (mm-dd-yy)\" primary=\"false\" />\n			<column id=\"age\" name=\"TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )\" title=\"Age\" primary=\"false\" />\n			<column id=\"billings\" name=\"IFNULL( BILLING.billcount, \'\')\" title=\"Billings\" primary=\"false\" />\n			<column id=\"visits\" name=\"IFNULL( VISIT.visitcount, \'\')\" title=\"Visits\" primary=\"false\" />\n			<column id=\"lastOBS1\" name=\"IFNULL( OBS1LAST.result, \'\')\" title=\"HbA1C\" primary=\"false\" />\n			<column id=\"testDateOBS1\" name=\"IFNULL( DATE_FORMAT( OBS1LAST.dateObserved, \'%m-%d-%Y\' ), \'\')\" title=\"HbA1C Test Date (mm-dd-yyyy)\" primary=\"false\" />\n			<column id=\"numOBS1s\" name=\"IFNULL( OBS1CNT.countOBS, \'\')\" title=\"Num. HbA1C &gt;= 6.5% Last 5yrs\" primary=\"false\" />\n			<column id=\"lastOBS2\" name=\"IFNULL( OBS2LAST.result, \'\')\" title=\"FBS\" primary=\"false\" />\n			<column id=\"testDateOBS2\" name=\"IFNULL( DATE_FORMAT( OBS2LAST.dateObserved, \'%m-%d-%Y\' ), \'\')\" title=\"FBS Test Date (mm-dd-yyyy)\" primary=\"false\" />\n                        <column id=\"numOfMeds\" name=\"IFNULL( MEDS.numOfMeds, \'\')\" title=\"Diabetes Medications\" primary=\"false\" />\n		</displayColumns>\n		\n		<exportColumns>\n			<column id=\"demographic\" name=\"d.demographic_no\" title=\"Patient Id\" primary=\"true\" />\n                        <column id=\"firstName\" name=\"d.first_name\" title=\"First Name\" primary=\"false\" />\n                        <column id=\"lastName\" name=\"d.last_name\" title=\"Last Name\" primary=\"false\" />\n			<column id=\"dob\" name=\"DATE_FORMAT( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth), \'%m-%d-%Y\' )\" title=\"Date of Birth (mm-dd-yy)\" primary=\"false\" />\n			<column id=\"age\" name=\"TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )\" title=\"Age\" primary=\"false\" />\n			<column id=\"billings\" name=\"IFNULL( BILLING.billcount, \'\')\" title=\"Billings\" primary=\"false\" />\n			<column id=\"visits\" name=\"IFNULL( VISIT.visitcount, \'\')\" title=\"Visits\" primary=\"false\" />\n			<column id=\"lastOBS1\" name=\"IFNULL( OBS1LAST.result, \'\')\" title=\"HbA1C\" primary=\"false\" />\n			<column id=\"testDateOBS1\" name=\"IFNULL( DATE_FORMAT( OBS1LAST.dateObserved, \'%m-%d-%Y\' ), \'\')\" title=\"HbA1C Test Date (mm-dd-yyyy)\" primary=\"false\" />\n			<column id=\"numOBS1s\" name=\"IFNULL( OBS1CNT.countOBS, \'\')\" title=\"Num. HbA1C &gt;= 6.5% Last 5yrs\" primary=\"false\" />\n			<column id=\"lastOBS2\" name=\"IFNULL( OBS2LAST.result, \'\')\" title=\"FBS\" primary=\"false\" />\n			<column id=\"testDateOBS2\" name=\"IFNULL( DATE_FORMAT( OBS2LAST.dateObserved, \'%m-%d-%Y\' ), \'\')\" title=\"FBS Test Date (mm-dd-yyyy)\" primary=\"false\" />\n                        <column id=\"numOfMeds\" name=\"IFNULL( MEDS.numOfMeds, \'\')\" title=\"Diabetes Medications\" primary=\"false\" />\n		</exportColumns>\n		<query>	\n  SELECT *	\n  FROM demographic d \n  LEFT JOIN (\n    SELECT demographic_no, dxresearch_code, coding_system, COUNT(dxresearch_code)\n    FROM dxresearch\n    WHERE status != \'D\' AND\n    (\n      (dxresearch_code LIKE ${dxcodesICD} AND coding_system = ${dxcodesSysICD}) OR\n      (dxresearch_code = ${dxcodesSnoMed} AND coding_system LIKE ${dxcodesSysSnoMed})\n    )\n    GROUP BY demographic_no\n    ORDER BY demographic_no\n  ) dxr\n  ON d.demographic_no = dxr.demographic_no\n  -- Billed 250 in last 3 years\n  LEFT JOIN (\n    SELECT b.demographic_no AS demographic_no, b.dx_code1 AS dxcode1, b.dx_code2 AS dxcode2, b.dx_code3 AS dxcode3, COUNT(b.demographic_no) AS billcount\n    FROM billingmaster b\n    WHERE b.dx_code1 = ${billingCode} OR b.dx_code2 = ${billingCode} OR b.dx_code3 = ${billingCode}\n    AND DATE(b.createdate) > ${lowerLimit.billingdate}\n    AND b.demographic_no > 0\n    GROUP BY b.demographic_no HAVING COUNT(b.demographic_no) > -1\n  ) BILLING\n  ON (d.demographic_no = BILLING.demographic_no)\n  -- Coded 250 during visit encounter in last 3 years\n  LEFT JOIN(\n    SELECT ASSIGNED.demographic_no AS demographic_no, observation_date AS visitdate, uuid, COUNT(ASSIGNED.demographic_no) AS visitcount\n    FROM casemgmt_note note\n    INNER JOIN (\n      SELECT note_id, CODED.demo_no AS demographic_no FROM casemgmt_issue_notes\n      INNER JOIN (\n        SELECT ci.id AS id, ci.update_date, ci.demographic_no demo_no FROM issue i\n        INNER JOIN casemgmt_issue ci\n        ON i.issue_id = ci.issue_id\n        WHERE\n        (i.type LIKE ${dxcodesSysICD} AND i.code LIKE ${dxcodesICD}) OR\n        (i.type LIKE ${dxcodesSysSnoMed} AND i.code = ${dxcodesSnoMed})\n      ) CODED\n      ON (casemgmt_issue_notes.id = CODED.id)\n      ORDER BY CODED.demo_no\n    ) ASSIGNED\n    ON note.note_id = ASSIGNED.note_id AND\n    -- GET LAST REVISION OF NOTE\n    note.note_id= (SELECT MAX(cmn.note_id) FROM casemgmt_note cmn WHERE cmn.uuid = note.uuid) AND\n    DATE(note.observation_date) > ${lowerLimit.visitdate}\n    GROUP BY demographic_no\n    ORDER BY demographic_no\n  ) VISIT\n  ON (d.demographic_no = VISIT.demographic_no)\n  -- HbA1C measurement\n  LEFT JOIN ( \n    SELECT m.demographicNo AS demographic_no, m.dataField AS result, m.dateObserved AS dateObserved\n    FROM measurements m\n    INNER JOIN (\n      SELECT demographicNo, MAX(dateObserved) AS dateObserved\n      FROM measurements\n      WHERE type = ${obs1Name}\n      GROUP BY demographicNo\n    ) mlast\n    ON m.demographicNo = mlast.demographicNo\n    WHERE m.type = ${obs1Name}\n    AND m.dateObserved = mlast.dateObserved\n    AND DATE(m.dateObserved) &gt; ${lowerLimit.labdatelast}\n    AND m.demographicNo &gt; 0\n  ) OBS1LAST\n  ON (d.demographic_no = OBS1LAST.demographic_no) \n  -- Fasting Glucose measurement\n  LEFT JOIN ( \n    SELECT m.demographicNo AS demographic_no, m.dataField AS result, m.dateObserved AS dateObserved\n    FROM measurements m\n    INNER JOIN (\n      SELECT demographicNo, MAX(dateObserved) AS dateObserved\n      FROM measurements\n      WHERE type = ${obs2Name}\n      GROUP BY demographicNo\n    ) mlast\n    ON m.demographicNo = mlast.demographicNo\n    WHERE m.type = ${obs2Name}\n    AND m.dateObserved = mlast.dateObserved\n    AND DATE(m.dateObserved) &gt; ${lowerLimit.labdatelast}\n    AND m.demographicNo &gt; 0\n  ) OBS2LAST\n  ON (d.demographic_no = OBS2LAST.demographic_no)\n  LEFT JOIN ( \n    SELECT m.demographicNo AS demographic_no, m.dataField, COUNT(m.dataField) AS countOBS\n    FROM measurements m\n    WHERE m.type = ${obs1Name}\n    AND m.dataField &gt;= ${obs1Result}\n    AND DATE(m.dateObserved) &gt; ${lowerLimit.labdateObs}\n    AND m.demographicNo &gt; 0\n    GROUP BY m.demographicNo HAVING COUNT(m.demographicNo) &gt; -1\n  ) OBS1CNT\n  ON (d.demographic_no = OBS1CNT.demographic_no)\n  LEFT JOIN (\n    SELECT dr.demographic_no, COUNT(DISTINCT dr.atc) AS numOfMeds FROM drugs AS dr\n--    WHERE dr.archived = 0 AND LEFT(dr.ATC,4) IN ${drugs}\n    WHERE dr.archived = 0 AND dr.ATC LIKE \'A10%\'\n    AND (dr.long_term OR (dr.rx_date &lt;= NOW() AND (DATE_ADD(dr.rx_date, INTERVAL(DATEDIFF(dr.end_date,dr.rx_date)*1.0) DAY)) >= NOW()))\n    GROUP BY dr.demographic_no\n  ) MEDS\n  ON (d.demographic_no = MEDS.demographic_no)\n  WHERE d.patient_status LIKE ${active}\n  AND d.demographic_no > 0\n  AND (\n    dxr.dxresearch_code IS NULL AND\n    ( (BILLING.billcount IS NOT NULL AND BILLING.billcount &gt;= ${numOfBills})  OR\n      (VISIT.visitcount IS NOT NULL AND VISIT.visitcount &gt;= ${numOfVisits}) OR\n      ( (OBS1LAST.result IS NOT NULL AND (OBS1LAST.result &gt; ${obs1Result} OR (OBS1LAST.result &gt; 0.01*${obs1Result} AND OBS1LAST.result &lt; 1))) OR\n        (OBS2LAST.result IS NOT NULL AND OBS2LAST.result &gt; ${obs2Result} ) OR\n        (OBS1CNT.countOBS IS NOT NULL AND OBS1CNT.countOBS &gt;= ${numOfObs}) OR\n        (MEDS.numOfMeds IS NOT NULL AND MEDS.numOfMeds &gt;= ${numOfMeds})\n      )\n    )\n  )\n  AND d.provider_no LIKE ${provider}\n  ORDER BY d.demographic_no\n		</query>\n	</drillDownQuery>\n</indicatorTemplateXML>\n','','\0',0,NULL,NULL),
(30,4,'Diabetes Prevalence','CDM','Diabetes','DoBC CPQI PSP Panel','2017-08-02','% of active patients in the practice coded with Diabetes.','\ni) Diabetes patients: \"Patient Status: Active\nAND has a Current Problem List/Profile item code of 73211009 OR starting with 250\"\nii) Other patients: \"Patient Status: Active\nAND does not have a Current Problem List/Profile item code of 73211009 OR startin','<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<indicatorTemplateXML>\n	<author>OSCAR BC</author>\n	<uid></uid>\n	<heading>\n		<category>CDM</category>\n		<subCategory>Diabetes</subCategory>\n		<name>Diabetes Prevalence</name>\n		<definition>% of active patients in the practice coded with Diabetes.</definition>\n		<framework>DoBC CPQI PSP Panel</framework>\n		<frameworkVersion>08-02-2017</frameworkVersion>\n		<notes>\ni) Diabetes patients: \"Patient Status: Active\nAND has a Current Problem List/Profile item code of 73211009 OR starting with 250\"\nii) Other patients: \"Patient Status: Active\nAND does not have a Current Problem List/Profile item code of 73211009 OR starting with 250\"\n		</notes>\n	</heading>\n	<indicatorQuery>\n		<version>03-13-2018</version>\n		<params>\n			<!-- \n				Required parameter provider. Value options are: \n					[ an individual providerNo, or provider range ] ie: value=\"370, 1001\" \n					\"all\" ie: value=\"all\" including null.\n					\"loggedInProvider\" ie:\n				Default is \"loggedInProvider\"\n				Use this parameter in the query as ${provider}\n				This parameter should be used for fetching patient\'s assigned to a MRP.\n				ie: WHERE demographic.provider_no = ${provider}\n			-->\n			<parameter id=\"provider\" name=\"provider_no\" value=\"loggedInProvider\" />\n			<parameter id=\"pstatus\" name=\"Patient Status\" value=\"\'AC\'\" />\n			<parameter id=\"dxcodesICD\" name=\"Dx Codes (ICD)\" value=\"250\" />\n			<parameter id=\"dxcodesSysICD\" name=\"DX CodeSystem (ICD)\" value=\"\'icd9\'\" />\n			<parameter id=\"dxcodesSnoMed\" name=\"Dx Codes (SnoMed)\" value=\"73211009\" />\n			<parameter id=\"dxcodesSysSnoMed\" name=\"Dx CodeSystem (SnoMed)\" value=\"\'snomed%\'\" />\n		</params>\n		<query>\n			<!-- Indicator SQL Query here -->\nSELECT\n -- PERCENT OF TOTAL PATIENTS NOTED AS ACTIVE WITH CURRENT DIABETES\n IF( COUNT(fin.patient) > 0, SUM( IF( dxresearch_code is not NULL , 1, 0) ) , 0 ) AS \"% Active, Current Diabetes\",\n -- PERCENT OF TOTAL PATIENTS NOTED AS ACTIVE WITHOUT CURRENT DIABETES\n IF( COUNT(fin.patient) > 0, SUM( IF( dxresearch_code is NULL , 1, 0) ) , 0 ) AS \"% Active, No Current Diabetes\"\nFROM (\n SELECT d.demographic_no AS patient, d.patient_status AS pt_status, dxresearch_code\n FROM demographic d\n LEFT JOIN (\n  SELECT demographic_no, dxresearch_code, count(dxresearch_code)\n  FROM dxresearch\n  WHERE status=\'A\' AND\n  (\n   (LEFT(dxresearch_code, 3) IN (\'250\') AND coding_system = ${dxcodesSysICD}) OR\n   (dxresearch_code IN (\'73211009\') AND coding_system LIKE ${dxcodesSysSnoMed})\n   )\n  GROUP BY demographic_no\n  ORDER BY demographic_no\n ) problems\n ON d.demographic_no = problems.demographic_no\n WHERE d.provider_no LIKE ${provider} AND d.patient_status = ${pstatus}\n) fin\n		</query>\n	</indicatorQuery>\n	<drillDownQuery>\n		<version>03-13-2018</version>\n		<params>\n			<parameter id=\"provider\" name=\"provider_no\" value=\"loggedInProvider\" />	\n			<parameter id=\"pstatus\" name=\"Patient Status\" value=\"\'AC\'\" />\n			<parameter id=\"dxcodesICD\" name=\"Dx Codes (ICD)\" value=\"250\" />\n			<parameter id=\"dxcodesSysICD\" name=\"DX CodeSystem (ICD)\" value=\"\'icd9\'\" />\n			<parameter id=\"dxcodesSnoMed\" name=\"Dx Codes (SnoMed)\" value=\"73211009\" />\n			<parameter id=\"dxcodesSysSnoMed\" name=\"Dx CodeSystem (SnoMed)\" value=\"\'snomed%\'\" />\n		</params>\n		<displayColumns>\n			<column id=\"demographic\" name=\"d.demographic_no\" title=\"Patient Id\" primary=\"true\" />\n			<column id=\"name\" name=\"CONCAT( d.last_name, \', \', d.first_name )\" title=\"Patient Name\" primary=\"false\" />\n			<column id=\"dob\" name=\"DATE_FORMAT( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth), \'%m-%d-%Y\' )\" title=\"Date of Birth (mm-dd-yy)\" primary=\"false\" />\n			<column id=\"age\" name=\"TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )\" title=\"Age\" primary=\"false\" />\n			<column id=\"dxcode\" title=\"Dx System/Code\" name=\"CONCAT(MIN(dxr.coding_system),\'/\',MIN(dxr.dxresearch_code),IF( MIN(dxr.dxresearch_code) != MAX(dxr.dxresearch_code),CONCAT( \' &amp; \', MAX(dxr.coding_system), \'/\', MAX(dxr.dxresearch_code) ),\'\') )\" primary=\"false\" />\n		</displayColumns>\n		<exportColumns>\n			<column id=\"demographic\" name=\"d.demographic_no\" title=\"Patient Id\" primary=\"true\" />\n			<column id=\"firstName\" name=\"d.first_name\" title=\"First Name\" primary=\"false\" />\n			<column id=\"lastName\" name=\"d.last_name\" title=\"Last Name\" primary=\"false\" />\n			<column id=\"dob\" name=\"DATE_FORMAT( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth), \'%m-%d-%Y\' )\" title=\"Date of Birth (mm-dd-yy)\" primary=\"false\" />\n			<column id=\"age\" name=\"TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )\" title=\"Age\" primary=\"false\" />\n			<column id=\"dxcode\" title=\"Dx System/Code\" name=\"CONCAT(MIN(dxr.coding_system),\'/\',MIN(dxr.dxresearch_code),IF( MIN(dxr.dxresearch_code) != MAX(dxr.dxresearch_code),CONCAT( \' &amp; \', MAX(dxr.coding_system), \'/\', MAX(dxr.dxresearch_code) ),\'\') )\" primary=\"false\" />\n		</exportColumns>\n		<query>\n			<!-- Drilldown SQL Query here -->\nSELECT\n*			\nFROM demographic d\nLEFT JOIN dxresearch dxr\nON d.demographic_no = dxr.demographic_no\nWHERE d.patient_status=${pstatus}\nAND\n(\n (LEFT(dxr.dxresearch_code, 3) IN (\'250\') AND dxr.coding_system = ${dxcodesSysICD}) OR\n (dxr.dxresearch_code IN (\'73211009\') AND dxr.coding_system LIKE ${dxcodesSysSnoMed})\n )\nAND dxr.status = \'A\'\nAND d.provider_no LIKE ${provider}\nGROUP BY d.demographic_no\nORDER BY COUNT(d.demographic_no) DESC, d.demographic_no\n		</query>\n	</drillDownQuery>\n</indicatorTemplateXML>\n','','\0',0,NULL,NULL),
(31,4,'Consider Heart Failure','CDM','Heart Failure','DoBC CPQI PSP Panel','2017-08-02','\n			Patients with heart failure dx in 2+ bills or 2+ visit encounters within last 3 years or LVEF < 40 OR BNP > 400 OR Current Digoxin OR Metolazone medication\n		','\n		  Created for Doctors of BC\n		  i) HF dx in 2+ bills: \"Patient Status: Active\nAND does not have a Current Problem List/Profile item code of 84114007 OR starting with 428\nAND with >= 2 Bills with the ICD9 diagnosis code starting with 428 in the last 3 y','<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<indicatorTemplateXML>\n	<author>OSCAR BC</author>\n	<uid></uid>\n	<heading>\n		<category>CDM</category>\n		<subCategory>Heart Failure</subCategory>\n		<name>Consider Heart Failure</name>\n		<definition>\n			Patients with heart failure dx in 2+ bills or 2+ visit encounters within last 3 years or LVEF &lt; 40 OR BNP &gt; 400 OR Current Digoxin OR Metolazone medication\n		</definition>\n		<framework>DoBC CPQI PSP Panel</framework>\n		<frameworkVersion>08-02-2017</frameworkVersion>\n		<notes>\n		  Created for Doctors of BC\n		  i) HF dx in 2+ bills: \"Patient Status: Active\nAND does not have a Current Problem List/Profile item code of 84114007 OR starting with 428\nAND with >= 2 Bills with the ICD9 diagnosis code starting with 428 in the last 3 years\"\n		  ii) HF dx in 2+ visits: \"Patient Status: Active\nAND does not have a Current Problem List/Profile item code of 84114007 OR starting with 428\nAND with >= 2 Visit Encounters with Snomed diagnosis code 84114007 or the ICD9 diagnosis code starting with 428 in the last 3 years\"\n		  iii) LVEF &lt; 40 OR BNP &gt; 400 OR Current Digoxin OR Metolazone medication: \"Patient Status: Active\nAND does not have a Current Problem List/Profile item code of 84114007 OR starting with 428\nAND ( has an LVEF (Left ventricular ejection fraction) observation and value &lt; 40 OR a BNP observation and value &gt; 400 OR Current Digoxin medication (ATC code C01AA05) OR Current Metolazone medication (ATC code C03BA08)\"\n		</notes>\n	</heading>\n	<indicatorQuery>\n		<version>03-13-2018</version>\n		<params>\n			<parameter id=\"provider\" name=\"Provider Number\" value=\"loggedInProvider\" />\n			<parameter id=\"active\" name=\"Active Patients\" value=\"\'AC\'\" />\n			<parameter id=\"dxcodesICD\" name=\"Dx Codes (ICD)\" value=\"\'428%\'\" />\n                        <parameter id=\"dxcodesSysICD\" name=\"DX CodeSystem (ICD)\" value=\"\'icd9\'\" />\n                        <parameter id=\"dxcodesSnoMed\" name=\"Dx Codes (SnoMed)\" value=\"\'84114007\'\" />\n                        <parameter id=\"dxcodesSysSnoMed\" name=\"Dx CodeSystem (SnoMed)\" value=\"\'snomed%\'\" />\n			<parameter id=\"billingCode\" name=\"ICD9 Billing Code\" value=\"428\" />\n			<parameter id=\"numOfBills\" name=\"Number of ICD9 428 Bills\" value=\"2\" />\n			<parameter id=\"numOfVisits\" name=\"Number of Visit Encounters coded 428/ICD9\" value=\"2\" />\n                        <parameter id=\"obs1Name\" name=\"Obs 1 Name\" value=\"\'LVEF\'\" />\n                        <parameter id=\"obs1Result\" name=\"Obs 1 Result\" value=\"40\" />\n                        <parameter id=\"obs2Name\" name=\"Obs 2 Name\" value=\"\'BNP\'\" />\n                        <parameter id=\"obs2Result\" name=\"Obs 2 Result\" value=\"400\" />\n			<parameter id=\"drugs\" name=\"ATC Code/Class\" value=\"C01AA05,C03BA08\" />\n			<parameter id=\"numOfMeds\" name=\"Heart Failure Medications\" value=\"1\" />\n		</params>\n		<range>\n			<lowerLimit id=\"billingdate\" label=\"From Date\" name=\"Date\" value=\"DATE_SUB( NOW(), INTERVAL 3 YEAR )\" />\n			<upperLimit id=\"billingdate\" label=\"Date Today\" name=\"Date\" value=\"NOW()\" />\n			<lowerLimit id=\"visitdate\" label=\"From Date\" name=\"Date\" value=\"DATE_SUB( NOW(), INTERVAL 3 YEAR )\" />\n			<upperLimit id=\"visitdate\" label=\"Date Today\" name=\"Date\" value=\"NOW()\" />\n		</range>\n		<query>\nSELECT\n  IF ( COUNT(fin.patient) &gt; 0, SUM( CASE WHEN (fin.dx IS NULL AND fin.billcount &gt;= ${numOfBills}) THEN 1 ELSE 0 END ) , 0) AS \"HF dx in ${numOfBills}+ bills\",\n  IF ( COUNT(fin.patient) &gt; 0, SUM( CASE WHEN (fin.dx IS NULL AND fin.visitcount &gt;= ${numOfVisits}) THEN 1 ELSE 0 END ) , 0) AS \"HF dx in ${numOfVisits}+ visits\",\n  IF ( COUNT(fin.patient) &gt; 0, SUM( CASE WHEN (fin.dx IS NULL AND ( fin.result1 &lt; ${obs1Result} OR fin.result2 &gt; ${obs2Result} OR fin.medcount &gt;= ${numOfMeds})) THEN 1 ELSE 0 END ) , 0) AS \"LVEF &lt; ${obs1Result} OR BNP &gt; ${obs2Result} OR current Digoxin/Metolazone\"\nFROM ( \n  SELECT \n    d.demographic_no AS patient, \n    BILLING.billcount AS billcount,\n    VISIT.visitcount AS visitcount,\n    OBS1LAST.result AS result1,\n    OBS2LAST.result AS result2,\n    MEDS.numOfMeds AS medcount,\n    dxr.dxresearch_code AS dx,\n    dxr.coding_system AS dxs\n  FROM demographic d \n  LEFT JOIN (\n    SELECT demographic_no, dxresearch_code, coding_system, count(dxresearch_code)\n    FROM dxresearch\n    WHERE status=\'A\' AND\n    (\n      (dxresearch_code LIKE ${dxcodesICD} AND coding_system = ${dxcodesSysICD}) OR\n      (dxresearch_code = ${dxcodesSnoMed} AND coding_system LIKE ${dxcodesSysSnoMed})\n    )\n    GROUP BY demographic_no\n    ORDER BY demographic_no\n  ) dxr\n  ON d.demographic_no = dxr.demographic_no\n  -- Billed 428 in last 3 years\n  LEFT JOIN (\n    SELECT b.demographic_no as demographic_no, b.dx_code1 as dxcode1, b.dx_code2 as dxcode2, b.dx_code3 as dxcode3, count(b.demographic_no) as billcount\n    FROM billingmaster b\n    WHERE b.dx_code1 = ${billingCode} OR b.dx_code2 = ${billingCode} OR b.dx_code3 = ${billingCode}\n    AND DATE(b.createdate) > ${lowerLimit.billingdate}\n    AND b.demographic_no > 0\n    GROUP BY b.demographic_no HAVING COUNT(b.demographic_no) > -1\n  ) BILLING\n  ON (d.demographic_no = BILLING.demographic_no)  \n  -- Coded 428 during visit encounter in last 3 years\n  LEFT JOIN(\n    SELECT ASSIGNED.demographic_no as demographic_no, observation_date as visitdate, uuid, count(ASSIGNED.demographic_no) as visitcount\n    FROM casemgmt_note note\n    INNER JOIN (\n      SELECT note_id, CODED.demo_no as demographic_no FROM casemgmt_issue_notes\n      INNER JOIN (\n        SELECT ci.id as id, ci.update_date, ci.demographic_no demo_no FROM issue i\n        INNER JOIN casemgmt_issue ci\n        ON i.issue_id = ci.issue_id\n        WHERE\n	(i.type like ${dxcodesSysICD} and i.code like ${dxcodesICD}) OR\n	(i.type like ${dxcodesSysSnoMed} and i.code = ${dxcodesSnoMed})\n      ) CODED\n      ON (casemgmt_issue_notes.id = CODED.id)\n      ORDER BY CODED.demo_no\n    ) ASSIGNED\n    ON note.note_id = ASSIGNED.note_id AND\n    -- GET LAST REVISION OF NOTE\n    note.note_id= (SELECT MAX(cmn.note_id) FROM casemgmt_note cmn WHERE cmn.uuid = note.uuid) AND\n    DATE(note.observation_date) > ${lowerLimit.visitdate}\n    GROUP BY demographic_no\n    ORDER BY demographic_no\n  ) VISIT\n  ON (d.demographic_no = VISIT.demographic_no)  \n  -- LVEF measurement\n  LEFT JOIN ( \n    SELECT m.demographicNo AS demographic_no, m.dataField as result, m.dateObserved AS dateObserved\n    FROM measurements m\n    INNER JOIN (\n      SELECT demographicNo, MAX(dateObserved) AS dateObserved\n      FROM measurements\n      WHERE type = ${obs1Name}\n      GROUP BY demographicNo\n    ) mlast\n    ON m.demographicNo = mlast.demographicNo\n    WHERE m.type = ${obs1Name}\n    AND m.dataField NOT LIKE \'>%\'\n    AND m.dateObserved = mlast.dateObserved\n    AND m.demographicNo &gt; 0\n    GROUP BY m.demographicNo HAVING COUNT(m.demographicNo) &gt; -1\n  ) OBS1LAST\n  ON (d.demographic_no = OBS1LAST.demographic_no) \n  LEFT JOIN ( \n    SELECT m.demographicNo AS demographic_no, m.dataField as result, m.dateObserved AS dateObserved\n    FROM measurements m\n    INNER JOIN (\n      SELECT demographicNo, MAX(dateObserved) AS dateObserved\n      FROM measurements\n      WHERE type = ${obs2Name}\n      GROUP BY demographicNo\n    ) mlast\n    ON m.demographicNo = mlast.demographicNo\n    WHERE m.type = ${obs2Name}\n    AND m.dateObserved = mlast.dateObserved\n    AND m.demographicNo &gt; 0\n    GROUP BY m.demographicNo HAVING COUNT(m.demographicNo) &gt; -1\n  ) OBS2LAST\n  ON (d.demographic_no = OBS2LAST.demographic_no)\n  LEFT JOIN (\n    SELECT dr.demographic_no, count(DISTINCT dr.atc) AS numOfMeds FROM drugs AS dr\n    WHERE dr.archived = 0 AND dr.ATC IN ${drugs}\n    AND (dr.long_term OR (dr.rx_date &lt;= NOW() AND (DATE_ADD(dr.rx_date, INTERVAL(DATEDIFF(dr.end_date,dr.rx_date)*1.0) DAY)) >= NOW()))\n    GROUP BY dr.demographic_no\n  ) MEDS\n  ON (d.demographic_no = MEDS.demographic_no) \n  WHERE d.patient_status LIKE ${active}\n  AND d.demographic_no > 0\n  AND d.provider_no LIKE ${provider} \n) fin\n		</query>\n	</indicatorQuery>\n	<drillDownQuery>\n		<version>03-13-2018</version>\n		<params>\n			<parameter id=\"provider\" name=\"Provider Number\" value=\"loggedInProvider\" />\n			<parameter id=\"active\" name=\"Active Patients\" value=\"\'AC\'\" />\n			<parameter id=\"dxcodesICD\" name=\"Dx Codes (ICD)\" value=\"\'428%\'\" />\n                        <parameter id=\"dxcodesSysICD\" name=\"DX CodeSystem (ICD)\" value=\"\'icd9\'\" />\n                        <parameter id=\"dxcodesSnoMed\" name=\"Dx Codes (SnoMed)\" value=\"\'84114007\'\" />\n                        <parameter id=\"dxcodesSysSnoMed\" name=\"Dx CodeSystem (SnoMed)\" value=\"\'snomed%\'\" />\n			<parameter id=\"billingCode\" name=\"ICD9 Billing Code\" value=\"428\" />\n			<parameter id=\"numOfBills\" name=\"Number of ICD9 428 Bills\" value=\"2\" />\n			<parameter id=\"numOfVisits\" name=\"Number of Visit Encounters coded 428/ICD9\" value=\"2\" />\n                        <parameter id=\"obs1Name\" name=\"Obs 1 Name\" value=\"\'LVEF\'\" />\n                        <parameter id=\"obs1Result\" name=\"Obs 1 Result\" value=\"40\" />\n                        <parameter id=\"obs2Name\" name=\"Obs 2 Name\" value=\"\'BNP\'\" />\n                        <parameter id=\"obs2Result\" name=\"Obs 2 Result\" value=\"400\" />\n			<parameter id=\"drugs\" name=\"ATC Code/Class\" value=\"C01AA05,C03BA08\" />\n			<parameter id=\"numOfMeds\" name=\"Heart Failure Medications\" value=\"1\" />\n		</params>\n		\n		<range>\n			<lowerLimit id=\"billingdate\" label=\"From Date\" name=\"Date\" value=\"DATE_SUB( NOW(), INTERVAL 3 YEAR )\" />\n			<upperLimit id=\"billingdate\" label=\"Date Today\" name=\"Date\" value=\"NOW()\" />\n			<lowerLimit id=\"visitdate\" label=\"From Date\" name=\"Date\" value=\"DATE_SUB( NOW(), INTERVAL 3 YEAR )\" />\n			<upperLimit id=\"visitdate\" label=\"Date Today\" name=\"Date\" value=\"NOW()\" />\n		</range>\n		\n		<displayColumns>\n			<column id=\"demographic\" name=\"d.demographic_no\" title=\"Patient Id\" primary=\"true\" />\n			<column id=\"name\" name=\"CONCAT( d.last_name, \', \', d.first_name )\" title=\"Patient Name\" primary=\"false\" />\n			<column id=\"dob\" name=\"DATE_FORMAT( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth), \'%m-%d-%Y\' )\" title=\"Date of Birth\" primary=\"false\" />\n			<column id=\"age\" name=\"TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )\" title=\"Age\" primary=\"false\" />\n			<column id=\"billings\" name=\"IFNULL( BILLING.billcount, \'0\')\" title=\"Billings\" primary=\"false\" />\n			<column id=\"visits\" name=\"IFNULL( VISIT.visitcount, \'0\')\" title=\"Visits\" primary=\"false\" />\n			<column id=\"obs1last\" name=\"IFNULL( OBS1LAST.result, \'NA\')\" title=\"LVEF\" primary=\"false\" />\n			<column id=\"obs2last\" name=\"IFNULL( OBS2LAST.result, \'NA\')\" title=\"BNP\" primary=\"false\" />\n			<column id=\"numOfMeds\" name=\"IFNULL( MEDS.numOfMeds, \'NA\')\" title=\"Digoxin/Metolazone Medications\" primary=\"false\" />\n		</displayColumns>\n		\n		<exportColumns>\n			<column id=\"demographic\" name=\"d.demographic_no\" title=\"Patient Id\" primary=\"true\" />\n                        <column id=\"firstName\" name=\"d.first_name\" title=\"First Name\" primary=\"false\" />\n                        <column id=\"lastName\" name=\"d.last_name\" title=\"Last Name\" primary=\"false\" />\n			<column id=\"dob\" name=\"DATE_FORMAT( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth), \'%m-%d-%Y\' )\" title=\"Date of Birth\" primary=\"false\" />\n			<column id=\"age\" name=\"TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )\" title=\"Age\" primary=\"false\" />\n			<column id=\"billings\" name=\"IFNULL( BILLING.billcount, \'0\')\" title=\"Billings\" primary=\"false\" />\n			<column id=\"visits\" name=\"IFNULL( VISIT.visitcount, \'0\')\" title=\"Visits\" primary=\"false\" />\n			<column id=\"obs1last\" name=\"IFNULL( OBS1LAST.result, \'NA\')\" title=\"LVEF\" primary=\"false\" />\n			<column id=\"obs2last\" name=\"IFNULL( OBS2LAST.result, \'NA\')\" title=\"BNP\" primary=\"false\" />\n			<column id=\"numOfMeds\" name=\"IFNULL( MEDS.numOfMeds, \'NA\')\" title=\"Digoxin/Metolazone Medications\" primary=\"false\" />\n		</exportColumns>\n		<query>	\n  SELECT *	\n  FROM demographic d \n  LEFT JOIN (\n    SELECT demographic_no, dxresearch_code, coding_system, count(dxresearch_code)\n    FROM dxresearch\n    WHERE status=\'A\' AND\n    (\n      (dxresearch_code LIKE ${dxcodesICD} AND coding_system = ${dxcodesSysICD}) OR\n      (dxresearch_code = ${dxcodesSnoMed} AND coding_system LIKE ${dxcodesSysSnoMed})\n    )\n    GROUP BY demographic_no\n    ORDER BY demographic_no\n  ) dxr\n  ON d.demographic_no = dxr.demographic_no\n  -- Billed 428 in last 3 years\n  LEFT JOIN (\n    SELECT b.demographic_no as demographic_no, b.dx_code1 as dxcode1, b.dx_code2 as dxcode2, b.dx_code3 as dxcode3, count(b.demographic_no) as billcount\n    FROM billingmaster b\n    WHERE b.dx_code1 = ${billingCode} OR b.dx_code2 = ${billingCode} OR b.dx_code3 = ${billingCode}\n    AND DATE(b.createdate) > ${lowerLimit.billingdate}\n    AND b.demographic_no > 0\n    GROUP BY b.demographic_no HAVING COUNT(b.demographic_no) > -1\n  ) BILLING\n  ON (d.demographic_no = BILLING.demographic_no)  \n  -- Coded 428 during visit encounter in last 3 years\n  LEFT JOIN(\n    SELECT ASSIGNED.demographic_no as demographic_no, observation_date as visitdate, uuid, count(ASSIGNED.demographic_no) as visitcount\n    FROM casemgmt_note note\n    INNER JOIN (\n      SELECT note_id, CODED.demo_no as demographic_no FROM casemgmt_issue_notes\n      INNER JOIN (\n        SELECT ci.id as id, ci.update_date, ci.demographic_no demo_no FROM issue i\n        INNER JOIN casemgmt_issue ci\n        ON i.issue_id = ci.issue_id\n        WHERE\n	(i.type like ${dxcodesSysICD} and i.code like ${dxcodesICD}) OR\n	(i.type like ${dxcodesSysSnoMed} and i.code = ${dxcodesSnoMed})\n      ) CODED\n      ON (casemgmt_issue_notes.id = CODED.id)\n      ORDER BY CODED.demo_no\n    ) ASSIGNED\n    ON note.note_id = ASSIGNED.note_id AND\n    -- GET LAST REVISION OF NOTE\n    note.note_id= (SELECT MAX(cmn.note_id) FROM casemgmt_note cmn WHERE cmn.uuid = note.uuid) AND\n    DATE(note.observation_date) > ${lowerLimit.visitdate}\n    GROUP BY demographic_no\n    ORDER BY demographic_no\n  ) VISIT\n  ON (d.demographic_no = VISIT.demographic_no)  \n  -- LVEF measurement\n  LEFT JOIN ( \n    SELECT m.demographicNo AS demographic_no, m.dataField as result, m.dateObserved AS dateObserved\n    FROM measurements m\n    INNER JOIN (\n      SELECT demographicNo, MAX(dateObserved) AS dateObserved\n      FROM measurements\n      WHERE type = ${obs1Name}\n      GROUP BY demographicNo\n    ) mlast\n    ON m.demographicNo = mlast.demographicNo\n    WHERE m.type = ${obs1Name}\n    AND m.dataField NOT LIKE \'>%\'\n    AND m.dateObserved = mlast.dateObserved\n    AND m.demographicNo &gt; 0\n    GROUP BY m.demographicNo HAVING COUNT(m.demographicNo) &gt; -1\n  ) OBS1LAST\n  ON (d.demographic_no = OBS1LAST.demographic_no) \n  LEFT JOIN ( \n    SELECT m.demographicNo AS demographic_no, m.dataField as result, m.dateObserved AS dateObserved\n    FROM measurements m\n    INNER JOIN (\n      SELECT demographicNo, MAX(dateObserved) AS dateObserved\n      FROM measurements\n      WHERE type = ${obs2Name}\n      GROUP BY demographicNo\n    ) mlast\n    ON m.demographicNo = mlast.demographicNo\n    WHERE m.type = ${obs2Name}\n    AND m.dateObserved = mlast.dateObserved\n    AND m.demographicNo &gt; 0\n    GROUP BY m.demographicNo HAVING COUNT(m.demographicNo) &gt; -1\n  ) OBS2LAST\n  ON (d.demographic_no = OBS2LAST.demographic_no)\n    LEFT JOIN (\n    SELECT dr.demographic_no, count(DISTINCT dr.atc) AS numOfMeds FROM drugs AS dr\n    WHERE dr.archived = 0 AND dr.ATC IN ${drugs}\n    AND (dr.long_term OR (dr.rx_date &lt;= NOW() AND (DATE_ADD(dr.rx_date, INTERVAL(DATEDIFF(dr.end_date,dr.rx_date)*1.0) DAY)) >= NOW()))\n    GROUP BY dr.demographic_no\n  ) MEDS\n  ON (d.demographic_no = MEDS.demographic_no)\n  WHERE d.patient_status LIKE ${active}\n  AND d.demographic_no > 0\n  AND dxr.dxresearch_code IS NULL AND (\n    (BILLING.billcount IS NOT NULL AND BILLING.billcount &gt;= ${numOfBills}) OR\n    (VISIT.visitcount IS NOT NULL AND VISIT.visitcount &gt;= ${numOfVisits}) OR\n    ((OBS1LAST.result IS NOT NULL AND OBS1LAST.result &lt; ${obs1Result}) OR (OBS2LAST.result IS NOT NULL AND OBS2LAST.result &gt; ${obs2Result}) OR (MEDS.numOfMeds IS NOT NULL AND MEDS.numOfMeds &gt;= ${numOfMeds}) ))\n  AND d.provider_no LIKE ${provider}\n  ORDER BY d.demographic_no\n		</query>\n	</drillDownQuery>\n</indicatorTemplateXML>\n','','\0',0,NULL,NULL),
(32,4,'Heart Failure Prevalence','CDM','Heart Failure','DoBC CPQI PSP Panel','2017-08-02','% of active patients in the practice coded with Heart Failure.','\ni) HF patients: \"Patient Status: Active\nAND has a Current Problem List/Profile item code of 84114007 OR starting with 428\"\nii) Other patients: \"Patient Status: Active\nAND does not have a Current Problem List/Profile item code of 84114007 OR starting with','<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<indicatorTemplateXML>\n	<author>OSCAR BC</author>\n	<uid></uid>\n	<heading>\n		<category>CDM</category>\n		<subCategory>Heart Failure</subCategory>\n		<name>Heart Failure Prevalence</name>\n		<definition>% of active patients in the practice coded with Heart Failure.</definition>\n		<framework>DoBC CPQI PSP Panel</framework>\n		<frameworkVersion>08-02-2017</frameworkVersion>\n		<notes>\ni) HF patients: \"Patient Status: Active\nAND has a Current Problem List/Profile item code of 84114007 OR starting with 428\"\nii) Other patients: \"Patient Status: Active\nAND does not have a Current Problem List/Profile item code of 84114007 OR starting with 428\"\n		</notes>\n	</heading>\n	<indicatorQuery>\n		<version>03-13-2018</version>\n		<params>\n			<!-- \n				Required parameter provider. Value options are: \n					[ an individual providerNo, or provider range ] ie: value=\"370, 1001\" \n					\"all\" ie: value=\"all\" including null.\n					\"loggedInProvider\" ie:\n				Default is \"loggedInProvider\"\n				Use this parameter in the query as ${provider}\n				This parameter should be used for fetching patient\'s assigned to a MRP.\n				ie: WHERE demographic.provider_no = ${provider}\n			-->\n			<parameter id=\"provider\" name=\"provider_no\" value=\"loggedInProvider\" />\n			<parameter id=\"pstatus\" name=\"Patient Status\" value=\"\'AC\'\" />\n			<parameter id=\"dxcodesICD\" name=\"Dx Codes (ICD)\" value=\"428\" />\n			<parameter id=\"dxcodesSysICD\" name=\"DX CodeSystem (ICD)\" value=\"\'icd9\'\" />\n			<parameter id=\"dxcodesSnoMed\" name=\"Dx Codes (SnoMed)\" value=\"84114007\" />\n			<parameter id=\"dxcodesSysSnoMed\" name=\"Dx CodeSystem (SnoMed)\" value=\"\'snomed%\'\" />\n		</params>\n		<query>\n			<!-- Indicator SQL Query here -->\nSELECT\n -- PERCENT OF TOTAL PATIENTS NOTED AS ACTIVE WITH CURRENT HEART FAILURE\n IF( COUNT(fin.patient) > 0, SUM( IF( dxresearch_code is not NULL , 1, 0) ) , 0 ) AS \"% Active, Current Heart Failure\",\n -- PERCENT OF TOTAL PATIENTS NOTED AS ACTIVE WITHOUT CURRENT HEART FAILURE\n IF( COUNT(fin.patient) > 0, SUM( IF( dxresearch_code is NULL , 1, 0) ) , 0 ) AS \"% Active, No Current Heart Failure\"\nFROM (\n SELECT d.demographic_no AS patient, d.patient_status AS pt_status, dxresearch_code\n FROM demographic d\n LEFT JOIN (\n  SELECT demographic_no, dxresearch_code, count(dxresearch_code)\n  FROM dxresearch\n  WHERE status=\'A\' AND\n  (\n   (LEFT(dxresearch_code, 3) IN (\'428\') AND coding_system = ${dxcodesSysICD}) OR\n   (dxresearch_code IN (\'84114007\') AND coding_system LIKE ${dxcodesSysSnoMed})\n   )\n  GROUP BY demographic_no\n  ORDER BY demographic_no\n ) problems\n ON d.demographic_no = problems.demographic_no\n WHERE d.provider_no LIKE ${provider} AND d.patient_status = ${pstatus}\n) fin\n		</query>\n	</indicatorQuery>\n	<drillDownQuery>\n		<version>03-13-2018</version>\n		<params>\n			<parameter id=\"provider\" name=\"provider_no\" value=\"loggedInProvider\" />	\n			<parameter id=\"pstatus\" name=\"Patient Status\" value=\"\'AC\'\" />\n			<parameter id=\"dxcodesICD\" name=\"Dx Codes (ICD)\" value=\"428\" />\n			<parameter id=\"dxcodesSysICD\" name=\"DX CodeSystem (ICD)\" value=\"\'icd9\'\" />\n			<parameter id=\"dxcodesSnoMed\" name=\"Dx Codes (SnoMed)\" value=\"84114007\" />\n			<parameter id=\"dxcodesSysSnoMed\" name=\"Dx CodeSystem (SnoMed)\" value=\"\'snomed%\'\" />\n		</params>\n		<displayColumns>\n			<column id=\"demographic\" name=\"d.demographic_no\" title=\"Patient Id\" primary=\"true\" />\n			<column id=\"name\" name=\"CONCAT( d.last_name, \', \', d.first_name )\" title=\"Patient Name\" primary=\"false\" />\n			<column id=\"dob\" name=\"DATE_FORMAT( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth), \'%m-%d-%Y\' )\" title=\"Date of Birth (mm-dd-yy)\" primary=\"false\" />\n			<column id=\"age\" name=\"TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )\" title=\"Age\" primary=\"false\" />\n			<column id=\"dxcode\" title=\"Dx System/Code\" name=\"CONCAT(MIN(dxr.coding_system),\'/\',MIN(dxr.dxresearch_code),IF( MIN(dxr.dxresearch_code) != MAX(dxr.dxresearch_code),CONCAT( \' &amp; \', MAX(dxr.coding_system), \'/\', MAX(dxr.dxresearch_code) ),\'\') )\" primary=\"false\" />\n		</displayColumns>\n		<exportColumns>\n			<column id=\"demographic\" name=\"d.demographic_no\" title=\"Patient Id\" primary=\"true\" />\n			<column id=\"firstName\" name=\"d.first_name\" title=\"First Name\" primary=\"false\" />\n			<column id=\"lastName\" name=\"d.last_name\" title=\"Last Name\" primary=\"false\" />\n			<column id=\"dob\" name=\"DATE_FORMAT( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth), \'%m-%d-%Y\' )\" title=\"Date of Birth (mm-dd-yy)\" primary=\"false\" />\n			<column id=\"age\" name=\"TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )\" title=\"Age\" primary=\"false\" />\n			<column id=\"dxcode\" title=\"Dx System/Code\" name=\"CONCAT(MIN(dxr.coding_system),\'/\',MIN(dxr.dxresearch_code),IF( MIN(dxr.dxresearch_code) != MAX(dxr.dxresearch_code),CONCAT( \' &amp; \', MAX(dxr.coding_system), \'/\', MAX(dxr.dxresearch_code) ),\'\') )\" primary=\"false\" />\n		</exportColumns>\n		<query>\n			<!-- Drilldown SQL Query here -->\nSELECT\n*			\nFROM demographic d\nLEFT JOIN dxresearch dxr\nON d.demographic_no = dxr.demographic_no\nWHERE d.patient_status=${pstatus}\nAND\n(\n (LEFT(dxr.dxresearch_code, 3) IN (\'428\') AND dxr.coding_system = ${dxcodesSysICD}) OR\n (dxr.dxresearch_code IN (\'84114007\') AND dxr.coding_system LIKE ${dxcodesSysSnoMed})\n )\nAND dxr.status = \'A\'\nAND d.provider_no LIKE ${provider}\nGROUP BY d.demographic_no\nORDER BY COUNT(d.demographic_no) DESC, d.demographic_no\n		</query>\n	</drillDownQuery>\n</indicatorTemplateXML>\n','','\0',0,NULL,NULL),
(33,4,'Consider Hypertension','CDM','Hypertension','DoBC CPQI PSP Panel','2017-08-02','\n			Patients with hypertension dx in 2+ bills or 2+ visits within last 3 years or most recent BP > 140/90 or 2+ BP > 140/90 in last 2 years\n		','\n		  Created for Doctors of BC\n		  i) HTN dx in 2+ bills: \"Patient Status: Active\nAND does not have a Current Problem List/Profile item code of 38341003 OR starting with 401\nAND with ?2 Bills with the ICD9 diagnosis code starting with 401 in the last 3 ye','<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<indicatorTemplateXML>\n	<author>OSCAR BC</author>\n	<uid></uid>\n	<heading>\n		<category>CDM</category>\n		<subCategory>Hypertension</subCategory>\n		<name>Consider Hypertension</name>\n		<definition>\n			Patients with hypertension dx in 2+ bills or 2+ visits within last 3 years or most recent BP &gt; 140/90 or 2+ BP > 140/90 in last 2 years\n		</definition>\n		<framework>DoBC CPQI PSP Panel</framework>\n		<frameworkVersion>08-02-2017</frameworkVersion>\n		<notes>\n		  Created for Doctors of BC\n		  i) HTN dx in 2+ bills: \"Patient Status: Active\nAND does not have a Current Problem List/Profile item code of 38341003 OR starting with 401\nAND with ?2 Bills with the ICD9 diagnosis code starting with 401 in the last 3 years\"\n		  ii) HTN dx in 2+ visits: \"Patient Status: Active\nAND does not have a Current Problem List/Profile item code of 38341003 OR starting with 401\nAND with ?2 Visit Encounters with Snomed diagnosis code 38341003 or the ICD9 diagnosis code starting with 401 in the last 3 years\"\n		  iii) BP &gt; 140/90: \"Patient Status: Active\nAND does not have a Current Problem List/Profile item code of 38341003 OR starting with 401\nAND WITH  the a most recent Blood Pressure observation > 140/90 OR 2+ Blood Pressures documented >140/90 in the last 2 years\"\n		</notes>\n	</heading>\n	<indicatorQuery>\n		<version>03-13-2018</version>\n		<params>\n			<parameter id=\"provider\" name=\"Provider Number\" value=\"loggedInProvider\" />\n			<parameter id=\"active\" name=\"Active Patients\" value=\"\'AC\'\" />\n			<parameter id=\"dxcodesICD\" name=\"Dx Codes (ICD)\" value=\"\'401%\'\" />\n                        <parameter id=\"dxcodesSysICD\" name=\"DX CodeSystem (ICD)\" value=\"\'icd9\'\" />\n                        <parameter id=\"dxcodesSnoMed\" name=\"Dx Codes (SnoMed)\" value=\"\'38341003\'\" />\n                        <parameter id=\"dxcodesSysSnoMed\" name=\"Dx CodeSystem (SnoMed)\" value=\"\'snomed%\'\" />\n			<parameter id=\"billingCode\" name=\"ICD9 Billing Code\" value=\"401\" />\n			<parameter id=\"numOfBills\" name=\"Number of ICD9 401 Bills\" value=\"2\" />\n			<parameter id=\"numOfVisits\" name=\"Number of Visit Encounters coded 401/ICD9\" value=\"2\" />\n			<parameter id=\"numOfBPs\" name=\"Number of BP measurements\" value=\"2\" />\n		</params>\n		<range>\n			<lowerLimit id=\"billingdate\" label=\"From Date\" name=\"Date\" value=\"DATE_SUB( NOW(), INTERVAL 3 YEAR )\" />\n			<upperLimit id=\"billingdate\" label=\"Date Today\" name=\"Date\" value=\"NOW()\" />\n			<lowerLimit id=\"visitdate\" label=\"From Date\" name=\"Date\" value=\"DATE_SUB( NOW(), INTERVAL 3 YEAR )\" />\n                        <upperLimit id=\"visitdate\" label=\"Date Today\" name=\"Date\" value=\"NOW()\" />\n			<lowerLimit id=\"labdate\" label=\"From Date\" name=\"Date\" value=\"DATE_SUB( NOW(), INTERVAL 2 YEAR )\" />\n			<upperLimit id=\"labdate\" label=\"Date Today\" name=\"Date\" value=\"NOW()\" />\n		</range>\n		<query>\nSELECT\n  IF ( COUNT(fin.patient) &gt; 0, SUM( CASE WHEN (fin.dx IS NULL AND fin.billcount &gt;= ${numOfBills}) THEN 1 ELSE 0 END ) , 0) AS \"HTN dx in ${numOfBills}+ bills\",\n  IF ( COUNT(fin.patient) &gt; 0, SUM( CASE WHEN (fin.dx IS NULL AND fin.visitcount &gt;= ${numOfVisits}) THEN 1 ELSE 0 END ) , 0) AS \"HTN dx in ${numOfVisits}+ visits\",\n\n  IF ( COUNT(fin.patient) &gt; 0, SUM( CASE WHEN (fin.dx IS NULL AND ((fin.lastBP REGEXP \'1[4-9][1-9]/[0-9]{1,3}\' OR fin.lastBP REGEXP \'2[0-9][0-9]/[0-9]{1,3}\' OR\n      fin.lastBP REGEXP \'[0-9]{1,3}/9[1-9]{1}\' OR fin.lastBP REGEXP \'[0-9]{1,3}/1[0-9]{2}\') OR (fin.countBP &gt;= ${numOfBPs})) ) THEN 1 ELSE 0 END ) , 0) AS \"BP &gt; 140/90\"\nFROM ( \n  SELECT \n    d.demographic_no AS patient, \n    BILLING.billcount AS billcount,\n    VISIT.visitcount AS visitcount,\n    LAST.bp AS lastBP,\n    BP2.countBP AS countBP,\n    dxr.dxresearch_code AS dx,\n    dxr.coding_system AS dxs\n  FROM demographic d \n  LEFT JOIN (\n    SELECT demographic_no, dxresearch_code, coding_system, count(dxresearch_code)\n    FROM dxresearch\n    WHERE status=\'A\' AND\n    (\n      (dxresearch_code LIKE ${dxcodesICD} AND coding_system = ${dxcodesSysICD}) OR\n      (dxresearch_code = ${dxcodesSnoMed} AND coding_system LIKE ${dxcodesSysSnoMed})\n    )\n    GROUP BY demographic_no\n    ORDER BY demographic_no\n  ) dxr\n  ON d.demographic_no = dxr.demographic_no\n  -- Billed 401 in last 3 years\n  LEFT JOIN (\n    SELECT b.demographic_no as demographic_no, b.dx_code1 as dxcode1, b.dx_code2 as dxcode2, b.dx_code3 as dxcode3, count(b.demographic_no) as billcount\n    FROM billingmaster b\n    WHERE b.dx_code1 = ${billingCode} OR b.dx_code2 = ${billingCode} OR b.dx_code3 = ${billingCode}\n    AND DATE(b.createdate) > ${lowerLimit.billingdate}\n    AND b.demographic_no > 0\n    GROUP BY b.demographic_no HAVING COUNT(b.demographic_no) > -1\n  ) BILLING\n  ON (d.demographic_no = BILLING.demographic_no)\n  -- Coded 401 during visit encounter in last 3 years\n  LEFT JOIN(\n    SELECT ASSIGNED.demographic_no AS demographic_no, observation_date AS visitdate, uuid, count(ASSIGNED.demographic_no) AS visitcount\n    FROM casemgmt_note note\n    INNER JOIN (\n      SELECT note_id, CODED.demo_no AS demographic_no FROM casemgmt_issue_notes\n      INNER JOIN (\n        SELECT ci.id AS id, ci.update_date, ci.demographic_no demo_no FROM issue i\n        INNER JOIN casemgmt_issue ci\n        ON i.issue_id = ci.issue_id\n        WHERE\n        (i.type LIKE ${dxcodesSysICD} and i.code LIKE ${dxcodesICD}) OR\n        (i.type LIKE ${dxcodesSysSnoMed} and i.code = ${dxcodesSnoMed})\n      ) CODED\n      ON (casemgmt_issue_notes.id = CODED.id)\n      ORDER BY CODED.demo_no\n    ) ASSIGNED\n    ON note.note_id = ASSIGNED.note_id AND\n    -- GET LAST REVISION OF NOTE\n    note.note_id= (SELECT MAX(cmn.note_id) FROM casemgmt_note cmn WHERE cmn.uuid = note.uuid) AND\n    DATE(note.observation_date) > ${lowerLimit.visitdate}\n    GROUP BY demographic_no\n    ORDER BY demographic_no\n  ) VISIT\n  ON (d.demographic_no = VISIT.demographic_no)\n  -- Last BP measurement\n  LEFT JOIN (\n    SELECT m.demographicNo AS demographic_no, m.dataField AS bp, m.dateObserved AS dateObserved\n    FROM measurements m\n    INNER JOIN (\n      SELECT demographicNo, MAX(dateObserved) AS dateObserved\n      FROM measurements\n      WHERE type = \'BP\'\n      GROUP BY demographicNo\n    ) mlast\n    ON m.demographicNo = mlast.demographicNo\n    WHERE m.type = \'BP\'\n    AND m.dateObserved = mlast.dateObserved\n    AND m.demographicNo &gt; 0\n    GROUP BY m.demographicNo\n  ) LAST\n  ON (d.demographic_no = LAST.demographic_no) \n  -- Two of more BP > 140/90 in last two years\n  LEFT JOIN ( \n    SELECT m.demographicNo as demographic_no, m.dataField as bp, count(m.dataField) as countBP\n    FROM measurements m\n    WHERE m.type = \'BP\'\n    AND DATE(m.dateObserved) > ${lowerLimit.labdate}\n    AND (m.dataField REGEXP \'1[4-9][1-9]/[0-9]{1,3}\' OR m.dataField REGEXP \'2[0-9][0-9]/[0-9]{1,3}\' OR\n      m.dataField REGEXP \'[0-9]{1,3}/9[1-9]{1}\' OR m.datafield REGEXP \'[0-9]{1,3}/1[0-9]{2}\')\n    AND m.demographicNo > 0\n    GROUP BY m.demographicNo HAVING COUNT(m.demographicNo) > -1\n  ) BP2\n  ON (d.demographic_no = BP2.demographic_no) \n  WHERE d.patient_status LIKE ${active}\n  AND d.demographic_no > 0\n  AND d.provider_no LIKE ${provider} \n) fin\n		</query>\n	</indicatorQuery>\n	<drillDownQuery>\n		<version>03-13-2018</version>\n		<params>\n			<parameter id=\"provider\" name=\"Provider Number\" value=\"loggedInProvider\" />\n			<parameter id=\"active\" name=\"Active Patients\" value=\"\'AC\'\" />\n			<parameter id=\"dxcodesICD\" name=\"Dx Codes (ICD)\" value=\"\'401%\'\" />\n                        <parameter id=\"dxcodesSysICD\" name=\"DX CodeSystem (ICD)\" value=\"\'icd9\'\" />\n                        <parameter id=\"dxcodesSnoMed\" name=\"Dx Codes (SnoMed)\" value=\"\'38341003\'\" />\n                        <parameter id=\"dxcodesSysSnoMed\" name=\"Dx CodeSystem (SnoMed)\" value=\"\'snomed%\'\" />\n			<parameter id=\"numOfBills\" name=\"Number of ICD9 401 Bills\" value=\"2\" />\n			<parameter id=\"numOfVisits\" name=\"Number of ICD9 401 Visit Encounters\" value=\"2\" />\n			<parameter id=\"numOfBPs\" name=\"Number of BP measurements\" value=\"2\" />\n			<parameter id=\"billingCode\" name=\"ICD9 Billing Code\" value=\"401\" />\n		</params>\n		\n		<range>\n			<lowerLimit id=\"billingdate\" label=\"From Date\" name=\"Date\" value=\"DATE_SUB( NOW(), INTERVAL 3 YEAR )\" />\n			<upperLimit id=\"billingdate\" label=\"Date Today\" name=\"Date\" value=\"NOW()\" />\n			<lowerLimit id=\"visitdate\" label=\"From Date\" name=\"Date\" value=\"DATE_SUB( NOW(), INTERVAL 3 YEAR )\" />\n                        <upperLimit id=\"visitdate\" label=\"Date Today\" name=\"Date\" value=\"NOW()\" />\n			<lowerLimit id=\"labdate\" label=\"From Date\" name=\"Date\" value=\"DATE_SUB( NOW(), INTERVAL 2 YEAR )\" />\n			<upperLimit id=\"labdate\" label=\"Date Today\" name=\"Date\" value=\"NOW()\" />\n		</range>\n		\n		<displayColumns>\n			<column id=\"demographic\" name=\"d.demographic_no\" title=\"Patient Id\" primary=\"true\" />\n			<column id=\"name\" name=\"CONCAT( d.last_name, \', \', d.first_name )\" title=\"Patient Name\" primary=\"false\" />\n			<column id=\"dob\" name=\"DATE_FORMAT( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth), \'%m-%d-%Y\' )\" title=\"Date of Birth\" primary=\"false\" />\n			<column id=\"age\" name=\"TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )\" title=\"Age\" primary=\"false\" />\n			<column id=\"billings\" name=\"IFNULL( BILLING.billcount, \'0\')\" title=\"Billings\" primary=\"false\" />\n			<column id=\"visits\" name=\"IFNULL( VISIT.visitcount, \'0\')\" title=\"Visits\" primary=\"false\" />\n			<column id=\"lastBP\" name=\"IFNULL( LAST.bp, \'NA\')\" title=\"Last BP\" primary=\"false\" />\n			<column id=\"testDateBP\" name=\"IFNULL( DATE_FORMAT( LAST.dateObserved, \'%m-%d-%Y\' ), \'NA\')\" title=\"Date (yyyy-mm-dd)\" primary=\"false\" />\n			<column id=\"numBPs\" name=\"IFNULL( BP2.countBP, \'0\')\" title=\"BPs>140/90 Last 2yrs\" primary=\"false\" />\n		</displayColumns>\n		\n		<exportColumns>\n			<column id=\"demographic\" name=\"d.demographic_no\" title=\"Patient Id\" primary=\"true\" />\n                        <column id=\"firstName\" name=\"d.first_name\" title=\"First Name\" primary=\"false\" />\n                        <column id=\"lastName\" name=\"d.last_name\" title=\"Last Name\" primary=\"false\" />\n			<column id=\"dob\" name=\"DATE_FORMAT( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth), \'%m-%d-%Y\' )\" title=\"Date of Birth\" primary=\"false\" />\n			<column id=\"age\" name=\"TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )\" title=\"Age\" primary=\"false\" />\n			<column id=\"billings\" name=\"IFNULL( BILLING.billcount, \'0\')\" title=\"Billings\" primary=\"false\" />\n			<column id=\"visits\" name=\"IFNULL( VISIT.visitcount, \'0\')\" title=\"Visits\" primary=\"false\" />\n			<column id=\"lastBP\" name=\"IFNULL( LAST.bp, \'\')\" title=\"Last BP\" primary=\"false\" />\n			<column id=\"testDateBP\" name=\"IFNULL( DATE_FORMAT( LAST.dateObserved, \'%m-%d-%Y\' ), \'\')\" title=\"Date (yyyy-mm-dd)\" primary=\"false\" />\n			<column id=\"numBPs\" name=\"IFNULL( BP2.countBP, \'0\')\" title=\"BPs>140/90 Last 2yrs\" primary=\"false\" />\n		</exportColumns>\n		<query>	\np  SELECT *	\n  FROM demographic d \n  LEFT JOIN (\n    SELECT demographic_no, dxresearch_code, coding_system, count(dxresearch_code)\n    FROM dxresearch\n    WHERE status=\'A\' AND\n    (\n      (dxresearch_code LIKE ${dxcodesICD} AND coding_system = ${dxcodesSysICD}) OR\n      (dxresearch_code = ${dxcodesSnoMed} AND coding_system LIKE ${dxcodesSysSnoMed})\n    )\n    GROUP BY demographic_no\n    ORDER BY demographic_no\n  ) dxr\n  ON d.demographic_no = dxr.demographic_no\n  -- Billed 401 in last 3 years\n  LEFT JOIN (\n    SELECT b.demographic_no as demographic_no, b.dx_code1 as dxcode1, b.dx_code2 as dxcode2, b.dx_code3 as dxcode3, count(b.demographic_no) as billcount\n    FROM billingmaster b\n    WHERE b.dx_code1 = ${billingCode} OR b.dx_code2 = ${billingCode} OR b.dx_code3 = ${billingCode}\n    AND DATE(b.createdate) > ${lowerLimit.billingdate}\n    AND b.demographic_no > 0\n    GROUP BY b.demographic_no HAVING COUNT(b.demographic_no) > -1\n  ) BILLING\n  ON (d.demographic_no = BILLING.demographic_no)  \n  -- Coded 401 during visit encounter in last 3 years\n  LEFT JOIN(\n    SELECT ASSIGNED.demographic_no AS demographic_no, observation_date AS visitdate, uuid, count(ASSIGNED.demographic_no) AS visitcount\n    FROM casemgmt_note note\n    INNER JOIN (\n      SELECT note_id, CODED.demo_no AS demographic_no FROM casemgmt_issue_notes\n      INNER JOIN (\n        SELECT ci.id AS id, ci.update_date, ci.demographic_no demo_no FROM issue i\n        INNER JOIN casemgmt_issue ci\n        ON i.issue_id = ci.issue_id\n        WHERE\n        (i.type LIKE ${dxcodesSysICD} and i.code LIKE ${dxcodesICD}) OR\n        (i.type LIKE ${dxcodesSysSnoMed} and i.code = ${dxcodesSnoMed})\n      ) CODED\n      ON (casemgmt_issue_notes.id = CODED.id)\n      ORDER BY CODED.demo_no\n    ) ASSIGNED\n    ON note.note_id = ASSIGNED.note_id AND\n    -- GET LAST REVISION OF NOTE\n    note.note_id= (SELECT MAX(cmn.note_id) FROM casemgmt_note cmn WHERE cmn.uuid = note.uuid) AND\n    DATE(note.observation_date) > ${lowerLimit.visitdate}\n    GROUP BY demographic_no\n    ORDER BY demographic_no\n  ) VISIT\n  ON (d.demographic_no = VISIT.demographic_no)\n  -- Last BP measurement\n  LEFT JOIN (\n    SELECT m.demographicNo AS demographic_no, m.dataField AS bp, m.dateObserved AS dateObserved\n    FROM measurements m\n    INNER JOIN (\n      SELECT demographicNo, MAX(dateObserved) AS dateObserved\n      FROM measurements\n      WHERE type = \'BP\'\n      GROUP BY demographicNo\n    ) mlast\n    ON m.demographicNo = mlast.demographicNo\n    WHERE m.type = \'BP\'\n    AND m.dateObserved = mlast.dateObserved\n    AND m.demographicNo &gt; 0\n    GROUP BY m.demographicNo\n  ) LAST\n  ON (d.demographic_no = LAST.demographic_no) \n  -- Two of more BP > 140/90 in last two years\n  LEFT JOIN ( \n    SELECT m.demographicNo as demographic_no, m.dataField as bp, count(m.dataField) as countBP\n    FROM measurements m\n    WHERE m.type = \'BP\'\n    AND DATE(m.dateObserved) > ${lowerLimit.labdate}\n    AND (m.dataField REGEXP \'1[4-9][1-9]/[0-9]{1,3}\' OR m.dataField REGEXP \'2[0-9][0-9]/[0-9]{1,3}\' OR\n      m.dataField REGEXP \'[0-9]{1,3}/9[1-9]{1}\' OR m.datafield REGEXP \'[0-9]{1,3}/1[0-9]{2}\')\n    AND m.demographicNo > 0\n    GROUP BY m.demographicNo HAVING COUNT(m.demographicNo) > -1\n  ) BP2\n  ON (d.demographic_no = BP2.demographic_no) \n  WHERE d.patient_status LIKE ${active}\n  AND d.demographic_no > 0\n  AND d.provider_no LIKE ${provider}\n  AND ( dxr.dxresearch_code IS NULL AND (\n  (BILLING.billcount IS NOT NULL AND BILLING.billcount &gt;= ${numOfBills}) OR\n  (VISIT.visitcount IS NOT NULL AND VISIT.visitcount &gt;= ${numOfVisits}) OR\n  (LAST.bp REGEXP \'1[4-9][1-9]/[0-9]{1,3}\' OR LAST.bp REGEXP \'2[0-9][0-9]/[0-9]{1,3}\' OR\n  LAST.bp REGEXP \'[0-9]{1,3}/9[1-9]{1}\' OR LAST.bp REGEXP \'[0-9]{1,3}/1[0-9]{2}\') OR\n  (BP2.countBP IS NOT NULL AND BP2.countBP &gt; ${numOfBPs})))\n  ORDER BY d.demographic_no\n		</query>\n	</drillDownQuery>\n</indicatorTemplateXML>\n','','\0',0,NULL,NULL),
(34,4,'Hypertension Prevalence','CDM','Hypertension','DoBC CPQI PSP Panel','2017-08-02','% of active patients in the practice coded with Hypertension.','\ni) HTN patients: \"Patient Status: Active\nAND has a Current Problem List/Profile item code of 38341003 OR starting with 401\"\nii) Other patients: \"Patient Status: Active\nAND does not have a Current Problem List/Profile item code of 38341003 OR starting wit','<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<indicatorTemplateXML>\n	<author>OSCAR BC</author>\n	<uid></uid>\n	<heading>\n		<category>CDM</category>\n		<subCategory>Hypertension</subCategory>\n		<name>Hypertension Prevalence</name>\n		<definition>% of active patients in the practice coded with Hypertension.</definition>\n		<framework>DoBC CPQI PSP Panel</framework>\n		<frameworkVersion>08-02-2017</frameworkVersion>\n		<notes>\ni) HTN patients: \"Patient Status: Active\nAND has a Current Problem List/Profile item code of 38341003 OR starting with 401\"\nii) Other patients: \"Patient Status: Active\nAND does not have a Current Problem List/Profile item code of 38341003 OR starting with 401\"\n		</notes>\n	</heading>\n	<indicatorQuery>\n		<version>03-13-2018</version>\n		<params>\n			<!-- \n				Required parameter provider. Value options are: \n					[ an individual providerNo, or provider range ] ie: value=\"370, 1001\" \n					\"all\" ie: value=\"all\" including null.\n					\"loggedInProvider\" ie:\n				Default is \"loggedInProvider\"\n				Use this parameter in the query as ${provider}\n				This parameter should be used for fetching patient\'s assigned to a MRP.\n				ie: WHERE demographic.provider_no = ${provider}\n			-->\n			<parameter id=\"provider\" name=\"provider_no\" value=\"loggedInProvider\" />\n			<parameter id=\"pstatus\" name=\"Patient Status\" value=\"\'AC\'\" />\n			<parameter id=\"dxcodesICD\" name=\"Dx Codes (ICD)\" value=\"401\" />\n			<parameter id=\"dxcodesSysICD\" name=\"DX CodeSystem (ICD)\" value=\"\'icd9\'\" />\n			<parameter id=\"dxcodesSnoMed\" name=\"Dx Codes (SnoMed)\" value=\"38341003\" />\n			<parameter id=\"dxcodesSysSnoMed\" name=\"Dx CodeSystem (SnoMed)\" value=\"\'snomed%\'\" />\n		</params>\n		<query>\n			<!-- Indicator SQL Query here -->\nSELECT\n -- PERCENT OF TOTAL PATIENTS NOTED AS ACTIVE WITH CURRENT HYPERTENSION\n IF( COUNT(fin.patient) > 0, SUM( IF( dxresearch_code is not NULL , 1, 0) ) , 0 ) AS \"% Active, Current Hypertension\",\n -- PERCENT OF TOTAL PATIENTS NOTED AS ACTIVE WITHOUT CURRENT HYPERTENSION\n IF( COUNT(fin.patient) > 0, SUM( IF( dxresearch_code is NULL , 1, 0) ) , 0 ) AS \"% Active, No Current Hypertension\"\nFROM (\n SELECT d.demographic_no AS patient, d.patient_status AS pt_status, dxresearch_code\n FROM demographic d\n LEFT JOIN (\n  SELECT demographic_no, dxresearch_code, count(dxresearch_code)\n  FROM dxresearch\n  WHERE status=\'A\' AND\n  (\n   (LEFT(dxresearch_code, 3) IN (\'401\') AND coding_system = ${dxcodesSysICD}) OR\n   (dxresearch_code IN (\'38341003\') AND coding_system LIKE ${dxcodesSysSnoMed})\n   )\n  GROUP BY demographic_no\n  ORDER BY demographic_no\n ) problems\n ON d.demographic_no = problems.demographic_no\n WHERE d.provider_no LIKE ${provider} AND d.patient_status = ${pstatus}\n) fin\n		</query>\n	</indicatorQuery>\n	<drillDownQuery>\n		<version>03-13-2018</version>\n		<params>\n			<parameter id=\"provider\" name=\"provider_no\" value=\"loggedInProvider\" />	\n			<parameter id=\"pstatus\" name=\"Patient Status\" value=\"\'AC\'\" />\n			<parameter id=\"dxcodesICD\" name=\"Dx Codes (ICD)\" value=\"401\" />\n			<parameter id=\"dxcodesSysICD\" name=\"DX CodeSystem (ICD)\" value=\"\'icd9\'\" />\n			<parameter id=\"dxcodesSnoMed\" name=\"Dx Codes (SnoMed)\" value=\"38341003\" />\n			<parameter id=\"dxcodesSysSnoMed\" name=\"Dx CodeSystem (SnoMed)\" value=\"\'snomed%\'\" />\n		</params>\n		<displayColumns>\n			<column id=\"demographic\" name=\"d.demographic_no\" title=\"Patient Id\" primary=\"true\" />\n			<column id=\"name\" name=\"CONCAT( d.last_name, \', \', d.first_name )\" title=\"Patient Name\" primary=\"false\" />\n			<column id=\"dob\" name=\"DATE_FORMAT( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth), \'%m-%d-%Y\' )\" title=\"Date of Birth (mm-dd-yy)\" primary=\"false\" />\n			<column id=\"age\" name=\"TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )\" title=\"Age\" primary=\"false\" />\n			<column id=\"dxcode\" title=\"Dx System/Code\" name=\"CONCAT(MIN(dxr.coding_system),\'/\',MIN(dxr.dxresearch_code),IF( MIN(dxr.dxresearch_code) != MAX(dxr.dxresearch_code),CONCAT( \' &amp; \', MAX(dxr.coding_system), \'/\', MAX(dxr.dxresearch_code) ),\'\') )\" primary=\"false\" />\n		</displayColumns>\n		<exportColumns>\n			<column id=\"demographic\" name=\"d.demographic_no\" title=\"Patient Id\" primary=\"true\" />\n			<column id=\"firstName\" name=\"d.first_name\" title=\"First Name\" primary=\"false\" />\n			<column id=\"lastName\" name=\"d.last_name\" title=\"Last Name\" primary=\"false\" />\n			<column id=\"dob\" name=\"DATE_FORMAT( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth), \'%m-%d-%Y\' )\" title=\"Date of Birth (mm-dd-yy)\" primary=\"false\" />\n			<column id=\"age\" name=\"TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )\" title=\"Age\" primary=\"false\" />\n			<column id=\"dxcode\" title=\"Dx System/Code\" name=\"CONCAT(MIN(dxr.coding_system),\'/\',MIN(dxr.dxresearch_code),IF( MIN(dxr.dxresearch_code) != MAX(dxr.dxresearch_code),CONCAT( \' &amp; \', MAX(dxr.coding_system), \'/\', MAX(dxr.dxresearch_code) ),\'\') )\" primary=\"false\" />\n		</exportColumns>\n		<query>\n			<!-- Drilldown SQL Query here -->\nSELECT\n*			\nFROM demographic d\nLEFT JOIN dxresearch dxr\nON d.demographic_no = dxr.demographic_no\nWHERE d.patient_status=${pstatus}\nAND\n(\n (LEFT(dxr.dxresearch_code, 3) IN (\'401\') AND dxr.coding_system = ${dxcodesSysICD}) OR\n (dxr.dxresearch_code IN (\'38341003\') AND dxr.coding_system LIKE ${dxcodesSysSnoMed})\n )\nAND dxr.status = \'A\'\nAND d.provider_no LIKE ${provider}\nGROUP BY d.demographic_no\nORDER BY COUNT(d.demographic_no) DESC, d.demographic_no\n		</query>\n	</drillDownQuery>\n</indicatorTemplateXML>\n','','\0',0,NULL,NULL),
(35,4,'Active Med Count','Home','Polypharmacy','DoBC CPQI PSP Panel','2017-08-02','% of active patients with an active continuous medication count of 0, 1-4, 5-9 or 10+.','','<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<indicatorTemplateXML>\n	<author>OSCAR BC</author>\n	<uid></uid>\n	<heading>\n		<category>Home</category>\n		<subCategory>Polypharmacy</subCategory>\n		<name>Active Med Count</name>\n		<definition>% of active patients with an active continuous medication count of 0, 1-4, 5-9 or 10+.</definition>\n		<framework>DoBC CPQI PSP Panel</framework>\n		<frameworkVersion>08-02-2017</frameworkVersion>\n		<notes></notes>\n	</heading>\n	<indicatorQuery>\n		<version>03-13-2018</version>\n		<params>\n			<!-- \n				Use this parameter in the query as ${provider}\n				This parameter should be used for fetching patient\'s assigned to a MRP.\n				ie: WHERE demographic.provider_no = ${provider}\n			-->\n			<parameter id=\"provider\" name=\"provider_no\" value=\"loggedInProvider\" />\n			<parameter id=\"pstatus\" name=\"Patient Status\" value=\"\'AC\'\" />\n		</params>\n		<query>\n			<!-- Indicator SQL Query here -->\nSELECT\nIF( COUNT(patient) > 0,\nSUM( IF(patient_status = ${pstatus} AND med_COUNT >= 10,1,0)),0) AS \'10+ meds\',\nIF( COUNT(patient) > 0,\nSUM( IF(patient_status = ${pstatus} AND med_COUNT BETWEEN 5 AND 9, 1, 0)),0) AS \'5-9 meds\',\nIF( COUNT(patient) > 0,\nSUM( IF(patient_status = ${pstatus} AND med_COUNT BETWEEN 1 AND 4, 1, 0)),0) AS \'1-4 meds\',\nIF( COUNT(patient) > 0,\nSUM( IF(patient_status = ${pstatus} AND med_COUNT = 0,1,0)),0) AS \'0 meds\'\nFROM (\nSELECT d.demographic_no AS patient, d.patient_status, COUNT(DISTINCT meds.regional_identifier) AS med_count\nFROM demographic d LEFT JOIN(\nSELECT dr.demographic_no, dr.regional_identifier FROM drugs AS dr\nWHERE dr.archived = 0 AND dr.regional_identifier IS NOT NULL AND\ndr.regional_identifier != \'\' AND rx_date &lt;= NOW() AND\n(DATE_ADD(dr.rx_date, INTERVAL(DATEDIFF(dr.end_date,dr.rx_date)*1.0)\nDAY)) >= NOW() ORDER BY dr.demographic_no) meds\non (d.demographic_no = meds.demographic_no) where d.provider_no LIKE ${provider}\nGROUP BY d.demographic_no\nORDER BY COUNT(DISTINCT meds.regional_identifier) DESC\n) counts\n		</query>\n	</indicatorQuery>\n	<drillDownQuery>\n		<version>03-13-2018</version>\n		<params>\n			<parameter id=\"provider\" name=\"provider_no\" value=\"loggedInProvider\" />	\n			<parameter id=\"pstatus\" name=\"Patient Status\" value=\"\'AC\'\" />\n		</params>\n		<displayColumns>\n			<column id=\"demographic\" name=\"demographic_no\" title=\"Patient Id\" primary=\"true\" />\n			<column id=\"name\" name=\"CONCAT( last_name, \', \', first_name )\" title=\"Patient Name\" primary=\"false\" />\n			<column id=\"dob\" name=\"DATE_FORMAT( CONCAT(year_of_birth,\'-\',month_of_birth,\'-\',date_of_birth), \'%m-%d-%Y\' )\" title=\"Date of Birth (mm-dd-yy)\" primary=\"false\" />\n			<column id=\"age\" name=\"TIMESTAMPDIFF(YEAR, DATE( CONCAT(year_of_birth,\'-\',month_of_birth,\'-\',date_of_birth) ), CURDATE() )\" title=\"Age\" primary=\"false\" />\n			<column id=\"activeMedCount\" name=\"counts.med_count\" title=\"Active Med Count\" primary=\"false\" />\n			<column id=\"patientStatus\" name=\"patient_status\" title=\"Patient Status\" primary=\"false\" />\n		</displayColumns>\n		<exportColumns>\n			<column id=\"demographic\" name=\"demographic_no\" title=\"Patient Id\" primary=\"true\" />\n			<column id=\"name\" name=\"CONCAT( last_name, \', \', first_name )\" title=\"Patient Name\" primary=\"false\" />\n			<column id=\"dob\" name=\"DATE_FORMAT( CONCAT(year_of_birth,\'-\',month_of_birth,\'-\',date_of_birth), \'%m-%d-%Y\' )\" title=\"Date of Birth (mm-dd-yy)\" primary=\"false\" />\n			<column id=\"age\" name=\"TIMESTAMPDIFF(YEAR, DATE( CONCAT(year_of_birth,\'-\',month_of_birth,\'-\',date_of_birth) ), CURDATE() )\" title=\"Age\" primary=\"false\" />\n			<column id=\"activeMedCount\" name=\"counts.med_count\" title=\"Active Med Count\" primary=\"false\" />\n			<column id=\"patientStatus\" name=\"patient_status\" title=\"Patient Status\" primary=\"false\" />\n		</exportColumns>\n		<query>\n			<!-- Drilldown SQL Query here -->\nSELECT demographic_no, patient_status, counts.med_count\nFROM\n  (SELECT d.*, COUNT(DISTINCT meds.regional_identifier) AS med_count\n  FROM demographic d\n  LEFT JOIN(\n    SELECT dr.demographic_no, dr.regional_identifier FROM drugs AS dr\n    WHERE dr.archived = 0 AND dr.regional_identifier IS NOT NULL AND\n      dr.regional_identifier != \'\' AND rx_date &lt;= NOW() AND\n      (DATE_ADD(dr.rx_date, INTERVAL(DATEDIFF(dr.end_date,dr.rx_date)*1.0)\n      DAY)) >= NOW()\n    ORDER BY dr.demographic_no\n    ) meds\n  ON (d.demographic_no = meds.demographic_no) where d.provider_no LIKE ${provider}\n  GROUP BY d.demographic_no\n  ORDER BY COUNT(DISTINCT meds.regional_identifier) DESC ,\n    d.demographic_no ASC\n  ) counts\nWHERE patient_status=${pstatus} AND med_count > 0\n		</query>\n	</drillDownQuery>\n	<shared>false</shared>\n	<sharedMetricSetName>General - Polypharmacy</sharedMetricSetName>\n	<sharedMetricDataId></sharedMetricDataId>\n	<sharedMappings>\n		<sharedMapping fromLabel=\"10+ meds\" toLabel=\"10+ Rx\"/>\n		<sharedMapping fromLabel=\"5-9 meds\" toLabel=\"5-9 Rx\"/>\n		<sharedMapping fromLabel=\"1-4 meds\" toLabel=\"1-4 Rx\"/>\n		<sharedMapping fromLabel=\"0 meds\" toLabel=\"0 Rx\"/>\n	</sharedMappings>	\n</indicatorTemplateXML>\n','','\0',0,NULL,NULL),
(36,5,'Consider Advanced Care Planning','CDM','Advanced Care Planning','DoBC CPQI PSP Panel','2017-08-02','\n			Patients with advanced care planning dx in 2+ bills or 2+ visit encounters within last 3 years or PPS < 50\n		','\n		  Created for Doctors of BC\n		  i) Advanced Care Planning dx in 2+ bills: \"Patient Status: Active\nAND does not have a Current Problem List/Profile item code of 105499002 or starting with V66\nAND with >=2 Bills with the billing code starting with V66 in','<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<indicatorTemplateXML>\n	<author>OSCAR BC</author>\n	<uid></uid>\n	<heading>\n		<category>CDM</category>\n		<subCategory>Advanced Care Planning</subCategory>\n		<name>Consider Advanced Care Planning</name>\n		<definition>\n			Patients with advanced care planning dx in 2+ bills or 2+ visit encounters within last 3 years or PPS &lt; 50\n		</definition>\n		<framework>DoBC CPQI PSP Panel</framework>\n		<frameworkVersion>08-02-2017</frameworkVersion>\n		<notes>\n		  Created for Doctors of BC\n		  i) Advanced Care Planning dx in 2+ bills: \"Patient Status: Active\nAND does not have a Current Problem List/Profile item code of 105499002 or starting with V66\nAND with >=2 Bills with the billing code starting with V66 in the last 3 years\"\n		  ii) Advanced Care Planning dx in 2+ visits: \"Patient Status: Active\nAND does not have a Current Problem List/Profile item code of 105499002 or starting with V66\nAND with >=2 Visit Encounters with Snomed diagnosis code 105499002 or the ICD9 diagnosis code starting with V66 in the last 3 years\"\n                  iii) PPS &lt; 50: \"Patient Status: Active\nAND does not have a Current Problem List/Profile item code of 105499002 or starting with V66\nAND with most recent Palliative Performance Scale score &lt; 50\n		</notes>\n	</heading>\n	<indicatorQuery>\n		<version>03-13-2018</version>\n		<params>\n			<parameter id=\"provider\" name=\"Provider Number\" value=\"loggedInProvider\" />\n			<parameter id=\"active\" name=\"Active Patients\" value=\"\'AC\'\" />\n			<parameter id=\"dxcodesICD\" name=\"Dx Codes (ICD)\" value=\"V66\" />\n                        <parameter id=\"dxcodesSysICD\" name=\"DX CodeSystem (ICD)\" value=\"\'icd9\'\" />\n                        <parameter id=\"dxcodesSnoMed\" name=\"Dx Codes (SnoMed)\" value=\"105499002\" />\n                        <parameter id=\"dxcodesSysSnoMed\" name=\"Dx CodeSystem (SnoMed)\" value=\"\'snomed%\'\" />\n			<parameter id=\"billingCode\" name=\"ICD9 Billing Code\" value=\"V66\" />\n			<parameter id=\"numOfBills\" name=\"Number of ICD9 V66 Bills\" value=\"2\" />\n			<parameter id=\"numOfVisits\" name=\"Number of Visit Encounters coded V66/ICD9\" value=\"2\" />\n			<parameter id=\"obsName\" name=\"Observation Name\" value=\"\'PPS\'\" />\n			<parameter id=\"obsResult\" name=\"Observation Result\" value=\"50\" />\n		</params>\n		<range>\n			<lowerLimit id=\"billingdate\" label=\"From Date\" name=\"Date\" value=\"DATE_SUB( NOW(), INTERVAL 3 YEAR )\" />\n			<upperLimit id=\"billingdate\" label=\"Date Today\" name=\"Date\" value=\"NOW()\" />\n			<lowerLimit id=\"visitdate\" label=\"From Date\" name=\"Date\" value=\"DATE_SUB( NOW(), INTERVAL 3 YEAR )\" />\n			<upperLimit id=\"visitdate\" label=\"Date Today\" name=\"Date\" value=\"NOW()\" />\n		</range>\n		<query>\nSELECT\n  IF ( COUNT(fin.patient) &gt; 0, SUM( CASE WHEN (fin.dx IS NULL AND fin.billcount &gt;= ${numOfBills}) THEN 1 ELSE 0 END ) , 0) AS \"Advanced Care Planning dx in ${numOfBills}+ bills\",\n  IF ( COUNT(fin.patient) &gt; 0, SUM( CASE WHEN (fin.dx IS NULL AND fin.visitcount &gt;= ${numOfVisits}) THEN 1 ELSE 0 END ) , 0) AS \"Advanced Care Planning dx in ${numOfVisits}+ visits\",\n  IF ( COUNT(fin.patient) &gt; 0, SUM( CASE WHEN (fin.dx IS NULL AND fin.result &lt; ${obsResult}) THEN 1 ELSE 0 END ) , 0) AS \"PPS &lt; ${obsResult}%\"\nFROM ( \n  SELECT \n    d.demographic_no AS patient, \n    BILLING.billcount AS billcount,\n    VISIT.visitcount AS visitcount,\n    OBSLAST.result AS result,\n    dxr.dxresearch_code AS dx,\n    dxr.coding_system AS dxs\n  FROM demographic d \n  LEFT JOIN (\n    SELECT demographic_no, dxresearch_code, coding_system, count(dxresearch_code)\n    FROM dxresearch\n    WHERE status=\'A\' AND\n    (\n      (LEFT(dxresearch_code, 3) IN (\'V66\') AND coding_system = ${dxcodesSysICD}) OR\n      (dxresearch_code IN (\'105499002\') AND coding_system LIKE ${dxcodesSysSnoMed})\n    )\n    GROUP BY demographic_no\n    ORDER BY demographic_no\n  ) dxr\n  ON d.demographic_no = dxr.demographic_no\n  -- Billed V66 in last 3 years\n  LEFT JOIN (\n    SELECT b.demographic_no as demographic_no, b.dx_code1 as dxcode1, b.dx_code2 as dxcode2, b.dx_code3 as dxcode3, count(b.demographic_no) as billcount\n    FROM billingmaster b\n    WHERE ( LEFT(b.dx_code1, 3) IN (\'V66\') OR LEFT(b.dx_code2, 3) IN (\'V66\') OR LEFT(b.dx_code3, 3) IN (\'V66\') )\n    AND DATE(b.createdate) > ${lowerLimit.billingdate}\n    AND b.demographic_no > 0\n    GROUP BY b.demographic_no HAVING COUNT(b.demographic_no) > -1\n  ) BILLING\n  ON (d.demographic_no = BILLING.demographic_no)  \n  -- Coded dx during visit encounter in last 3 years\n  LEFT JOIN(\n    SELECT ASSIGNED.demographic_no as demographic_no, observation_date as visitdate, uuid, count(ASSIGNED.demographic_no) as visitcount\n    FROM casemgmt_note note\n    INNER JOIN (\n      SELECT note_id, CODED.demo_no as demographic_no FROM casemgmt_issue_notes\n      INNER JOIN (\n        SELECT ci.id as id, ci.update_date, ci.demographic_no demo_no FROM issue i\n        INNER JOIN casemgmt_issue ci\n        ON i.issue_id = ci.issue_id\n        WHERE\n	(i.type LIKE ${dxcodesSysICD} AND LEFT(i.code, 3) IN (\'V66\')) OR\n	(i.type LIKE ${dxcodesSysSnoMed} AND i.code IN (\'105499002\'))\n      ) CODED\n      ON (casemgmt_issue_notes.id = CODED.id)\n      ORDER BY CODED.demo_no\n    ) ASSIGNED\n    ON note.note_id = ASSIGNED.note_id AND\n    -- GET LAST REVISION OF NOTE\n    note.note_id= (SELECT MAX(cmn.note_id) FROM casemgmt_note cmn WHERE cmn.uuid = note.uuid) AND\n    DATE(note.observation_date) > ${lowerLimit.visitdate}\n    GROUP BY demographic_no\n    ORDER BY demographic_no\n  ) VISIT\n  ON (d.demographic_no = VISIT.demographic_no)\n  -- Consider Observation\n  LEFT JOIN ( \n    SELECT m.demographicNo AS demographic_no, m.dataField AS result, m.dateObserved AS dateObserved\n    FROM measurements m\n    INNER JOIN (\n      SELECT demographicNo, MAX(dateObserved) AS dateObserved\n      FROM measurements\n      WHERE type = ${obsName}\n      GROUP BY demographicNo\n    ) mlast\n    ON m.demographicNo = mlast.demographicNo\n    WHERE m.type = ${obsName}\n    AND m.dateObserved = mlast.dateObserved\n    AND m.demographicNo &gt; 0\n    GROUP BY m.demographicNo\n  ) OBSLAST\n  ON (d.demographic_no = OBSLAST.demographic_no)  \n  WHERE d.patient_status LIKE ${active}\n  AND d.demographic_no > 0\n  AND d.provider_no LIKE ${provider} \n) fin\n		</query>\n	</indicatorQuery>\n	<drillDownQuery>\n		<version>03-13-2018</version>\n		<params>\n			<parameter id=\"provider\" name=\"Provider Number\" value=\"loggedInProvider\" />\n			<parameter id=\"active\" name=\"Active Patients\" value=\"\'AC\'\" />\n			<parameter id=\"dxcodesICD\" name=\"Dx Codes (ICD)\" value=\"V66\" />\n                        <parameter id=\"dxcodesSysICD\" name=\"DX CodeSystem (ICD)\" value=\"\'icd9\'\" />\n                        <parameter id=\"dxcodesSnoMed\" name=\"Dx Codes (SnoMed)\" value=\"105499002\" />\n                        <parameter id=\"dxcodesSysSnoMed\" name=\"Dx CodeSystem (SnoMed)\" value=\"\'snomed%\'\" />\n			<parameter id=\"billingCode\" name=\"ICD9 Billing Code\" value=\"V66\" />\n			<parameter id=\"numOfBills\" name=\"Number of ICD9 V66 Bills\" value=\"2\" />\n			<parameter id=\"numOfVisits\" name=\"Number of Visit Encounters coded V66/ICD9\" value=\"2\" />\n			<parameter id=\"obsName\" name=\"Observation Name\" value=\"\'PPS\'\" />\n			<parameter id=\"obsResult\" name=\"Observation Result\" value=\"50\" />\n		</params>\n		\n		<range>\n			<lowerLimit id=\"billingdate\" label=\"From Date\" name=\"Date\" value=\"DATE_SUB( NOW(), INTERVAL 3 YEAR )\" />\n			<upperLimit id=\"billingdate\" label=\"Date Today\" name=\"Date\" value=\"NOW()\" />\n			<lowerLimit id=\"visitdate\" label=\"From Date\" name=\"Date\" value=\"DATE_SUB( NOW(), INTERVAL 3 YEAR )\" />\n			<upperLimit id=\"visitdate\" label=\"Date Today\" name=\"Date\" value=\"NOW()\" />\n		</range>\n		\n		<displayColumns>\n			<column id=\"demographic\" name=\"d.demographic_no\" title=\"Patient Id\" primary=\"true\" />\n			<column id=\"name\" name=\"CONCAT( d.last_name, \', \', d.first_name )\" title=\"Patient Name\" primary=\"false\" />\n			<column id=\"dob\" name=\"DATE_FORMAT( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth), \'%m-%d-%Y\' )\" title=\"Date of Birth\" primary=\"false\" />\n			<column id=\"age\" name=\"TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )\" title=\"Age\" primary=\"false\" />\n			<column id=\"billings\" name=\"IFNULL( BILLING.billcount, \'0\')\" title=\"Billings\" primary=\"false\" />\n			<column id=\"visits\" name=\"IFNULL( VISIT.visitcount, \'0\')\" title=\"Visits\" primary=\"false\" />\n			<column id=\"observation\" name=\"IFNULL( OBSLAST.result, \'NA\')\" title=\"PPS\" primary=\"false\" />\n		</displayColumns>\n		\n		<exportColumns>\n			<column id=\"demographic\" name=\"d.demographic_no\" title=\"Patient Id\" primary=\"true\" />\n                        <column id=\"firstName\" name=\"d.first_name\" title=\"First Name\" primary=\"false\" />\n                        <column id=\"lastName\" name=\"d.last_name\" title=\"Last Name\" primary=\"false\" />\n			<column id=\"dob\" name=\"DATE_FORMAT( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth), \'%m-%d-%Y\' )\" title=\"Date of Birth\" primary=\"false\" />\n			<column id=\"age\" name=\"TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )\" title=\"Age\" primary=\"false\" />\n			<column id=\"billings\" name=\"IFNULL( BILLING.billcount, \'0\')\" title=\"Billings\" primary=\"false\" />\n			<column id=\"visits\" name=\"IFNULL( VISIT.visitcount, \'0\')\" title=\"Visits\" primary=\"false\" />\n			<column id=\"observation\" name=\"IFNULL( OBSLAST.result, \'NA\')\" title=\"PPS\" primary=\"false\" />\n		</exportColumns>\n		<query>	\n  SELECT *	\n  FROM demographic d \n  LEFT JOIN (\n    SELECT demographic_no, dxresearch_code, coding_system, count(dxresearch_code)\n    FROM dxresearch\n    WHERE status=\'A\' AND\n    (\n      (LEFT(dxresearch_code, 3) IN (\'V66\') AND coding_system = ${dxcodesSysICD}) OR\n      (dxresearch_code IN (\'105499002\') AND coding_system LIKE ${dxcodesSysSnoMed})\n    )\n    GROUP BY demographic_no\n    ORDER BY demographic_no\n  ) dxr\n  ON d.demographic_no = dxr.demographic_no\n  -- Billed V66 in last 3 years\n  LEFT JOIN (\n    SELECT b.demographic_no as demographic_no, b.dx_code1 as dxcode1, b.dx_code2 as dxcode2, b.dx_code3 as dxcode3, count(b.demographic_no) as billcount\n    FROM billingmaster b\n    WHERE ( LEFT(b.dx_code1, 3) IN (\'V66\') OR LEFT(b.dx_code2, 3) IN (\'V66\') OR LEFT(b.dx_code3, 3) IN (\'V66\') )\n    AND DATE(b.createdate) > ${lowerLimit.billingdate}\n    AND b.demographic_no > 0\n    GROUP BY b.demographic_no HAVING COUNT(b.demographic_no) > -1\n  ) BILLING\n  ON (d.demographic_no = BILLING.demographic_no)  \n  -- Coded dx during visit encounter in last 3 years\n  LEFT JOIN(\n    SELECT ASSIGNED.demographic_no as demographic_no, observation_date as visitdate, uuid, count(ASSIGNED.demographic_no) as visitcount\n    FROM casemgmt_note note\n    INNER JOIN (\n      SELECT note_id, CODED.demo_no as demographic_no FROM casemgmt_issue_notes\n      INNER JOIN (\n        SELECT ci.id as id, ci.update_date, ci.demographic_no demo_no FROM issue i\n        INNER JOIN casemgmt_issue ci\n        ON i.issue_id = ci.issue_id\n        WHERE\n	(i.type LIKE ${dxcodesSysICD} AND LEFT(i.code, 3) IN (\'V66\')) OR\n	(i.type LIKE ${dxcodesSysSnoMed} AND i.code IN (\'105499002\'))\n      ) CODED\n      ON (casemgmt_issue_notes.id = CODED.id)\n      ORDER BY CODED.demo_no\n    ) ASSIGNED\n    ON note.note_id = ASSIGNED.note_id AND\n    -- GET LAST REVISION OF NOTE\n    note.note_id= (SELECT MAX(cmn.note_id) FROM casemgmt_note cmn WHERE cmn.uuid = note.uuid) AND\n    DATE(note.observation_date) > ${lowerLimit.visitdate}\n    GROUP BY demographic_no\n    ORDER BY demographic_no\n  ) VISIT\n  ON (d.demographic_no = VISIT.demographic_no)  \n  -- Consider OBS here if needed\n  LEFT JOIN ( \n    SELECT m.demographicNo AS demographic_no, m.dataField AS result, m.dateObserved AS dateObserved\n    FROM measurements m\n    INNER JOIN (\n      SELECT demographicNo, MAX(dateObserved) AS dateObserved\n      FROM measurements\n      WHERE type = ${obsName}\n      GROUP BY demographicNo\n    ) mlast\n    ON m.demographicNo = mlast.demographicNo\n    WHERE m.type = ${obsName}\n    AND m.dateObserved = mlast.dateObserved\n    AND m.demographicNo &gt; 0\n    GROUP BY m.demographicNo\n  ) OBSLAST\n  ON (d.demographic_no = OBSLAST.demographic_no)  \n  WHERE d.patient_status LIKE ${active}\n  AND d.demographic_no > 0\n  AND ( dxr.dxresearch_code IS NULL AND ((BILLING.billcount IS NOT NULL AND BILLING.billcount &gt;= ${numOfBills}) OR (VISIT.visitcount IS NOT NULL AND VISIT.visitcount &gt;= ${numOfVisits}) OR (OBSLAST.result IS NOT NULL AND OBSLAST.result &lt; ${obsResult})) )\n  AND d.provider_no LIKE ${provider}\n  ORDER BY d.demographic_no\n		</query>\n	</drillDownQuery>\n</indicatorTemplateXML>\n','','\0',0,NULL,NULL),
(37,5,'Advanced Care Planning Prevalence','CDM','Advanced Care Planning','DoBC CPQI PSP Panel','2017-08-02','% of active patients in the practice coded with Advanced Care Planning.','\ni) Advanced care patients: \"Patient Status: Active\nAND has a Current Problem List/Profile item code of 105499002 or starting with V66\"\nii) Other patients: \"Patient Status: Active\nAND does not have a Current Problem List/Profile item code of 105499002 or ','<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<indicatorTemplateXML>\n	<author>OSCAR BC</author>\n	<uid></uid>\n	<heading>\n		<category>CDM</category>\n		<subCategory>Advanced Care Planning</subCategory>\n		<name>Advanced Care Planning Prevalence</name>\n		<definition>% of active patients in the practice coded with Advanced Care Planning.</definition>\n		<framework>DoBC CPQI PSP Panel</framework>\n		<frameworkVersion>08-02-2017</frameworkVersion>\n		<notes>\ni) Advanced care patients: \"Patient Status: Active\nAND has a Current Problem List/Profile item code of 105499002 or starting with V66\"\nii) Other patients: \"Patient Status: Active\nAND does not have a Current Problem List/Profile item code of 105499002 or starting with V66\"\n		</notes>\n	</heading>\n	<indicatorQuery>\n		<version>03-13-2018</version>\n		<params>\n			<!-- \n				Required parameter provider. Value options are: \n					[ an individual providerNo, or provider range ] ie: value=\"370, 1001\" \n					\"all\" ie: value=\"all\" including null.\n					\"loggedInProvider\" ie:\n				Default is \"loggedInProvider\"\n				Use this parameter in the query as ${provider}\n				This parameter should be used for fetching patient\'s assigned to a MRP.\n				ie: WHERE demographic.provider_no = ${provider}\n			-->\n			<parameter id=\"provider\" name=\"provider_no\" value=\"loggedInProvider\" />\n			<parameter id=\"pstatus\" name=\"Patient Status\" value=\"\'AC\'\" />\n			<parameter id=\"dxcodesICD\" name=\"Dx Codes (ICD)\" value=\"V66\" />\n			<parameter id=\"dxcodesSysICD\" name=\"DX CodeSystem (ICD)\" value=\"\'icd9\'\" />\n			<parameter id=\"dxcodesSnoMed\" name=\"Dx Codes (SnoMed)\" value=\"105499002\" />\n			<parameter id=\"dxcodesSysSnoMed\" name=\"Dx CodeSystem (SnoMed)\" value=\"\'snomed%\'\" />\n		</params>\n		<query>\n			<!-- Indicator SQL Query here -->\nSELECT\n -- PERCENT OF TOTAL PATIENTS NOTED AS ACTIVE WITH CURRENT ADVANCED CARE PLANNING\n IF( COUNT(fin.patient) > 0, SUM( IF( dxresearch_code is not NULL , 1, 0) ) , 0 ) AS \"% Active, Current Advanced Care Planning\",\n -- PERCENT OF TOTAL PATIENTS NOTED AS ACTIVE WITHOUT CURRENT ADVANCED CARE PLANNING\n IF( COUNT(fin.patient) > 0, SUM( IF( dxresearch_code is NULL , 1, 0) ) , 0 ) AS \"% Active, No Current Advanced Care Planning\"\nFROM (\n SELECT d.demographic_no AS patient, d.patient_status AS pt_status, dxresearch_code\n FROM demographic d\n LEFT JOIN (\n  SELECT demographic_no, dxresearch_code, count(dxresearch_code)\n  FROM dxresearch\n  WHERE status=\'A\' AND\n  (\n   (LEFT(dxresearch_code, 3) IN (\'V66\') AND coding_system = ${dxcodesSysICD}) OR\n   (dxresearch_code IN (\'105499002\') AND coding_system LIKE ${dxcodesSysSnoMed})\n   )\n  GROUP BY demographic_no\n  ORDER BY demographic_no\n ) problems\n ON d.demographic_no = problems.demographic_no\n WHERE d.provider_no LIKE ${provider} AND d.patient_status = ${pstatus}\n) fin\n		</query>\n	</indicatorQuery>\n	<drillDownQuery>\n		<version>03-13-2018</version>\n		<params>\n			<parameter id=\"provider\" name=\"provider_no\" value=\"loggedInProvider\" />	\n			<parameter id=\"pstatus\" name=\"Patient Status\" value=\"\'AC\'\" />\n			<parameter id=\"dxcodesICD\" name=\"Dx Codes (ICD)\" value=\"V66\" />\n			<parameter id=\"dxcodesSysICD\" name=\"DX CodeSystem (ICD)\" value=\"\'icd9\'\" />\n			<parameter id=\"dxcodesSnoMed\" name=\"Dx Codes (SnoMed)\" value=\"105499002\" />\n			<parameter id=\"dxcodesSysSnoMed\" name=\"Dx CodeSystem (SnoMed)\" value=\"\'snomed%\'\" />\n		</params>\n		<displayColumns>\n			<column id=\"demographic\" name=\"d.demographic_no\" title=\"Patient Id\" primary=\"true\" />\n			<column id=\"name\" name=\"CONCAT( d.last_name, \', \', d.first_name )\" title=\"Patient Name\" primary=\"false\" />\n			<column id=\"dob\" name=\"DATE_FORMAT( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth), \'%m-%d-%Y\' )\" title=\"Date of Birth (mm-dd-yy)\" primary=\"false\" />\n			<column id=\"age\" name=\"TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )\" title=\"Age\" primary=\"false\" />\n			<column id=\"dxcode\" title=\"Dx System/Code\" name=\"CONCAT(MIN(dxr.coding_system),\'/\',MIN(dxr.dxresearch_code),IF( MIN(dxr.dxresearch_code) != MAX(dxr.dxresearch_code),CONCAT( \' &amp; \', MAX(dxr.coding_system), \'/\', MAX(dxr.dxresearch_code) ),\'\') )\" primary=\"false\" />\n		</displayColumns>\n		<exportColumns>\n			<column id=\"demographic\" name=\"d.demographic_no\" title=\"Patient Id\" primary=\"true\" />\n			<column id=\"firstName\" name=\"d.first_name\" title=\"First Name\" primary=\"false\" />\n			<column id=\"lastName\" name=\"d.last_name\" title=\"Last Name\" primary=\"false\" />\n			<column id=\"dob\" name=\"DATE_FORMAT( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth), \'%m-%d-%Y\' )\" title=\"Date of Birth (mm-dd-yy)\" primary=\"false\" />\n			<column id=\"age\" name=\"TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )\" title=\"Age\" primary=\"false\" />\n			<column id=\"dxcode\" title=\"Dx System/Code\" name=\"CONCAT(MIN(dxr.coding_system),\'/\',MIN(dxr.dxresearch_code),IF( MIN(dxr.dxresearch_code) != MAX(dxr.dxresearch_code),CONCAT( \' &amp; \', MAX(dxr.coding_system), \'/\', MAX(dxr.dxresearch_code) ),\'\') )\" primary=\"false\" />\n		</exportColumns>\n		<query>\n			<!-- Drilldown SQL Query here -->\nSELECT\n*			\nFROM demographic d\nLEFT JOIN dxresearch dxr\nON d.demographic_no = dxr.demographic_no\nWHERE d.patient_status=${pstatus}\nAND\n(\n (LEFT(dxr.dxresearch_code, 3) IN (\'V66\') AND dxr.coding_system = ${dxcodesSysICD}) OR\n (dxr.dxresearch_code IN (\'105499002\') AND dxr.coding_system LIKE ${dxcodesSysSnoMed})\n )\nAND dxr.status = \'A\'\nAND d.provider_no LIKE ${provider}\nGROUP BY d.demographic_no\nORDER BY COUNT(d.demographic_no) DESC, d.demographic_no\n		</query>\n	</drillDownQuery>\n</indicatorTemplateXML>\n','','\0',0,NULL,NULL),
(38,5,'Consider Chronic Kidney Disease','CDM','Chronic Kidney Disease','DoBC CPQI PSP Panel','2017-08-02','\n			Patients with chronic kidney disease dx in 2+ bills or 2+ visit encounters within last 3 years or eGFR <60 or ACR >=3\n		','\n		  Created for Doctors of BC\n		  i) Chronic Kidney Disease dx in 2+ bills: \"Patient Status: Active\nAND does not have a Current Problem List/Profile item code of 90688005, 709044004 OR starting with 585\nAND with >= 2 Bills with the ICD9 diagnosis code st','<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<indicatorTemplateXML>\n	<author>OSCAR BC</author>\n	<uid></uid>\n	<heading>\n		<category>CDM</category>\n		<subCategory>Chronic Kidney Disease</subCategory>\n		<name>Consider Chronic Kidney Disease</name>\n		<definition>\n			Patients with chronic kidney disease dx in 2+ bills or 2+ visit encounters within last 3 years or eGFR &lt;60 or ACR &gt;=3\n		</definition>\n		<framework>DoBC CPQI PSP Panel</framework>\n		<frameworkVersion>08-02-2017</frameworkVersion>\n		<notes>\n		  Created for Doctors of BC\n		  i) Chronic Kidney Disease dx in 2+ bills: \"Patient Status: Active\nAND does not have a Current Problem List/Profile item code of 90688005, 709044004 OR starting with 585\nAND with >= 2 Bills with the ICD9 diagnosis code starting with 585 in the last 3 years\"\n		  ii) Chronic Kidney Disease dx in 2+ visits: \"Patient Status: Active\nAND does not have a Current Problem List/Profile item code of 90688005, 709044004 OR starting with 585\nAND with >= 2 Visit Encounters with Snomed diagnosis code 90688005, 709044004 or the ICD9 diagnosis code starting with 585 in the last 3 years\"\n		  iii) eGFR &lt;60 or ACR &gt;=3: \"Patient Status: Active\nAND does not have a Current Problem List/Profile item code of 90688005, 709044004 OR starting with 585\nAND with last eGFR (estimated Glomerular Filtration Rate) lab result &lt;60 OR a last ACR (Albumin:creatinine ratio) lab result &gt;=3 OR  2 or more eGFR &lt;60 or ACR &gt;=3 in the last 2 years\"\n		</notes>\n	</heading>\n	<indicatorQuery>\n		<version>03-13-2018</version>\n		<params>\n			<parameter id=\"provider\" name=\"Provider Number\" value=\"loggedInProvider\" />\n			<parameter id=\"active\" name=\"Active Patients\" value=\"\'AC\'\" />\n			<parameter id=\"dxcodesICD\" name=\"Dx Codes (ICD)\" value=\"585\" />\n                        <parameter id=\"dxcodesSysICD\" name=\"DX CodeSystem (ICD)\" value=\"\'icd9\'\" />\n                        <parameter id=\"dxcodesSnoMed\" name=\"Dx Codes (SnoMed)\" value=\"90688005,709044004\" />\n                        <parameter id=\"dxcodesSysSnoMed\" name=\"Dx CodeSystem (SnoMed)\" value=\"\'snomed%\'\" />\n			<parameter id=\"billingCode\" name=\"ICD9 Billing Code\" value=\"585\" />\n			<parameter id=\"numOfBills\" name=\"Number of ICD9 585 Bills\" value=\"2\" />\n			<parameter id=\"numOfVisits\" name=\"Number of Visit Encounters coded 585/ICD9\" value=\"2\" />\n			<parameter id=\"obs1Name\" name=\"Obs 1 Name\" value=\"\'EGFR\'\" />\n			<parameter id=\"obs1Result\" name=\"Obs 1 Result\" value=\"60\" />\n			<parameter id=\"obs2Name\" name=\"Obs 2 Name\" value=\"\'ACR\'\" />\n			<parameter id=\"obs2Result\" name=\"Obs 2 Result\" value=\"3\" />\n			<parameter id=\"numOfObs\" name=\"Number of measurements\" value=\"2\" />			\n		</params>\n		<range>\n			<lowerLimit id=\"billingdate\" label=\"From Date\" name=\"Date\" value=\"DATE_SUB( NOW(), INTERVAL 3 YEAR )\" />\n			<upperLimit id=\"billingdate\" label=\"Date Today\" name=\"Date\" value=\"NOW()\" />\n			<lowerLimit id=\"visitdate\" label=\"From Date\" name=\"Date\" value=\"DATE_SUB( NOW(), INTERVAL 3 YEAR )\" />\n			<upperLimit id=\"visitdate\" label=\"Date Today\" name=\"Date\" value=\"NOW()\" />\n			<lowerLimit id=\"labdate\" label=\"From Date\" name=\"Date\" value=\"DATE_SUB( NOW(), INTERVAL 2 YEAR )\" />\n			<upperLimit id=\"labdate\" label=\"Date Today\" name=\"Date\" value=\"NOW()\" />\n		</range>\n		<query>\nSELECT\n  IF ( COUNT(fin.patient) &gt; 0, SUM( CASE WHEN (fin.dx IS NULL AND fin.billcount &gt;= ${numOfBills}) THEN 1 ELSE 0 END ) , 0) AS \"Chronic Kidney Disease dx in ${numOfBills}+ bills\",\n  IF ( COUNT(fin.patient) &gt; 0, SUM( CASE WHEN (fin.dx IS NULL AND fin.visitcount &gt;= ${numOfVisits}) THEN 1 ELSE 0 END ) , 0) AS \"Chronic Kidney Disease dx in ${numOfVisits}+ visits\",\n  IF ( COUNT(fin.patient) &gt; 0, SUM( CASE WHEN (fin.dx IS NULL AND (fin.result1 &lt; ${obs1Result} OR fin.result2 &gt;= ${obs2Result} OR fin.cntResult1 &gt;= ${numOfObs} OR fin.cntResult2 &gt;= ${numOfObs})) THEN 1 ELSE 0 END ) , 0) AS \"eGFR &lt; ${obs1Result} or ACR &gt;= ${obs2Result}\"  \nFROM ( \n  SELECT \n    d.demographic_no AS patient, \n    BILLING.billcount AS billcount,\n    VISIT.visitcount AS visitcount,\n    OBS1LAST.result AS result1,\n    OBS2LAST.result AS result2,\n    OBS1CNT.countOBS AS cntResult1,\n    OBS2CNT.countOBS AS cntResult2,\n    dxr.dxresearch_code AS dx,\n    dxr.coding_system AS dxs\n  FROM demographic d \n  LEFT JOIN (\n    SELECT demographic_no, dxresearch_code, coding_system, count(dxresearch_code)\n    FROM dxresearch\n    WHERE status=\'A\' AND\n    (\n      (LEFT(dxresearch_code, 3) IN (\'585\') AND coding_system = ${dxcodesSysICD}) OR\n      (dxresearch_code IN (\'90688005\',\'709044004\') AND coding_system LIKE ${dxcodesSysSnoMed})\n    )\n    GROUP BY demographic_no\n    ORDER BY demographic_no\n  ) dxr\n  ON d.demographic_no = dxr.demographic_no\n  -- Billed 585 in last 3 years\n  LEFT JOIN (\n    SELECT b.demographic_no as demographic_no, b.dx_code1 as dxcode1, b.dx_code2 as dxcode2, b.dx_code3 as dxcode3, count(b.demographic_no) as billcount\n    FROM billingmaster b\n    WHERE ( LEFT(b.dx_code1, 3) IN (\'585\') OR LEFT(b.dx_code2, 3) IN (\'585\') OR LEFT(b.dx_code3, 3) IN (\'585\') )\n    AND DATE(b.createdate) > ${lowerLimit.billingdate}\n    AND b.demographic_no > 0\n    GROUP BY b.demographic_no HAVING COUNT(b.demographic_no) > -1\n  ) BILLING\n  ON (d.demographic_no = BILLING.demographic_no)  \n  -- Coded dx during visit encounter in last 3 years\n  LEFT JOIN(\n    SELECT ASSIGNED.demographic_no as demographic_no, observation_date as visitdate, uuid, count(ASSIGNED.demographic_no) as visitcount\n    FROM casemgmt_note note\n    INNER JOIN (\n      SELECT note_id, CODED.demo_no as demographic_no FROM casemgmt_issue_notes\n      INNER JOIN (\n        SELECT ci.id as id, ci.update_date, ci.demographic_no demo_no FROM issue i\n        INNER JOIN casemgmt_issue ci\n        ON i.issue_id = ci.issue_id\n        WHERE\n	(i.type LIKE ${dxcodesSysICD} AND LEFT(i.code, 3) IN (\'585\')) OR\n	(i.type LIKE ${dxcodesSysSnoMed} AND i.code IN (\'90688005\',\'709044004\'))\n      ) CODED\n      ON (casemgmt_issue_notes.id = CODED.id)\n      ORDER BY CODED.demo_no\n    ) ASSIGNED\n    ON note.note_id = ASSIGNED.note_id AND\n    -- GET LAST REVISION OF NOTE\n    note.note_id= (SELECT MAX(cmn.note_id) FROM casemgmt_note cmn WHERE cmn.uuid = note.uuid) AND\n    DATE(note.observation_date) > ${lowerLimit.visitdate}\n    GROUP BY demographic_no\n    ORDER BY demographic_no\n  ) VISIT\n  ON (d.demographic_no = VISIT.demographic_no)\n  LEFT JOIN ( \n    SELECT m.demographicNo AS demographic_no, m.dataField as result, m.dateObserved AS dateObserved\n    FROM measurements m\n    INNER JOIN (\n      SELECT demographicNo, MAX(dateObserved) AS dateObserved\n      FROM measurements\n      WHERE type = ${obs1Name}\n      GROUP BY demographicNo\n    ) mlast\n    ON m.demographicNo = mlast.demographicNo\n    WHERE m.type = ${obs1Name}\n    AND m.dataField NOT LIKE \'>%\'\n    AND m.dateObserved = mlast.dateObserved\n    AND m.demographicNo &gt; 0\n    GROUP BY m.demographicNo HAVING COUNT(m.demographicNo) &gt; -1\n  ) OBS1LAST\n  ON (d.demographic_no = OBS1LAST.demographic_no) \n  LEFT JOIN ( \n    SELECT m.demographicNo AS demographic_no, m.dataField as result, m.dateObserved AS dateObserved\n    FROM measurements m\n    INNER JOIN (\n      SELECT demographicNo, MAX(dateObserved) AS dateObserved\n      FROM measurements\n      WHERE type = ${obs2Name}\n      GROUP BY demographicNo\n    ) mlast\n    ON m.demographicNo = mlast.demographicNo\n    WHERE m.type = ${obs2Name}\n    AND m.dateObserved = mlast.dateObserved\n    AND m.demographicNo &gt; 0\n    GROUP BY m.demographicNo HAVING COUNT(m.demographicNo) &gt; -1\n  ) OBS2LAST\n  ON (d.demographic_no = OBS2LAST.demographic_no)\n  LEFT JOIN ( \n    SELECT m.demographicNo AS demographic_no, m.dataField, count(m.dataField) as countOBS\n    FROM measurements m\n    WHERE m.type = ${obs1Name}\n    AND m.dataField NOT LIKE \'>%\' AND m.dataField &lt; ${obs1Result}\n    AND DATE(m.dateObserved) &gt; ${lowerLimit.labdate}\n    AND m.demographicNo &gt; 0\n    GROUP BY m.demographicNo HAVING COUNT(m.demographicNo) &gt; -1\n  ) OBS1CNT\n  ON (d.demographic_no = OBS1CNT.demographic_no) \n  LEFT JOIN ( \n    SELECT m.demographicNo AS demographic_no, m.dataField, count(m.dataField) as countOBS\n    FROM measurements m\n    WHERE m.type = ${obs2Name}\n    AND m.dataField &gt;= ${obs2Result}\n    AND DATE(m.dateObserved) &gt; ${lowerLimit.labdate}\n    AND m.demographicNo &gt; 0\n    GROUP BY m.demographicNo HAVING COUNT(m.demographicNo) &gt; -1\n  ) OBS2CNT\n  ON (d.demographic_no = OBS2CNT.demographic_no)\n  WHERE d.patient_status LIKE ${active}\n  AND d.demographic_no &gt; 0\n  AND d.provider_no LIKE ${provider} \n) fin\n		</query>\n	</indicatorQuery>\n	<drillDownQuery>\n		<version>03-13-2018</version>\n		<params>\n			<parameter id=\"provider\" name=\"Provider Number\" value=\"loggedInProvider\" />\n			<parameter id=\"active\" name=\"Active Patients\" value=\"\'AC\'\" />\n			<parameter id=\"dxcodesICD\" name=\"Dx Codes (ICD)\" value=\"585\" />\n                        <parameter id=\"dxcodesSysICD\" name=\"DX CodeSystem (ICD)\" value=\"\'icd9\'\" />\n                        <parameter id=\"dxcodesSnoMed\" name=\"Dx Codes (SnoMed)\" value=\"90688005,709044004\" />\n                        <parameter id=\"dxcodesSysSnoMed\" name=\"Dx CodeSystem (SnoMed)\" value=\"\'snomed%\'\" />\n			<parameter id=\"billingCode\" name=\"ICD9 Billing Code\" value=\"585\" />\n			<parameter id=\"numOfBills\" name=\"Number of ICD9 585 Bills\" value=\"2\" />\n			<parameter id=\"numOfVisits\" name=\"Number of Visit Encounters coded 585/ICD9\" value=\"2\" />\n			<parameter id=\"obs1Name\" name=\"Obs 1 Name\" value=\"\'EGFR\'\" />\n			<parameter id=\"obs1Result\" name=\"Obs 1 Result\" value=\"60\" />\n			<parameter id=\"obs2Name\" name=\"Obs 2 Name\" value=\"\'ACR\'\" />\n			<parameter id=\"obs2Result\" name=\"Obs 2 Result\" value=\"3\" />\n			<parameter id=\"numOfObs\" name=\"Number of measurements\" value=\"2\" />			\n		</params>\n		\n		<range>\n			<lowerLimit id=\"billingdate\" label=\"From Date\" name=\"Date\" value=\"DATE_SUB( NOW(), INTERVAL 3 YEAR )\" />\n			<upperLimit id=\"billingdate\" label=\"Date Today\" name=\"Date\" value=\"NOW()\" />\n			<lowerLimit id=\"visitdate\" label=\"From Date\" name=\"Date\" value=\"DATE_SUB( NOW(), INTERVAL 3 YEAR )\" />\n			<upperLimit id=\"visitdate\" label=\"Date Today\" name=\"Date\" value=\"NOW()\" />\n			<lowerLimit id=\"labdate\" label=\"From Date\" name=\"Date\" value=\"DATE_SUB( NOW(), INTERVAL 2 YEAR )\" />\n			<upperLimit id=\"labdate\" label=\"Date Today\" name=\"Date\" value=\"NOW()\" />\n		</range>\n		\n		<displayColumns>\n			<column id=\"demographic\" name=\"d.demographic_no\" title=\"Patient Id\" primary=\"true\" />\n			<column id=\"name\" name=\"CONCAT( d.last_name, \', \', d.first_name )\" title=\"Patient Name\" primary=\"false\" />\n			<column id=\"dob\" name=\"DATE_FORMAT( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth), \'%m-%d-%Y\' )\" title=\"Date of Birth\" primary=\"false\" />\n			<column id=\"age\" name=\"TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )\" title=\"Age\" primary=\"false\" />\n			<column id=\"billings\" name=\"IFNULL( BILLING.billcount, \'0\')\" title=\"Billings\" primary=\"false\" />\n			<column id=\"visits\" name=\"IFNULL( VISIT.visitcount, \'0\')\" title=\"Visits\" primary=\"false\" />\n			<column id=\"lastOBS1\" name=\"IFNULL( OBS1LAST.result, \'NA\')\" title=\"Last EGFR\" primary=\"false\" />\n			<column id=\"testDateOBS1\" name=\"IFNULL( DATE_FORMAT( OBS1LAST.dateObserved, \'%m-%d-%Y\' ), \'NA\')\" title=\"EGFR Date (yyyy-mm-dd)\" primary=\"false\" />\n			<column id=\"numOBS1s\" name=\"IFNULL( OBS1CNT.countOBS, \'0\')\" title=\"Num. eGFR &lt;60 Last 2yrs\" primary=\"false\" />\n			<column id=\"lastOBS2\" name=\"IFNULL( OBS2LAST.result, \'NA\')\" title=\"Last ACR\" primary=\"false\" />\n			<column id=\"testDateOBS2\" name=\"IFNULL( DATE_FORMAT( OBS2LAST.dateObserved, \'%m-%d-%Y\' ), \'NA\')\" title=\"ACR Date (yyyy-mm-dd)\" primary=\"false\" />\n			<column id=\"numOBS2s\" name=\"IFNULL( OBS2CNT.countOBS, \'0\')\" title=\"Num. ACR &gt;=3 Last 2yrs\" primary=\"false\" />\n		</displayColumns>\n		\n		<exportColumns>\n			<column id=\"demographic\" name=\"d.demographic_no\" title=\"Patient Id\" primary=\"true\" />\n                        <column id=\"firstName\" name=\"d.first_name\" title=\"First Name\" primary=\"false\" />\n                        <column id=\"lastName\" name=\"d.last_name\" title=\"Last Name\" primary=\"false\" />\n			<column id=\"dob\" name=\"DATE_FORMAT( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth), \'%m-%d-%Y\' )\" title=\"Date of Birth\" primary=\"false\" />\n			<column id=\"age\" name=\"TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )\" title=\"Age\" primary=\"false\" />\n			<column id=\"billings\" name=\"IFNULL( BILLING.billcount, \'0\')\" title=\"Billings\" primary=\"false\" />\n			<column id=\"visits\" name=\"IFNULL( VISIT.visitcount, \'0\')\" title=\"Visits\" primary=\"false\" />\n			<column id=\"lastOBS1\" name=\"IFNULL( OBS1LAST.result, \'NA\')\" title=\"Last EGFR\" primary=\"false\" />\n			<column id=\"testDateOBS1\" name=\"IFNULL( DATE_FORMAT( OBS1LAST.dateObserved, \'%m-%d-%Y\' ), \'NA\')\" title=\"EGFR Date (yyyy-mm-dd)\" primary=\"false\" />\n			<column id=\"numOBS1s\" name=\"IFNULL( OBS1CNT.countOBS, \'0\')\" title=\"Num. eGFR &lt;60 Last 2yrs\" primary=\"false\" />\n			<column id=\"lastOBS2\" name=\"IFNULL( OBS2LAST.result, \'NA\')\" title=\"Last ACR\" primary=\"false\" />\n			<column id=\"testDateOBS2\" name=\"IFNULL( DATE_FORMAT( OBS2LAST.dateObserved, \'%m-%d-%Y\' ), \'NA\')\" title=\"ACR Date (yyyy-mm-dd)\" primary=\"false\" />\n			<column id=\"numOBS2s\" name=\"IFNULL( OBS2CNT.countOBS, \'0\')\" title=\"Num. ACR &gt;=3 Last 2yrs\" primary=\"false\" />\n		</exportColumns>\n		<query>	\n  SELECT *	\n  FROM demographic d \n  LEFT JOIN (\n    SELECT demographic_no, dxresearch_code, coding_system, count(dxresearch_code)\n    FROM dxresearch\n    WHERE status=\'A\' AND\n    (\n      (LEFT(dxresearch_code, 3) IN (\'585\') AND coding_system = ${dxcodesSysICD}) OR\n      (dxresearch_code IN (\'90688005\',\'709044004\') AND coding_system LIKE ${dxcodesSysSnoMed})\n    )\n    GROUP BY demographic_no\n    ORDER BY demographic_no\n  ) dxr\n  ON d.demographic_no = dxr.demographic_no\n  -- Billed 585 in last 3 years\n  LEFT JOIN (\n    SELECT b.demographic_no as demographic_no, b.dx_code1 as dxcode1, b.dx_code2 as dxcode2, b.dx_code3 as dxcode3, count(b.demographic_no) as billcount\n    FROM billingmaster b\n    WHERE ( LEFT(b.dx_code1, 3) IN (\'585\') OR LEFT(b.dx_code2, 3) IN (\'585\') OR LEFT(b.dx_code3, 3) IN (\'585\') )\n    AND DATE(b.createdate) > ${lowerLimit.billingdate}\n    AND b.demographic_no > 0\n    GROUP BY b.demographic_no HAVING COUNT(b.demographic_no) > -1\n  ) BILLING\n  ON (d.demographic_no = BILLING.demographic_no)  \n  -- Coded dx during visit encounter in last 3 years\n  LEFT JOIN(\n    SELECT ASSIGNED.demographic_no as demographic_no, observation_date as visitdate, uuid, count(ASSIGNED.demographic_no) as visitcount\n    FROM casemgmt_note note\n    INNER JOIN (\n      SELECT note_id, CODED.demo_no as demographic_no FROM casemgmt_issue_notes\n      INNER JOIN (\n        SELECT ci.id as id, ci.update_date, ci.demographic_no demo_no FROM issue i\n        INNER JOIN casemgmt_issue ci\n        ON i.issue_id = ci.issue_id\n        WHERE\n	(i.type LIKE ${dxcodesSysICD} AND LEFT(i.code, 3) IN (\'585\')) OR\n	(i.type LIKE ${dxcodesSysSnoMed} AND i.code IN (\'90688005\',\'709044004\'))\n      ) CODED\n      ON (casemgmt_issue_notes.id = CODED.id)\n      ORDER BY CODED.demo_no\n    ) ASSIGNED\n    ON note.note_id = ASSIGNED.note_id AND\n    -- GET LAST REVISION OF NOTE\n    note.note_id= (SELECT MAX(cmn.note_id) FROM casemgmt_note cmn WHERE cmn.uuid = note.uuid) AND\n    DATE(note.observation_date) > ${lowerLimit.visitdate}\n    GROUP BY demographic_no\n    ORDER BY demographic_no\n  ) VISIT\n  ON (d.demographic_no = VISIT.demographic_no)  \n  -- Consider OBS here if needed\n  LEFT JOIN ( \n    SELECT m.demographicNo AS demographic_no, m.dataField as result, m.dateObserved AS dateObserved\n    FROM measurements m\n    INNER JOIN (\n      SELECT demographicNo, MAX(dateObserved) AS dateObserved\n      FROM measurements\n      WHERE type = ${obs1Name}\n      GROUP BY demographicNo\n    ) mlast\n    ON m.demographicNo = mlast.demographicNo\n    WHERE m.type = ${obs1Name}\n    AND m.dataField NOT LIKE \'>%\'\n    AND m.dateObserved = mlast.dateObserved\n    AND m.demographicNo &gt; 0\n    GROUP BY m.demographicNo HAVING COUNT(m.demographicNo) &gt; -1\n  ) OBS1LAST\n  ON (d.demographic_no = OBS1LAST.demographic_no) \n  LEFT JOIN (\n    SELECT m.demographicNo AS demographic_no, m.dataField as result, m.dateObserved AS dateObserved\n    FROM measurements m\n    INNER JOIN (\n      SELECT demographicNo, MAX(dateObserved) AS dateObserved\n      FROM measurements\n      WHERE type = ${obs2Name}\n      GROUP BY demographicNo\n    ) mlast\n    ON m.demographicNo = mlast.demographicNo\n    WHERE m.type = ${obs2Name}\n    AND m.dateObserved = mlast.dateObserved\n    AND m.demographicNo &gt; 0\n    GROUP BY m.demographicNo HAVING COUNT(m.demographicNo) &gt; -1\n  ) OBS2LAST\n  ON (d.demographic_no = OBS2LAST.demographic_no)\n  LEFT JOIN ( \n    SELECT m.demographicNo AS demographic_no, m.dataField, count(m.dataField) as countOBS\n    FROM measurements m\n    WHERE m.type = ${obs1Name}\n    AND m.dataField NOT LIKE \'>%\' AND m.dataField &lt; ${obs1Result}\n    AND DATE(m.dateObserved) &gt; ${lowerLimit.labdate}\n    AND m.demographicNo &gt; 0\n    GROUP BY m.demographicNo HAVING COUNT(m.demographicNo) &gt; -1\n  ) OBS1CNT\n  ON (d.demographic_no = OBS1CNT.demographic_no) \n  LEFT JOIN ( \n    SELECT m.demographicNo AS demographic_no, m.dataField, count(m.dataField) as countOBS\n    FROM measurements m\n    WHERE m.type = ${obs2Name}\n    AND m.dataField &gt;= ${obs2Result}\n    AND DATE(m.dateObserved) &gt; ${lowerLimit.labdate}\n    AND m.demographicNo &gt; 0\n    GROUP BY m.demographicNo HAVING COUNT(m.demographicNo) &gt; -1\n  ) OBS2CNT\n  ON (d.demographic_no = OBS2CNT.demographic_no)  \n  WHERE d.patient_status LIKE ${active}\n  AND d.demographic_no > 0\n  AND d.provider_no LIKE ${provider}\n  AND (\n  dxr.dxresearch_code IS NULL AND\n  ( (BILLING.billcount IS NOT NULL AND BILLING.billcount &gt;= ${numOfBills}) OR\n    (VISIT.visitcount IS NOT NULL AND VISIT.visitcount &gt;= ${numOfVisits}) OR\n    ( (OBS1LAST.result IS NOT NULL AND OBS1LAST.result &lt; ${obs1Result}) OR\n      (OBS2LAST.result IS NOT NULL AND OBS2LAST.result &gt;= ${obs2Result}) OR\n      (OBS1CNT.countOBS IS NOT NULL AND OBS1CNT.countOBS &gt;= ${numOfObs}) OR\n      (OBS2CNT.countOBS IS NOT NULL AND OBS2CNT.countOBS &gt;= ${numOfObs})) )\n  )\n  ORDER BY d.demographic_no\n		</query>\n	</drillDownQuery>\n</indicatorTemplateXML>\n','','\0',0,NULL,NULL),
(39,5,'Chronic Kidney Disease Prevalence','CDM','Chronic Kidney Disease','DoBC CPQI PSP Panel','2017-08-02','% of active patients in the practice coded with Chronic Kidney Disease.','\ni) CKD patients: \"Patient Status: Active\nAND has a Current Problem List/Profile item code of 90688005, 709044004 OR starting with 585\"\nii) Other patients: \"Patient Status: Active\nAND does not have a Current Problem List/Profile item code of 90688005, 709','<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<indicatorTemplateXML>\n	<author>OSCAR BC</author>\n	<uid></uid>\n	<heading>\n		<category>CDM</category>\n		<subCategory>Chronic Kidney Disease</subCategory>\n		<name>Chronic Kidney Disease Prevalence</name>\n		<definition>% of active patients in the practice coded with Chronic Kidney Disease.</definition>\n		<framework>DoBC CPQI PSP Panel</framework>\n		<frameworkVersion>08-02-2017</frameworkVersion>\n		<notes>\ni) CKD patients: \"Patient Status: Active\nAND has a Current Problem List/Profile item code of 90688005, 709044004 OR starting with 585\"\nii) Other patients: \"Patient Status: Active\nAND does not have a Current Problem List/Profile item code of 90688005, 709044004 OR starting with 585\"\n		</notes>\n	</heading>\n	<indicatorQuery>\n		<version>03-13-2018</version>\n		<params>\n			<!-- \n				Required parameter provider. Value options are: \n					[ an individual providerNo, or provider range ] ie: value=\"370, 1001\" \n					\"all\" ie: value=\"all\" including null.\n					\"loggedInProvider\" ie:\n				Default is \"loggedInProvider\"\n				Use this parameter in the query as ${provider}\n				This parameter should be used for fetching patient\'s assigned to a MRP.\n				ie: WHERE demographic.provider_no = ${provider}\n			-->\n			<parameter id=\"provider\" name=\"provider_no\" value=\"loggedInProvider\" />\n			<parameter id=\"pstatus\" name=\"Patient Status\" value=\"\'AC\'\" />\n			<parameter id=\"dxcodesICD\" name=\"Dx Codes (ICD)\" value=\"585\" />\n			<parameter id=\"dxcodesSysICD\" name=\"DX CodeSystem (ICD)\" value=\"\'icd9\'\" />\n			<parameter id=\"dxcodesSnoMed\" name=\"Dx Codes (SnoMed)\" value=\"90688005,709044004\" />\n			<parameter id=\"dxcodesSysSnoMed\" name=\"Dx CodeSystem (SnoMed)\" value=\"\'snomed%\'\" />\n		</params>\n		<query>\n			<!-- Indicator SQL Query here -->\nSELECT\n -- PERCENT OF TOTAL PATIENTS NOTED AS ACTIVE WITH CURRENT CHRONIC KIDNEY DISEASE\n IF( COUNT(fin.patient) > 0, SUM( IF( dxresearch_code is not NULL , 1, 0) ) , 0 ) AS \"% Active, Current Chronic Kidney Disease\",\n -- PERCENT OF TOTAL PATIENTS NOTED AS ACTIVE WITHOUT CURRENT CHRONIC KIDNEY DISEASE\n IF( COUNT(fin.patient) > 0, SUM( IF( dxresearch_code is NULL , 1, 0) ) , 0 ) AS \"% Active, No Current Chronic Kidney Disease\"\nFROM (\n SELECT d.demographic_no AS patient, d.patient_status AS pt_status, dxresearch_code\n FROM demographic d\n LEFT JOIN (\n  SELECT demographic_no, dxresearch_code, count(dxresearch_code)\n  FROM dxresearch\n  WHERE status=\'A\' AND\n  (\n   (LEFT(dxresearch_code, 3) IN (\'585\') AND coding_system = ${dxcodesSysICD}) OR\n   (dxresearch_code IN (\'90688005\', \'709044004\') AND coding_system LIKE ${dxcodesSysSnoMed})\n   )\n  GROUP BY demographic_no\n  ORDER BY demographic_no\n ) problems\n ON d.demographic_no = problems.demographic_no\n WHERE d.provider_no LIKE ${provider} AND d.patient_status = ${pstatus}\n) fin\n		</query>\n	</indicatorQuery>\n	<drillDownQuery>\n		<version>03-13-2018</version>\n		<params>\n			<parameter id=\"provider\" name=\"provider_no\" value=\"loggedInProvider\" />	\n			<parameter id=\"pstatus\" name=\"Patient Status\" value=\"\'AC\'\" />\n			<parameter id=\"dxcodesICD\" name=\"Dx Codes (ICD)\" value=\"585\" />\n			<parameter id=\"dxcodesSysICD\" name=\"DX CodeSystem (ICD)\" value=\"\'icd9\'\" />\n			<parameter id=\"dxcodesSnoMed\" name=\"Dx Codes (SnoMed)\" value=\"90688005,709044004\" />\n			<parameter id=\"dxcodesSysSnoMed\" name=\"Dx CodeSystem (SnoMed)\" value=\"\'snomed%\'\" />\n		</params>\n		<displayColumns>\n			<column id=\"demographic\" name=\"d.demographic_no\" title=\"Patient Id\" primary=\"true\" />\n			<column id=\"name\" name=\"CONCAT( d.last_name, \', \', d.first_name )\" title=\"Patient Name\" primary=\"false\" />\n			<column id=\"dob\" name=\"DATE_FORMAT( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth), \'%m-%d-%Y\' )\" title=\"Date of Birth (mm-dd-yy)\" primary=\"false\" />\n			<column id=\"age\" name=\"TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )\" title=\"Age\" primary=\"false\" />\n			<column id=\"dxcode\" title=\"Dx System/Code\" name=\"CONCAT(MIN(dxr.coding_system),\'/\',MIN(dxr.dxresearch_code),IF( MIN(dxr.dxresearch_code) != MAX(dxr.dxresearch_code),CONCAT( \' &amp; \', MAX(dxr.coding_system), \'/\', MAX(dxr.dxresearch_code) ),\'\') )\" primary=\"false\" />\n		</displayColumns>\n		<exportColumns>\n			<column id=\"demographic\" name=\"d.demographic_no\" title=\"Patient Id\" primary=\"true\" />\n			<column id=\"firstName\" name=\"d.first_name\" title=\"First Name\" primary=\"false\" />\n			<column id=\"lastName\" name=\"d.last_name\" title=\"Last Name\" primary=\"false\" />\n			<column id=\"dob\" name=\"DATE_FORMAT( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth), \'%m-%d-%Y\' )\" title=\"Date of Birth (mm-dd-yy)\" primary=\"false\" />\n			<column id=\"age\" name=\"TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )\" title=\"Age\" primary=\"false\" />\n			<column id=\"dxcode\" title=\"Dx System/Code\" name=\"CONCAT(MIN(dxr.coding_system),\'/\',MIN(dxr.dxresearch_code),IF( MIN(dxr.dxresearch_code) != MAX(dxr.dxresearch_code),CONCAT( \' &amp; \', MAX(dxr.coding_system), \'/\', MAX(dxr.dxresearch_code) ),\'\') )\" primary=\"false\" />\n		</exportColumns>\n		<query>\n			<!-- Drilldown SQL Query here -->\nSELECT\n*			\nFROM demographic d\nLEFT JOIN dxresearch dxr\nON d.demographic_no = dxr.demographic_no\nWHERE d.patient_status=${pstatus}\nAND\n(\n (LEFT(dxr.dxresearch_code, 3) IN (\'585\') AND dxr.coding_system = ${dxcodesSysICD}) OR\n (dxr.dxresearch_code IN (\'90688005\', \'709044004\') AND dxr.coding_system LIKE ${dxcodesSysSnoMed})\n )\nAND dxr.status = \'A\'\nAND d.provider_no LIKE ${provider}\nGROUP BY d.demographic_no\nORDER BY COUNT(d.demographic_no) DESC, d.demographic_no\n		</query>\n	</drillDownQuery>\n</indicatorTemplateXML>\n','','\0',0,NULL,NULL),
(40,5,'Consider Chronic Liver Disease','CDM','Chronic Liver Disease','DoBC CPQI PSP Panel','2017-08-02','\n			Patients with chronic liver disease dx in 2+ bills or 2+ visit encounters within last 3 years\n		','\n		  Created for Doctors of BC\n		  i) Chronic Liver Disease dx in 2+ bills: \"Patient Status: Active\nAND does not have a Current Problem List/Profile item code of 328383001 or starting with 571, 573\nAND with >=2 Bills with the billing code starting with 57','<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<indicatorTemplateXML>\n	<author>OSCAR BC</author>\n	<uid></uid>\n	<heading>\n		<category>CDM</category>\n		<subCategory>Chronic Liver Disease</subCategory>\n		<name>Consider Chronic Liver Disease</name>\n		<definition>\n			Patients with chronic liver disease dx in 2+ bills or 2+ visit encounters within last 3 years\n		</definition>\n		<framework>DoBC CPQI PSP Panel</framework>\n		<frameworkVersion>08-02-2017</frameworkVersion>\n		<notes>\n		  Created for Doctors of BC\n		  i) Chronic Liver Disease dx in 2+ bills: \"Patient Status: Active\nAND does not have a Current Problem List/Profile item code of 328383001 or starting with 571, 573\nAND with >=2 Bills with the billing code starting with 571, 573 in the last 3 years\"\n		  ii) Chronic Liver Disease dx in 2+ visits: \"Patient Status: Active\nAND does not have a Current Problem List/Profile item code of 328383001 or starting with 571, 573\nAND with >=2 Visit Encounters with the Snomed diagnosis code 328383001 or the ICD9 diagnosis code starting with 571, 573 in the last 3 years\"\n		</notes>\n	</heading>\n	<indicatorQuery>\n		<version>03-13-2018</version>\n		<params>\n			<parameter id=\"provider\" name=\"Provider Number\" value=\"loggedInProvider\" />\n			<parameter id=\"active\" name=\"Active Patients\" value=\"\'AC\'\" />\n			<parameter id=\"dxcodesICD\" name=\"Dx Codes (ICD)\" value=\"571,573\" />\n                        <parameter id=\"dxcodesSysICD\" name=\"DX CodeSystem (ICD)\" value=\"\'icd9\'\" />\n                        <parameter id=\"dxcodesSnoMed\" name=\"Dx Codes (SnoMed)\" value=\"328383001\" />\n                        <parameter id=\"dxcodesSysSnoMed\" name=\"Dx CodeSystem (SnoMed)\" value=\"\'snomed%\'\" />\n			<parameter id=\"billingCode\" name=\"ICD9 Billing Code\" value=\"571,573\" />\n			<parameter id=\"numOfBills\" name=\"Number of ICD9 571,573 Bills\" value=\"2\" />\n			<parameter id=\"numOfVisits\" name=\"Number of Visit Encounters coded 571,573/ICD9\" value=\"2\" />\n		</params>\n		<range>\n			<lowerLimit id=\"billingdate\" label=\"From Date\" name=\"Date\" value=\"DATE_SUB( NOW(), INTERVAL 3 YEAR )\" />\n			<upperLimit id=\"billingdate\" label=\"Date Today\" name=\"Date\" value=\"NOW()\" />\n			<lowerLimit id=\"visitdate\" label=\"From Date\" name=\"Date\" value=\"DATE_SUB( NOW(), INTERVAL 3 YEAR )\" />\n			<upperLimit id=\"visitdate\" label=\"Date Today\" name=\"Date\" value=\"NOW()\" />\n		</range>\n		<query>\nSELECT\n  IF ( COUNT(fin.patient) &gt; 0, SUM( CASE WHEN (fin.dx IS NULL AND fin.billcount &gt;= ${numOfBills}) THEN 1 ELSE 0 END ) , 0) AS \"Chronic Liver Disease dx in ${numOfBills}+ bills\",\n  IF ( COUNT(fin.patient) &gt; 0, SUM( CASE WHEN (fin.dx IS NULL AND fin.visitcount &gt;= ${numOfVisits}) THEN 1 ELSE 0 END ) , 0) AS \"Chronic Liver Disease dx in ${numOfVisits}+ visits\"\n-- Consider OBS here if needed  \nFROM ( \n  SELECT \n    d.demographic_no AS patient, \n    BILLING.billcount AS billcount,\n    VISIT.visitcount AS visitcount,\n    dxr.dxresearch_code AS dx,\n    dxr.coding_system AS dxs\n  FROM demographic d \n  LEFT JOIN (\n    SELECT demographic_no, dxresearch_code, coding_system, count(dxresearch_code)\n    FROM dxresearch\n    WHERE status=\'A\' AND\n    (\n      (LEFT(dxresearch_code, 3) IN (\'571\',\'573\') AND coding_system = ${dxcodesSysICD}) OR\n      (dxresearch_code IN (\'328383001\') AND coding_system LIKE ${dxcodesSysSnoMed})\n    )\n    GROUP BY demographic_no\n    ORDER BY demographic_no\n  ) dxr\n  ON d.demographic_no = dxr.demographic_no\n  -- Billed 571,573 in last 3 years\n  LEFT JOIN (\n    SELECT b.demographic_no as demographic_no, b.dx_code1 as dxcode1, b.dx_code2 as dxcode2, b.dx_code3 as dxcode3, count(b.demographic_no) as billcount\n    FROM billingmaster b\n    WHERE ( LEFT(b.dx_code1, 3) IN (\'571\',\'573\') OR LEFT(b.dx_code2, 3) IN (\'571\',\'573\') OR LEFT(b.dx_code3, 3) IN (\'571\',\'573\') )\n    AND DATE(b.createdate) > ${lowerLimit.billingdate}\n    AND b.demographic_no > 0\n    GROUP BY b.demographic_no HAVING COUNT(b.demographic_no) > -1\n  ) BILLING\n  ON (d.demographic_no = BILLING.demographic_no)  \n  -- Coded dx during visit encounter in last 3 years\n  LEFT JOIN(\n    SELECT ASSIGNED.demographic_no as demographic_no, observation_date as visitdate, uuid, count(ASSIGNED.demographic_no) as visitcount\n    FROM casemgmt_note note\n    INNER JOIN (\n      SELECT note_id, CODED.demo_no as demographic_no FROM casemgmt_issue_notes\n      INNER JOIN (\n        SELECT ci.id as id, ci.update_date, ci.demographic_no demo_no FROM issue i\n        INNER JOIN casemgmt_issue ci\n        ON i.issue_id = ci.issue_id\n        WHERE\n	(i.type LIKE ${dxcodesSysICD} AND LEFT(i.code, 3) IN (\'571\',\'573\')) OR\n	(i.type LIKE ${dxcodesSysSnoMed} AND i.code IN (\'328383001\'))\n      ) CODED\n      ON (casemgmt_issue_notes.id = CODED.id)\n      ORDER BY CODED.demo_no\n    ) ASSIGNED\n    ON note.note_id = ASSIGNED.note_id AND\n    -- GET LAST REVISION OF NOTE\n    note.note_id= (SELECT MAX(cmn.note_id) FROM casemgmt_note cmn WHERE cmn.uuid = note.uuid) AND\n    DATE(note.observation_date) > ${lowerLimit.visitdate}\n    GROUP BY demographic_no\n    ORDER BY demographic_no\n  ) VISIT\n  ON (d.demographic_no = VISIT.demographic_no)  \n  WHERE d.patient_status LIKE ${active}\n  AND d.demographic_no > 0\n  AND d.provider_no LIKE ${provider} \n) fin\n		</query>\n	</indicatorQuery>\n	<drillDownQuery>\n		<version>03-13-2018</version>\n		<params>\n			<parameter id=\"provider\" name=\"Provider Number\" value=\"loggedInProvider\" />\n			<parameter id=\"active\" name=\"Active Patients\" value=\"\'AC\'\" />\n			<parameter id=\"dxcodesICD\" name=\"Dx Codes (ICD)\" value=\"571,573\" />\n                        <parameter id=\"dxcodesSysICD\" name=\"DX CodeSystem (ICD)\" value=\"\'icd9\'\" />\n                        <parameter id=\"dxcodesSnoMed\" name=\"Dx Codes (SnoMed)\" value=\"328383001\" />\n                        <parameter id=\"dxcodesSysSnoMed\" name=\"Dx CodeSystem (SnoMed)\" value=\"\'snomed%\'\" />\n			<parameter id=\"billingCode\" name=\"ICD9 Billing Code\" value=\"571,573\" />\n			<parameter id=\"numOfBills\" name=\"Number of ICD9 571,573 Bills\" value=\"2\" />\n			<parameter id=\"numOfVisits\" name=\"Number of Visit Encounters coded 571,573/ICD9\" value=\"2\" />\n		</params>\n		\n		<range>\n			<lowerLimit id=\"billingdate\" label=\"From Date\" name=\"Date\" value=\"DATE_SUB( NOW(), INTERVAL 3 YEAR )\" />\n			<upperLimit id=\"billingdate\" label=\"Date Today\" name=\"Date\" value=\"NOW()\" />\n			<lowerLimit id=\"visitdate\" label=\"From Date\" name=\"Date\" value=\"DATE_SUB( NOW(), INTERVAL 3 YEAR )\" />\n			<upperLimit id=\"visitdate\" label=\"Date Today\" name=\"Date\" value=\"NOW()\" />\n		</range>\n		\n		<displayColumns>\n			<column id=\"demographic\" name=\"d.demographic_no\" title=\"Patient Id\" primary=\"true\" />\n			<column id=\"name\" name=\"CONCAT( d.last_name, \', \', d.first_name )\" title=\"Patient Name\" primary=\"false\" />\n			<column id=\"dob\" name=\"DATE_FORMAT( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth), \'%m-%d-%Y\' )\" title=\"Date of Birth\" primary=\"false\" />\n			<column id=\"age\" name=\"TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )\" title=\"Age\" primary=\"false\" />\n			<column id=\"billings\" name=\"IFNULL( BILLING.billcount, \'0\')\" title=\"Billings\" primary=\"false\" />\n			<column id=\"visits\" name=\"IFNULL( VISIT.visitcount, \'0\')\" title=\"Visits\" primary=\"false\" />\n		</displayColumns>\n		\n		<exportColumns>\n			<column id=\"demographic\" name=\"d.demographic_no\" title=\"Patient Id\" primary=\"true\" />\n                        <column id=\"firstName\" name=\"d.first_name\" title=\"First Name\" primary=\"false\" />\n                        <column id=\"lastName\" name=\"d.last_name\" title=\"Last Name\" primary=\"false\" />\n			<column id=\"dob\" name=\"DATE_FORMAT( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth), \'%m-%d-%Y\' )\" title=\"Date of Birth\" primary=\"false\" />\n			<column id=\"age\" name=\"TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )\" title=\"Age\" primary=\"false\" />\n			<column id=\"billings\" name=\"IFNULL( BILLING.billcount, \'0\')\" title=\"Billings\" primary=\"false\" />\n			<column id=\"visits\" name=\"IFNULL( VISIT.visitcount, \'0\')\" title=\"Visits\" primary=\"false\" />\n		</exportColumns>\n		<query>	\n  SELECT *	\n  FROM demographic d \n  LEFT JOIN (\n    SELECT demographic_no, dxresearch_code, coding_system, count(dxresearch_code)\n    FROM dxresearch\n    WHERE status=\'A\' AND\n    (\n      (LEFT(dxresearch_code, 3) IN (\'571\',\'573\') AND coding_system = ${dxcodesSysICD}) OR\n      (dxresearch_code IN (\'328383001\') AND coding_system LIKE ${dxcodesSysSnoMed})\n    )\n    GROUP BY demographic_no\n    ORDER BY demographic_no\n  ) dxr\n  ON d.demographic_no = dxr.demographic_no\n  -- Billed 571,573 in last 3 years\n  LEFT JOIN (\n    SELECT b.demographic_no as demographic_no, b.dx_code1 as dxcode1, b.dx_code2 as dxcode2, b.dx_code3 as dxcode3, count(b.demographic_no) as billcount\n    FROM billingmaster b\n    WHERE ( LEFT(b.dx_code1, 3) IN (\'571\',\'573\') OR LEFT(b.dx_code2, 3) IN (\'571\',\'573\') OR LEFT(b.dx_code3, 3) IN (\'571\',\'573\') )\n    AND DATE(b.createdate) > ${lowerLimit.billingdate}\n    AND b.demographic_no > 0\n    GROUP BY b.demographic_no HAVING COUNT(b.demographic_no) > -1\n  ) BILLING\n  ON (d.demographic_no = BILLING.demographic_no)  \n  -- Coded dx during visit encounter in last 3 years\n  LEFT JOIN(\n    SELECT ASSIGNED.demographic_no as demographic_no, observation_date as visitdate, uuid, count(ASSIGNED.demographic_no) as visitcount\n    FROM casemgmt_note note\n    INNER JOIN (\n      SELECT note_id, CODED.demo_no as demographic_no FROM casemgmt_issue_notes\n      INNER JOIN (\n        SELECT ci.id as id, ci.update_date, ci.demographic_no demo_no FROM issue i\n        INNER JOIN casemgmt_issue ci\n        ON i.issue_id = ci.issue_id\n        WHERE\n	(i.type LIKE ${dxcodesSysICD} AND LEFT(i.code, 3) IN (\'571\',\'573\')) OR\n	(i.type LIKE ${dxcodesSysSnoMed} AND i.code IN (\'328383001\'))\n      ) CODED\n      ON (casemgmt_issue_notes.id = CODED.id)\n      ORDER BY CODED.demo_no\n    ) ASSIGNED\n    ON note.note_id = ASSIGNED.note_id AND\n    -- GET LAST REVISION OF NOTE\n    note.note_id= (SELECT MAX(cmn.note_id) FROM casemgmt_note cmn WHERE cmn.uuid = note.uuid) AND\n    DATE(note.observation_date) > ${lowerLimit.visitdate}\n    GROUP BY demographic_no\n    ORDER BY demographic_no\n  ) VISIT\n  ON (d.demographic_no = VISIT.demographic_no)  \n-- Consider OBS here if needed  \n  WHERE d.patient_status LIKE ${active}\n  AND d.demographic_no > 0\n  AND ( dxr.dxresearch_code IS NULL AND ((BILLING.billcount IS NOT NULL AND BILLING.billcount &gt;= ${numOfBills}) OR (VISIT.visitcount IS NOT NULL AND VISIT.visitcount &gt;= ${numOfVisits})))\n  AND d.provider_no LIKE ${provider}\n  ORDER BY d.demographic_no\n		</query>\n	</drillDownQuery>\n</indicatorTemplateXML>\n','','\0',0,NULL,NULL),
(41,5,'Chronic Liver Disease Prevalence','CDM','Chronic Liver Disease','DoBC CPQI PSP Panel','2017-08-02','% of active patients in the practice coded with Chronic Liver Disease.','\ni) Chronic Liver Disease: \"Patient Status: Active\nAND has a Current Problem List/Profile item code of 328383001 or starting with 571, 573\"\nii) Other patients: \"Patient Status: Active\nAND does not have a Current Problem List/Profile item code of 328383001','<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<indicatorTemplateXML>\n	<author>OSCAR BC</author>\n	<uid></uid>\n	<heading>\n		<category>CDM</category>\n		<subCategory>Chronic Liver Disease</subCategory>\n		<name>Chronic Liver Disease Prevalence</name>\n		<definition>% of active patients in the practice coded with Chronic Liver Disease.</definition>\n		<framework>DoBC CPQI PSP Panel</framework>\n		<frameworkVersion>08-02-2017</frameworkVersion>\n		<notes>\ni) Chronic Liver Disease: \"Patient Status: Active\nAND has a Current Problem List/Profile item code of 328383001 or starting with 571, 573\"\nii) Other patients: \"Patient Status: Active\nAND does not have a Current Problem List/Profile item code of 328383001 or starting with 571, 573\"\n		</notes>\n	</heading>\n	<indicatorQuery>\n		<version>03-13-2018</version>\n		<params>\n			<!-- \n				Required parameter provider. Value options are: \n					[ an individual providerNo, or provider range ] ie: value=\"370, 1001\" \n					\"all\" ie: value=\"all\" including null.\n					\"loggedInProvider\" ie:\n				Default is \"loggedInProvider\"\n				Use this parameter in the query as ${provider}\n				This parameter should be used for fetching patient\'s assigned to a MRP.\n				ie: WHERE demographic.provider_no = ${provider}\n			-->\n			<parameter id=\"provider\" name=\"provider_no\" value=\"loggedInProvider\" />\n			<parameter id=\"pstatus\" name=\"Patient Status\" value=\"\'AC\'\" />\n			<parameter id=\"dxcodesICD\" name=\"Dx Codes (ICD)\" value=\"571,573\" />\n			<parameter id=\"dxcodesSysICD\" name=\"DX CodeSystem (ICD)\" value=\"\'icd9\'\" />\n			<parameter id=\"dxcodesSnoMed\" name=\"Dx Codes (SnoMed)\" value=\"328383001\" />\n			<parameter id=\"dxcodesSysSnoMed\" name=\"Dx CodeSystem (SnoMed)\" value=\"\'snomed%\'\" />\n		</params>\n		<query>\n			<!-- Indicator SQL Query here -->\nSELECT\n -- PERCENT OF TOTAL PATIENTS NOTED AS ACTIVE WITH CURRENT CHRONIC LIVER DISEASE\n IF( COUNT(fin.patient) > 0, SUM( IF( dxresearch_code is not NULL , 1, 0) ) , 0 ) AS \"% Active, Current Chronic Liver Disease\",\n -- PERCENT OF TOTAL PATIENTS NOTED AS ACTIVE WITHOUT CURRENT CHRONIC LIVER DISEASE\n IF( COUNT(fin.patient) > 0, SUM( IF( dxresearch_code is NULL , 1, 0) ) , 0 ) AS \"% Active, No Current Chronic Liver Disease\"\nFROM (\n SELECT d.demographic_no AS patient, d.patient_status AS pt_status, dxresearch_code\n FROM demographic d\n LEFT JOIN (\n  SELECT demographic_no, dxresearch_code, count(dxresearch_code)\n  FROM dxresearch\n  WHERE status=\'A\' AND\n  (\n   (LEFT(dxresearch_code, 3) IN (\'571\', \'573\') AND coding_system = ${dxcodesSysICD}) OR\n   (dxresearch_code IN (\'328383001\') AND coding_system LIKE ${dxcodesSysSnoMed})\n   )\n  GROUP BY demographic_no\n  ORDER BY demographic_no\n ) problems\n ON d.demographic_no = problems.demographic_no\n WHERE d.provider_no LIKE ${provider} AND d.patient_status = ${pstatus}\n) fin\n		</query>\n	</indicatorQuery>\n	<drillDownQuery>\n		<version>03-13-2018</version>\n		<params>\n			<parameter id=\"provider\" name=\"provider_no\" value=\"loggedInProvider\" />	\n			<parameter id=\"pstatus\" name=\"Patient Status\" value=\"\'AC\'\" />\n			<parameter id=\"dxcodesICD\" name=\"Dx Codes (ICD)\" value=\"571,573\" />\n			<parameter id=\"dxcodesSysICD\" name=\"DX CodeSystem (ICD)\" value=\"\'icd9\'\" />\n			<parameter id=\"dxcodesSnoMed\" name=\"Dx Codes (SnoMed)\" value=\"328383001\" />\n			<parameter id=\"dxcodesSysSnoMed\" name=\"Dx CodeSystem (SnoMed)\" value=\"\'snomed%\'\" />\n		</params>\n		<displayColumns>\n			<column id=\"demographic\" name=\"d.demographic_no\" title=\"Patient Id\" primary=\"true\" />\n			<column id=\"name\" name=\"CONCAT( d.last_name, \', \', d.first_name )\" title=\"Patient Name\" primary=\"false\" />\n			<column id=\"dob\" name=\"DATE_FORMAT( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth), \'%m-%d-%Y\' )\" title=\"Date of Birth (mm-dd-yy)\" primary=\"false\" />\n			<column id=\"age\" name=\"TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )\" title=\"Age\" primary=\"false\" />\n			<column id=\"dxcode\" title=\"Dx System/Code\" name=\"CONCAT(MIN(dxr.coding_system),\'/\',MIN(dxr.dxresearch_code),IF( MIN(dxr.dxresearch_code) != MAX(dxr.dxresearch_code),CONCAT( \' &amp; \', MAX(dxr.coding_system), \'/\', MAX(dxr.dxresearch_code) ),\'\') )\" primary=\"false\" />\n		</displayColumns>\n		<exportColumns>\n			<column id=\"demographic\" name=\"d.demographic_no\" title=\"Patient Id\" primary=\"true\" />\n			<column id=\"firstName\" name=\"d.first_name\" title=\"First Name\" primary=\"false\" />\n			<column id=\"lastName\" name=\"d.last_name\" title=\"Last Name\" primary=\"false\" />\n			<column id=\"dob\" name=\"DATE_FORMAT( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth), \'%m-%d-%Y\' )\" title=\"Date of Birth (mm-dd-yy)\" primary=\"false\" />\n			<column id=\"age\" name=\"TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )\" title=\"Age\" primary=\"false\" />\n			<column id=\"dxcode\" title=\"Dx System/Code\" name=\"CONCAT(MIN(dxr.coding_system),\'/\',MIN(dxr.dxresearch_code),IF( MIN(dxr.dxresearch_code) != MAX(dxr.dxresearch_code),CONCAT( \' &amp; \', MAX(dxr.coding_system), \'/\', MAX(dxr.dxresearch_code) ),\'\') )\" primary=\"false\" />\n		</exportColumns>\n		<query>\n			<!-- Drilldown SQL Query here -->\nSELECT\n*			\nFROM demographic d\nLEFT JOIN dxresearch dxr\nON d.demographic_no = dxr.demographic_no\nWHERE d.patient_status=${pstatus}\nAND\n(\n (LEFT(dxr.dxresearch_code, 3) IN (\'571\', \'573\') AND dxr.coding_system = ${dxcodesSysICD}) OR\n (dxr.dxresearch_code IN (\'328383001\') AND dxr.coding_system LIKE ${dxcodesSysSnoMed})\n )\nAND dxr.status = \'A\'\nAND d.provider_no LIKE ${provider}\nGROUP BY d.demographic_no\nORDER BY COUNT(d.demographic_no) DESC, d.demographic_no\n		</query>\n	</drillDownQuery>\n</indicatorTemplateXML>\n','','\0',0,NULL,NULL),
(42,5,'Consider Frailty','CDM','Frailty','DoBC CPQI PSP Panel','2017-08-02','\n			Patients with frailty dx in 2+ bills or 2+ visit encounters within last 3 years\n		','\n		  Created for Doctors of BC\n		  i) Frailty dx in 2+ bills: \"Patient Status: Active\nAND does not have a Current Problem List/Profile item code of 248279007, 404904002, V15, 797 \nAND with >=2 Bills with the billing code of V15 in the last 3 years\"\n		  ii','<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<indicatorTemplateXML>\n	<author>OSCAR BC</author>\n	<uid></uid>\n	<heading>\n		<category>CDM</category>\n		<subCategory>Frailty</subCategory>\n		<name>Consider Frailty</name>\n		<definition>\n			Patients with frailty dx in 2+ bills or 2+ visit encounters within last 3 years\n		</definition>\n		<framework>DoBC CPQI PSP Panel</framework>\n		<frameworkVersion>08-02-2017</frameworkVersion>\n		<notes>\n		  Created for Doctors of BC\n		  i) Frailty dx in 2+ bills: \"Patient Status: Active\nAND does not have a Current Problem List/Profile item code of 248279007, 404904002, V15, 797 \nAND with >=2 Bills with the billing code of V15 in the last 3 years\"\n		  ii) Frailty dx in 2+ visits: \"Patient Status: Active\nAND does not have a Current Problem List/Profile item code of 248279007, 404904002, V15, 797 \nAND with >=2 Visit Encounters with Snomed diagnosis code 248279007, 404904002 or the ICD9 diagnosis code of V15, 797 in the last 3 years\"\n		</notes>\n	</heading>\n	<indicatorQuery>\n		<version>03-13-2018</version>\n		<params>\n			<parameter id=\"provider\" name=\"Provider Number\" value=\"loggedInProvider\" />\n			<parameter id=\"active\" name=\"Active Patients\" value=\"\'AC\'\" />\n			<parameter id=\"dxcodesICD\" name=\"Dx Codes (ICD)\" value=\"V15,797\" />\n                        <parameter id=\"dxcodesSysICD\" name=\"DX CodeSystem (ICD)\" value=\"\'icd9\'\" />\n                        <parameter id=\"dxcodesSnoMed\" name=\"Dx Codes (SnoMed)\" value=\"248279007,404904002\" />\n                        <parameter id=\"dxcodesSysSnoMed\" name=\"Dx CodeSystem (SnoMed)\" value=\"\'snomed%\'\" />\n			<parameter id=\"billingCode\" name=\"ICD9 Billing Code\" value=\"V15,797\" />\n			<parameter id=\"numOfBills\" name=\"Number of ICD9 V15 Bills\" value=\"2\" />\n			<parameter id=\"numOfVisits\" name=\"Number of Visit Encounters coded V15,797/ICD9\" value=\"2\" />\n		</params>\n		<range>\n			<lowerLimit id=\"billingdate\" label=\"From Date\" name=\"Date\" value=\"DATE_SUB( NOW(), INTERVAL 3 YEAR )\" />\n			<upperLimit id=\"billingdate\" label=\"Date Today\" name=\"Date\" value=\"NOW()\" />\n			<lowerLimit id=\"visitdate\" label=\"From Date\" name=\"Date\" value=\"DATE_SUB( NOW(), INTERVAL 3 YEAR )\" />\n			<upperLimit id=\"visitdate\" label=\"Date Today\" name=\"Date\" value=\"NOW()\" />\n		</range>\n		<query>\nSELECT\n  IF ( COUNT(fin.patient) &gt; 0, SUM( CASE WHEN (fin.dx IS NULL AND fin.billcount &gt;= ${numOfBills}) THEN 1 ELSE 0 END ) , 0) AS \"Frailty dx in ${numOfBills}+ bills\",\n  IF ( COUNT(fin.patient) &gt; 0, SUM( CASE WHEN (fin.dx IS NULL AND fin.visitcount &gt;= ${numOfVisits}) THEN 1 ELSE 0 END ) , 0) AS \"Frailty dx in ${numOfVisits}+ visits\"\n-- Consider OBS here if needed  \nFROM ( \n  SELECT \n    d.demographic_no AS patient, \n    BILLING.billcount AS billcount,\n    VISIT.visitcount AS visitcount,\n    dxr.dxresearch_code AS dx,\n    dxr.coding_system AS dxs\n  FROM demographic d \n  LEFT JOIN (\n    SELECT demographic_no, dxresearch_code, coding_system, count(dxresearch_code)\n    FROM dxresearch\n    WHERE status=\'A\' AND\n    (\n      (dxresearch_code IN (\'V15\', \'797\') AND coding_system = ${dxcodesSysICD}) OR\n      (dxresearch_code IN (\'248279007\',\'404904002\') AND coding_system LIKE ${dxcodesSysSnoMed})\n    )\n    GROUP BY demographic_no\n    ORDER BY demographic_no\n  ) dxr\n  ON d.demographic_no = dxr.demographic_no\n  -- Billed V15 in last 3 years\n  LEFT JOIN (\n    SELECT b.demographic_no as demographic_no, b.dx_code1 as dxcode1, b.dx_code2 as dxcode2, b.dx_code3 as dxcode3, count(b.demographic_no) as billcount\n    FROM billingmaster b\n    WHERE ( b.dx_code1 IN (\'V15\') OR b.dx_code2 IN (\'V15\') OR b.dx_code3 IN (\'V15\') )\n    AND DATE(b.createdate) > ${lowerLimit.billingdate}\n    AND b.demographic_no > 0\n    GROUP BY b.demographic_no HAVING COUNT(b.demographic_no) > -1\n  ) BILLING\n  ON (d.demographic_no = BILLING.demographic_no)  \n  -- Coded dx during visit encounter in last 3 years\n  LEFT JOIN(\n    SELECT ASSIGNED.demographic_no as demographic_no, observation_date as visitdate, uuid, count(ASSIGNED.demographic_no) as visitcount\n    FROM casemgmt_note note\n    INNER JOIN (\n      SELECT note_id, CODED.demo_no as demographic_no FROM casemgmt_issue_notes\n      INNER JOIN (\n        SELECT ci.id as id, ci.update_date, ci.demographic_no demo_no FROM issue i\n        INNER JOIN casemgmt_issue ci\n        ON i.issue_id = ci.issue_id\n        WHERE\n	(i.type LIKE ${dxcodesSysICD} AND i.code IN (\'V15\',\'797\')) OR\n	(i.type LIKE ${dxcodesSysSnoMed} AND i.code IN (\'248279007\',\'404904002\'))\n      ) CODED\n      ON (casemgmt_issue_notes.id = CODED.id)\n      ORDER BY CODED.demo_no\n    ) ASSIGNED\n    ON note.note_id = ASSIGNED.note_id AND\n    -- GET LAST REVISION OF NOTE\n    note.note_id= (SELECT MAX(cmn.note_id) FROM casemgmt_note cmn WHERE cmn.uuid = note.uuid) AND\n    DATE(note.observation_date) > ${lowerLimit.visitdate}\n    GROUP BY demographic_no\n    ORDER BY demographic_no\n  ) VISIT\n  ON (d.demographic_no = VISIT.demographic_no)  \n  WHERE d.patient_status LIKE ${active}\n  AND d.demographic_no > 0\n  AND d.provider_no LIKE ${provider} \n) fin\n		</query>\n	</indicatorQuery>\n	<drillDownQuery>\n		<version>03-13-2018</version>\n		<params>\n			<parameter id=\"provider\" name=\"Provider Number\" value=\"loggedInProvider\" />\n			<parameter id=\"active\" name=\"Active Patients\" value=\"\'AC\'\" />\n			<parameter id=\"dxcodesICD\" name=\"Dx Codes (ICD)\" value=\"V15,797\" />\n                        <parameter id=\"dxcodesSysICD\" name=\"DX CodeSystem (ICD)\" value=\"\'icd9\'\" />\n                        <parameter id=\"dxcodesSnoMed\" name=\"Dx Codes (SnoMed)\" value=\"248279007,404904002\" />\n                        <parameter id=\"dxcodesSysSnoMed\" name=\"Dx CodeSystem (SnoMed)\" value=\"\'snomed%\'\" />\n			<parameter id=\"billingCode\" name=\"ICD9 Billing Code\" value=\"V15,797\" />\n			<parameter id=\"numOfBills\" name=\"Number of ICD9 V15 Bills\" value=\"2\" />\n			<parameter id=\"numOfVisits\" name=\"Number of Visit Encounters coded V15,797/ICD9\" value=\"2\" />\n		</params>\n		\n		<range>\n			<lowerLimit id=\"billingdate\" label=\"From Date\" name=\"Date\" value=\"DATE_SUB( NOW(), INTERVAL 3 YEAR )\" />\n			<upperLimit id=\"billingdate\" label=\"Date Today\" name=\"Date\" value=\"NOW()\" />\n			<lowerLimit id=\"visitdate\" label=\"From Date\" name=\"Date\" value=\"DATE_SUB( NOW(), INTERVAL 3 YEAR )\" />\n			<upperLimit id=\"visitdate\" label=\"Date Today\" name=\"Date\" value=\"NOW()\" />\n		</range>\n		\n		<displayColumns>\n			<column id=\"demographic\" name=\"d.demographic_no\" title=\"Patient Id\" primary=\"true\" />\n			<column id=\"name\" name=\"CONCAT( d.last_name, \', \', d.first_name )\" title=\"Patient Name\" primary=\"false\" />\n			<column id=\"dob\" name=\"DATE_FORMAT( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth), \'%m-%d-%Y\' )\" title=\"Date of Birth\" primary=\"false\" />\n			<column id=\"age\" name=\"TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )\" title=\"Age\" primary=\"false\" />\n			<column id=\"billings\" name=\"IFNULL( BILLING.billcount, \'0\')\" title=\"Billings\" primary=\"false\" />\n			<column id=\"visits\" name=\"IFNULL( VISIT.visitcount, \'0\')\" title=\"Visits\" primary=\"false\" />\n		</displayColumns>\n		\n		<exportColumns>\n			<column id=\"demographic\" name=\"d.demographic_no\" title=\"Patient Id\" primary=\"true\" />\n                        <column id=\"firstName\" name=\"d.first_name\" title=\"First Name\" primary=\"false\" />\n                        <column id=\"lastName\" name=\"d.last_name\" title=\"Last Name\" primary=\"false\" />\n			<column id=\"dob\" name=\"DATE_FORMAT( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth), \'%m-%d-%Y\' )\" title=\"Date of Birth\" primary=\"false\" />\n			<column id=\"age\" name=\"TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )\" title=\"Age\" primary=\"false\" />\n			<column id=\"billings\" name=\"IFNULL( BILLING.billcount, \'0\')\" title=\"Billings\" primary=\"false\" />\n			<column id=\"visits\" name=\"IFNULL( VISIT.visitcount, \'0\')\" title=\"Visits\" primary=\"false\" />\n		</exportColumns>\n		<query>	\n  SELECT *	\n  FROM demographic d \n  LEFT JOIN (\n    SELECT demographic_no, dxresearch_code, coding_system, count(dxresearch_code)\n    FROM dxresearch\n    WHERE status=\'A\' AND\n    (\n      (dxresearch_code IN (\'V15\', \'797\') AND coding_system = ${dxcodesSysICD}) OR\n      (dxresearch_code IN (\'248279007\',\'404904002\') AND coding_system LIKE ${dxcodesSysSnoMed})\n    )\n    GROUP BY demographic_no\n    ORDER BY demographic_no\n  ) dxr\n  ON d.demographic_no = dxr.demographic_no\n  -- Billed V15 in last 3 years\n  LEFT JOIN (\n    SELECT b.demographic_no as demographic_no, b.dx_code1 as dxcode1, b.dx_code2 as dxcode2, b.dx_code3 as dxcode3, count(b.demographic_no) as billcount\n    FROM billingmaster b\n    WHERE ( b.dx_code1 IN (\'V15\') OR b.dx_code2 IN (\'V15\') OR b.dx_code3 IN (\'V15\') )\n    AND DATE(b.createdate) > ${lowerLimit.billingdate}\n    AND b.demographic_no > 0\n    GROUP BY b.demographic_no HAVING COUNT(b.demographic_no) > -1\n  ) BILLING\n  ON (d.demographic_no = BILLING.demographic_no)  \n  -- Coded dx during visit encounter in last 3 years\n  LEFT JOIN(\n    SELECT ASSIGNED.demographic_no as demographic_no, observation_date as visitdate, uuid, count(ASSIGNED.demographic_no) as visitcount\n    FROM casemgmt_note note\n    INNER JOIN (\n      SELECT note_id, CODED.demo_no as demographic_no FROM casemgmt_issue_notes\n      INNER JOIN (\n        SELECT ci.id as id, ci.update_date, ci.demographic_no demo_no FROM issue i\n        INNER JOIN casemgmt_issue ci\n        ON i.issue_id = ci.issue_id\n        WHERE\n	(i.type LIKE ${dxcodesSysICD} and LEFT(i.code, 3) IN (\'V15\',\'797\')) OR\n	(i.type LIKE ${dxcodesSysSnoMed} AND i.code IN (\'248279007\',\'404904002\'))\n      ) CODED\n      ON (casemgmt_issue_notes.id = CODED.id)\n      ORDER BY CODED.demo_no\n    ) ASSIGNED\n    ON note.note_id = ASSIGNED.note_id AND\n    -- GET LAST REVISION OF NOTE\n    note.note_id= (SELECT MAX(cmn.note_id) FROM casemgmt_note cmn WHERE cmn.uuid = note.uuid) AND\n    DATE(note.observation_date) > ${lowerLimit.visitdate}\n    GROUP BY demographic_no\n    ORDER BY demographic_no\n  ) VISIT\n  ON (d.demographic_no = VISIT.demographic_no)  \n-- Consider OBS here if needed  \n  WHERE d.patient_status LIKE ${active}\n  AND d.demographic_no > 0\n  AND ( dxr.dxresearch_code IS NULL AND ((BILLING.billcount IS NOT NULL AND BILLING.billcount &gt;= ${numOfBills}) OR (VISIT.visitcount IS NOT NULL AND VISIT.visitcount &gt;= ${numOfVisits})))\n  AND d.provider_no LIKE ${provider}\n  ORDER BY d.demographic_no\n		</query>\n	</drillDownQuery>\n</indicatorTemplateXML>\n','','\0',0,NULL,NULL),
(43,5,'Frailty Prevalence','CDM','Frailty','DoBC CPQI PSP Panel','2017-08-02','% of active patients in the practice coded with Frailty.','\ni) Frailty patients: \"Patient Status: Active\nAND has a Current Problem List/Profile item code of 248279007, 404904002, V15, 797\"\nii) Other patients: \"Patient Status: Active\nAND does not have a Current Problem List/Profile item code of 248279007, 40490400','<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<indicatorTemplateXML>\n	<author>OSCAR BC</author>\n	<uid></uid>\n	<heading>\n		<category>CDM</category>\n		<subCategory>Frailty</subCategory>\n		<name>Frailty Prevalence</name>\n		<definition>% of active patients in the practice coded with Frailty.</definition>\n		<framework>DoBC CPQI PSP Panel</framework>\n		<frameworkVersion>08-02-2017</frameworkVersion>\n		<notes>\ni) Frailty patients: \"Patient Status: Active\nAND has a Current Problem List/Profile item code of 248279007, 404904002, V15, 797\"\nii) Other patients: \"Patient Status: Active\nAND does not have a Current Problem List/Profile item code of 248279007, 404904002, V15, 797\"\n		</notes>\n	</heading>\n	<indicatorQuery>\n		<version>03-13-2018</version>\n		<params>\n			<!-- \n				Required parameter provider. Value options are: \n					[ an individual providerNo, or provider range ] ie: value=\"370, 1001\" \n					\"all\" ie: value=\"all\" including null.\n					\"loggedInProvider\" ie:\n				Default is \"loggedInProvider\"\n				Use this parameter in the query as ${provider}\n				This parameter should be used for fetching patient\'s assigned to a MRP.\n				ie: WHERE demographic.provider_no = ${provider}\n			-->\n			<parameter id=\"provider\" name=\"provider_no\" value=\"loggedInProvider\" />\n			<parameter id=\"pstatus\" name=\"Patient Status\" value=\"\'AC\'\" />\n			<parameter id=\"dxcodesICD\" name=\"Dx Codes (ICD)\" value=\"V15,797\" />\n			<parameter id=\"dxcodesSysICD\" name=\"DX CodeSystem (ICD)\" value=\"\'icd9\'\" />\n			<parameter id=\"dxcodesSnoMed\" name=\"Dx Codes (SnoMed)\" value=\"248279007,404904002\" />\n			<parameter id=\"dxcodesSysSnoMed\" name=\"Dx CodeSystem (SnoMed)\" value=\"\'snomed%\'\" />\n		</params>\n		<query>\n			<!-- Indicator SQL Query here -->\nSELECT\n -- PERCENT OF TOTAL PATIENTS NOTED AS ACTIVE WITH CURRENT FRAILTY\n IF( COUNT(fin.patient) > 0, SUM( IF( dxresearch_code is not NULL , 1, 0) ) , 0 ) AS \"% Active, Current Frailty\",\n -- PERCENT OF TOTAL PATIENTS NOTED AS ACTIVE WITHOUT CURRENT FRAILTY\n IF( COUNT(fin.patient) > 0, SUM( IF( dxresearch_code is NULL , 1, 0) ) , 0 ) AS \"% Active, No Current Frailty\"\nFROM (\n SELECT d.demographic_no AS patient, d.patient_status AS pt_status, dxresearch_code\n FROM demographic d\n LEFT JOIN (\n  SELECT demographic_no, dxresearch_code, count(dxresearch_code)\n  FROM dxresearch\n  WHERE status=\'A\' AND\n  (\n   (dxresearch_code IN (\'V15\', \'797\') AND coding_system = ${dxcodesSysICD}) OR\n   (dxresearch_code IN (\'248279007\', \'404904002\') AND coding_system LIKE ${dxcodesSysSnoMed})\n   )\n  GROUP BY demographic_no\n  ORDER BY demographic_no\n ) problems\n ON d.demographic_no = problems.demographic_no\n WHERE d.provider_no LIKE ${provider} AND d.patient_status = ${pstatus}\n) fin\n		</query>\n	</indicatorQuery>\n	<drillDownQuery>\n		<version>03-13-2018</version>\n		<params>\n			<parameter id=\"provider\" name=\"provider_no\" value=\"loggedInProvider\" />	\n			<parameter id=\"pstatus\" name=\"Patient Status\" value=\"\'AC\'\" />\n			<parameter id=\"dxcodesICD\" name=\"Dx Codes (ICD)\" value=\"V15,797\" />\n			<parameter id=\"dxcodesSysICD\" name=\"DX CodeSystem (ICD)\" value=\"\'icd9\'\" />\n			<parameter id=\"dxcodesSnoMed\" name=\"Dx Codes (SnoMed)\" value=\"248279007,404904002\" />\n			<parameter id=\"dxcodesSysSnoMed\" name=\"Dx CodeSystem (SnoMed)\" value=\"\'snomed%\'\" />\n		</params>\n		<displayColumns>\n			<column id=\"demographic\" name=\"d.demographic_no\" title=\"Patient Id\" primary=\"true\" />\n			<column id=\"name\" name=\"CONCAT( d.last_name, \', \', d.first_name )\" title=\"Patient Name\" primary=\"false\" />\n			<column id=\"dob\" name=\"DATE_FORMAT( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth), \'%m-%d-%Y\' )\" title=\"Date of Birth (mm-dd-yy)\" primary=\"false\" />\n			<column id=\"age\" name=\"TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )\" title=\"Age\" primary=\"false\" />\n			<column id=\"dxcode\" title=\"Dx System/Code\" name=\"CONCAT(MIN(dxr.coding_system),\'/\',MIN(dxr.dxresearch_code),IF( MIN(dxr.dxresearch_code) != MAX(dxr.dxresearch_code),CONCAT( \' &amp; \', MAX(dxr.coding_system), \'/\', MAX(dxr.dxresearch_code) ),\'\') )\" primary=\"false\" />\n		</displayColumns>\n		<exportColumns>\n			<column id=\"demographic\" name=\"d.demographic_no\" title=\"Patient Id\" primary=\"true\" />\n			<column id=\"firstName\" name=\"d.first_name\" title=\"First Name\" primary=\"false\" />\n			<column id=\"lastName\" name=\"d.last_name\" title=\"Last Name\" primary=\"false\" />\n			<column id=\"dob\" name=\"DATE_FORMAT( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth), \'%m-%d-%Y\' )\" title=\"Date of Birth (mm-dd-yy)\" primary=\"false\" />\n			<column id=\"age\" name=\"TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )\" title=\"Age\" primary=\"false\" />\n			<column id=\"dxcode\" title=\"Dx System/Code\" name=\"CONCAT(MIN(dxr.coding_system),\'/\',MIN(dxr.dxresearch_code),IF( MIN(dxr.dxresearch_code) != MAX(dxr.dxresearch_code),CONCAT( \' &amp; \', MAX(dxr.coding_system), \'/\', MAX(dxr.dxresearch_code) ),\'\') )\" primary=\"false\" />\n		</exportColumns>\n		<query>\n			<!-- Drilldown SQL Query here -->\nSELECT\n*			\nFROM demographic d\nLEFT JOIN dxresearch dxr\nON d.demographic_no = dxr.demographic_no\nWHERE d.patient_status=${pstatus}\nAND\n(\n (dxr.dxresearch_code IN (\'V15\', \'797\') AND dxr.coding_system = ${dxcodesSysICD}) OR\n (dxr.dxresearch_code IN (\'248279007\', \'404904002\') AND dxr.coding_system LIKE ${dxcodesSysSnoMed})\n )\nAND dxr.status = \'A\'\nAND d.provider_no LIKE ${provider}\nGROUP BY d.demographic_no\nORDER BY COUNT(d.demographic_no) DESC, d.demographic_no\n		</query>\n	</drillDownQuery>\n</indicatorTemplateXML>\n','','\0',0,NULL,NULL),
(44,5,'Consider Ischemic Cerebrovascular Disease','CDM','Ischemic Cerebrovascular Disease','DoBC CPQI PSP Panel','2017-08-02','\n			Patients with ischemic cerebrovascular disease dx in 2+ bills or 2+ visit encounters within last 3 years\n		','\n		  Created for Doctors of BC\n		  i) Ischemic Cerebrovascular Disease dx in 2+ bills: \"Patient Status: Active\nAND does not have a Current Problem List/Profile item code of 64009001, 195236009, 266257000, 288723005  OR starting with 430, 431, 433, 434, 43','<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<indicatorTemplateXML>\n	<author>OSCAR BC</author>\n	<uid></uid>\n	<heading>\n		<category>CDM</category>\n		<subCategory>Ischemic Cerebrovascular Disease</subCategory>\n		<name>Consider Ischemic Cerebrovascular Disease</name>\n		<definition>\n			Patients with ischemic cerebrovascular disease dx in 2+ bills or 2+ visit encounters within last 3 years\n		</definition>\n		<framework>DoBC CPQI PSP Panel</framework>\n		<frameworkVersion>08-02-2017</frameworkVersion>\n		<notes>\n		  Created for Doctors of BC\n		  i) Ischemic Cerebrovascular Disease dx in 2+ bills: \"Patient Status: Active\nAND does not have a Current Problem List/Profile item code of 64009001, 195236009, 266257000, 288723005  OR starting with 430, 431, 433, 434, 435 OR 436\nAND with >= 2 Bills with the ICD9 diagnosis code starting with 430, 431, 433, 434, 435 OR 436 in the last 3 years\"\n		  ii) Ischemic Cerebrovascular Disease dx in 2+ visits: \"Patient Status: Active\nAND does not have a Current Problem List/Profile item code of 64009001, 195236009, 266257000, 288723005  OR starting with 430, 431, 433, 434, 435 OR 436\nAND with >= 2 Visit Encounters with Snomed diagnosis code 64009001, 195236009, 266257000, 288723005 or the ICD9 diagnosis code starting with  430, 431, 433, 434, 435 OR 436 in the last 3 years\"\n		</notes>\n	</heading>\n	<indicatorQuery>\n		<version>03-13-2018</version>\n		<params>\n			<parameter id=\"provider\" name=\"Provider Number\" value=\"loggedInProvider\" />\n			<parameter id=\"active\" name=\"Active Patients\" value=\"\'AC\'\" />\n			<parameter id=\"dxcodesICD\" name=\"Dx Codes (ICD)\" value=\"430,431,433,434,435,436\" />\n                        <parameter id=\"dxcodesSysICD\" name=\"DX CodeSystem (ICD)\" value=\"\'icd9\'\" />\n                        <parameter id=\"dxcodesSnoMed\" name=\"Dx Codes (SnoMed)\" value=\"64009001,195236009,266257000,288723005\" />\n                        <parameter id=\"dxcodesSysSnoMed\" name=\"Dx CodeSystem (SnoMed)\" value=\"\'snomed%\'\" />\n			<parameter id=\"billingCode\" name=\"ICD9 Billing Code\" value=\"430,431,433,434,435,436\" />\n			<parameter id=\"numOfBills\" name=\"Number of ICD9 430,431,433,434,435,436 Bills\" value=\"2\" />\n			<parameter id=\"numOfVisits\" name=\"Number of Visit Encounters coded 430,431,433,434,435,436/ICD9\" value=\"2\" />\n		</params>\n		<range>\n			<lowerLimit id=\"billingdate\" label=\"From Date\" name=\"Date\" value=\"DATE_SUB( NOW(), INTERVAL 3 YEAR )\" />\n			<upperLimit id=\"billingdate\" label=\"Date Today\" name=\"Date\" value=\"NOW()\" />\n			<lowerLimit id=\"visitdate\" label=\"From Date\" name=\"Date\" value=\"DATE_SUB( NOW(), INTERVAL 3 YEAR )\" />\n			<upperLimit id=\"visitdate\" label=\"Date Today\" name=\"Date\" value=\"NOW()\" />\n		</range>\n		<query>\nSELECT\n  IF ( COUNT(fin.patient) &gt; 0, SUM( CASE WHEN (fin.dx IS NULL AND fin.billcount &gt;= ${numOfBills}) THEN 1 ELSE 0 END ) , 0) AS \"Ischemic Cerebrovascular Disease dx in ${numOfBills}+ bills\",\n  IF ( COUNT(fin.patient) &gt; 0, SUM( CASE WHEN (fin.dx IS NULL AND fin.visitcount &gt;= ${numOfVisits}) THEN 1 ELSE 0 END ) , 0) AS \"Ischemic Cerebrovascular Disease dx in ${numOfVisits}+ visits\"\n-- Consider OBS here if needed  \nFROM ( \n  SELECT \n    d.demographic_no AS patient, \n    BILLING.billcount AS billcount,\n    VISIT.visitcount AS visitcount,\n    dxr.dxresearch_code AS dx,\n    dxr.coding_system AS dxs\n  FROM demographic d \n  LEFT JOIN (\n    SELECT demographic_no, dxresearch_code, coding_system, count(dxresearch_code)\n    FROM dxresearch\n    WHERE status=\'A\' AND\n    (\n      (LEFT(dxresearch_code, 3) IN (\'430\',\'431\',\'433\',\'434\',\'435\',\'436\') AND coding_system = ${dxcodesSysICD}) OR\n      (dxresearch_code IN (\'64009001\',\'195236009\',\'266257000\',\'288723005\') AND coding_system LIKE ${dxcodesSysSnoMed})\n    )\n    GROUP BY demographic_no\n    ORDER BY demographic_no\n  ) dxr\n  ON d.demographic_no = dxr.demographic_no\n  -- Billed 430,431,433,434,435,436 in last 3 years\n  LEFT JOIN (\n    SELECT b.demographic_no as demographic_no, b.dx_code1 as dxcode1, b.dx_code2 as dxcode2, b.dx_code3 as dxcode3, count(b.demographic_no) as billcount\n    FROM billingmaster b\n    WHERE ( LEFT(b.dx_code1, 3) IN (\'430\',\'431\',\'433\',\'434\',\'435\',\'436\') OR LEFT(b.dx_code2, 3) IN (\'430\',\'431\',\'433\',\'434\',\'435\',\'436\') OR LEFT(b.dx_code3, 3) IN (\'430\',\'431\',\'433\',\'434\',\'435\',\'436\') )\n    AND DATE(b.createdate) > ${lowerLimit.billingdate}\n    AND b.demographic_no > 0\n    GROUP BY b.demographic_no HAVING COUNT(b.demographic_no) > -1\n  ) BILLING\n  ON (d.demographic_no = BILLING.demographic_no)  \n  -- Coded dx during visit encounter in last 3 years\n  LEFT JOIN(\n    SELECT ASSIGNED.demographic_no as demographic_no, observation_date as visitdate, uuid, count(ASSIGNED.demographic_no) as visitcount\n    FROM casemgmt_note note\n    INNER JOIN (\n      SELECT note_id, CODED.demo_no as demographic_no FROM casemgmt_issue_notes\n      INNER JOIN (\n        SELECT ci.id as id, ci.update_date, ci.demographic_no demo_no FROM issue i\n        INNER JOIN casemgmt_issue ci\n        ON i.issue_id = ci.issue_id\n        WHERE\n	(i.type LIKE ${dxcodesSysICD} AND LEFT(i.code, 3) IN (\'430\',\'431\',\'433\',\'434\',\'435\',\'436\')) OR\n	(i.type LIKE ${dxcodesSysSnoMed} AND i.code IN (\'64009001\',\'195236009\',\'266257000\',\'288723005\'))\n      ) CODED\n      ON (casemgmt_issue_notes.id = CODED.id)\n      ORDER BY CODED.demo_no\n    ) ASSIGNED\n    ON note.note_id = ASSIGNED.note_id AND\n    -- GET LAST REVISION OF NOTE\n    note.note_id= (SELECT MAX(cmn.note_id) FROM casemgmt_note cmn WHERE cmn.uuid = note.uuid) AND\n    DATE(note.observation_date) > ${lowerLimit.visitdate}\n    GROUP BY demographic_no\n    ORDER BY demographic_no\n  ) VISIT\n  ON (d.demographic_no = VISIT.demographic_no)  \n  WHERE d.patient_status LIKE ${active}\n  AND d.demographic_no > 0\n  AND d.provider_no LIKE ${provider} \n) fin\n		</query>\n	</indicatorQuery>\n	<drillDownQuery>\n		<version>03-13-2018</version>\n		<params>\n			<parameter id=\"provider\" name=\"Provider Number\" value=\"loggedInProvider\" />\n			<parameter id=\"active\" name=\"Active Patients\" value=\"\'AC\'\" />\n			<parameter id=\"dxcodesICD\" name=\"Dx Codes (ICD)\" value=\"430,431,433,434,435,436\" />\n                        <parameter id=\"dxcodesSysICD\" name=\"DX CodeSystem (ICD)\" value=\"\'icd9\'\" />\n                        <parameter id=\"dxcodesSnoMed\" name=\"Dx Codes (SnoMed)\" value=\"64009001,195236009,266257000,288723005\" />\n                        <parameter id=\"dxcodesSysSnoMed\" name=\"Dx CodeSystem (SnoMed)\" value=\"\'snomed%\'\" />\n			<parameter id=\"billingCode\" name=\"ICD9 Billing Code\" value=\"430,431,433,434,435,436\" />\n			<parameter id=\"numOfBills\" name=\"Number of ICD9 430,431,433,434,435,436 Bills\" value=\"2\" />\n			<parameter id=\"numOfVisits\" name=\"Number of Visit Encounters coded 430,431,433,434,435,436/ICD9\" value=\"2\" />\n		</params>\n		\n		<range>\n			<lowerLimit id=\"billingdate\" label=\"From Date\" name=\"Date\" value=\"DATE_SUB( NOW(), INTERVAL 3 YEAR )\" />\n			<upperLimit id=\"billingdate\" label=\"Date Today\" name=\"Date\" value=\"NOW()\" />\n			<lowerLimit id=\"visitdate\" label=\"From Date\" name=\"Date\" value=\"DATE_SUB( NOW(), INTERVAL 3 YEAR )\" />\n			<upperLimit id=\"visitdate\" label=\"Date Today\" name=\"Date\" value=\"NOW()\" />\n		</range>\n		\n		<displayColumns>\n			<column id=\"demographic\" name=\"d.demographic_no\" title=\"Patient Id\" primary=\"true\" />\n			<column id=\"name\" name=\"CONCAT( d.last_name, \', \', d.first_name )\" title=\"Patient Name\" primary=\"false\" />\n			<column id=\"dob\" name=\"DATE_FORMAT( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth), \'%m-%d-%Y\' )\" title=\"Date of Birth\" primary=\"false\" />\n			<column id=\"age\" name=\"TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )\" title=\"Age\" primary=\"false\" />\n			<column id=\"billings\" name=\"IFNULL( BILLING.billcount, \'0\')\" title=\"Billings\" primary=\"false\" />\n			<column id=\"visits\" name=\"IFNULL( VISIT.visitcount, \'0\')\" title=\"Visits\" primary=\"false\" />\n		</displayColumns>\n		\n		<exportColumns>\n			<column id=\"demographic\" name=\"d.demographic_no\" title=\"Patient Id\" primary=\"true\" />\n                        <column id=\"firstName\" name=\"d.first_name\" title=\"First Name\" primary=\"false\" />\n                        <column id=\"lastName\" name=\"d.last_name\" title=\"Last Name\" primary=\"false\" />\n			<column id=\"dob\" name=\"DATE_FORMAT( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth), \'%m-%d-%Y\' )\" title=\"Date of Birth\" primary=\"false\" />\n			<column id=\"age\" name=\"TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )\" title=\"Age\" primary=\"false\" />\n			<column id=\"billings\" name=\"IFNULL( BILLING.billcount, \'0\')\" title=\"Billings\" primary=\"false\" />\n			<column id=\"visits\" name=\"IFNULL( VISIT.visitcount, \'0\')\" title=\"Visits\" primary=\"false\" />\n		</exportColumns>\n		<query>	\n  SELECT *	\n  FROM demographic d \n  LEFT JOIN (\n    SELECT demographic_no, dxresearch_code, coding_system, count(dxresearch_code)\n    FROM dxresearch\n    WHERE status=\'A\' AND\n    (\n      (LEFT(dxresearch_code, 3) IN (\'430\',\'431\',\'433\',\'434\',\'435\',\'436\') AND coding_system = ${dxcodesSysICD}) OR\n      (dxresearch_code IN (\'64009001\',\'195236009\',\'266257000\',\'288723005\') AND coding_system LIKE ${dxcodesSysSnoMed})\n    )\n    GROUP BY demographic_no\n    ORDER BY demographic_no\n  ) dxr\n  ON d.demographic_no = dxr.demographic_no\n  -- Billed 430,431,433,434,435,436 in last 3 years\n  LEFT JOIN (\n    SELECT b.demographic_no as demographic_no, b.dx_code1 as dxcode1, b.dx_code2 as dxcode2, b.dx_code3 as dxcode3, count(b.demographic_no) as billcount\n    FROM billingmaster b\n    WHERE ( LEFT(b.dx_code1, 3) IN (\'430\',\'431\',\'433\',\'434\',\'435\',\'436\') OR LEFT(b.dx_code2, 3) IN (\'430\',\'431\',\'433\',\'434\',\'435\',\'436\') OR LEFT(b.dx_code3, 3) IN (\'430\',\'431\',\'433\',\'434\',\'435\',\'436\') )\n    AND DATE(b.createdate) > ${lowerLimit.billingdate}\n    AND b.demographic_no > 0\n    GROUP BY b.demographic_no HAVING COUNT(b.demographic_no) > -1\n  ) BILLING\n  ON (d.demographic_no = BILLING.demographic_no)  \n  -- Coded dx during visit encounter in last 3 years\n  LEFT JOIN(\n    SELECT ASSIGNED.demographic_no as demographic_no, observation_date as visitdate, uuid, count(ASSIGNED.demographic_no) as visitcount\n    FROM casemgmt_note note\n    INNER JOIN (\n      SELECT note_id, CODED.demo_no as demographic_no FROM casemgmt_issue_notes\n      INNER JOIN (\n        SELECT ci.id as id, ci.update_date, ci.demographic_no demo_no FROM issue i\n        INNER JOIN casemgmt_issue ci\n        ON i.issue_id = ci.issue_id\n        WHERE\n	(i.type LIKE ${dxcodesSysICD} AND LEFT(i.code, 3) IN (\'430\',\'431\',\'433\',\'434\',\'435\',\'436\')) OR\n	(i.type LIKE ${dxcodesSysSnoMed} AND i.code IN (\'64009001\',\'195236009\',\'266257000\',\'288723005\'))\n      ) CODED\n      ON (casemgmt_issue_notes.id = CODED.id)\n      ORDER BY CODED.demo_no\n    ) ASSIGNED\n    ON note.note_id = ASSIGNED.note_id AND\n    -- GET LAST REVISION OF NOTE\n    note.note_id= (SELECT MAX(cmn.note_id) FROM casemgmt_note cmn WHERE cmn.uuid = note.uuid) AND\n    DATE(note.observation_date) > ${lowerLimit.visitdate}\n    GROUP BY demographic_no\n    ORDER BY demographic_no\n  ) VISIT\n  ON (d.demographic_no = VISIT.demographic_no)  \n-- Consider OBS here if needed  \n  WHERE d.patient_status LIKE ${active}\n  AND d.demographic_no > 0\n  AND ( dxr.dxresearch_code IS NULL AND ((BILLING.billcount IS NOT NULL AND BILLING.billcount &gt;= ${numOfBills}) OR (VISIT.visitcount IS NOT NULL AND VISIT.visitcount &gt;= ${numOfVisits})))\n  AND d.provider_no LIKE ${provider}\n  ORDER BY d.demographic_no\n		</query>\n	</drillDownQuery>\n</indicatorTemplateXML>\n','','\0',0,NULL,NULL),
(45,5,'Ischemic Cerebrovascular Disease Prevalence','CDM','Ischemic Cerebrovascular Disease','DoBC CPQI PSP Panel','2017-08-02','% of active patients in the practice coded with Ischemic Cerebrovascular Disease.','\ni) Ischemic cerebrovascular disease patients: \"Patient Status: Active\nAND has a Current Problem List/Profile item code of 64009001, 195236009, 266257000, 288723005    OR starting with 430, 431, 433, 434, 435, 436\"\nii) Other patients: \"Patient Status: Act','<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<indicatorTemplateXML>\n	<author>OSCAR BC</author>\n	<uid></uid>\n	<heading>\n		<category>CDM</category>\n		<subCategory>Ischemic Cerebrovascular Disease</subCategory>\n		<name>Ischemic Cerebrovascular Disease Prevalence</name>\n		<definition>% of active patients in the practice coded with Ischemic Cerebrovascular Disease.</definition>\n		<framework>DoBC CPQI PSP Panel</framework>\n		<frameworkVersion>08-02-2017</frameworkVersion>\n		<notes>\ni) Ischemic cerebrovascular disease patients: \"Patient Status: Active\nAND has a Current Problem List/Profile item code of 64009001, 195236009, 266257000, 288723005    OR starting with 430, 431, 433, 434, 435, 436\"\nii) Other patients: \"Patient Status: Active\nAND does not have a Current Problem List/Profile item code of 64009001, 195236009, 266257000, 288723005    OR starting with 430, 431, 433, 434, 435, 436\"\n		</notes>\n	</heading>\n	<indicatorQuery>\n		<version>03-13-2018</version>\n		<params>\n			<!-- \n				Required parameter provider. Value options are: \n					[ an individual providerNo, or provider range ] ie: value=\"370, 1001\" \n					\"all\" ie: value=\"all\" including null.\n					\"loggedInProvider\" ie:\n				Default is \"loggedInProvider\"\n				Use this parameter in the query as ${provider}\n				This parameter should be used for fetching patient\'s assigned to a MRP.\n				ie: WHERE demographic.provider_no = ${provider}\n			-->\n			<parameter id=\"provider\" name=\"provider_no\" value=\"loggedInProvider\" />\n			<parameter id=\"pstatus\" name=\"Patient Status\" value=\"\'AC\'\" />\n			<parameter id=\"dxcodesICD\" name=\"Dx Codes (ICD)\" value=\"430,431,433,434,435,436\" />\n			<parameter id=\"dxcodesSysICD\" name=\"DX CodeSystem (ICD)\" value=\"\'icd9\'\" />\n			<parameter id=\"dxcodesSnoMed\" name=\"Dx Codes (SnoMed)\" value=\"64009001,195236009,266257000,288723005\" />\n			<parameter id=\"dxcodesSysSnoMed\" name=\"Dx CodeSystem (SnoMed)\" value=\"\'snomed%\'\" />\n		</params>\n		<query>\n			<!-- Indicator SQL Query here -->\nSELECT\n -- PERCENT OF TOTAL PATIENTS NOTED AS ACTIVE WITH CURRENT ISCHEMIC CEREBROVASCULAR DISEASE\n IF( COUNT(fin.patient) > 0, SUM( IF( dxresearch_code is not NULL , 1, 0) ) , 0 ) AS \"% Active, Current Ischemic Cerebrovascular Disease\",\n -- PERCENT OF TOTAL PATIENTS NOTED AS ACTIVE WITHOUT CURRENT ISCHEMIC CEREBROVASCULAR DISEASE\n IF( COUNT(fin.patient) > 0, SUM( IF( dxresearch_code is NULL , 1, 0) ) , 0 ) AS \"% Active, No Current Ischemic Cerebrovascular Disease\"\nFROM (\n SELECT d.demographic_no AS patient, d.patient_status AS pt_status, dxresearch_code\n FROM demographic d\n LEFT JOIN (\n  SELECT demographic_no, dxresearch_code, count(dxresearch_code)\n  FROM dxresearch\n  WHERE status=\'A\' AND\n  (\n   (LEFT(dxresearch_code, 3) IN (\'430\', \'431\', \'433\', \'434\', \'435\', \'436\') AND coding_system = ${dxcodesSysICD}) OR\n   (dxresearch_code IN (\'64009001\', \'195236009\', \'266257000\', \'288723005\') AND coding_system LIKE ${dxcodesSysSnoMed})\n   )\n  GROUP BY demographic_no\n  ORDER BY demographic_no\n ) problems\n ON d.demographic_no = problems.demographic_no\n WHERE d.provider_no LIKE ${provider} AND d.patient_status = ${pstatus}\n) fin\n		</query>\n	</indicatorQuery>\n	<drillDownQuery>\n		<version>03-13-2018</version>\n		<params>\n			<parameter id=\"provider\" name=\"provider_no\" value=\"loggedInProvider\" />	\n			<parameter id=\"pstatus\" name=\"Patient Status\" value=\"\'AC\'\" />\n			<parameter id=\"dxcodesICD\" name=\"Dx Codes (ICD)\" value=\"430,431,433,434,435,436\" />\n			<parameter id=\"dxcodesSysICD\" name=\"DX CodeSystem (ICD)\" value=\"\'icd9\'\" />\n			<parameter id=\"dxcodesSnoMed\" name=\"Dx Codes (SnoMed)\" value=\"64009001,195236009,266257000,288723005\" />\n			<parameter id=\"dxcodesSysSnoMed\" name=\"Dx CodeSystem (SnoMed)\" value=\"\'snomed%\'\" />\n		</params>\n		<displayColumns>\n			<column id=\"demographic\" name=\"d.demographic_no\" title=\"Patient Id\" primary=\"true\" />\n			<column id=\"name\" name=\"CONCAT( d.last_name, \', \', d.first_name )\" title=\"Patient Name\" primary=\"false\" />\n			<column id=\"dob\" name=\"DATE_FORMAT( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth), \'%m-%d-%Y\' )\" title=\"Date of Birth (mm-dd-yy)\" primary=\"false\" />\n			<column id=\"age\" name=\"TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )\" title=\"Age\" primary=\"false\" />\n			<column id=\"dxcode\" title=\"Dx System/Code\" name=\"CONCAT(MIN(dxr.coding_system),\'/\',MIN(dxr.dxresearch_code),IF( MIN(dxr.dxresearch_code) != MAX(dxr.dxresearch_code),CONCAT( \' &amp; \', MAX(dxr.coding_system), \'/\', MAX(dxr.dxresearch_code) ),\'\') )\" primary=\"false\" />\n		</displayColumns>\n		<exportColumns>\n			<column id=\"demographic\" name=\"d.demographic_no\" title=\"Patient Id\" primary=\"true\" />\n			<column id=\"firstName\" name=\"d.first_name\" title=\"First Name\" primary=\"false\" />\n			<column id=\"lastName\" name=\"d.last_name\" title=\"Last Name\" primary=\"false\" />\n			<column id=\"dob\" name=\"DATE_FORMAT( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth), \'%m-%d-%Y\' )\" title=\"Date of Birth (mm-dd-yy)\" primary=\"false\" />\n			<column id=\"age\" name=\"TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )\" title=\"Age\" primary=\"false\" />\n			<column id=\"dxcode\" title=\"Dx System/Code\" name=\"CONCAT(MIN(dxr.coding_system),\'/\',MIN(dxr.dxresearch_code),IF( MIN(dxr.dxresearch_code) != MAX(dxr.dxresearch_code),CONCAT( \' &amp; \', MAX(dxr.coding_system), \'/\', MAX(dxr.dxresearch_code) ),\'\') )\" primary=\"false\" />\n		</exportColumns>\n		<query>\n			<!-- Drilldown SQL Query here -->\nSELECT\n*			\nFROM demographic d\nLEFT JOIN dxresearch dxr\nON d.demographic_no = dxr.demographic_no\nWHERE d.patient_status=${pstatus}\nAND\n(\n (LEFT(dxr.dxresearch_code, 3) IN (\'430\', \'431\', \'433\', \'434\', \'435\', \'436\') AND dxr.coding_system = ${dxcodesSysICD}) OR\n (dxr.dxresearch_code IN (\'64009001\', \'195236009\', \'266257000\', \'288723005\') AND dxr.coding_system LIKE ${dxcodesSysSnoMed})\n )\nAND dxr.status = \'A\'\nAND d.provider_no LIKE ${provider}\nGROUP BY d.demographic_no\nORDER BY COUNT(d.demographic_no) DESC, d.demographic_no\n		</query>\n	</drillDownQuery>\n</indicatorTemplateXML>\n','','\0',0,NULL,NULL),
(46,5,'Consider Ischemic Heart Disease','CDM','Ischemic Heart Disease','DoBC CPQI PSP Panel','2017-08-02','\n			Patients with ischemic heart disease dx in 2+ bills or 2+ visit encounters within last 3 years\n		','\n		  Created for Doctors of BC\n		  i) Ischemic Heart Disease dx in 2+ bills: \"Patient Status: Active\nAND does not have a Current Problem List/Profile item code of 414545008  OR starting with 414\nAND with >= 2 Bills with the ICD9 diagnosis code starting wi','<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<indicatorTemplateXML>\n	<author>OSCAR BC</author>\n	<uid></uid>\n	<heading>\n		<category>CDM</category>\n		<subCategory>Ischemic Heart Disease</subCategory>\n		<name>Consider Ischemic Heart Disease</name>\n		<definition>\n			Patients with ischemic heart disease dx in 2+ bills or 2+ visit encounters within last 3 years\n		</definition>\n		<framework>DoBC CPQI PSP Panel</framework>\n		<frameworkVersion>08-02-2017</frameworkVersion>\n		<notes>\n		  Created for Doctors of BC\n		  i) Ischemic Heart Disease dx in 2+ bills: \"Patient Status: Active\nAND does not have a Current Problem List/Profile item code of 414545008  OR starting with 414\nAND with >= 2 Bills with the ICD9 diagnosis code starting with 414 in the last 3 years\"\n		  ii) Ischemic Heart Disease dx in 2+ visits: \"Patient Status: Active\nAND does not have a Current Problem List/Profile item code of 414545008  OR starting with 414\nAND with >= 2 Visit Encounters with Snomed diagnosis code of 414545008 or the ICD9 diagnosis code starting with 414 in the last 3 years\"\n		</notes>\n	</heading>\n	<indicatorQuery>\n		<version>03-13-2018</version>\n		<params>\n			<parameter id=\"provider\" name=\"Provider Number\" value=\"loggedInProvider\" />\n			<parameter id=\"active\" name=\"Active Patients\" value=\"\'AC\'\" />\n			<parameter id=\"dxcodesICD\" name=\"Dx Codes (ICD)\" value=\"414\" />\n                        <parameter id=\"dxcodesSysICD\" name=\"DX CodeSystem (ICD)\" value=\"\'icd9\'\" />\n                        <parameter id=\"dxcodesSnoMed\" name=\"Dx Codes (SnoMed)\" value=\"414545008\" />\n                        <parameter id=\"dxcodesSysSnoMed\" name=\"Dx CodeSystem (SnoMed)\" value=\"\'snomed%\'\" />\n			<parameter id=\"billingCode\" name=\"ICD9 Billing Code\" value=\"414\" />\n			<parameter id=\"numOfBills\" name=\"Number of ICD9 414 Bills\" value=\"2\" />\n			<parameter id=\"numOfVisits\" name=\"Number of Visit Encounters coded 414/ICD9\" value=\"2\" />\n		</params>\n		<range>\n			<lowerLimit id=\"billingdate\" label=\"From Date\" name=\"Date\" value=\"DATE_SUB( NOW(), INTERVAL 3 YEAR )\" />\n			<upperLimit id=\"billingdate\" label=\"Date Today\" name=\"Date\" value=\"NOW()\" />\n			<lowerLimit id=\"visitdate\" label=\"From Date\" name=\"Date\" value=\"DATE_SUB( NOW(), INTERVAL 3 YEAR )\" />\n			<upperLimit id=\"visitdate\" label=\"Date Today\" name=\"Date\" value=\"NOW()\" />\n		</range>\n		<query>\nSELECT\n  IF ( COUNT(fin.patient) &gt; 0, SUM( CASE WHEN (fin.dx IS NULL AND fin.billcount &gt;= ${numOfBills}) THEN 1 ELSE 0 END ) , 0) AS \"Ischemic Heart Disease dx in ${numOfBills}+ bills\",\n  IF ( COUNT(fin.patient) &gt; 0, SUM( CASE WHEN (fin.dx IS NULL AND fin.visitcount &gt;= ${numOfVisits}) THEN 1 ELSE 0 END ) , 0) AS \"Ischemic Heart Disease dx in ${numOfVisits}+ visits\"\n-- Consider OBS here if needed  \nFROM ( \n  SELECT \n    d.demographic_no AS patient, \n    BILLING.billcount AS billcount,\n    VISIT.visitcount AS visitcount,\n    dxr.dxresearch_code AS dx,\n    dxr.coding_system AS dxs\n  FROM demographic d \n  LEFT JOIN (\n    SELECT demographic_no, dxresearch_code, coding_system, count(dxresearch_code)\n    FROM dxresearch\n    WHERE status=\'A\' AND\n    (\n      (LEFT(dxresearch_code, 3) IN (\'414\') AND coding_system = ${dxcodesSysICD}) OR\n      (dxresearch_code IN (\'414545008\') AND coding_system LIKE ${dxcodesSysSnoMed})\n    )\n    GROUP BY demographic_no\n    ORDER BY demographic_no\n  ) dxr\n  ON d.demographic_no = dxr.demographic_no\n  -- Billed 414 in last 3 years\n  LEFT JOIN (\n    SELECT b.demographic_no as demographic_no, b.dx_code1 as dxcode1, b.dx_code2 as dxcode2, b.dx_code3 as dxcode3, count(b.demographic_no) as billcount\n    FROM billingmaster b\n    WHERE ( LEFT(b.dx_code1, 3) IN (\'414\') OR LEFT(b.dx_code2, 3) IN (\'414\') OR LEFT(b.dx_code3, 3) IN (\'414\') )\n    AND DATE(b.createdate) > ${lowerLimit.billingdate}\n    AND b.demographic_no > 0\n    GROUP BY b.demographic_no HAVING COUNT(b.demographic_no) > -1\n  ) BILLING\n  ON (d.demographic_no = BILLING.demographic_no)  \n  -- Coded dx during visit encounter in last 3 years\n  LEFT JOIN(\n    SELECT ASSIGNED.demographic_no as demographic_no, observation_date as visitdate, uuid, count(ASSIGNED.demographic_no) as visitcount\n    FROM casemgmt_note note\n    INNER JOIN (\n      SELECT note_id, CODED.demo_no as demographic_no FROM casemgmt_issue_notes\n      INNER JOIN (\n        SELECT ci.id as id, ci.update_date, ci.demographic_no demo_no FROM issue i\n        INNER JOIN casemgmt_issue ci\n        ON i.issue_id = ci.issue_id\n        WHERE\n	(i.type LIKE ${dxcodesSysICD} AND LEFT(i.code, 3) IN (\'414\')) OR\n	(i.type LIKE ${dxcodesSysSnoMed} AND i.code IN (\'414545008\'))\n      ) CODED\n      ON (casemgmt_issue_notes.id = CODED.id)\n      ORDER BY CODED.demo_no\n    ) ASSIGNED\n    ON note.note_id = ASSIGNED.note_id AND\n    -- GET LAST REVISION OF NOTE\n    note.note_id= (SELECT MAX(cmn.note_id) FROM casemgmt_note cmn WHERE cmn.uuid = note.uuid) AND\n    DATE(note.observation_date) > ${lowerLimit.visitdate}\n    GROUP BY demographic_no\n    ORDER BY demographic_no\n  ) VISIT\n  ON (d.demographic_no = VISIT.demographic_no)  \n  WHERE d.patient_status LIKE ${active}\n  AND d.demographic_no > 0\n  AND d.provider_no LIKE ${provider} \n) fin\n		</query>\n	</indicatorQuery>\n	<drillDownQuery>\n		<version>03-13-2018</version>\n		<params>\n			<parameter id=\"provider\" name=\"Provider Number\" value=\"loggedInProvider\" />\n			<parameter id=\"active\" name=\"Active Patients\" value=\"\'AC\'\" />\n			<parameter id=\"dxcodesICD\" name=\"Dx Codes (ICD)\" value=\"414\" />\n                        <parameter id=\"dxcodesSysICD\" name=\"DX CodeSystem (ICD)\" value=\"\'icd9\'\" />\n                        <parameter id=\"dxcodesSnoMed\" name=\"Dx Codes (SnoMed)\" value=\"414545008\" />\n                        <parameter id=\"dxcodesSysSnoMed\" name=\"Dx CodeSystem (SnoMed)\" value=\"\'snomed%\'\" />\n			<parameter id=\"billingCode\" name=\"ICD9 Billing Code\" value=\"414\" />\n			<parameter id=\"numOfBills\" name=\"Number of ICD9 414 Bills\" value=\"2\" />\n			<parameter id=\"numOfVisits\" name=\"Number of Visit Encounters coded 414/ICD9\" value=\"2\" />\n		</params>\n		\n		<range>\n			<lowerLimit id=\"billingdate\" label=\"From Date\" name=\"Date\" value=\"DATE_SUB( NOW(), INTERVAL 3 YEAR )\" />\n			<upperLimit id=\"billingdate\" label=\"Date Today\" name=\"Date\" value=\"NOW()\" />\n			<lowerLimit id=\"visitdate\" label=\"From Date\" name=\"Date\" value=\"DATE_SUB( NOW(), INTERVAL 3 YEAR )\" />\n			<upperLimit id=\"visitdate\" label=\"Date Today\" name=\"Date\" value=\"NOW()\" />\n		</range>\n		\n		<displayColumns>\n			<column id=\"demographic\" name=\"d.demographic_no\" title=\"Patient Id\" primary=\"true\" />\n			<column id=\"name\" name=\"CONCAT( d.last_name, \', \', d.first_name )\" title=\"Patient Name\" primary=\"false\" />\n			<column id=\"dob\" name=\"DATE_FORMAT( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth), \'%m-%d-%Y\' )\" title=\"Date of Birth\" primary=\"false\" />\n			<column id=\"age\" name=\"TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )\" title=\"Age\" primary=\"false\" />\n			<column id=\"billings\" name=\"IFNULL( BILLING.billcount, \'0\')\" title=\"Billings\" primary=\"false\" />\n			<column id=\"visits\" name=\"IFNULL( VISIT.visitcount, \'0\')\" title=\"Visits\" primary=\"false\" />\n		</displayColumns>\n		\n		<exportColumns>\n			<column id=\"demographic\" name=\"d.demographic_no\" title=\"Patient Id\" primary=\"true\" />\n                        <column id=\"firstName\" name=\"d.first_name\" title=\"First Name\" primary=\"false\" />\n                        <column id=\"lastName\" name=\"d.last_name\" title=\"Last Name\" primary=\"false\" />\n			<column id=\"dob\" name=\"DATE_FORMAT( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth), \'%m-%d-%Y\' )\" title=\"Date of Birth\" primary=\"false\" />\n			<column id=\"age\" name=\"TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )\" title=\"Age\" primary=\"false\" />\n			<column id=\"billings\" name=\"IFNULL( BILLING.billcount, \'0\')\" title=\"Billings\" primary=\"false\" />\n			<column id=\"visits\" name=\"IFNULL( VISIT.visitcount, \'0\')\" title=\"Visits\" primary=\"false\" />\n		</exportColumns>\n		<query>	\n  SELECT *	\n  FROM demographic d \n  LEFT JOIN (\n    SELECT demographic_no, dxresearch_code, coding_system, count(dxresearch_code)\n    FROM dxresearch\n    WHERE status=\'A\' AND\n    (\n      (LEFT(dxresearch_code, 3) IN (\'414\') AND coding_system = ${dxcodesSysICD}) OR\n      (dxresearch_code IN (\'414545008\') AND coding_system LIKE ${dxcodesSysSnoMed})\n    )\n    GROUP BY demographic_no\n    ORDER BY demographic_no\n  ) dxr\n  ON d.demographic_no = dxr.demographic_no\n  -- Billed 414 in last 3 years\n  LEFT JOIN (\n    SELECT b.demographic_no as demographic_no, b.dx_code1 as dxcode1, b.dx_code2 as dxcode2, b.dx_code3 as dxcode3, count(b.demographic_no) as billcount\n    FROM billingmaster b\n    WHERE ( LEFT(b.dx_code1, 3) IN (\'414\') OR LEFT(b.dx_code2, 3) IN (\'414\') OR LEFT(b.dx_code3, 3) IN (\'414\') )\n    AND DATE(b.createdate) > ${lowerLimit.billingdate}\n    AND b.demographic_no > 0\n    GROUP BY b.demographic_no HAVING COUNT(b.demographic_no) > -1\n  ) BILLING\n  ON (d.demographic_no = BILLING.demographic_no)  \n  -- Coded dx during visit encounter in last 3 years\n  LEFT JOIN(\n    SELECT ASSIGNED.demographic_no as demographic_no, observation_date as visitdate, uuid, count(ASSIGNED.demographic_no) as visitcount\n    FROM casemgmt_note note\n    INNER JOIN (\n      SELECT note_id, CODED.demo_no as demographic_no FROM casemgmt_issue_notes\n      INNER JOIN (\n        SELECT ci.id as id, ci.update_date, ci.demographic_no demo_no FROM issue i\n        INNER JOIN casemgmt_issue ci\n        ON i.issue_id = ci.issue_id\n        WHERE\n	(i.type LIKE ${dxcodesSysICD} AND LEFT(i.code, 3) IN (\'414\')) OR\n	(i.type LIKE ${dxcodesSysSnoMed} AND i.code IN (\'414545008\'))\n      ) CODED\n      ON (casemgmt_issue_notes.id = CODED.id)\n      ORDER BY CODED.demo_no\n    ) ASSIGNED\n    ON note.note_id = ASSIGNED.note_id AND\n    -- GET LAST REVISION OF NOTE\n    note.note_id= (SELECT MAX(cmn.note_id) FROM casemgmt_note cmn WHERE cmn.uuid = note.uuid) AND\n    DATE(note.observation_date) > ${lowerLimit.visitdate}\n    GROUP BY demographic_no\n    ORDER BY demographic_no\n  ) VISIT\n  ON (d.demographic_no = VISIT.demographic_no)  \n-- Consider OBS here if needed  \n  WHERE d.patient_status LIKE ${active}\n  AND d.demographic_no > 0\n  AND ( dxr.dxresearch_code IS NULL AND ((BILLING.billcount IS NOT NULL AND BILLING.billcount &gt;= ${numOfBills}) OR (VISIT.visitcount IS NOT NULL AND VISIT.visitcount &gt;= ${numOfVisits})))\n  AND d.provider_no LIKE ${provider}\n  ORDER BY d.demographic_no\n		</query>\n	</drillDownQuery>\n</indicatorTemplateXML>\n','','\0',0,NULL,NULL),
(47,5,'Ischemic Heart Disease Prevalence','CDM','Ischemic Heart Disease','DoBC CPQI PSP Panel','2017-08-02','% of active patients in the practice coded with Ischemic Heart Disease.','\ni) Heart disease patients: \"Patient Status: Active\nAND has a Current Problem List/Profile item code of 414545008  OR starting with 414\"\nii) Other patients: \"Patient Status: Active\nAND does not have a Current Problem List/Profile item code of 414545008  O','<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<indicatorTemplateXML>\n	<author>OSCAR BC</author>\n	<uid></uid>\n	<heading>\n		<category>CDM</category>\n		<subCategory>Ischemic Heart Disease</subCategory>\n		<name>Ischemic Heart Disease Prevalence</name>\n		<definition>% of active patients in the practice coded with Ischemic Heart Disease.</definition>\n		<framework>DoBC CPQI PSP Panel</framework>\n		<frameworkVersion>08-02-2017</frameworkVersion>\n		<notes>\ni) Heart disease patients: \"Patient Status: Active\nAND has a Current Problem List/Profile item code of 414545008  OR starting with 414\"\nii) Other patients: \"Patient Status: Active\nAND does not have a Current Problem List/Profile item code of 414545008  OR starting with 414\"\n		</notes>\n	</heading>\n	<indicatorQuery>\n		<version>03-13-2018</version>\n		<params>\n			<!-- \n				Required parameter provider. Value options are: \n					[ an individual providerNo, or provider range ] ie: value=\"370, 1001\" \n					\"all\" ie: value=\"all\" including null.\n					\"loggedInProvider\" ie:\n				Default is \"loggedInProvider\"\n				Use this parameter in the query as ${provider}\n				This parameter should be used for fetching patient\'s assigned to a MRP.\n				ie: WHERE demographic.provider_no = ${provider}\n			-->\n			<parameter id=\"provider\" name=\"provider_no\" value=\"loggedInProvider\" />\n			<parameter id=\"pstatus\" name=\"Patient Status\" value=\"\'AC\'\" />\n			<parameter id=\"dxcodesICD\" name=\"Dx Codes (ICD)\" value=\"414\" />\n			<parameter id=\"dxcodesSysICD\" name=\"DX CodeSystem (ICD)\" value=\"\'icd9\'\" />\n			<parameter id=\"dxcodesSnoMed\" name=\"Dx Codes (SnoMed)\" value=\"414545008\" />\n			<parameter id=\"dxcodesSysSnoMed\" name=\"Dx CodeSystem (SnoMed)\" value=\"\'snomed%\'\" />\n		</params>\n		<query>\n			<!-- Indicator SQL Query here -->\nSELECT\n -- PERCENT OF TOTAL PATIENTS NOTED AS ACTIVE WITH CURRENT ISCHEMIC HEART DISEASE\n IF( COUNT(fin.patient) > 0, SUM( IF( dxresearch_code is not NULL , 1, 0) ) , 0 ) AS \"% Active, Current Ischemic Heart Disease\",\n -- PERCENT OF TOTAL PATIENTS NOTED AS ACTIVE WITHOUT CURRENT ISCHEMIC HEART DISEASE\n IF( COUNT(fin.patient) > 0, SUM( IF( dxresearch_code is NULL , 1, 0) ) , 0 ) AS \"% Active, No Current Ischemic Heart Disease\"\nFROM (\n SELECT d.demographic_no AS patient, d.patient_status AS pt_status, dxresearch_code\n FROM demographic d\n LEFT JOIN (\n  SELECT demographic_no, dxresearch_code, count(dxresearch_code)\n  FROM dxresearch\n  WHERE status=\'A\' AND\n  (\n   (LEFT(dxresearch_code, 3) IN (\'414\') AND coding_system = ${dxcodesSysICD}) OR\n   (dxresearch_code IN (\'414545008\') AND coding_system LIKE ${dxcodesSysSnoMed})\n   )\n  GROUP BY demographic_no\n  ORDER BY demographic_no\n ) problems\n ON d.demographic_no = problems.demographic_no\n WHERE d.provider_no LIKE ${provider} AND d.patient_status = ${pstatus}\n) fin\n		</query>\n	</indicatorQuery>\n	<drillDownQuery>\n		<version>03-13-2018</version>\n		<params>\n			<parameter id=\"provider\" name=\"provider_no\" value=\"loggedInProvider\" />	\n			<parameter id=\"pstatus\" name=\"Patient Status\" value=\"\'AC\'\" />\n			<parameter id=\"dxcodesICD\" name=\"Dx Codes (ICD)\" value=\"414\" />\n			<parameter id=\"dxcodesSysICD\" name=\"DX CodeSystem (ICD)\" value=\"\'icd9\'\" />\n			<parameter id=\"dxcodesSnoMed\" name=\"Dx Codes (SnoMed)\" value=\"414545008\" />\n			<parameter id=\"dxcodesSysSnoMed\" name=\"Dx CodeSystem (SnoMed)\" value=\"\'snomed%\'\" />\n		</params>\n		<displayColumns>\n			<column id=\"demographic\" name=\"d.demographic_no\" title=\"Patient Id\" primary=\"true\" />\n			<column id=\"name\" name=\"CONCAT( d.last_name, \', \', d.first_name )\" title=\"Patient Name\" primary=\"false\" />\n			<column id=\"dob\" name=\"DATE_FORMAT( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth), \'%m-%d-%Y\' )\" title=\"Date of Birth (mm-dd-yy)\" primary=\"false\" />\n			<column id=\"age\" name=\"TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )\" title=\"Age\" primary=\"false\" />\n			<column id=\"dxcode\" title=\"Dx System/Code\" name=\"CONCAT(MIN(dxr.coding_system),\'/\',MIN(dxr.dxresearch_code),IF( MIN(dxr.dxresearch_code) != MAX(dxr.dxresearch_code),CONCAT( \' &amp; \', MAX(dxr.coding_system), \'/\', MAX(dxr.dxresearch_code) ),\'\') )\" primary=\"false\" />\n		</displayColumns>\n		<exportColumns>\n			<column id=\"demographic\" name=\"d.demographic_no\" title=\"Patient Id\" primary=\"true\" />\n			<column id=\"firstName\" name=\"d.first_name\" title=\"First Name\" primary=\"false\" />\n			<column id=\"lastName\" name=\"d.last_name\" title=\"Last Name\" primary=\"false\" />\n			<column id=\"dob\" name=\"DATE_FORMAT( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth), \'%m-%d-%Y\' )\" title=\"Date of Birth (mm-dd-yy)\" primary=\"false\" />\n			<column id=\"age\" name=\"TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )\" title=\"Age\" primary=\"false\" />\n			<column id=\"dxcode\" title=\"Dx System/Code\" name=\"CONCAT(MIN(dxr.coding_system),\'/\',MIN(dxr.dxresearch_code),IF( MIN(dxr.dxresearch_code) != MAX(dxr.dxresearch_code),CONCAT( \' &amp; \', MAX(dxr.coding_system), \'/\', MAX(dxr.dxresearch_code) ),\'\') )\" primary=\"false\" />\n		</exportColumns>\n		<query>\n			<!-- Drilldown SQL Query here -->\nSELECT\n*			\nFROM demographic d\nLEFT JOIN dxresearch dxr\nON d.demographic_no = dxr.demographic_no\nWHERE d.patient_status=${pstatus}\nAND\n(\n (LEFT(dxr.dxresearch_code, 3) IN (\'414\') AND dxr.coding_system = ${dxcodesSysICD}) OR\n (dxr.dxresearch_code IN (\'414545008\') AND dxr.coding_system LIKE ${dxcodesSysSnoMed})\n )\nAND dxr.status = \'A\'\nAND d.provider_no LIKE ${provider}\nGROUP BY d.demographic_no\nORDER BY COUNT(d.demographic_no) DESC, d.demographic_no\n		</query>\n	</drillDownQuery>\n</indicatorTemplateXML>\n','','\0',0,NULL,NULL),
(48,5,'Consider Osteoarthritis','CDM','Osteoarthritis','DoBC CPQI PSP Panel','2017-08-02','\n			Patients with osteoarthritis dx in 2+ bills or 2+ visit encounters within last 3 years\n		','\n		  Created for Doctors of BC\n		  i) Osteoarthritis dx in 2+ bills: \"Patient Status: Active\nAND does not have a Current Problem List/Profile item code of 396275006 OR starting with 715\nAND with >=2 Bills with the ICD9 diagnosis code starting with 715 in ','<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<indicatorTemplateXML>\n	<author>OSCAR BC</author>\n	<uid></uid>\n	<heading>\n		<category>CDM</category>\n		<subCategory>Osteoarthritis</subCategory>\n		<name>Consider Osteoarthritis</name>\n		<definition>\n			Patients with osteoarthritis dx in 2+ bills or 2+ visit encounters within last 3 years\n		</definition>\n		<framework>DoBC CPQI PSP Panel</framework>\n		<frameworkVersion>08-02-2017</frameworkVersion>\n		<notes>\n		  Created for Doctors of BC\n		  i) Osteoarthritis dx in 2+ bills: \"Patient Status: Active\nAND does not have a Current Problem List/Profile item code of 396275006 OR starting with 715\nAND with >=2 Bills with the ICD9 diagnosis code starting with 715 in the last 3 years\"\n		  ii) Osteoarthritis dx in 2+ visits: \"Patient Status: Active\nAND does not have a Current Problem List/Profile item code of 396275006 OR starting with 715\nAND with >= 2 Visit Encounters with Snomed diagnosis code 396275006 or with the ICD9 diagnosis code starting with 715 in the last 3 years\"\n		</notes>\n	</heading>\n	<indicatorQuery>\n		<version>03-13-2018</version>\n		<params>\n			<parameter id=\"provider\" name=\"Provider Number\" value=\"loggedInProvider\" />\n			<parameter id=\"active\" name=\"Active Patients\" value=\"\'AC\'\" />\n			<parameter id=\"dxcodesICD\" name=\"Dx Codes (ICD)\" value=\"715\" />\n                        <parameter id=\"dxcodesSysICD\" name=\"DX CodeSystem (ICD)\" value=\"\'icd9\'\" />\n                        <parameter id=\"dxcodesSnoMed\" name=\"Dx Codes (SnoMed)\" value=\"396275006\" />\n                        <parameter id=\"dxcodesSysSnoMed\" name=\"Dx CodeSystem (SnoMed)\" value=\"\'snomed%\'\" />\n			<parameter id=\"billingCode\" name=\"ICD9 Billing Code\" value=\"715\" />\n			<parameter id=\"numOfBills\" name=\"Number of ICD9 715 Bills\" value=\"2\" />\n			<parameter id=\"numOfVisits\" name=\"Number of Visit Encounters coded 715/ICD9\" value=\"2\" />\n		</params>\n		<range>\n			<lowerLimit id=\"billingdate\" label=\"From Date\" name=\"Date\" value=\"DATE_SUB( NOW(), INTERVAL 3 YEAR )\" />\n			<upperLimit id=\"billingdate\" label=\"Date Today\" name=\"Date\" value=\"NOW()\" />\n			<lowerLimit id=\"visitdate\" label=\"From Date\" name=\"Date\" value=\"DATE_SUB( NOW(), INTERVAL 3 YEAR )\" />\n			<upperLimit id=\"visitdate\" label=\"Date Today\" name=\"Date\" value=\"NOW()\" />\n		</range>\n		<query>\nSELECT\n  IF ( COUNT(fin.patient) &gt; 0, SUM( CASE WHEN (fin.dx IS NULL AND fin.billcount &gt;= ${numOfBills}) THEN 1 ELSE 0 END ) , 0) AS \"Osteoarthritis dx in ${numOfBills}+ bills\",\n  IF ( COUNT(fin.patient) &gt; 0, SUM( CASE WHEN (fin.dx IS NULL AND fin.visitcount &gt;= ${numOfVisits}) THEN 1 ELSE 0 END ) , 0) AS \"Osteoarthritis dx in ${numOfVisits}+ visits\"\n-- Consider OBS here if needed  \nFROM ( \n  SELECT \n    d.demographic_no AS patient, \n    BILLING.billcount AS billcount,\n    VISIT.visitcount AS visitcount,\n    dxr.dxresearch_code AS dx,\n    dxr.coding_system AS dxs\n  FROM demographic d \n  LEFT JOIN (\n    SELECT demographic_no, dxresearch_code, coding_system, count(dxresearch_code)\n    FROM dxresearch\n    WHERE status=\'A\' AND\n    (\n      (LEFT(dxresearch_code, 3) IN (\'715\') AND coding_system = ${dxcodesSysICD}) OR\n      (dxresearch_code IN (\'396275006\') AND coding_system LIKE ${dxcodesSysSnoMed})\n    )\n    GROUP BY demographic_no\n    ORDER BY demographic_no\n  ) dxr\n  ON d.demographic_no = dxr.demographic_no\n  -- Billed 715 in last 3 years\n  LEFT JOIN (\n    SELECT b.demographic_no as demographic_no, b.dx_code1 as dxcode1, b.dx_code2 as dxcode2, b.dx_code3 as dxcode3, count(b.demographic_no) as billcount\n    FROM billingmaster b\n    WHERE ( LEFT(b.dx_code1, 3) IN (\'715\') OR LEFT(b.dx_code2, 3) IN (\'715\') OR LEFT(b.dx_code3, 3) IN (\'715\') )\n    AND DATE(b.createdate) > ${lowerLimit.billingdate}\n    AND b.demographic_no > 0\n    GROUP BY b.demographic_no HAVING COUNT(b.demographic_no) > -1\n  ) BILLING\n  ON (d.demographic_no = BILLING.demographic_no)  \n  -- Coded dx during visit encounter in last 3 years\n  LEFT JOIN(\n    SELECT ASSIGNED.demographic_no as demographic_no, observation_date as visitdate, uuid, count(ASSIGNED.demographic_no) as visitcount\n    FROM casemgmt_note note\n    INNER JOIN (\n      SELECT note_id, CODED.demo_no as demographic_no FROM casemgmt_issue_notes\n      INNER JOIN (\n        SELECT ci.id as id, ci.update_date, ci.demographic_no demo_no FROM issue i\n        INNER JOIN casemgmt_issue ci\n        ON i.issue_id = ci.issue_id\n        WHERE\n	(i.type LIKE ${dxcodesSysICD} AND LEFT(i.code, 3) IN (\'715\')) OR\n	(i.type LIKE ${dxcodesSysSnoMed} AND i.code IN (\'396275006\'))\n      ) CODED\n      ON (casemgmt_issue_notes.id = CODED.id)\n      ORDER BY CODED.demo_no\n    ) ASSIGNED\n    ON note.note_id = ASSIGNED.note_id AND\n    -- GET LAST REVISION OF NOTE\n    note.note_id= (SELECT MAX(cmn.note_id) FROM casemgmt_note cmn WHERE cmn.uuid = note.uuid) AND\n    DATE(note.observation_date) > ${lowerLimit.visitdate}\n    GROUP BY demographic_no\n    ORDER BY demographic_no\n  ) VISIT\n  ON (d.demographic_no = VISIT.demographic_no)  \n  WHERE d.patient_status LIKE ${active}\n  AND d.demographic_no > 0\n  AND d.provider_no LIKE ${provider} \n) fin\n		</query>\n	</indicatorQuery>\n	<drillDownQuery>\n		<version>03-13-2018</version>\n		<params>\n			<parameter id=\"provider\" name=\"Provider Number\" value=\"loggedInProvider\" />\n			<parameter id=\"active\" name=\"Active Patients\" value=\"\'AC\'\" />\n			<parameter id=\"dxcodesICD\" name=\"Dx Codes (ICD)\" value=\"715\" />\n                        <parameter id=\"dxcodesSysICD\" name=\"DX CodeSystem (ICD)\" value=\"\'icd9\'\" />\n                        <parameter id=\"dxcodesSnoMed\" name=\"Dx Codes (SnoMed)\" value=\"396275006\" />\n                        <parameter id=\"dxcodesSysSnoMed\" name=\"Dx CodeSystem (SnoMed)\" value=\"\'snomed%\'\" />\n			<parameter id=\"billingCode\" name=\"ICD9 Billing Code\" value=\"715\" />\n			<parameter id=\"numOfBills\" name=\"Number of ICD9 715 Bills\" value=\"2\" />\n			<parameter id=\"numOfVisits\" name=\"Number of Visit Encounters coded 715/ICD9\" value=\"2\" />\n		</params>\n		\n		<range>\n			<lowerLimit id=\"billingdate\" label=\"From Date\" name=\"Date\" value=\"DATE_SUB( NOW(), INTERVAL 3 YEAR )\" />\n			<upperLimit id=\"billingdate\" label=\"Date Today\" name=\"Date\" value=\"NOW()\" />\n			<lowerLimit id=\"visitdate\" label=\"From Date\" name=\"Date\" value=\"DATE_SUB( NOW(), INTERVAL 3 YEAR )\" />\n			<upperLimit id=\"visitdate\" label=\"Date Today\" name=\"Date\" value=\"NOW()\" />\n		</range>\n		\n		<displayColumns>\n			<column id=\"demographic\" name=\"d.demographic_no\" title=\"Patient Id\" primary=\"true\" />\n			<column id=\"name\" name=\"CONCAT( d.last_name, \', \', d.first_name )\" title=\"Patient Name\" primary=\"false\" />\n			<column id=\"dob\" name=\"DATE_FORMAT( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth), \'%m-%d-%Y\' )\" title=\"Date of Birth\" primary=\"false\" />\n			<column id=\"age\" name=\"TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )\" title=\"Age\" primary=\"false\" />\n			<column id=\"billings\" name=\"IFNULL( BILLING.billcount, \'0\')\" title=\"Billings\" primary=\"false\" />\n			<column id=\"visits\" name=\"IFNULL( VISIT.visitcount, \'0\')\" title=\"Visits\" primary=\"false\" />\n		</displayColumns>\n		\n		<exportColumns>\n			<column id=\"demographic\" name=\"d.demographic_no\" title=\"Patient Id\" primary=\"true\" />\n                        <column id=\"firstName\" name=\"d.first_name\" title=\"First Name\" primary=\"false\" />\n                        <column id=\"lastName\" name=\"d.last_name\" title=\"Last Name\" primary=\"false\" />\n			<column id=\"dob\" name=\"DATE_FORMAT( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth), \'%m-%d-%Y\' )\" title=\"Date of Birth\" primary=\"false\" />\n			<column id=\"age\" name=\"TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )\" title=\"Age\" primary=\"false\" />\n			<column id=\"billings\" name=\"IFNULL( BILLING.billcount, \'0\')\" title=\"Billings\" primary=\"false\" />\n			<column id=\"visits\" name=\"IFNULL( VISIT.visitcount, \'0\')\" title=\"Visits\" primary=\"false\" />\n		</exportColumns>\n		<query>	\n  SELECT *	\n  FROM demographic d \n  LEFT JOIN (\n    SELECT demographic_no, dxresearch_code, coding_system, count(dxresearch_code)\n    FROM dxresearch\n    WHERE status=\'A\' AND\n    (\n      (LEFT(dxresearch_code, 3) IN (\'715\') AND coding_system = ${dxcodesSysICD}) OR\n      (dxresearch_code IN (\'396275006\') AND coding_system LIKE ${dxcodesSysSnoMed})\n    )\n    GROUP BY demographic_no\n    ORDER BY demographic_no\n  ) dxr\n  ON d.demographic_no = dxr.demographic_no\n  -- Billed 715 in last 3 years\n  LEFT JOIN (\n    SELECT b.demographic_no as demographic_no, b.dx_code1 as dxcode1, b.dx_code2 as dxcode2, b.dx_code3 as dxcode3, count(b.demographic_no) as billcount\n    FROM billingmaster b\n    WHERE ( LEFT(b.dx_code1, 3) IN (\'715\') OR LEFT(b.dx_code2, 3) IN (\'715\') OR LEFT(b.dx_code3, 3) IN (\'715\') )\n    AND DATE(b.createdate) > ${lowerLimit.billingdate}\n    AND b.demographic_no > 0\n    GROUP BY b.demographic_no HAVING COUNT(b.demographic_no) > -1\n  ) BILLING\n  ON (d.demographic_no = BILLING.demographic_no)  \n  -- Coded dx during visit encounter in last 3 years\n  LEFT JOIN(\n    SELECT ASSIGNED.demographic_no as demographic_no, observation_date as visitdate, uuid, count(ASSIGNED.demographic_no) as visitcount\n    FROM casemgmt_note note\n    INNER JOIN (\n      SELECT note_id, CODED.demo_no as demographic_no FROM casemgmt_issue_notes\n      INNER JOIN (\n        SELECT ci.id as id, ci.update_date, ci.demographic_no demo_no FROM issue i\n        INNER JOIN casemgmt_issue ci\n        ON i.issue_id = ci.issue_id\n        WHERE\n	(i.type LIKE ${dxcodesSysICD} AND LEFT(i.code, 3) IN (\'715\')) OR\n	(i.type LIKE ${dxcodesSysSnoMed} AND i.code IN (\'396275006\'))\n      ) CODED\n      ON (casemgmt_issue_notes.id = CODED.id)\n      ORDER BY CODED.demo_no\n    ) ASSIGNED\n    ON note.note_id = ASSIGNED.note_id AND\n    -- GET LAST REVISION OF NOTE\n    note.note_id= (SELECT MAX(cmn.note_id) FROM casemgmt_note cmn WHERE cmn.uuid = note.uuid) AND\n    DATE(note.observation_date) > ${lowerLimit.visitdate}\n    GROUP BY demographic_no\n    ORDER BY demographic_no\n  ) VISIT\n  ON (d.demographic_no = VISIT.demographic_no)  \n-- Consider OBS here if needed  \n  WHERE d.patient_status LIKE ${active}\n  AND d.demographic_no > 0\n  AND ( dxr.dxresearch_code IS NULL AND ((BILLING.billcount IS NOT NULL AND BILLING.billcount &gt;= ${numOfBills}) OR (VISIT.visitcount IS NOT NULL AND VISIT.visitcount &gt;= ${numOfVisits})))\n  AND d.provider_no LIKE ${provider}\n  ORDER BY d.demographic_no\n		</query>\n	</drillDownQuery>\n</indicatorTemplateXML>\n','','\0',0,NULL,NULL),
(49,5,'Osteoarthritis Prevalence','CDM','Osteoarthritis','DoBC CPQI PSP Panel','2017-08-02','% of active patients in the practice coded with Osteoarthritis.','\ni) Osteoarthritis patients: \"Patient Status: Active\nAND has a Current Problem List/Profile item code of 396275006 OR starting with 715\"\nii) Other patients: \"Patient Status: Active\nAND does not have a Current Problem List/Profile item code of 396275006 OR','<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<indicatorTemplateXML>\n	<author>OSCAR BC</author>\n	<uid></uid>\n	<heading>\n		<category>CDM</category>\n		<subCategory>Osteoarthritis</subCategory>\n		<name>Osteoarthritis Prevalence</name>\n		<definition>% of active patients in the practice coded with Osteoarthritis.</definition>\n		<framework>DoBC CPQI PSP Panel</framework>\n		<frameworkVersion>08-02-2017</frameworkVersion>\n		<notes>\ni) Osteoarthritis patients: \"Patient Status: Active\nAND has a Current Problem List/Profile item code of 396275006 OR starting with 715\"\nii) Other patients: \"Patient Status: Active\nAND does not have a Current Problem List/Profile item code of 396275006 OR starting with 715\"\n		</notes>\n	</heading>\n	<indicatorQuery>\n		<version>03-13-2018</version>\n		<params>\n			<!-- \n				Required parameter provider. Value options are: \n					[ an individual providerNo, or provider range ] ie: value=\"370, 1001\" \n					\"all\" ie: value=\"all\" including null.\n					\"loggedInProvider\" ie:\n				Default is \"loggedInProvider\"\n				Use this parameter in the query as ${provider}\n				This parameter should be used for fetching patient\'s assigned to a MRP.\n				ie: WHERE demographic.provider_no = ${provider}\n			-->\n			<parameter id=\"provider\" name=\"provider_no\" value=\"loggedInProvider\" />\n			<parameter id=\"pstatus\" name=\"Patient Status\" value=\"\'AC\'\" />\n			<parameter id=\"dxcodesICD\" name=\"Dx Codes (ICD)\" value=\"715\" />\n			<parameter id=\"dxcodesSysICD\" name=\"DX CodeSystem (ICD)\" value=\"\'icd9\'\" />\n			<parameter id=\"dxcodesSnoMed\" name=\"Dx Codes (SnoMed)\" value=\"396275006\" />\n			<parameter id=\"dxcodesSysSnoMed\" name=\"Dx CodeSystem (SnoMed)\" value=\"\'snomed%\'\" />\n		</params>\n		<query>\n			<!-- Indicator SQL Query here -->\nSELECT\n -- PERCENT OF TOTAL PATIENTS NOTED AS ACTIVE WITH CURRENT OSTEOARTHRITIS\n IF( COUNT(fin.patient) > 0, SUM( IF( dxresearch_code is not NULL , 1, 0) ) , 0 ) AS \"% Active, Current Osteoarthritis\",\n -- PERCENT OF TOTAL PATIENTS NOTED AS ACTIVE WITHOUT CURRENT OSTEOARTHRITIS\n IF( COUNT(fin.patient) > 0, SUM( IF( dxresearch_code is NULL , 1, 0) ) , 0 ) AS \"% Active, No Current Osteoarthritis\"\nFROM (\n SELECT d.demographic_no AS patient, d.patient_status AS pt_status, dxresearch_code\n FROM demographic d\n LEFT JOIN (\n  SELECT demographic_no, dxresearch_code, count(dxresearch_code)\n  FROM dxresearch\n  WHERE status=\'A\' AND\n  (\n   (LEFT(dxresearch_code, 3) IN (\'715\') AND coding_system = ${dxcodesSysICD}) OR\n   (dxresearch_code IN (\'396275006\') AND coding_system LIKE ${dxcodesSysSnoMed})\n   )\n  GROUP BY demographic_no\n  ORDER BY demographic_no\n ) problems\n ON d.demographic_no = problems.demographic_no\n WHERE d.provider_no LIKE ${provider} AND d.patient_status = ${pstatus}\n) fin\n		</query>\n	</indicatorQuery>\n	<drillDownQuery>\n		<version>03-13-2018</version>\n		<params>\n			<parameter id=\"provider\" name=\"provider_no\" value=\"loggedInProvider\" />	\n			<parameter id=\"pstatus\" name=\"Patient Status\" value=\"\'AC\'\" />\n			<parameter id=\"dxcodesICD\" name=\"Dx Codes (ICD)\" value=\"715\" />\n			<parameter id=\"dxcodesSysICD\" name=\"DX CodeSystem (ICD)\" value=\"\'icd9\'\" />\n			<parameter id=\"dxcodesSnoMed\" name=\"Dx Codes (SnoMed)\" value=\"396275006\" />\n			<parameter id=\"dxcodesSysSnoMed\" name=\"Dx CodeSystem (SnoMed)\" value=\"\'snomed%\'\" />\n		</params>\n		<displayColumns>\n			<column id=\"demographic\" name=\"d.demographic_no\" title=\"Patient Id\" primary=\"true\" />\n			<column id=\"name\" name=\"CONCAT( d.last_name, \', \', d.first_name )\" title=\"Patient Name\" primary=\"false\" />\n			<column id=\"dob\" name=\"DATE_FORMAT( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth), \'%m-%d-%Y\' )\" title=\"Date of Birth (mm-dd-yy)\" primary=\"false\" />\n			<column id=\"age\" name=\"TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )\" title=\"Age\" primary=\"false\" />\n			<column id=\"dxcode\" title=\"Dx System/Code\" name=\"CONCAT(MIN(dxr.coding_system),\'/\',MIN(dxr.dxresearch_code),IF( MIN(dxr.dxresearch_code) != MAX(dxr.dxresearch_code),CONCAT( \' &amp; \', MAX(dxr.coding_system), \'/\', MAX(dxr.dxresearch_code) ),\'\') )\" primary=\"false\" />\n		</displayColumns>\n		<exportColumns>\n			<column id=\"demographic\" name=\"d.demographic_no\" title=\"Patient Id\" primary=\"true\" />\n			<column id=\"firstName\" name=\"d.first_name\" title=\"First Name\" primary=\"false\" />\n			<column id=\"lastName\" name=\"d.last_name\" title=\"Last Name\" primary=\"false\" />\n			<column id=\"dob\" name=\"DATE_FORMAT( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth), \'%m-%d-%Y\' )\" title=\"Date of Birth (mm-dd-yy)\" primary=\"false\" />\n			<column id=\"age\" name=\"TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )\" title=\"Age\" primary=\"false\" />\n			<column id=\"dxcode\" title=\"Dx System/Code\" name=\"CONCAT(MIN(dxr.coding_system),\'/\',MIN(dxr.dxresearch_code),IF( MIN(dxr.dxresearch_code) != MAX(dxr.dxresearch_code),CONCAT( \' &amp; \', MAX(dxr.coding_system), \'/\', MAX(dxr.dxresearch_code) ),\'\') )\" primary=\"false\" />\n		</exportColumns>\n		<query>\n			<!-- Drilldown SQL Query here -->\nSELECT\n*			\nFROM demographic d\nLEFT JOIN dxresearch dxr\nON d.demographic_no = dxr.demographic_no\nWHERE d.patient_status=${pstatus}\nAND\n(\n (LEFT(dxr.dxresearch_code, 3) IN (\'715\') AND dxr.coding_system = ${dxcodesSysICD}) OR\n (dxr.dxresearch_code IN (\'396275006\') AND dxr.coding_system LIKE ${dxcodesSysSnoMed})\n )\nAND dxr.status = \'A\'\nAND d.provider_no LIKE ${provider}\nGROUP BY d.demographic_no\nORDER BY COUNT(d.demographic_no) DESC, d.demographic_no\n		</query>\n	</drillDownQuery>\n</indicatorTemplateXML>\n','','\0',0,NULL,NULL),
(50,6,'Consider Alcohol Dependence Syndrome','CDM','Alcohol Dependence Syndrome','DoBC CPQI PSP Panel','2017-08-02','\n			Patients with alcohol dependence syndrome dx in 2+ bills or 2+ visit encounters within last 3 years\n		','\n		  Created for Doctors of BC\n		  i) Alcohol Dependence Syndrome dx in 2+ bills: \"Patient Status: Active\nAND does not have a Current Problem List/Profile item code of 66590003 OR starting with 303\nAND with >=2 Bills with the ICD9 diagnosis code starting ','<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<indicatorTemplateXML>\n	<author>OSCAR BC</author>\n	<uid></uid>\n	<heading>\n		<category>CDM</category>\n		<subCategory>Alcohol Dependence Syndrome</subCategory>\n		<name>Consider Alcohol Dependence Syndrome</name>\n		<definition>\n			Patients with alcohol dependence syndrome dx in 2+ bills or 2+ visit encounters within last 3 years\n		</definition>\n		<framework>DoBC CPQI PSP Panel</framework>\n		<frameworkVersion>08-02-2017</frameworkVersion>\n		<notes>\n		  Created for Doctors of BC\n		  i) Alcohol Dependence Syndrome dx in 2+ bills: \"Patient Status: Active\nAND does not have a Current Problem List/Profile item code of 66590003 OR starting with 303\nAND with >=2 Bills with the ICD9 diagnosis code starting with 303 in the last 3 years\"\n		  ii) Alcohol Dependence Syndrome dx in 2+ visits: \"Patient Status: Active\nAND does not have a Current Problem List/Profile item code of 66590003 OR starting with 303\nAND with >=2 Visit Encounters with Snomed diagnosis code 66590003 or the ICD9 diagnosis code starting with 303 in the last 3 years\"\n		</notes>\n	</heading>\n	<indicatorQuery>\n		<version>03-13-2018</version>\n		<params>\n			<parameter id=\"provider\" name=\"Provider Number\" value=\"loggedInProvider\" />\n			<parameter id=\"active\" name=\"Active Patients\" value=\"\'AC\'\" />\n			<parameter id=\"dxcodesICD\" name=\"Dx Codes (ICD)\" value=\"303\" />\n                        <parameter id=\"dxcodesSysICD\" name=\"DX CodeSystem (ICD)\" value=\"\'icd9\'\" />\n                        <parameter id=\"dxcodesSnoMed\" name=\"Dx Codes (SnoMed)\" value=\"66590003\" />\n                        <parameter id=\"dxcodesSysSnoMed\" name=\"Dx CodeSystem (SnoMed)\" value=\"\'snomed%\'\" />\n			<parameter id=\"billingCode\" name=\"ICD9 Billing Code\" value=\"303\" />\n			<parameter id=\"numOfBills\" name=\"Number of ICD9 303 Bills\" value=\"2\" />\n			<parameter id=\"numOfVisits\" name=\"Number of Visit Encounters coded 303/ICD9\" value=\"2\" />\n		</params>\n		<range>\n			<lowerLimit id=\"billingdate\" label=\"From Date\" name=\"Date\" value=\"DATE_SUB( NOW(), INTERVAL 3 YEAR )\" />\n			<upperLimit id=\"billingdate\" label=\"Date Today\" name=\"Date\" value=\"NOW()\" />\n			<lowerLimit id=\"visitdate\" label=\"From Date\" name=\"Date\" value=\"DATE_SUB( NOW(), INTERVAL 3 YEAR )\" />\n			<upperLimit id=\"visitdate\" label=\"Date Today\" name=\"Date\" value=\"NOW()\" />\n		</range>\n		<query>\nSELECT\n  IF ( COUNT(fin.patient) &gt; 0, SUM( CASE WHEN (fin.dx IS NULL AND fin.billcount &gt;= ${numOfBills}) THEN 1 ELSE 0 END ) , 0) AS \"Alcohol Dependence Syndrome dx in ${numOfBills}+ bills\",\n  IF ( COUNT(fin.patient) &gt; 0, SUM( CASE WHEN (fin.dx IS NULL AND fin.visitcount &gt;= ${numOfVisits}) THEN 1 ELSE 0 END ) , 0) AS \"Alcohol Dependence Syndrome dx in ${numOfVisits}+ visits\"\n-- Consider OBS here if needed  \nFROM ( \n  SELECT \n    d.demographic_no AS patient, \n    BILLING.billcount AS billcount,\n    VISIT.visitcount AS visitcount,\n    dxr.dxresearch_code AS dx,\n    dxr.coding_system AS dxs\n  FROM demographic d \n  LEFT JOIN (\n    SELECT demographic_no, dxresearch_code, coding_system, count(dxresearch_code)\n    FROM dxresearch\n    WHERE status=\'A\' AND\n    (\n      (LEFT(dxresearch_code, 3) IN (\'303\') AND coding_system = ${dxcodesSysICD}) OR\n      (dxresearch_code IN (\'66590003\') AND coding_system LIKE ${dxcodesSysSnoMed})\n    )\n    GROUP BY demographic_no\n    ORDER BY demographic_no\n  ) dxr\n  ON d.demographic_no = dxr.demographic_no\n  -- Billed 303 in last 3 years\n  LEFT JOIN (\n    SELECT b.demographic_no as demographic_no, b.dx_code1 as dxcode1, b.dx_code2 as dxcode2, b.dx_code3 as dxcode3, count(b.demographic_no) as billcount\n    FROM billingmaster b\n    WHERE ( LEFT(b.dx_code1, 3) IN (\'303\') OR LEFT(b.dx_code2, 3) IN (\'303\') OR LEFT(b.dx_code3, 3) IN (\'303\') )\n    AND DATE(b.createdate) > ${lowerLimit.billingdate}\n    AND b.demographic_no > 0\n    GROUP BY b.demographic_no HAVING COUNT(b.demographic_no) > -1\n  ) BILLING\n  ON (d.demographic_no = BILLING.demographic_no)  \n  -- Coded dx during visit encounter in last 3 years\n  LEFT JOIN(\n    SELECT ASSIGNED.demographic_no as demographic_no, observation_date as visitdate, uuid, count(ASSIGNED.demographic_no) as visitcount\n    FROM casemgmt_note note\n    INNER JOIN (\n      SELECT note_id, CODED.demo_no as demographic_no FROM casemgmt_issue_notes\n      INNER JOIN (\n        SELECT ci.id as id, ci.update_date, ci.demographic_no demo_no FROM issue i\n        INNER JOIN casemgmt_issue ci\n        ON i.issue_id = ci.issue_id\n        WHERE\n	(i.type LIKE ${dxcodesSysICD} AND LEFT(i.code, 3) IN (\'303\')) OR\n	(i.type LIKE ${dxcodesSysSnoMed} AND i.code IN (\'66590003\'))\n      ) CODED\n      ON (casemgmt_issue_notes.id = CODED.id)\n      ORDER BY CODED.demo_no\n    ) ASSIGNED\n    ON note.note_id = ASSIGNED.note_id AND\n    -- GET LAST REVISION OF NOTE\n    note.note_id= (SELECT MAX(cmn.note_id) FROM casemgmt_note cmn WHERE cmn.uuid = note.uuid) AND\n    DATE(note.observation_date) > ${lowerLimit.visitdate}\n    GROUP BY demographic_no\n    ORDER BY demographic_no\n  ) VISIT\n  ON (d.demographic_no = VISIT.demographic_no)  \n  WHERE d.patient_status LIKE ${active}\n  AND d.demographic_no > 0\n  AND d.provider_no LIKE ${provider} \n) fin\n		</query>\n	</indicatorQuery>\n	<drillDownQuery>\n		<version>03-13-2018</version>\n		<params>\n			<parameter id=\"provider\" name=\"Provider Number\" value=\"loggedInProvider\" />\n			<parameter id=\"active\" name=\"Active Patients\" value=\"\'AC\'\" />\n			<parameter id=\"dxcodesICD\" name=\"Dx Codes (ICD)\" value=\"303\" />\n                        <parameter id=\"dxcodesSysICD\" name=\"DX CodeSystem (ICD)\" value=\"\'icd9\'\" />\n                        <parameter id=\"dxcodesSnoMed\" name=\"Dx Codes (SnoMed)\" value=\"66590003\" />\n                        <parameter id=\"dxcodesSysSnoMed\" name=\"Dx CodeSystem (SnoMed)\" value=\"\'snomed%\'\" />\n			<parameter id=\"billingCode\" name=\"ICD9 Billing Code\" value=\"303\" />\n			<parameter id=\"numOfBills\" name=\"Number of ICD9 303 Bills\" value=\"2\" />\n			<parameter id=\"numOfVisits\" name=\"Number of Visit Encounters coded 303/ICD9\" value=\"2\" />\n		</params>\n		\n		<range>\n			<lowerLimit id=\"billingdate\" label=\"From Date\" name=\"Date\" value=\"DATE_SUB( NOW(), INTERVAL 3 YEAR )\" />\n			<upperLimit id=\"billingdate\" label=\"Date Today\" name=\"Date\" value=\"NOW()\" />\n			<lowerLimit id=\"visitdate\" label=\"From Date\" name=\"Date\" value=\"DATE_SUB( NOW(), INTERVAL 3 YEAR )\" />\n			<upperLimit id=\"visitdate\" label=\"Date Today\" name=\"Date\" value=\"NOW()\" />\n		</range>\n		\n		<displayColumns>\n			<column id=\"demographic\" name=\"d.demographic_no\" title=\"Patient Id\" primary=\"true\" />\n			<column id=\"name\" name=\"CONCAT( d.last_name, \', \', d.first_name )\" title=\"Patient Name\" primary=\"false\" />\n			<column id=\"dob\" name=\"DATE_FORMAT( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth), \'%m-%d-%Y\' )\" title=\"Date of Birth\" primary=\"false\" />\n			<column id=\"age\" name=\"TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )\" title=\"Age\" primary=\"false\" />\n			<column id=\"billings\" name=\"IFNULL( BILLING.billcount, \'0\')\" title=\"Billings\" primary=\"false\" />\n			<column id=\"visits\" name=\"IFNULL( VISIT.visitcount, \'0\')\" title=\"Visits\" primary=\"false\" />\n		</displayColumns>\n		\n		<exportColumns>\n			<column id=\"demographic\" name=\"d.demographic_no\" title=\"Patient Id\" primary=\"true\" />\n                        <column id=\"firstName\" name=\"d.first_name\" title=\"First Name\" primary=\"false\" />\n                        <column id=\"lastName\" name=\"d.last_name\" title=\"Last Name\" primary=\"false\" />\n			<column id=\"dob\" name=\"DATE_FORMAT( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth), \'%m-%d-%Y\' )\" title=\"Date of Birth\" primary=\"false\" />\n			<column id=\"age\" name=\"TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )\" title=\"Age\" primary=\"false\" />\n			<column id=\"billings\" name=\"IFNULL( BILLING.billcount, \'0\')\" title=\"Billings\" primary=\"false\" />\n			<column id=\"visits\" name=\"IFNULL( VISIT.visitcount, \'0\')\" title=\"Visits\" primary=\"false\" />\n		</exportColumns>\n		<query>	\n  SELECT *	\n  FROM demographic d \n  LEFT JOIN (\n    SELECT demographic_no, dxresearch_code, coding_system, count(dxresearch_code)\n    FROM dxresearch\n    WHERE status=\'A\' AND\n    (\n      (LEFT(dxresearch_code, 3) IN (\'303\') AND coding_system = ${dxcodesSysICD}) OR\n      (dxresearch_code IN (\'66590003\') AND coding_system LIKE ${dxcodesSysSnoMed})\n    )\n    GROUP BY demographic_no\n    ORDER BY demographic_no\n  ) dxr\n  ON d.demographic_no = dxr.demographic_no\n  -- Billed 303 in last 3 years\n  LEFT JOIN (\n    SELECT b.demographic_no as demographic_no, b.dx_code1 as dxcode1, b.dx_code2 as dxcode2, b.dx_code3 as dxcode3, count(b.demographic_no) as billcount\n    FROM billingmaster b\n    WHERE ( LEFT(b.dx_code1, 3) IN (\'303\') OR LEFT(b.dx_code2, 3) IN (\'303\') OR LEFT(b.dx_code3, 3) IN (\'303\') )\n    AND DATE(b.createdate) > ${lowerLimit.billingdate}\n    AND b.demographic_no > 0\n    GROUP BY b.demographic_no HAVING COUNT(b.demographic_no) > -1\n  ) BILLING\n  ON (d.demographic_no = BILLING.demographic_no)  \n  -- Coded dx during visit encounter in last 3 years\n  LEFT JOIN(\n    SELECT ASSIGNED.demographic_no as demographic_no, observation_date as visitdate, uuid, count(ASSIGNED.demographic_no) as visitcount\n    FROM casemgmt_note note\n    INNER JOIN (\n      SELECT note_id, CODED.demo_no as demographic_no FROM casemgmt_issue_notes\n      INNER JOIN (\n        SELECT ci.id as id, ci.update_date, ci.demographic_no demo_no FROM issue i\n        INNER JOIN casemgmt_issue ci\n        ON i.issue_id = ci.issue_id\n        WHERE\n	(i.type LIKE ${dxcodesSysICD} AND LEFT(i.code, 3) IN (\'303\')) OR\n	(i.type LIKE ${dxcodesSysSnoMed} AND i.code IN (\'66590003\'))\n      ) CODED\n      ON (casemgmt_issue_notes.id = CODED.id)\n      ORDER BY CODED.demo_no\n    ) ASSIGNED\n    ON note.note_id = ASSIGNED.note_id AND\n    -- GET LAST REVISION OF NOTE\n    note.note_id= (SELECT MAX(cmn.note_id) FROM casemgmt_note cmn WHERE cmn.uuid = note.uuid) AND\n    DATE(note.observation_date) > ${lowerLimit.visitdate}\n    GROUP BY demographic_no\n    ORDER BY demographic_no\n  ) VISIT\n  ON (d.demographic_no = VISIT.demographic_no)  \n-- Consider OBS here if needed  \n  WHERE d.patient_status LIKE ${active}\n  AND d.demographic_no > 0\n  AND ( dxr.dxresearch_code IS NULL AND ((BILLING.billcount IS NOT NULL AND BILLING.billcount &gt;= ${numOfBills}) OR (VISIT.visitcount IS NOT NULL AND VISIT.visitcount &gt;= ${numOfVisits})))\n  AND d.provider_no LIKE ${provider}\n  ORDER BY d.demographic_no\n		</query>\n	</drillDownQuery>\n</indicatorTemplateXML>\n','','\0',0,NULL,NULL),
(51,6,'Alcohol Dependence Syndrome Prevalence','CDM','Alcohol Dependence Syndrome','DoBC CPQI PSP Panel','2017-08-02','% of active patients in the practice coded with Alcohol Dependence Syndrome.','\ni) Alchohol dependence patients: \"Patient Status: Active\nAND has a Current Problem List/Profile item code of 66590003 OR starting with 303\"\nii) Other patients: \"Patient Status: Active\nAND does not have a Current Problem List/Profile item code of 66590003','<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<indicatorTemplateXML>\n	<author>OSCAR BC</author>\n	<uid></uid>\n	<heading>\n		<category>CDM</category>\n		<subCategory>Alcohol Dependence Syndrome</subCategory>\n		<name>Alcohol Dependence Syndrome Prevalence</name>\n		<definition>% of active patients in the practice coded with Alcohol Dependence Syndrome.</definition>\n		<framework>DoBC CPQI PSP Panel</framework>\n		<frameworkVersion>08-02-2017</frameworkVersion>\n		<notes>\ni) Alchohol dependence patients: \"Patient Status: Active\nAND has a Current Problem List/Profile item code of 66590003 OR starting with 303\"\nii) Other patients: \"Patient Status: Active\nAND does not have a Current Problem List/Profile item code of 66590003 OR starting with 303\"\n		</notes>\n	</heading>\n	<indicatorQuery>\n		<version>03-13-2018</version>\n		<params>\n			<!-- \n				Required parameter provider. Value options are: \n					[ an individual providerNo, or provider range ] ie: value=\"370, 1001\" \n					\"all\" ie: value=\"all\" including null.\n					\"loggedInProvider\" ie:\n				Default is \"loggedInProvider\"\n				Use this parameter in the query as ${provider}\n				This parameter should be used for fetching patient\'s assigned to a MRP.\n				ie: WHERE demographic.provider_no = ${provider}\n			-->\n			<parameter id=\"provider\" name=\"provider_no\" value=\"loggedInProvider\" />\n			<parameter id=\"pstatus\" name=\"Patient Status\" value=\"\'AC\'\" />\n			<parameter id=\"dxcodesICD\" name=\"Dx Codes (ICD)\" value=\"303\" />\n			<parameter id=\"dxcodesSysICD\" name=\"DX CodeSystem (ICD)\" value=\"\'icd9\'\" />\n			<parameter id=\"dxcodesSnoMed\" name=\"Dx Codes (SnoMed)\" value=\"66590003\" />\n			<parameter id=\"dxcodesSysSnoMed\" name=\"Dx CodeSystem (SnoMed)\" value=\"\'snomed%\'\" />\n		</params>\n		<query>\n			<!-- Indicator SQL Query here -->\nSELECT\n -- PERCENT OF TOTAL PATIENTS NOTED AS ACTIVE WITH CURRENT ALCOHOL DEPENDENCE SYNDROME\n IF( COUNT(fin.patient) > 0, SUM( IF( dxresearch_code is not NULL , 1, 0) ) , 0 ) AS \"% Active, Current Alcohol Dependence Syndrome\",\n -- PERCENT OF TOTAL PATIENTS NOTED AS ACTIVE WITHOUT CURRENT ALCOHOL DEPENDENCE SYNDROME\n IF( COUNT(fin.patient) > 0, SUM( IF( dxresearch_code is NULL , 1, 0) ) , 0 ) AS \"% Active, No Current Alcohol Dependence Syndrome\"\nFROM (\n SELECT d.demographic_no AS patient, d.patient_status AS pt_status, dxresearch_code\n FROM demographic d\n LEFT JOIN (\n  SELECT demographic_no, dxresearch_code, count(dxresearch_code)\n  FROM dxresearch\n  WHERE status=\'A\' AND\n  (\n   (LEFT(dxresearch_code, 3) IN (\'303\') AND coding_system = ${dxcodesSysICD}) OR\n   (dxresearch_code IN (\'66590003\') AND coding_system LIKE ${dxcodesSysSnoMed})\n   )\n  GROUP BY demographic_no\n  ORDER BY demographic_no\n ) problems\n ON d.demographic_no = problems.demographic_no\n WHERE d.provider_no LIKE ${provider} AND d.patient_status = ${pstatus}\n) fin\n		</query>\n	</indicatorQuery>\n	<drillDownQuery>\n		<version>03-13-2018</version>\n		<params>\n			<parameter id=\"provider\" name=\"provider_no\" value=\"loggedInProvider\" />	\n			<parameter id=\"pstatus\" name=\"Patient Status\" value=\"\'AC\'\" />\n			<parameter id=\"dxcodesICD\" name=\"Dx Codes (ICD)\" value=\"303\" />\n			<parameter id=\"dxcodesSysICD\" name=\"DX CodeSystem (ICD)\" value=\"\'icd9\'\" />\n			<parameter id=\"dxcodesSnoMed\" name=\"Dx Codes (SnoMed)\" value=\"66590003\" />\n			<parameter id=\"dxcodesSysSnoMed\" name=\"Dx CodeSystem (SnoMed)\" value=\"\'snomed%\'\" />\n		</params>\n		<displayColumns>\n			<column id=\"demographic\" name=\"d.demographic_no\" title=\"Patient Id\" primary=\"true\" />\n			<column id=\"name\" name=\"CONCAT( d.last_name, \', \', d.first_name )\" title=\"Patient Name\" primary=\"false\" />\n			<column id=\"dob\" name=\"DATE_FORMAT( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth), \'%m-%d-%Y\' )\" title=\"Date of Birth (mm-dd-yy)\" primary=\"false\" />\n			<column id=\"age\" name=\"TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )\" title=\"Age\" primary=\"false\" />\n			<column id=\"dxcode\" title=\"Dx System/Code\" name=\"CONCAT(MIN(dxr.coding_system),\'/\',MIN(dxr.dxresearch_code),IF( MIN(dxr.dxresearch_code) != MAX(dxr.dxresearch_code),CONCAT( \' &amp; \', MAX(dxr.coding_system), \'/\', MAX(dxr.dxresearch_code) ),\'\') )\" primary=\"false\" />\n		</displayColumns>\n		<exportColumns>\n			<column id=\"demographic\" name=\"d.demographic_no\" title=\"Patient Id\" primary=\"true\" />\n			<column id=\"firstName\" name=\"d.first_name\" title=\"First Name\" primary=\"false\" />\n			<column id=\"lastName\" name=\"d.last_name\" title=\"Last Name\" primary=\"false\" />\n			<column id=\"dob\" name=\"DATE_FORMAT( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth), \'%m-%d-%Y\' )\" title=\"Date of Birth (mm-dd-yy)\" primary=\"false\" />\n			<column id=\"age\" name=\"TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )\" title=\"Age\" primary=\"false\" />\n			<column id=\"dxcode\" title=\"Dx System/Code\" name=\"CONCAT(MIN(dxr.coding_system),\'/\',MIN(dxr.dxresearch_code),IF( MIN(dxr.dxresearch_code) != MAX(dxr.dxresearch_code),CONCAT( \' &amp; \', MAX(dxr.coding_system), \'/\', MAX(dxr.dxresearch_code) ),\'\') )\" primary=\"false\" />\n		</exportColumns>\n		<query>\n			<!-- Drilldown SQL Query here -->\nSELECT\n*			\nFROM demographic d\nLEFT JOIN dxresearch dxr\nON d.demographic_no = dxr.demographic_no\nWHERE d.patient_status=${pstatus}\nAND\n(\n (LEFT(dxr.dxresearch_code, 3) IN (\'303\') AND dxr.coding_system = ${dxcodesSysICD}) OR\n (dxr.dxresearch_code IN (\'66590003\') AND dxr.coding_system LIKE ${dxcodesSysSnoMed})\n )\nAND dxr.status = \'A\'\nAND d.provider_no LIKE ${provider}\nGROUP BY d.demographic_no\nORDER BY COUNT(d.demographic_no) DESC, d.demographic_no\n		</query>\n	</drillDownQuery>\n</indicatorTemplateXML>\n','','\0',0,NULL,NULL),
(52,6,'Consider Anxiety','CDM','Anxiety','DoBC CPQI PSP Panel','2017-08-02','\n			Patients with anxiety dx in 2+ bills or 2+ visit encounters within last 3 years or most recent GAD-7 score >= 10 in the past 3 months\n		','\n		  Created for Doctors of BC\n		  i) Anxiety dx in 2+ bills: \"Patient Status: Active\nAND does not have a Current Problem List/Profile item code of 48694002 OR 197480006 OR starting with 300\nAND with >=2 Bills with the ICD9 diagnosis code starting with 30','<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<indicatorTemplateXML>\n	<author>OSCAR BC</author>\n	<uid></uid>\n	<heading>\n		<category>CDM</category>\n		<subCategory>Anxiety</subCategory>\n		<name>Consider Anxiety</name>\n		<definition>\n			Patients with anxiety dx in 2+ bills or 2+ visit encounters within last 3 years or most recent GAD-7 score &gt;= 10 in the past 3 months\n		</definition>\n		<framework>DoBC CPQI PSP Panel</framework>\n		<frameworkVersion>08-02-2017</frameworkVersion>\n		<notes>\n		  Created for Doctors of BC\n		  i) Anxiety dx in 2+ bills: \"Patient Status: Active\nAND does not have a Current Problem List/Profile item code of 48694002 OR 197480006 OR starting with 300\nAND with >=2 Bills with the ICD9 diagnosis code starting with 300 in the last 3 years\"\n		  ii) Anxiety dx in 2+ visits: \"Patient Status: Active\nAND does not have a Current Problem List/Profile item code of 48694002 OR 197480006 OR starting with 300\nAND with >=2 Visit Encounters with Snomed diagnosis code 48694002, 197480006 or the ICD9 diagnosis code starting with 300 in the last 3 years\"\n		  iii) GAD-7 score &gt;=10: \"Patient Status: Active\nAND does not have a Current Problem List/Profile item code of 48694002 OR 48694002 OR starting with 300\nAND WITH a most recent GAD-7 score &gt;=10 in the past 3 months\"\n		</notes>\n	</heading>\n	<indicatorQuery>\n		<version>03-13-2018</version>\n		<params>\n			<parameter id=\"provider\" name=\"Provider Number\" value=\"loggedInProvider\" />\n			<parameter id=\"active\" name=\"Active Patients\" value=\"\'AC\'\" />\n			<parameter id=\"dxcodesICD\" name=\"Dx Codes (ICD)\" value=\"300\" />\n                        <parameter id=\"dxcodesSysICD\" name=\"DX CodeSystem (ICD)\" value=\"\'icd9\'\" />\n                        <parameter id=\"dxcodesSnoMed\" name=\"Dx Codes (SnoMed)\" value=\"48694002,197480006\" />\n                        <parameter id=\"dxcodesSysSnoMed\" name=\"Dx CodeSystem (SnoMed)\" value=\"\'snomed%\'\" />\n			<parameter id=\"billingCode\" name=\"ICD9 Billing Code\" value=\"300\" />\n			<parameter id=\"numOfBills\" name=\"Number of ICD9 300 Bills\" value=\"2\" />\n			<parameter id=\"numOfVisits\" name=\"Number of Visit Encounters coded 300/ICD9\" value=\"2\" />\n			<parameter id=\"obsName\" name=\"Observation Name\" value=\"\'GAD7\'\" />\n			<parameter id=\"obsResult\" name=\"Observation Result\" value=\"10\" />\n		</params>\n		<range>\n			<lowerLimit id=\"billingdate\" label=\"From Date\" name=\"Date\" value=\"DATE_SUB( NOW(), INTERVAL 3 YEAR )\" />\n			<upperLimit id=\"billingdate\" label=\"Date Today\" name=\"Date\" value=\"NOW()\" />\n			<lowerLimit id=\"visitdate\" label=\"From Date\" name=\"Date\" value=\"DATE_SUB( NOW(), INTERVAL 3 YEAR )\" />\n			<upperLimit id=\"visitdate\" label=\"Date Today\" name=\"Date\" value=\"NOW()\" />\n			<lowerLimit id=\"obsdate\" label=\"From Date\" name=\"Date\" value=\"DATE_SUB( NOW(), INTERVAL 3 MONTH )\" />\n			<upperLimit id=\"obsdate\" label=\"Date Today\" name=\"Date\" value=\"NOW()\" />\n		</range>\n		<query>\nSELECT\n  IF ( COUNT(fin.patient) &gt; 0, SUM( CASE WHEN (fin.dx IS NULL AND fin.billcount &gt;= ${numOfBills}) THEN 1 ELSE 0 END ) , 0) AS \"Anxiety dx in ${numOfBills}+ bills\",\n  IF ( COUNT(fin.patient) &gt; 0, SUM( CASE WHEN (fin.dx IS NULL AND fin.visitcount &gt;= ${numOfVisits}) THEN 1 ELSE 0 END ) , 0) AS \"Anxiety dx in ${numOfVisits}+ visits\",\n  IF ( COUNT(fin.patient) &gt; 0, SUM( CASE WHEN (fin.dx IS NULL AND fin.result &gt;= ${obsResult}) THEN 1 ELSE 0 END ) , 0) AS \"GAD-7 &gt;= ${obsResult}\"\nFROM ( \n  SELECT \n    d.demographic_no AS patient, \n    BILLING.billcount AS billcount,\n    VISIT.visitcount AS visitcount,\n    OBSLAST.result AS result,\n    dxr.dxresearch_code AS dx,\n    dxr.coding_system AS dxs\n  FROM demographic d \n  LEFT JOIN (\n    SELECT demographic_no, dxresearch_code, coding_system, count(dxresearch_code)\n    FROM dxresearch\n    WHERE status=\'A\' AND\n    (\n      (LEFT(dxresearch_code, 3) IN (\'300\') AND coding_system = ${dxcodesSysICD}) OR\n      (dxresearch_code IN (\'48694002\',\'197480006\') AND coding_system LIKE ${dxcodesSysSnoMed})\n    )\n    GROUP BY demographic_no\n    ORDER BY demographic_no\n  ) dxr\n  ON d.demographic_no = dxr.demographic_no\n  -- Billed 300 in last 3 years\n  LEFT JOIN (\n    SELECT b.demographic_no as demographic_no, b.dx_code1 as dxcode1, b.dx_code2 as dxcode2, b.dx_code3 as dxcode3, count(b.demographic_no) as billcount\n    FROM billingmaster b\n    WHERE ( LEFT(b.dx_code1, 3) IN (\'300\') OR LEFT(b.dx_code2, 3) IN (\'300\') OR LEFT(b.dx_code3, 3) IN (\'300\') )\n    AND DATE(b.createdate) > ${lowerLimit.billingdate}\n    AND b.demographic_no > 0\n    GROUP BY b.demographic_no HAVING COUNT(b.demographic_no) > -1\n  ) BILLING\n  ON (d.demographic_no = BILLING.demographic_no)  \n  -- Coded dx during visit encounter in last 3 years\n  LEFT JOIN(\n    SELECT ASSIGNED.demographic_no as demographic_no, observation_date as visitdate, uuid, count(ASSIGNED.demographic_no) as visitcount\n    FROM casemgmt_note note\n    INNER JOIN (\n      SELECT note_id, CODED.demo_no as demographic_no FROM casemgmt_issue_notes\n      INNER JOIN (\n        SELECT ci.id as id, ci.update_date, ci.demographic_no demo_no FROM issue i\n        INNER JOIN casemgmt_issue ci\n        ON i.issue_id = ci.issue_id\n        WHERE\n	(i.type LIKE ${dxcodesSysICD} AND LEFT(i.code, 3) IN (\'300\')) OR\n	(i.type LIKE ${dxcodesSysSnoMed} AND i.code IN (\'48694002\',\'197480006\'))\n      ) CODED\n      ON (casemgmt_issue_notes.id = CODED.id)\n      ORDER BY CODED.demo_no\n    ) ASSIGNED\n    ON note.note_id = ASSIGNED.note_id AND\n    -- GET LAST REVISION OF NOTE\n    note.note_id= (SELECT MAX(cmn.note_id) FROM casemgmt_note cmn WHERE cmn.uuid = note.uuid) AND\n    DATE(note.observation_date) > ${lowerLimit.visitdate}\n    GROUP BY demographic_no\n    ORDER BY demographic_no\n  ) VISIT\n  ON (d.demographic_no = VISIT.demographic_no)\n  -- Consider Observation\n  LEFT JOIN ( \n    SELECT m.demographicNo AS demographic_no, m.dataField AS result, m.dateObserved AS dateObserved\n    FROM measurements m\n    INNER JOIN (\n      SELECT demographicNo, MAX(dateObserved) AS dateObserved\n      FROM measurements\n      WHERE type = ${obsName}\n      GROUP BY demographicNo\n    ) mlast\n    ON m.demographicNo = mlast.demographicNo\n    WHERE m.type = ${obsName}\n    AND m.dateObserved = mlast.dateObserved\n    AND (DATE(m.dateObserved) &gt; ${lowerLimit.obsdate})\n    AND m.demographicNo &gt; 0\n    GROUP BY m.demographicNo HAVING COUNT(m.demographicNo) > -1\n  ) OBSLAST\n  ON (d.demographic_no = OBSLAST.demographic_no)  \n  WHERE d.patient_status LIKE ${active}\n  AND d.demographic_no > 0\n  AND d.provider_no LIKE ${provider} \n) fin\n		</query>\n	</indicatorQuery>\n	<drillDownQuery>\n		<version>03-13-2018</version>\n		<params>\n			<parameter id=\"provider\" name=\"Provider Number\" value=\"loggedInProvider\" />\n			<parameter id=\"active\" name=\"Active Patients\" value=\"\'AC\'\" />\n			<parameter id=\"dxcodesICD\" name=\"Dx Codes (ICD)\" value=\"300\" />\n                        <parameter id=\"dxcodesSysICD\" name=\"DX CodeSystem (ICD)\" value=\"\'icd9\'\" />\n                        <parameter id=\"dxcodesSnoMed\" name=\"Dx Codes (SnoMed)\" value=\"48694002,197480006\" />\n                        <parameter id=\"dxcodesSysSnoMed\" name=\"Dx CodeSystem (SnoMed)\" value=\"\'snomed%\'\" />\n			<parameter id=\"billingCode\" name=\"ICD9 Billing Code\" value=\"300\" />\n			<parameter id=\"numOfBills\" name=\"Number of ICD9 300 Bills\" value=\"2\" />\n			<parameter id=\"numOfVisits\" name=\"Number of Visit Encounters coded 300/ICD9\" value=\"2\" />\n			<parameter id=\"obsName\" name=\"Observation Name\" value=\"\'GAD7\'\" />\n			<parameter id=\"obsResult\" name=\"Observation Result\" value=\"10\" />\n		</params>\n		\n		<range>\n			<lowerLimit id=\"billingdate\" label=\"From Date\" name=\"Date\" value=\"DATE_SUB( NOW(), INTERVAL 3 YEAR )\" />\n			<upperLimit id=\"billingdate\" label=\"Date Today\" name=\"Date\" value=\"NOW()\" />\n			<lowerLimit id=\"visitdate\" label=\"From Date\" name=\"Date\" value=\"DATE_SUB( NOW(), INTERVAL 3 YEAR )\" />\n			<upperLimit id=\"visitdate\" label=\"Date Today\" name=\"Date\" value=\"NOW()\" />\n			<lowerLimit id=\"obsdate\" label=\"From Date\" name=\"Date\" value=\"DATE_SUB( NOW(), INTERVAL 3 MONTH )\" />\n			<upperLimit id=\"obsdate\" label=\"Date Today\" name=\"Date\" value=\"NOW()\" />\n		</range>\n		\n		<displayColumns>\n			<column id=\"demographic\" name=\"d.demographic_no\" title=\"Patient Id\" primary=\"true\" />\n			<column id=\"name\" name=\"CONCAT( d.last_name, \', \', d.first_name )\" title=\"Patient Name\" primary=\"false\" />\n			<column id=\"dob\" name=\"DATE_FORMAT( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth), \'%m-%d-%Y\' )\" title=\"Date of Birth\" primary=\"false\" />\n			<column id=\"age\" name=\"TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )\" title=\"Age\" primary=\"false\" />\n			<column id=\"billings\" name=\"IFNULL( BILLING.billcount, \'0\')\" title=\"Billings\" primary=\"false\" />\n			<column id=\"visits\" name=\"IFNULL( VISIT.visitcount, \'0\')\" title=\"Visits\" primary=\"false\" />\n			<column id=\"observation\" name=\"IFNULL( OBSLAST.result, \'NA\')\" title=\"GAD-7\" primary=\"false\" />\n			<column id=\"obsDate\" name=\"IFNULL( DATE_FORMAT( OBSLAST.dateObserved, \'%m-%d-%Y\' ), \'\')\" title=\"Test Date (mm-dd-yyyy)\" primary=\"false\" />\n\n		</displayColumns>\n		\n		<exportColumns>\n			<column id=\"demographic\" name=\"d.demographic_no\" title=\"Patient Id\" primary=\"true\" />\n                        <column id=\"firstName\" name=\"d.first_name\" title=\"First Name\" primary=\"false\" />\n                        <column id=\"lastName\" name=\"d.last_name\" title=\"Last Name\" primary=\"false\" />\n			<column id=\"dob\" name=\"DATE_FORMAT( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth), \'%m-%d-%Y\' )\" title=\"Date of Birth\" primary=\"false\" />\n			<column id=\"age\" name=\"TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )\" title=\"Age\" primary=\"false\" />\n			<column id=\"billings\" name=\"IFNULL( BILLING.billcount, \'0\')\" title=\"Billings\" primary=\"false\" />\n			<column id=\"visits\" name=\"IFNULL( VISIT.visitcount, \'0\')\" title=\"Visits\" primary=\"false\" />\n			<column id=\"observation\" name=\"IFNULL( OBSLAST.result, \'NA\')\" title=\"GAD-7\" primary=\"false\" />\n			<column id=\"obsDate\" name=\"IFNULL( DATE_FORMAT( OBSLAST.dateObserved, \'%m-%d-%Y\' ), \'\')\" title=\"Test Date (mm-dd-yyyy)\" primary=\"false\" />\n		</exportColumns>\n		<query>	\n  SELECT *	\n  FROM demographic d \n  LEFT JOIN (\n    SELECT demographic_no, dxresearch_code, coding_system, count(dxresearch_code)\n    FROM dxresearch\n    WHERE status=\'A\' AND\n    (\n      (LEFT(dxresearch_code, 3) IN (\'300\') AND coding_system = ${dxcodesSysICD}) OR\n      (dxresearch_code IN (\'48694002\',\'197480006\') AND coding_system LIKE ${dxcodesSysSnoMed})\n    )\n    GROUP BY demographic_no\n    ORDER BY demographic_no\n  ) dxr\n  ON d.demographic_no = dxr.demographic_no\n  -- Billed 300 in last 3 years\n  LEFT JOIN (\n    SELECT b.demographic_no as demographic_no, b.dx_code1 as dxcode1, b.dx_code2 as dxcode2, b.dx_code3 as dxcode3, count(b.demographic_no) as billcount\n    FROM billingmaster b\n    WHERE ( LEFT(b.dx_code1, 3) IN (\'300\') OR LEFT(b.dx_code2, 3) IN (\'300\') OR LEFT(b.dx_code3, 3) IN (\'300\') )\n    AND DATE(b.createdate) > ${lowerLimit.billingdate}\n    AND b.demographic_no > 0\n    GROUP BY b.demographic_no HAVING COUNT(b.demographic_no) > -1\n  ) BILLING\n  ON (d.demographic_no = BILLING.demographic_no)  \n  -- Coded dx during visit encounter in last 3 years\n  LEFT JOIN(\n    SELECT ASSIGNED.demographic_no as demographic_no, observation_date as visitdate, uuid, count(ASSIGNED.demographic_no) as visitcount\n    FROM casemgmt_note note\n    INNER JOIN (\n      SELECT note_id, CODED.demo_no as demographic_no FROM casemgmt_issue_notes\n      INNER JOIN (\n        SELECT ci.id as id, ci.update_date, ci.demographic_no demo_no FROM issue i\n        INNER JOIN casemgmt_issue ci\n        ON i.issue_id = ci.issue_id\n        WHERE\n	(i.type LIKE ${dxcodesSysICD} AND LEFT(i.code, 3) IN (\'300\')) OR\n	(i.type LIKE ${dxcodesSysSnoMed} AND i.code IN (\'48694002\',\'197480006\'))\n      ) CODED\n      ON (casemgmt_issue_notes.id = CODED.id)\n      ORDER BY CODED.demo_no\n    ) ASSIGNED\n    ON note.note_id = ASSIGNED.note_id AND\n    -- GET LAST REVISION OF NOTE\n    note.note_id= (SELECT MAX(cmn.note_id) FROM casemgmt_note cmn WHERE cmn.uuid = note.uuid) AND\n    DATE(note.observation_date) > ${lowerLimit.visitdate}\n    GROUP BY demographic_no\n    ORDER BY demographic_no\n  ) VISIT\n  ON (d.demographic_no = VISIT.demographic_no)  \n  -- Consider OBS here if needed\n  LEFT JOIN ( \n    SELECT m.demographicNo AS demographic_no, m.dataField AS result, m.dateObserved AS dateObserved\n    FROM measurements m\n    INNER JOIN (\n      SELECT demographicNo, MAX(dateObserved) AS dateObserved\n      FROM measurements\n      WHERE type = ${obsName}\n      GROUP BY demographicNo\n    ) mlast\n    ON m.demographicNo = mlast.demographicNo\n    WHERE m.type = ${obsName}\n    AND m.dateObserved = mlast.dateObserved\n    AND (DATE(m.dateObserved) &gt; ${lowerLimit.obsdate})\n    AND m.demographicNo &gt; 0\n    GROUP BY m.demographicNo HAVING COUNT(m.demographicNo) > -1\n  ) OBSLAST\n  ON (d.demographic_no = OBSLAST.demographic_no)  \n  WHERE d.patient_status LIKE ${active}\n  AND d.demographic_no > 0\n  AND ( dxr.dxresearch_code IS NULL AND ((BILLING.billcount IS NOT NULL AND BILLING.billcount &gt;= ${numOfBills}) OR (VISIT.visitcount IS NOT NULL AND VISIT.visitcount &gt;= ${numOfVisits}) OR (OBSLAST.result IS NOT NULL AND OBSLAST.result &gt;= ${obsResult})) )\n  AND d.provider_no LIKE ${provider}\n  ORDER BY d.demographic_no\n		</query>\n	</drillDownQuery>\n</indicatorTemplateXML>\n','','\0',0,NULL,NULL),
(53,6,'Anxiety Prevalence','CDM','Anxiety','DoBC CPQI PSP Panel','2017-08-02','% of active patients in the practice coded with Anxiety.','\ni) Anxiety patients: \"Patient Status: Active\nAND has a Current Problem List/Profile item code of 48694002, 197480006  OR starting with 300\"\nii) Other patients: \"Patient Status: Active\nAND does not have a Current Problem List/Profile item code of 48694002','<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<indicatorTemplateXML>\n	<author>OSCAR BC</author>\n	<uid></uid>\n	<heading>\n		<category>CDM</category>\n		<subCategory>Anxiety</subCategory>\n		<name>Anxiety Prevalence</name>\n		<definition>% of active patients in the practice coded with Anxiety.</definition>\n		<framework>DoBC CPQI PSP Panel</framework>\n		<frameworkVersion>08-02-2017</frameworkVersion>\n		<notes>\ni) Anxiety patients: \"Patient Status: Active\nAND has a Current Problem List/Profile item code of 48694002, 197480006  OR starting with 300\"\nii) Other patients: \"Patient Status: Active\nAND does not have a Current Problem List/Profile item code of 48694002, 197480006  OR starting with 300\"\n		</notes>\n	</heading>\n	<indicatorQuery>\n		<version>03-13-2018</version>\n		<params>\n			<!-- \n				Required parameter provider. Value options are: \n					[ an individual providerNo, or provider range ] ie: value=\"370, 1001\" \n					\"all\" ie: value=\"all\" including null.\n					\"loggedInProvider\" ie:\n				Default is \"loggedInProvider\"\n				Use this parameter in the query as ${provider}\n				This parameter should be used for fetching patient\'s assigned to a MRP.\n				ie: WHERE demographic.provider_no = ${provider}\n			-->\n			<parameter id=\"provider\" name=\"provider_no\" value=\"loggedInProvider\" />\n			<parameter id=\"pstatus\" name=\"Patient Status\" value=\"\'AC\'\" />\n			<parameter id=\"dxcodesICD\" name=\"Dx Codes (ICD)\" value=\"300\" />\n			<parameter id=\"dxcodesSysICD\" name=\"DX CodeSystem (ICD)\" value=\"\'icd9\'\" />\n			<parameter id=\"dxcodesSnoMed\" name=\"Dx Codes (SnoMed)\" value=\"48694002,197480006\" />\n			<parameter id=\"dxcodesSysSnoMed\" name=\"Dx CodeSystem (SnoMed)\" value=\"\'snomed%\'\" />\n		</params>\n		<query>\n			<!-- Indicator SQL Query here -->\nSELECT\n -- PERCENT OF TOTAL PATIENTS NOTED AS ACTIVE WITH CURRENT ANXIETY\n IF( COUNT(fin.patient) > 0, SUM( IF( dxresearch_code is not NULL , 1, 0) ) , 0 ) AS \"% Active, Current Anxiety\",\n -- PERCENT OF TOTAL PATIENTS NOTED AS ACTIVE WITHOUT CURRENT ANXIETY\n IF( COUNT(fin.patient) > 0, SUM( IF( dxresearch_code is NULL , 1, 0) ) , 0 ) AS \"% Active, No Current Anxiety\"\nFROM (\n SELECT d.demographic_no AS patient, d.patient_status AS pt_status, dxresearch_code\n FROM demographic d\n LEFT JOIN (\n  SELECT demographic_no, dxresearch_code, count(dxresearch_code)\n  FROM dxresearch\n  WHERE status=\'A\' AND\n  (\n   (LEFT(dxresearch_code, 3) IN (\'300\') AND coding_system = ${dxcodesSysICD}) OR\n   (dxresearch_code IN (\'48694002\', \'197480006\') AND coding_system LIKE ${dxcodesSysSnoMed})\n   )\n  GROUP BY demographic_no\n  ORDER BY demographic_no\n ) problems\n ON d.demographic_no = problems.demographic_no\n WHERE d.provider_no LIKE ${provider} AND d.patient_status = ${pstatus}\n) fin\n		</query>\n	</indicatorQuery>\n	<drillDownQuery>\n		<version>03-13-2018</version>\n		<params>\n			<parameter id=\"provider\" name=\"provider_no\" value=\"loggedInProvider\" />	\n			<parameter id=\"pstatus\" name=\"Patient Status\" value=\"\'AC\'\" />\n			<parameter id=\"dxcodesICD\" name=\"Dx Codes (ICD)\" value=\"300\" />\n			<parameter id=\"dxcodesSysICD\" name=\"DX CodeSystem (ICD)\" value=\"\'icd9\'\" />\n			<parameter id=\"dxcodesSnoMed\" name=\"Dx Codes (SnoMed)\" value=\"48694002,197480006\" />\n			<parameter id=\"dxcodesSysSnoMed\" name=\"Dx CodeSystem (SnoMed)\" value=\"\'snomed%\'\" />\n		</params>\n		<displayColumns>\n			<column id=\"demographic\" name=\"d.demographic_no\" title=\"Patient Id\" primary=\"true\" />\n			<column id=\"name\" name=\"CONCAT( d.last_name, \', \', d.first_name )\" title=\"Patient Name\" primary=\"false\" />\n			<column id=\"dob\" name=\"DATE_FORMAT( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth), \'%m-%d-%Y\' )\" title=\"Date of Birth (mm-dd-yy)\" primary=\"false\" />\n			<column id=\"age\" name=\"TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )\" title=\"Age\" primary=\"false\" />\n			<column id=\"dxcode\" title=\"Dx System/Code\" name=\"CONCAT(MIN(dxr.coding_system),\'/\',MIN(dxr.dxresearch_code),IF( MIN(dxr.dxresearch_code) != MAX(dxr.dxresearch_code),CONCAT( \' &amp; \', MAX(dxr.coding_system), \'/\', MAX(dxr.dxresearch_code) ),\'\') )\" primary=\"false\" />\n		</displayColumns>\n		<exportColumns>\n			<column id=\"demographic\" name=\"d.demographic_no\" title=\"Patient Id\" primary=\"true\" />\n			<column id=\"firstName\" name=\"d.first_name\" title=\"First Name\" primary=\"false\" />\n			<column id=\"lastName\" name=\"d.last_name\" title=\"Last Name\" primary=\"false\" />\n			<column id=\"dob\" name=\"DATE_FORMAT( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth), \'%m-%d-%Y\' )\" title=\"Date of Birth (mm-dd-yy)\" primary=\"false\" />\n			<column id=\"age\" name=\"TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )\" title=\"Age\" primary=\"false\" />\n			<column id=\"dxcode\" title=\"Dx System/Code\" name=\"CONCAT(MIN(dxr.coding_system),\'/\',MIN(dxr.dxresearch_code),IF( MIN(dxr.dxresearch_code) != MAX(dxr.dxresearch_code),CONCAT( \' &amp; \', MAX(dxr.coding_system), \'/\', MAX(dxr.dxresearch_code) ),\'\') )\" primary=\"false\" />\n		</exportColumns>\n		<query>\n			<!-- Drilldown SQL Query here -->\nSELECT\n*			\nFROM demographic d\nLEFT JOIN dxresearch dxr\nON d.demographic_no = dxr.demographic_no\nWHERE d.patient_status=${pstatus}\nAND\n(\n (LEFT(dxr.dxresearch_code, 3) IN (\'300\') AND dxr.coding_system = ${dxcodesSysICD}) OR\n (dxr.dxresearch_code IN (\'48694002\', \'197480006\') AND dxr.coding_system LIKE ${dxcodesSysSnoMed})\n )\nAND dxr.status = \'A\'\nAND d.provider_no LIKE ${provider}\nGROUP BY d.demographic_no\nORDER BY COUNT(d.demographic_no) DESC, d.demographic_no\n		</query>\n	</drillDownQuery>\n</indicatorTemplateXML>\n','','\0',0,NULL,NULL),
(54,6,'Consider Dementia','CDM','Dementia','DoBC CPQI PSP Panel','2017-08-02','\n			Patients with dementia dx in 2+ bills or 2+ visit encounters or sMMSE < 21 or MOCA < 21 in last 3 years\n		','\n		  Created for Doctors of BC\n		  i) Dementia dx in 2+ bills: \"Patient Status: Active\nAnd does not have a Current Problem List/Profile item code of 52448006 OR starting with 331 OR with 290\nAND with >=2 Bills with the ICD9 diagnosis code starting with 33','<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<indicatorTemplateXML>\n	<author>OSCAR BC</author>\n	<uid></uid>\n	<heading>\n		<category>CDM</category>\n		<subCategory>Dementia</subCategory>\n		<name>Consider Dementia</name>\n		<definition>\n			Patients with dementia dx in 2+ bills or 2+ visit encounters or sMMSE &lt; 21 or MOCA &lt; 21 in last 3 years\n		</definition>\n		<framework>DoBC CPQI PSP Panel</framework>\n		<frameworkVersion>08-02-2017</frameworkVersion>\n		<notes>\n		  Created for Doctors of BC\n		  i) Dementia dx in 2+ bills: \"Patient Status: Active\nAnd does not have a Current Problem List/Profile item code of 52448006 OR starting with 331 OR with 290\nAND with >=2 Bills with the ICD9 diagnosis code starting with 331, 290 in the last 3 years\"\n		  ii) Dementia dx in 2+ visits: \"Patient Status: Active\nAnd does not have a Current Problem List/Profile item code of 52448006 OR starting with 331 OR with 290\nAND with >=2 Visit Encounters with Snomed code 52448006 or the ICD9 diagnosis code starting with 331, 290 in the last 3 years\"\n		  iii) sMMSE score &lt; 21 OR MOCA &lt; 21: \"Patient Status: Active\nAnd does not have a Current Problem List/Profile item code of 52448006 OR starting with 331 OR with 290\nAnd has an observation of \"Total sMMSE Score\" with a value &lt; 21 OR MOCA &lt; 21 within the last 3 years\"\n		</notes>\n	</heading>\n	<indicatorQuery>\n		<version>03-13-2018</version>\n		<params>\n			<parameter id=\"provider\" name=\"Provider Number\" value=\"loggedInProvider\" />\n			<parameter id=\"active\" name=\"Active Patients\" value=\"\'AC\'\" />\n			<parameter id=\"dxcodesICD\" name=\"Dx Codes (ICD)\" value=\"331,290\" />\n                        <parameter id=\"dxcodesSysICD\" name=\"DX CodeSystem (ICD)\" value=\"\'icd9\'\" />\n                        <parameter id=\"dxcodesSnoMed\" name=\"Dx Codes (SnoMed)\" value=\"52448006\" />\n                        <parameter id=\"dxcodesSysSnoMed\" name=\"Dx CodeSystem (SnoMed)\" value=\"\'snomed%\'\" />\n			<parameter id=\"billingCode\" name=\"ICD9 Billing Code\" value=\"331,290\" />\n			<parameter id=\"numOfBills\" name=\"Number of ICD9 331,290 Bills\" value=\"2\" />\n			<parameter id=\"numOfVisits\" name=\"Number of Visit Encounters coded 331,290/ICD9\" value=\"2\" />\n			<parameter id=\"obsName\" name=\"Observation Name\" value=\"MMSE,MOCA\" />\n			<parameter id=\"obsResult\" name=\"Observation Result\" value=\"21\" />\n		</params>\n		<range>\n			<lowerLimit id=\"billingdate\" label=\"From Date\" name=\"Date\" value=\"DATE_SUB( NOW(), INTERVAL 3 YEAR )\" />\n			<upperLimit id=\"billingdate\" label=\"Date Today\" name=\"Date\" value=\"NOW()\" />\n			<lowerLimit id=\"visitdate\" label=\"From Date\" name=\"Date\" value=\"DATE_SUB( NOW(), INTERVAL 3 YEAR )\" />\n			<upperLimit id=\"visitdate\" label=\"Date Today\" name=\"Date\" value=\"NOW()\" />\n			<lowerLimit id=\"obsdate\" label=\"From Date\" name=\"Date\" value=\"DATE_SUB( NOW(), INTERVAL 3 YEAR )\" />\n			<upperLimit id=\"obsdate\" label=\"Date Today\" name=\"Date\" value=\"NOW()\" />\n		</range>\n		<query>\nSELECT\n  IF ( COUNT(fin.patient) &gt; 0, SUM( CASE WHEN (fin.dx IS NULL AND fin.billcount &gt;= ${numOfBills}) THEN 1 ELSE 0 END ) , 0) AS \"Dementia dx in ${numOfBills}+ bills\",\n  IF ( COUNT(fin.patient) &gt; 0, SUM( CASE WHEN (fin.dx IS NULL AND fin.visitcount &gt;= ${numOfVisits}) THEN 1 ELSE 0 END ) , 0) AS \"Dementia dx in ${numOfVisits}+ visits\",\n  IF ( COUNT(fin.patient) &gt; 0, SUM( CASE WHEN (fin.dx IS NULL AND fin.result &lt; ${obsResult}) THEN 1 ELSE 0 END ) , 0) AS \"sMMSE/MOCA &lt; ${obsResult}\"\nFROM ( \n  SELECT \n    d.demographic_no AS patient, \n    BILLING.billcount AS billcount,\n    VISIT.visitcount AS visitcount,\n    OBSLAST.result AS result,\n    dxr.dxresearch_code AS dx,\n    dxr.coding_system AS dxs\n  FROM demographic d \n  LEFT JOIN (\n    SELECT demographic_no, dxresearch_code, coding_system, count(dxresearch_code)\n    FROM dxresearch\n    WHERE status=\'A\' AND\n    (\n      (LEFT(dxresearch_code, 3) IN (\'331\',\'290\') AND coding_system = ${dxcodesSysICD}) OR\n      (dxresearch_code IN (\'52448006\') AND coding_system LIKE ${dxcodesSysSnoMed})\n    )\n    GROUP BY demographic_no\n    ORDER BY demographic_no\n  ) dxr\n  ON d.demographic_no = dxr.demographic_no\n  -- Billed 331,290 in last 3 years\n  LEFT JOIN (\n    SELECT b.demographic_no as demographic_no, b.dx_code1 as dxcode1, b.dx_code2 as dxcode2, b.dx_code3 as dxcode3, count(b.demographic_no) as billcount\n    FROM billingmaster b\n    WHERE ( LEFT(b.dx_code1, 3) IN (\'331\',\'290\') OR LEFT(b.dx_code2, 3) IN (\'331\',\'290\') OR LEFT(b.dx_code3, 3) IN (\'331\',\'290\') )\n    AND DATE(b.createdate) > ${lowerLimit.billingdate}\n    AND b.demographic_no > 0\n    GROUP BY b.demographic_no HAVING COUNT(b.demographic_no) > -1\n  ) BILLING\n  ON (d.demographic_no = BILLING.demographic_no)  \n  -- Coded dx during visit encounter in last 3 years\n  LEFT JOIN(\n    SELECT ASSIGNED.demographic_no as demographic_no, observation_date as visitdate, uuid, count(ASSIGNED.demographic_no) as visitcount\n    FROM casemgmt_note note\n    INNER JOIN (\n      SELECT note_id, CODED.demo_no as demographic_no FROM casemgmt_issue_notes\n      INNER JOIN (\n        SELECT ci.id as id, ci.update_date, ci.demographic_no demo_no FROM issue i\n        INNER JOIN casemgmt_issue ci\n        ON i.issue_id = ci.issue_id\n        WHERE\n	(i.type LIKE ${dxcodesSysICD} AND LEFT(i.code, 3) IN (\'331\',\'290\')) OR\n	(i.type LIKE ${dxcodesSysSnoMed} AND i.code IN (\'52448006\'))\n      ) CODED\n      ON (casemgmt_issue_notes.id = CODED.id)\n      ORDER BY CODED.demo_no\n    ) ASSIGNED\n    ON note.note_id = ASSIGNED.note_id AND\n    -- GET LAST REVISION OF NOTE\n    note.note_id= (SELECT MAX(cmn.note_id) FROM casemgmt_note cmn WHERE cmn.uuid = note.uuid) AND\n    DATE(note.observation_date) > ${lowerLimit.visitdate}\n    GROUP BY demographic_no\n    ORDER BY demographic_no\n  ) VISIT\n  ON (d.demographic_no = VISIT.demographic_no)\n  -- Consider Observation\n  LEFT JOIN ( \n    SELECT m.demographicNo AS demographic_no, m.dataField AS result, m.dateObserved AS dateObserved\n    FROM measurements m\n    INNER JOIN (\n      SELECT demographicNo, MAX(dateObserved) AS dateObserved\n      FROM measurements\n      WHERE type IN ${obsName}\n      GROUP BY demographicNo\n    ) mlast\n    ON m.demographicNo = mlast.demographicNo\n    WHERE m.type IN ${obsName}\n    AND m.dateObserved = mlast.dateObserved\n    AND (DATE(m.dateObserved) &gt; ${lowerLimit.obsdate})\n    AND m.demographicNo &gt; 0\n    GROUP BY m.demographicNo\n  ) OBSLAST\n  ON (d.demographic_no = OBSLAST.demographic_no) \n  WHERE d.patient_status LIKE ${active}\n  AND d.demographic_no > 0\n  AND d.provider_no LIKE ${provider} \n) fin\n		</query>\n	</indicatorQuery>\n	<drillDownQuery>\n		<version>03-13-2018</version>\n		<params>\n			<parameter id=\"provider\" name=\"Provider Number\" value=\"loggedInProvider\" />\n			<parameter id=\"active\" name=\"Active Patients\" value=\"\'AC\'\" />\n			<parameter id=\"dxcodesICD\" name=\"Dx Codes (ICD)\" value=\"331,290\" />\n                        <parameter id=\"dxcodesSysICD\" name=\"DX CodeSystem (ICD)\" value=\"\'icd9\'\" />\n                        <parameter id=\"dxcodesSnoMed\" name=\"Dx Codes (SnoMed)\" value=\"52448006\" />\n                        <parameter id=\"dxcodesSysSnoMed\" name=\"Dx CodeSystem (SnoMed)\" value=\"\'snomed%\'\" />\n			<parameter id=\"billingCode\" name=\"ICD9 Billing Code\" value=\"331,290\" />\n			<parameter id=\"numOfBills\" name=\"Number of ICD9 331,290 Bills\" value=\"2\" />\n			<parameter id=\"numOfVisits\" name=\"Number of Visit Encounters coded 331,290/ICD9\" value=\"2\" />\n			<parameter id=\"obsName\" name=\"Observation Name\" value=\"MMSE,MOCA\" />\n			<parameter id=\"obsResult\" name=\"Observation Result\" value=\"21\" />\n		</params>\n		\n		<range>\n			<lowerLimit id=\"billingdate\" label=\"From Date\" name=\"Date\" value=\"DATE_SUB( NOW(), INTERVAL 3 YEAR )\" />\n			<upperLimit id=\"billingdate\" label=\"Date Today\" name=\"Date\" value=\"NOW()\" />\n			<lowerLimit id=\"visitdate\" label=\"From Date\" name=\"Date\" value=\"DATE_SUB( NOW(), INTERVAL 3 YEAR )\" />\n			<upperLimit id=\"visitdate\" label=\"Date Today\" name=\"Date\" value=\"NOW()\" />\n			<lowerLimit id=\"obsdate\" label=\"From Date\" name=\"Date\" value=\"DATE_SUB( NOW(), INTERVAL 3 YEAR )\" />\n			<upperLimit id=\"obsdate\" label=\"Date Today\" name=\"Date\" value=\"NOW()\" />\n		</range>\n		\n		<displayColumns>\n			<column id=\"demographic\" name=\"d.demographic_no\" title=\"Patient Id\" primary=\"true\" />\n			<column id=\"name\" name=\"CONCAT( d.last_name, \', \', d.first_name )\" title=\"Patient Name\" primary=\"false\" />\n			<column id=\"dob\" name=\"DATE_FORMAT( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth), \'%m-%d-%Y\' )\" title=\"Date of Birth\" primary=\"false\" />\n			<column id=\"age\" name=\"TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )\" title=\"Age\" primary=\"false\" />\n			<column id=\"billings\" name=\"IFNULL( BILLING.billcount, \'0\')\" title=\"Billings\" primary=\"false\" />\n			<column id=\"visits\" name=\"IFNULL( VISIT.visitcount, \'0\')\" title=\"Visits\" primary=\"false\" />\n			<column id=\"observation\" name=\"IFNULL( OBSLAST.result, \'NA\')\" title=\"sMMSE/MOCA\" primary=\"false\" />\n			<column id=\"obsDate\" name=\"IFNULL( DATE_FORMAT( OBSLAST.dateObserved, \'%m-%d-%Y\' ), \'\')\" title=\"Test Date (mm-dd-yyyy)\" primary=\"false\" />\n\n		</displayColumns>\n		\n		<exportColumns>\n			<column id=\"demographic\" name=\"d.demographic_no\" title=\"Patient Id\" primary=\"true\" />\n                        <column id=\"firstName\" name=\"d.first_name\" title=\"First Name\" primary=\"false\" />\n                        <column id=\"lastName\" name=\"d.last_name\" title=\"Last Name\" primary=\"false\" />\n			<column id=\"dob\" name=\"DATE_FORMAT( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth), \'%m-%d-%Y\' )\" title=\"Date of Birth\" primary=\"false\" />\n			<column id=\"age\" name=\"TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )\" title=\"Age\" primary=\"false\" />\n			<column id=\"billings\" name=\"IFNULL( BILLING.billcount, \'0\')\" title=\"Billings\" primary=\"false\" />\n			<column id=\"visits\" name=\"IFNULL( VISIT.visitcount, \'0\')\" title=\"Visits\" primary=\"false\" />\n			<column id=\"observation\" name=\"IFNULL( OBSLAST.result, \'NA\')\" title=\"sMMSE/MOCA\" primary=\"false\" />\n			<column id=\"obsDate\" name=\"IFNULL( DATE_FORMAT( OBSLAST.dateObserved, \'%m-%d-%Y\' ), \'\')\" title=\"Test Date (mm-dd-yyyy)\" primary=\"false\" />\n		</exportColumns>\n		<query>	\n  SELECT *	\n  FROM demographic d \n  LEFT JOIN (\n    SELECT demographic_no, dxresearch_code, coding_system, count(dxresearch_code)\n    FROM dxresearch\n    WHERE status=\'A\' AND\n    (\n      (LEFT(dxresearch_code, 3) IN (\'331\',\'290\') AND coding_system = ${dxcodesSysICD}) OR\n      (dxresearch_code IN (\'52448006\') AND coding_system LIKE ${dxcodesSysSnoMed})\n    )\n    GROUP BY demographic_no\n    ORDER BY demographic_no\n  ) dxr\n  ON d.demographic_no = dxr.demographic_no\n  -- Billed 331,290 in last 3 years\n  LEFT JOIN (\n    SELECT b.demographic_no as demographic_no, b.dx_code1 as dxcode1, b.dx_code2 as dxcode2, b.dx_code3 as dxcode3, count(b.demographic_no) as billcount\n    FROM billingmaster b\n    WHERE ( LEFT(b.dx_code1, 3) IN (\'331\',\'290\') OR LEFT(b.dx_code2, 3) IN (\'331\',\'290\') OR LEFT(b.dx_code3, 3) IN (\'331\',\'290\') )\n    AND DATE(b.createdate) > ${lowerLimit.billingdate}\n    AND b.demographic_no > 0\n    GROUP BY b.demographic_no HAVING COUNT(b.demographic_no) > -1\n  ) BILLING\n  ON (d.demographic_no = BILLING.demographic_no)  \n  -- Coded dx during visit encounter in last 3 years\n  LEFT JOIN(\n    SELECT ASSIGNED.demographic_no as demographic_no, observation_date as visitdate, uuid, count(ASSIGNED.demographic_no) as visitcount\n    FROM casemgmt_note note\n    INNER JOIN (\n      SELECT note_id, CODED.demo_no as demographic_no FROM casemgmt_issue_notes\n      INNER JOIN (\n        SELECT ci.id as id, ci.update_date, ci.demographic_no demo_no FROM issue i\n        INNER JOIN casemgmt_issue ci\n        ON i.issue_id = ci.issue_id\n        WHERE\n	(i.type LIKE ${dxcodesSysICD} AND LEFT(i.code, 3) IN (\'331\',\'290\')) OR\n	(i.type LIKE ${dxcodesSysSnoMed} AND i.code IN (\'52448006\'))\n      ) CODED\n      ON (casemgmt_issue_notes.id = CODED.id)\n      ORDER BY CODED.demo_no\n    ) ASSIGNED\n    ON note.note_id = ASSIGNED.note_id AND\n    -- GET LAST REVISION OF NOTE\n    note.note_id= (SELECT MAX(cmn.note_id) FROM casemgmt_note cmn WHERE cmn.uuid = note.uuid) AND\n    DATE(note.observation_date) > ${lowerLimit.visitdate}\n    GROUP BY demographic_no\n    ORDER BY demographic_no\n  ) VISIT\n  ON (d.demographic_no = VISIT.demographic_no)  \n  -- Consider OBS here if needed\n  LEFT JOIN ( \n    SELECT m.demographicNo AS demographic_no, m.dataField AS result, m.dateObserved AS dateObserved\n    FROM measurements m\n    INNER JOIN (\n      SELECT demographicNo, MAX(dateObserved) AS dateObserved\n      FROM measurements\n      WHERE type IN ${obsName}\n      GROUP BY demographicNo\n    ) mlast\n    ON m.demographicNo = mlast.demographicNo\n    WHERE m.type IN ${obsName}\n    AND m.dateObserved = mlast.dateObserved\n    AND (DATE(m.dateObserved) &gt; ${lowerLimit.obsdate})\n    AND m.demographicNo &gt; 0\n    GROUP BY m.demographicNo\n  ) OBSLAST\n  ON (d.demographic_no = OBSLAST.demographic_no) \n  WHERE d.patient_status LIKE ${active}\n  AND d.demographic_no > 0\n  AND ( dxr.dxresearch_code IS NULL AND ((BILLING.billcount IS NOT NULL AND BILLING.billcount &gt;= ${numOfBills}) OR (VISIT.visitcount IS NOT NULL AND VISIT.visitcount &gt;= ${numOfVisits}) OR (OBSLAST.result IS NOT NULL AND OBSLAST.result &lt; ${obsResult})) )\n  AND d.provider_no LIKE ${provider}\n  ORDER BY d.demographic_no\n		</query>\n	</drillDownQuery>\n</indicatorTemplateXML>\n','','\0',0,NULL,NULL),
(55,6,'Dementia Prevalence','CDM','Dementia','DoBC CPQI PSP Panel','2017-08-02','% of active patients in the practice coded with Dementia.','\ni) Dementia patients: \"Patient Status: Active\nAND has a Current Problem List/Profile item code of 52448006 OR starting with 331 OR 290\"\nii) Other patients: \"Patient Status: Active\nAND does not have a Current Problem List/Profile item code of 52448006 OR ','<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<indicatorTemplateXML>\n	<author>OSCAR BC</author>\n	<uid></uid>\n	<heading>\n		<category>CDM</category>\n		<subCategory>Dementia</subCategory>\n		<name>Dementia Prevalence</name>\n		<definition>% of active patients in the practice coded with Dementia.</definition>\n		<framework>DoBC CPQI PSP Panel</framework>\n		<frameworkVersion>08-02-2017</frameworkVersion>\n		<notes>\ni) Dementia patients: \"Patient Status: Active\nAND has a Current Problem List/Profile item code of 52448006 OR starting with 331 OR 290\"\nii) Other patients: \"Patient Status: Active\nAND does not have a Current Problem List/Profile item code of 52448006 OR starting with 331 OR 290\"\n		</notes>\n	</heading>\n	<indicatorQuery>\n		<version>03-13-2018</version>\n		<params>\n			<!-- \n				Required parameter provider. Value options are: \n					[ an individual providerNo, or provider range ] ie: value=\"370, 1001\" \n					\"all\" ie: value=\"all\" including null.\n					\"loggedInProvider\" ie:\n				Default is \"loggedInProvider\"\n				Use this parameter in the query as ${provider}\n				This parameter should be used for fetching patient\'s assigned to a MRP.\n				ie: WHERE demographic.provider_no = ${provider}\n			-->\n			<parameter id=\"provider\" name=\"provider_no\" value=\"loggedInProvider\" />\n			<parameter id=\"pstatus\" name=\"Patient Status\" value=\"\'AC\'\" />\n			<parameter id=\"dxcodesICD\" name=\"Dx Codes (ICD)\" value=\"331,290\" />\n			<parameter id=\"dxcodesSysICD\" name=\"DX CodeSystem (ICD)\" value=\"\'icd9\'\" />\n			<parameter id=\"dxcodesSnoMed\" name=\"Dx Codes (SnoMed)\" value=\"52448006\" />\n			<parameter id=\"dxcodesSysSnoMed\" name=\"Dx CodeSystem (SnoMed)\" value=\"\'snomed%\'\" />\n		</params>\n		<query>\n			<!-- Indicator SQL Query here -->\nSELECT\n -- PERCENT OF TOTAL PATIENTS NOTED AS ACTIVE WITH CURRENT DEMENTIA\n IF( COUNT(fin.patient) > 0, SUM( IF( dxresearch_code is not NULL , 1, 0) ) , 0 ) AS \"% Active, Current Dementia\",\n -- PERCENT OF TOTAL PATIENTS NOTED AS ACTIVE WITHOUT CURRENT DEMENTIA\n IF( COUNT(fin.patient) > 0, SUM( IF( dxresearch_code is NULL , 1, 0) ) , 0 ) AS \"% Active, No Current Dementia\"\nFROM (\n SELECT d.demographic_no AS patient, d.patient_status AS pt_status, dxresearch_code\n FROM demographic d\n LEFT JOIN (\n  SELECT demographic_no, dxresearch_code, count(dxresearch_code)\n  FROM dxresearch\n  WHERE status=\'A\' AND\n  (\n   (LEFT(dxresearch_code, 3) IN (\'331\', \'290\') AND coding_system = ${dxcodesSysICD}) OR\n   (dxresearch_code IN (\'52448006\') AND coding_system LIKE ${dxcodesSysSnoMed})\n   )\n  GROUP BY demographic_no\n  ORDER BY demographic_no\n ) problems\n ON d.demographic_no = problems.demographic_no\n WHERE d.provider_no LIKE ${provider} AND d.patient_status = ${pstatus}\n) fin\n		</query>\n	</indicatorQuery>\n	<drillDownQuery>\n		<version>03-13-2018</version>\n		<params>\n			<parameter id=\"provider\" name=\"provider_no\" value=\"loggedInProvider\" />	\n			<parameter id=\"pstatus\" name=\"Patient Status\" value=\"\'AC\'\" />\n			<parameter id=\"dxcodesICD\" name=\"Dx Codes (ICD)\" value=\"331,290\" />\n			<parameter id=\"dxcodesSysICD\" name=\"DX CodeSystem (ICD)\" value=\"\'icd9\'\" />\n			<parameter id=\"dxcodesSnoMed\" name=\"Dx Codes (SnoMed)\" value=\"52448006\" />\n			<parameter id=\"dxcodesSysSnoMed\" name=\"Dx CodeSystem (SnoMed)\" value=\"\'snomed%\'\" />\n		</params>\n		<displayColumns>\n			<column id=\"demographic\" name=\"d.demographic_no\" title=\"Patient Id\" primary=\"true\" />\n			<column id=\"name\" name=\"CONCAT( d.last_name, \', \', d.first_name )\" title=\"Patient Name\" primary=\"false\" />\n			<column id=\"dob\" name=\"DATE_FORMAT( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth), \'%m-%d-%Y\' )\" title=\"Date of Birth (mm-dd-yy)\" primary=\"false\" />\n			<column id=\"age\" name=\"TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )\" title=\"Age\" primary=\"false\" />\n			<column id=\"dxcode\" title=\"Dx System/Code\" name=\"CONCAT(MIN(dxr.coding_system),\'/\',MIN(dxr.dxresearch_code),IF( MIN(dxr.dxresearch_code) != MAX(dxr.dxresearch_code),CONCAT( \' &amp; \', MAX(dxr.coding_system), \'/\', MAX(dxr.dxresearch_code) ),\'\') )\" primary=\"false\" />\n		</displayColumns>\n		<exportColumns>\n			<column id=\"demographic\" name=\"d.demographic_no\" title=\"Patient Id\" primary=\"true\" />\n			<column id=\"firstName\" name=\"d.first_name\" title=\"First Name\" primary=\"false\" />\n			<column id=\"lastName\" name=\"d.last_name\" title=\"Last Name\" primary=\"false\" />\n			<column id=\"dob\" name=\"DATE_FORMAT( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth), \'%m-%d-%Y\' )\" title=\"Date of Birth (mm-dd-yy)\" primary=\"false\" />\n			<column id=\"age\" name=\"TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )\" title=\"Age\" primary=\"false\" />\n			<column id=\"dxcode\" title=\"Dx System/Code\" name=\"CONCAT(MIN(dxr.coding_system),\'/\',MIN(dxr.dxresearch_code),IF( MIN(dxr.dxresearch_code) != MAX(dxr.dxresearch_code),CONCAT( \' &amp; \', MAX(dxr.coding_system), \'/\', MAX(dxr.dxresearch_code) ),\'\') )\" primary=\"false\" />\n		</exportColumns>\n		<query>\n			<!-- Drilldown SQL Query here -->\nSELECT\n*			\nFROM demographic d\nLEFT JOIN dxresearch dxr\nON d.demographic_no = dxr.demographic_no\nWHERE d.patient_status=${pstatus}\nAND\n(\n (LEFT(dxr.dxresearch_code, 3) IN (\'331\', \'290\') AND dxr.coding_system = ${dxcodesSysICD}) OR\n (dxr.dxresearch_code IN (\'52448006\') AND dxr.coding_system LIKE ${dxcodesSysSnoMed})\n )\nAND dxr.status = \'A\'\nAND d.provider_no LIKE ${provider}\nGROUP BY d.demographic_no\nORDER BY COUNT(d.demographic_no) DESC, d.demographic_no\n		</query>\n	</drillDownQuery>\n</indicatorTemplateXML>\n','','\0',0,NULL,NULL),
(56,6,'Consider Depression','CDM','Depression','DoBC CPQI PSP Panel','2017-08-02','\n			Patients with depression dx in 2+ bills or 2+ visit encounters within last 3 years or most recent PHQ-9 >= 15 in past 3 months\n		','\n		  Created for Doctors of BC\n		  i) Depression dx in 2+ bills: \"Patient Status: Active\nAND does not have a Current Problem List/Profile item code of 35489007 OR starting with 311 OR 296\nAND with >=2 Bills with the ICD9 diagnosis code of 50B or starting ','<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<indicatorTemplateXML>\n	<author>OSCAR BC</author>\n	<uid></uid>\n	<heading>\n		<category>CDM</category>\n		<subCategory>Depression</subCategory>\n		<name>Consider Depression</name>\n		<definition>\n			Patients with depression dx in 2+ bills or 2+ visit encounters within last 3 years or most recent PHQ-9 &gt;= 15 in past 3 months\n		</definition>\n		<framework>DoBC CPQI PSP Panel</framework>\n		<frameworkVersion>08-02-2017</frameworkVersion>\n		<notes>\n		  Created for Doctors of BC\n		  i) Depression dx in 2+ bills: \"Patient Status: Active\nAND does not have a Current Problem List/Profile item code of 35489007 OR starting with 311 OR 296\nAND with >=2 Bills with the ICD9 diagnosis code of 50B or starting with 311, 296 in the last 3 years\"\n		  ii) Depression dx in 2+ visits: \"Patient Status: Active\nAND does not have a Current Problem List/Profile item code of 35489007 OR starting with 311 OR 296\nAND with >= 2 Visit Encounters with Snomed diagnosis code 35489007 or the ICD9 diagnosis code starting with 311 OR 296 in the last 3 years\"\n                  iii) Depression PHQ-9 score &gt;= 15: \"Patient Status: Active\nAND does not have a Current Problem List/Profile item code of 35489007 OR starting with 311 OR 296\nAND WITH a most recent PHQ-9 score &gt;=15 in the past 3 months\"\n		</notes>\n	</heading>\n	<indicatorQuery>\n		<version>03-13-2018</version>\n		<params>\n			<parameter id=\"provider\" name=\"Provider Number\" value=\"loggedInProvider\" />\n			<parameter id=\"active\" name=\"Active Patients\" value=\"\'AC\'\" />\n			<parameter id=\"dxcodesICD\" name=\"Dx Codes (ICD)\" value=\"311,296\" />\n                        <parameter id=\"dxcodesSysICD\" name=\"DX CodeSystem (ICD)\" value=\"\'icd9\'\" />\n                        <parameter id=\"dxcodesSnoMed\" name=\"Dx Codes (SnoMed)\" value=\"35489007\" />\n                        <parameter id=\"dxcodesSysSnoMed\" name=\"Dx CodeSystem (SnoMed)\" value=\"\'snomed%\'\" />\n			<parameter id=\"billingCode\" name=\"ICD9 Billing Code\" value=\"311,296\" />\n			<parameter id=\"numOfBills\" name=\"Number of ICD9 311,296 Bills\" value=\"2\" />\n			<parameter id=\"numOfVisits\" name=\"Number of Visit Encounters coded 311,296/ICD9\" value=\"2\" />\n			<parameter id=\"obsName\" name=\"Observation Name\" value=\"\'PHQ9\'\" />\n			<parameter id=\"obsResult\" name=\"Observation Result\" value=\"15\" />\n		</params>\n		<range>\n			<lowerLimit id=\"billingdate\" label=\"From Date\" name=\"Date\" value=\"DATE_SUB( NOW(), INTERVAL 3 YEAR )\" />\n			<upperLimit id=\"billingdate\" label=\"Date Today\" name=\"Date\" value=\"NOW()\" />\n			<lowerLimit id=\"visitdate\" label=\"From Date\" name=\"Date\" value=\"DATE_SUB( NOW(), INTERVAL 3 YEAR )\" />\n			<upperLimit id=\"visitdate\" label=\"Date Today\" name=\"Date\" value=\"NOW()\" />\n			<lowerLimit id=\"obsdate\" label=\"From Date\" name=\"Date\" value=\"DATE_SUB( NOW(), INTERVAL 3 MONTH )\" />\n			<upperLimit id=\"obsdate\" label=\"Date Today\" name=\"Date\" value=\"NOW()\" />\n		</range>\n		<query>\nSELECT\n  IF ( COUNT(fin.patient) &gt; 0, SUM( CASE WHEN (fin.dx IS NULL AND fin.billcount &gt;= ${numOfBills}) THEN 1 ELSE 0 END ) , 0) AS \"Depression dx in ${numOfBills}+ bills\",\n  IF ( COUNT(fin.patient) &gt; 0, SUM( CASE WHEN (fin.dx IS NULL AND fin.visitcount &gt;= ${numOfVisits}) THEN 1 ELSE 0 END ) , 0) AS \"Depression dx in ${numOfVisits}+ visits\",\n  IF ( COUNT(fin.patient) &gt; 0, SUM( CASE WHEN (fin.dx IS NULL AND fin.result &gt;= ${obsResult}) THEN 1 ELSE 0 END ) , 0) AS \"PHQ-9 &gt;= ${obsResult}\"\nFROM ( \n  SELECT \n    d.demographic_no AS patient, \n    BILLING.billcount AS billcount,\n    VISIT.visitcount AS visitcount,\n    OBSLAST.result AS result,\n    dxr.dxresearch_code AS dx,\n    dxr.coding_system AS dxs\n  FROM demographic d \n  LEFT JOIN (\n    SELECT demographic_no, dxresearch_code, coding_system, count(dxresearch_code)\n    FROM dxresearch\n    WHERE status=\'A\' AND\n    (\n      (LEFT(dxresearch_code, 3) IN (\'311\',\'296\') AND coding_system = ${dxcodesSysICD}) OR\n      (dxresearch_code IN (\'35489007\') AND coding_system LIKE ${dxcodesSysSnoMed})\n    )\n    GROUP BY demographic_no\n    ORDER BY demographic_no\n  ) dxr\n  ON d.demographic_no = dxr.demographic_no\n  -- Billed 311,296 in last 3 years\n  LEFT JOIN (\n    SELECT b.demographic_no as demographic_no, b.dx_code1 as dxcode1, b.dx_code2 as dxcode2, b.dx_code3 as dxcode3, count(b.demographic_no) as billcount\n    FROM billingmaster b\n    WHERE ( LEFT(b.dx_code1, 3) IN (\'311\',\'296\') OR LEFT(b.dx_code2, 3) IN (\'311\',\'296\') OR LEFT(b.dx_code3, 3) IN (\'311\',\'296\')\n     OR b.dx_code1 IN (\'50B\') OR b.dx_code2 IN (\'50B\') OR b.dx_code3 IN (\'50B\') )\n    AND DATE(b.createdate) > ${lowerLimit.billingdate}\n    AND b.demographic_no > 0\n    GROUP BY b.demographic_no HAVING COUNT(b.demographic_no) > -1\n  ) BILLING\n  ON (d.demographic_no = BILLING.demographic_no)  \n  -- Coded dx during visit encounter in last 3 years\n  LEFT JOIN(\n    SELECT ASSIGNED.demographic_no as demographic_no, observation_date as visitdate, uuid, count(ASSIGNED.demographic_no) as visitcount\n    FROM casemgmt_note note\n    INNER JOIN (\n      SELECT note_id, CODED.demo_no as demographic_no FROM casemgmt_issue_notes\n      INNER JOIN (\n        SELECT ci.id as id, ci.update_date, ci.demographic_no demo_no FROM issue i\n        INNER JOIN casemgmt_issue ci\n        ON i.issue_id = ci.issue_id\n        WHERE\n	(i.type LIKE ${dxcodesSysICD} AND LEFT(i.code, 3) IN (\'311\',\'296\')) OR\n	(i.type LIKE ${dxcodesSysSnoMed} AND i.code IN (\'35489007\'))\n      ) CODED\n      ON (casemgmt_issue_notes.id = CODED.id)\n      ORDER BY CODED.demo_no\n    ) ASSIGNED\n    ON note.note_id = ASSIGNED.note_id AND\n    -- GET LAST REVISION OF NOTE\n    note.note_id= (SELECT MAX(cmn.note_id) FROM casemgmt_note cmn WHERE cmn.uuid = note.uuid) AND\n    DATE(note.observation_date) > ${lowerLimit.visitdate}\n    GROUP BY demographic_no\n    ORDER BY demographic_no\n  ) VISIT\n  ON (d.demographic_no = VISIT.demographic_no)\n  -- Consider Observation\n  LEFT JOIN ( \n    SELECT m.demographicNo AS demographic_no, m.dataField AS result, m.dateObserved AS dateObserved\n    FROM measurements m\n    INNER JOIN (\n      SELECT demographicNo, MAX(dateObserved) AS dateObserved\n      FROM measurements\n      WHERE type = ${obsName}\n      GROUP BY demographicNo\n    ) mlast\n    ON m.demographicNo = mlast.demographicNo\n    WHERE m.type = ${obsName}\n    AND m.dateObserved = mlast.dateObserved\n    AND (DATE(m.dateObserved) &gt; ${lowerLimit.obsdate})\n    AND m.demographicNo &gt; 0\n    GROUP BY m.demographicNo HAVING COUNT(m.demographicNo) > -1\n  ) OBSLAST\n  ON (d.demographic_no = OBSLAST.demographic_no)  \n  WHERE d.patient_status LIKE ${active}\n  AND d.demographic_no > 0\n  AND d.provider_no LIKE ${provider} \n) fin\n		</query>\n	</indicatorQuery>\n	<drillDownQuery>\n		<version>03-13-2018</version>\n		<params>\n			<parameter id=\"provider\" name=\"Provider Number\" value=\"loggedInProvider\" />\n			<parameter id=\"active\" name=\"Active Patients\" value=\"\'AC\'\" />\n			<parameter id=\"dxcodesICD\" name=\"Dx Codes (ICD)\" value=\"311,296\" />\n                        <parameter id=\"dxcodesSysICD\" name=\"DX CodeSystem (ICD)\" value=\"\'icd9\'\" />\n                        <parameter id=\"dxcodesSnoMed\" name=\"Dx Codes (SnoMed)\" value=\"35489007\" />\n                        <parameter id=\"dxcodesSysSnoMed\" name=\"Dx CodeSystem (SnoMed)\" value=\"\'snomed%\'\" />\n			<parameter id=\"billingCode\" name=\"ICD9 Billing Code\" value=\"311,296\" />\n			<parameter id=\"numOfBills\" name=\"Number of ICD9 311,296 Bills\" value=\"2\" />\n			<parameter id=\"numOfVisits\" name=\"Number of Visit Encounters coded 311,296/ICD9\" value=\"2\" />\n			<parameter id=\"obsName\" name=\"Observation Name\" value=\"\'PHQ9\'\" />\n			<parameter id=\"obsResult\" name=\"Observation Result\" value=\"15\" />\n		</params>\n		\n		<range>\n			<lowerLimit id=\"billingdate\" label=\"From Date\" name=\"Date\" value=\"DATE_SUB( NOW(), INTERVAL 3 YEAR )\" />\n			<upperLimit id=\"billingdate\" label=\"Date Today\" name=\"Date\" value=\"NOW()\" />\n			<lowerLimit id=\"visitdate\" label=\"From Date\" name=\"Date\" value=\"DATE_SUB( NOW(), INTERVAL 3 YEAR )\" />\n			<upperLimit id=\"visitdate\" label=\"Date Today\" name=\"Date\" value=\"NOW()\" />\n			<lowerLimit id=\"obsdate\" label=\"From Date\" name=\"Date\" value=\"DATE_SUB( NOW(), INTERVAL 3 MONTH )\" />\n			<upperLimit id=\"obsdate\" label=\"Date Today\" name=\"Date\" value=\"NOW()\" />\n		</range>\n		\n		<displayColumns>\n			<column id=\"demographic\" name=\"d.demographic_no\" title=\"Patient Id\" primary=\"true\" />\n			<column id=\"name\" name=\"CONCAT( d.last_name, \', \', d.first_name )\" title=\"Patient Name\" primary=\"false\" />\n			<column id=\"dob\" name=\"DATE_FORMAT( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth), \'%m-%d-%Y\' )\" title=\"Date of Birth\" primary=\"false\" />\n			<column id=\"age\" name=\"TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )\" title=\"Age\" primary=\"false\" />\n			<column id=\"billings\" name=\"IFNULL( BILLING.billcount, \'0\')\" title=\"Billings\" primary=\"false\" />\n			<column id=\"visits\" name=\"IFNULL( VISIT.visitcount, \'0\')\" title=\"Visits\" primary=\"false\" />\n			<column id=\"observation\" name=\"IFNULL( OBSLAST.result, \'NA\')\" title=\"PHQ9\" primary=\"false\" />\n			<column id=\"obsDate\" name=\"IFNULL( DATE_FORMAT( OBSLAST.dateObserved, \'%m-%d-%Y\' ), \'\')\" title=\"Test Date (mm-dd-yyyy)\" primary=\"false\" />\n\n		</displayColumns>\n		\n		<exportColumns>\n			<column id=\"demographic\" name=\"d.demographic_no\" title=\"Patient Id\" primary=\"true\" />\n                        <column id=\"firstName\" name=\"d.first_name\" title=\"First Name\" primary=\"false\" />\n                        <column id=\"lastName\" name=\"d.last_name\" title=\"Last Name\" primary=\"false\" />\n			<column id=\"dob\" name=\"DATE_FORMAT( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth), \'%m-%d-%Y\' )\" title=\"Date of Birth\" primary=\"false\" />\n			<column id=\"age\" name=\"TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )\" title=\"Age\" primary=\"false\" />\n			<column id=\"billings\" name=\"IFNULL( BILLING.billcount, \'0\')\" title=\"Billings\" primary=\"false\" />\n			<column id=\"visits\" name=\"IFNULL( VISIT.visitcount, \'0\')\" title=\"Visits\" primary=\"false\" />\n			<column id=\"observation\" name=\"IFNULL( OBSLAST.result, \'NA\')\" title=\"PHQ9\" primary=\"false\" />\n			<column id=\"obsDate\" name=\"IFNULL( DATE_FORMAT( OBSLAST.dateObserved, \'%m-%d-%Y\' ), \'\')\" title=\"Test Date (mm-dd-yyyy)\" primary=\"false\" />\n		</exportColumns>\n		<query>	\n  SELECT *	\n  FROM demographic d \n  LEFT JOIN (\n    SELECT demographic_no, dxresearch_code, coding_system, count(dxresearch_code)\n    FROM dxresearch\n    WHERE status=\'A\' AND\n    (\n      (LEFT(dxresearch_code, 3) IN (\'311\',\'296\') AND coding_system = ${dxcodesSysICD}) OR\n      (dxresearch_code IN (\'35489007\') AND coding_system LIKE ${dxcodesSysSnoMed})\n    )\n    GROUP BY demographic_no\n    ORDER BY demographic_no\n  ) dxr\n  ON d.demographic_no = dxr.demographic_no\n  -- Billed 311,296 in last 3 years\n  LEFT JOIN (\n    SELECT b.demographic_no as demographic_no, b.dx_code1 as dxcode1, b.dx_code2 as dxcode2, b.dx_code3 as dxcode3, count(b.demographic_no) as billcount\n    FROM billingmaster b\n    WHERE ( LEFT(b.dx_code1, 3) IN (\'311\',\'296\') OR LEFT(b.dx_code2, 3) IN (\'311\',\'296\') OR LEFT(b.dx_code3, 3) IN (\'311\',\'296\')\n     OR b.dx_code1 IN (\'50B\') OR b.dx_code2 IN (\'50B\') OR b.dx_code3 IN (\'50B\') )\n    AND DATE(b.createdate) > ${lowerLimit.billingdate}\n    AND b.demographic_no > 0\n    GROUP BY b.demographic_no HAVING COUNT(b.demographic_no) > -1\n  ) BILLING\n  ON (d.demographic_no = BILLING.demographic_no)  \n  -- Coded dx during visit encounter in last 3 years\n  LEFT JOIN(\n    SELECT ASSIGNED.demographic_no as demographic_no, observation_date as visitdate, uuid, count(ASSIGNED.demographic_no) as visitcount\n    FROM casemgmt_note note\n    INNER JOIN (\n      SELECT note_id, CODED.demo_no as demographic_no FROM casemgmt_issue_notes\n      INNER JOIN (\n        SELECT ci.id as id, ci.update_date, ci.demographic_no demo_no FROM issue i\n        INNER JOIN casemgmt_issue ci\n        ON i.issue_id = ci.issue_id\n        WHERE\n	(i.type LIKE ${dxcodesSysICD} AND LEFT(i.code, 3) IN (\'311\',\'296\')) OR\n	(i.type LIKE ${dxcodesSysSnoMed} AND i.code IN (\'35489007\'))\n      ) CODED\n      ON (casemgmt_issue_notes.id = CODED.id)\n      ORDER BY CODED.demo_no\n    ) ASSIGNED\n    ON note.note_id = ASSIGNED.note_id AND\n    -- GET LAST REVISION OF NOTE\n    note.note_id= (SELECT MAX(cmn.note_id) FROM casemgmt_note cmn WHERE cmn.uuid = note.uuid) AND\n    DATE(note.observation_date) > ${lowerLimit.visitdate}\n    GROUP BY demographic_no\n    ORDER BY demographic_no\n  ) VISIT\n  ON (d.demographic_no = VISIT.demographic_no)  \n  -- Consider OBS here if needed\n  LEFT JOIN ( \n    SELECT m.demographicNo AS demographic_no, m.dataField AS result, m.dateObserved AS dateObserved\n    FROM measurements m\n    INNER JOIN (\n      SELECT demographicNo, MAX(dateObserved) AS dateObserved\n      FROM measurements\n      WHERE type = ${obsName}\n      GROUP BY demographicNo\n    ) mlast\n    ON m.demographicNo = mlast.demographicNo\n    WHERE m.type = ${obsName}\n    AND m.dateObserved = mlast.dateObserved\n    AND (DATE(m.dateObserved) &gt; ${lowerLimit.obsdate})\n    AND m.demographicNo &gt; 0\n    GROUP BY m.demographicNo HAVING COUNT(m.demographicNo) > -1\n  ) OBSLAST\n  ON (d.demographic_no = OBSLAST.demographic_no)  \n  WHERE d.patient_status LIKE ${active}\n  AND d.demographic_no > 0\n  AND ( dxr.dxresearch_code IS NULL AND ((BILLING.billcount IS NOT NULL AND BILLING.billcount &gt;= ${numOfBills}) OR (VISIT.visitcount IS NOT NULL AND VISIT.visitcount &gt;= ${numOfVisits}) OR (OBSLAST.result IS NOT NULL AND OBSLAST.result &gt;= ${obsResult})) )\n  AND d.provider_no LIKE ${provider}\n  ORDER BY d.demographic_no\n		</query>\n	</drillDownQuery>\n</indicatorTemplateXML>\n','','\0',0,NULL,NULL),
(57,6,'Depression Prevalence','CDM','Depression','DoBC CPQI PSP Panel','2017-08-02','% of active patients in the practice coded with Depression.','\ni) Depression patients: \"Patient Status: Active\nAND has a Current Problem List/Profile item code of 35489007 OR starting with 311, 296\"\nii) Other patients: \"Patient Status: Active\nAND does not have a Current Problem List/Profile item code of 35489007 OR ','<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<indicatorTemplateXML>\n	<author>OSCAR BC</author>\n	<uid></uid>\n	<heading>\n		<category>CDM</category>\n		<subCategory>Depression</subCategory>\n		<name>Depression Prevalence</name>\n		<definition>% of active patients in the practice coded with Depression.</definition>\n		<framework>DoBC CPQI PSP Panel</framework>\n		<frameworkVersion>08-02-2017</frameworkVersion>\n		<notes>\ni) Depression patients: \"Patient Status: Active\nAND has a Current Problem List/Profile item code of 35489007 OR starting with 311, 296\"\nii) Other patients: \"Patient Status: Active\nAND does not have a Current Problem List/Profile item code of 35489007 OR starting with 311, 296\"\n		</notes>\n	</heading>\n	<indicatorQuery>\n		<version>03-13-2018</version>\n		<params>\n			<!-- \n				Required parameter provider. Value options are: \n					[ an individual providerNo, or provider range ] ie: value=\"370, 1001\" \n					\"all\" ie: value=\"all\" including null.\n					\"loggedInProvider\" ie:\n				Default is \"loggedInProvider\"\n				Use this parameter in the query as ${provider}\n				This parameter should be used for fetching patient\'s assigned to a MRP.\n				ie: WHERE demographic.provider_no = ${provider}\n			-->\n			<parameter id=\"provider\" name=\"provider_no\" value=\"loggedInProvider\" />\n			<parameter id=\"pstatus\" name=\"Patient Status\" value=\"\'AC\'\" />\n			<parameter id=\"dxcodesICD\" name=\"Dx Codes (ICD)\" value=\"311,296\" />\n			<parameter id=\"dxcodesSysICD\" name=\"DX CodeSystem (ICD)\" value=\"\'icd9\'\" />\n			<parameter id=\"dxcodesSnoMed\" name=\"Dx Codes (SnoMed)\" value=\"35489007\" />\n			<parameter id=\"dxcodesSysSnoMed\" name=\"Dx CodeSystem (SnoMed)\" value=\"\'snomed%\'\" />\n		</params>\n		<query>\n			<!-- Indicator SQL Query here -->\nSELECT\n -- PERCENT OF TOTAL PATIENTS NOTED AS ACTIVE WITH CURRENT DEPRESSION\n IF( COUNT(fin.patient) > 0, SUM( IF( dxresearch_code is not NULL , 1, 0) ) , 0 ) AS \"% Active, Current Depression\",\n -- PERCENT OF TOTAL PATIENTS NOTED AS ACTIVE WITHOUT CURRENT DEPRESSION\n IF( COUNT(fin.patient) > 0, SUM( IF( dxresearch_code is NULL , 1, 0) ) , 0 ) AS \"% Active, No Current Depression\"\nFROM (\n SELECT d.demographic_no AS patient, d.patient_status AS pt_status, dxresearch_code\n FROM demographic d\n LEFT JOIN (\n  SELECT demographic_no, dxresearch_code, count(dxresearch_code)\n  FROM dxresearch\n  WHERE status=\'A\' AND\n  (\n   (LEFT(dxresearch_code, 3) IN (\'311\', \'296\') AND coding_system = ${dxcodesSysICD}) OR\n   (dxresearch_code IN (\'35489007\') AND coding_system LIKE ${dxcodesSysSnoMed})\n   )\n  GROUP BY demographic_no\n  ORDER BY demographic_no\n ) problems\n ON d.demographic_no = problems.demographic_no\n WHERE d.provider_no LIKE ${provider} AND d.patient_status = ${pstatus}\n) fin\n		</query>\n	</indicatorQuery>\n	<drillDownQuery>\n		<version>03-13-2018</version>\n		<params>\n			<parameter id=\"provider\" name=\"provider_no\" value=\"loggedInProvider\" />	\n			<parameter id=\"pstatus\" name=\"Patient Status\" value=\"\'AC\'\" />\n			<parameter id=\"dxcodesICD\" name=\"Dx Codes (ICD)\" value=\"311,296\" />\n			<parameter id=\"dxcodesSysICD\" name=\"DX CodeSystem (ICD)\" value=\"\'icd9\'\" />\n			<parameter id=\"dxcodesSnoMed\" name=\"Dx Codes (SnoMed)\" value=\"35489007\" />\n			<parameter id=\"dxcodesSysSnoMed\" name=\"Dx CodeSystem (SnoMed)\" value=\"\'snomed%\'\" />\n		</params>\n		<displayColumns>\n			<column id=\"demographic\" name=\"d.demographic_no\" title=\"Patient Id\" primary=\"true\" />\n			<column id=\"name\" name=\"CONCAT( d.last_name, \', \', d.first_name )\" title=\"Patient Name\" primary=\"false\" />\n			<column id=\"dob\" name=\"DATE_FORMAT( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth), \'%m-%d-%Y\' )\" title=\"Date of Birth (mm-dd-yy)\" primary=\"false\" />\n			<column id=\"age\" name=\"TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )\" title=\"Age\" primary=\"false\" />\n			<column id=\"dxcode\" title=\"Dx System/Code\" name=\"CONCAT(MIN(dxr.coding_system),\'/\',MIN(dxr.dxresearch_code),IF( MIN(dxr.dxresearch_code) != MAX(dxr.dxresearch_code),CONCAT( \' &amp; \', MAX(dxr.coding_system), \'/\', MAX(dxr.dxresearch_code) ),\'\') )\" primary=\"false\" />\n		</displayColumns>\n		<exportColumns>\n			<column id=\"demographic\" name=\"d.demographic_no\" title=\"Patient Id\" primary=\"true\" />\n			<column id=\"firstName\" name=\"d.first_name\" title=\"First Name\" primary=\"false\" />\n			<column id=\"lastName\" name=\"d.last_name\" title=\"Last Name\" primary=\"false\" />\n			<column id=\"dob\" name=\"DATE_FORMAT( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth), \'%m-%d-%Y\' )\" title=\"Date of Birth (mm-dd-yy)\" primary=\"false\" />\n			<column id=\"age\" name=\"TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )\" title=\"Age\" primary=\"false\" />\n			<column id=\"dxcode\" title=\"Dx System/Code\" name=\"CONCAT(MIN(dxr.coding_system),\'/\',MIN(dxr.dxresearch_code),IF( MIN(dxr.dxresearch_code) != MAX(dxr.dxresearch_code),CONCAT( \' &amp; \', MAX(dxr.coding_system), \'/\', MAX(dxr.dxresearch_code) ),\'\') )\" primary=\"false\" />\n		</exportColumns>\n		<query>\n			<!-- Drilldown SQL Query here -->\nSELECT\n*			\nFROM demographic d\nLEFT JOIN dxresearch dxr\nON d.demographic_no = dxr.demographic_no\nWHERE d.patient_status=${pstatus}\nAND\n(\n (LEFT(dxr.dxresearch_code, 3) IN (\'311\', \'296\') AND dxr.coding_system = ${dxcodesSysICD}) OR\n (dxr.dxresearch_code IN (\'35489007\') AND dxr.coding_system LIKE ${dxcodesSysSnoMed})\n )\nAND dxr.status = \'A\'\nAND d.provider_no LIKE ${provider}\nGROUP BY d.demographic_no\nORDER BY COUNT(d.demographic_no) DESC, d.demographic_no\n		</query>\n	</drillDownQuery>\n</indicatorTemplateXML>\n','','\0',0,NULL,NULL),
(58,7,'Consider Drug Dependence Syndrome','CDM','Drug Dependence Syndrome','DoBC CPQI PSP Panel','2017-08-02','\n			Patients with drug dependence syndrome dx in 2+ bills or 2+ visit encounters within last 3 years\n		','\n		  Created for Doctors of BC\n		  i) Drug Dependence Syndrome dx in 2+ bills: \"Patient Status: Active\nAND does not have a Current Problem List/Profile item code of 191816009 OR starting with 304\nAND with >=2 Bills with the ICD9 diagnosis code starting wi','<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<indicatorTemplateXML>\n	<author>OSCAR BC</author>\n	<uid></uid>\n	<heading>\n		<category>CDM</category>\n		<subCategory>Drug Dependence Syndrome</subCategory>\n		<name>Consider Drug Dependence Syndrome</name>\n		<definition>\n			Patients with drug dependence syndrome dx in 2+ bills or 2+ visit encounters within last 3 years\n		</definition>\n		<framework>DoBC CPQI PSP Panel</framework>\n		<frameworkVersion>08-02-2017</frameworkVersion>\n		<notes>\n		  Created for Doctors of BC\n		  i) Drug Dependence Syndrome dx in 2+ bills: \"Patient Status: Active\nAND does not have a Current Problem List/Profile item code of 191816009 OR starting with 304\nAND with >=2 Bills with the ICD9 diagnosis code starting with 304 in the last 3 years\"\n		  ii) Drug Dependence Syndrome dx in 2+ visits: \"Patient Status: Active\nAND does not have a Current Problem List/Profile item code of 191816009 OR starting with 304\nAND with >=2 Visit Encounters with Snomed diagnosis code 191816009 or the ICD9 diagnosis code starting with 304 in the last 3 years\"\n		</notes>\n	</heading>\n	<indicatorQuery>\n		<version>03-13-2018</version>\n		<params>\n			<parameter id=\"provider\" name=\"Provider Number\" value=\"loggedInProvider\" />\n			<parameter id=\"active\" name=\"Active Patients\" value=\"\'AC\'\" />\n			<parameter id=\"dxcodesICD\" name=\"Dx Codes (ICD)\" value=\"304\" />\n                        <parameter id=\"dxcodesSysICD\" name=\"DX CodeSystem (ICD)\" value=\"\'icd9\'\" />\n                        <parameter id=\"dxcodesSnoMed\" name=\"Dx Codes (SnoMed)\" value=\"191816009\" />\n                        <parameter id=\"dxcodesSysSnoMed\" name=\"Dx CodeSystem (SnoMed)\" value=\"\'snomed%\'\" />\n			<parameter id=\"billingCode\" name=\"ICD9 Billing Code\" value=\"304\" />\n			<parameter id=\"numOfBills\" name=\"Number of ICD9 304 Bills\" value=\"2\" />\n			<parameter id=\"numOfVisits\" name=\"Number of Visit Encounters coded 304/ICD9\" value=\"2\" />\n		</params>\n		<range>\n			<lowerLimit id=\"billingdate\" label=\"From Date\" name=\"Date\" value=\"DATE_SUB( NOW(), INTERVAL 3 YEAR )\" />\n			<upperLimit id=\"billingdate\" label=\"Date Today\" name=\"Date\" value=\"NOW()\" />\n			<lowerLimit id=\"visitdate\" label=\"From Date\" name=\"Date\" value=\"DATE_SUB( NOW(), INTERVAL 3 YEAR )\" />\n			<upperLimit id=\"visitdate\" label=\"Date Today\" name=\"Date\" value=\"NOW()\" />\n		</range>\n		<query>\nSELECT\n  IF ( COUNT(fin.patient) &gt; 0, SUM( CASE WHEN (fin.dx IS NULL AND fin.billcount &gt;= ${numOfBills}) THEN 1 ELSE 0 END ) , 0) AS \"Drug Dependence Syndrome dx in ${numOfBills}+ bills\",\n  IF ( COUNT(fin.patient) &gt; 0, SUM( CASE WHEN (fin.dx IS NULL AND fin.visitcount &gt;= ${numOfVisits}) THEN 1 ELSE 0 END ) , 0) AS \"Drug Dependence Syndrome dx in ${numOfVisits}+ visits\"\n-- Consider OBS here if needed  \nFROM ( \n  SELECT \n    d.demographic_no AS patient, \n    BILLING.billcount AS billcount,\n    VISIT.visitcount AS visitcount,\n    dxr.dxresearch_code AS dx,\n    dxr.coding_system AS dxs\n  FROM demographic d \n  LEFT JOIN (\n    SELECT demographic_no, dxresearch_code, coding_system, count(dxresearch_code)\n    FROM dxresearch\n    WHERE status=\'A\' AND\n    (\n      (LEFT(dxresearch_code, 3) IN (\'304\') AND coding_system = ${dxcodesSysICD}) OR\n      (dxresearch_code IN (\'191816009\') AND coding_system LIKE ${dxcodesSysSnoMed})\n    )\n    GROUP BY demographic_no\n    ORDER BY demographic_no\n  ) dxr\n  ON d.demographic_no = dxr.demographic_no\n  -- Billed 304 in last 3 years\n  LEFT JOIN (\n    SELECT b.demographic_no as demographic_no, b.dx_code1 as dxcode1, b.dx_code2 as dxcode2, b.dx_code3 as dxcode3, count(b.demographic_no) as billcount\n    FROM billingmaster b\n    WHERE ( LEFT(b.dx_code1, 3) IN (\'304\') OR LEFT(b.dx_code2, 3) IN (\'304\') OR LEFT(b.dx_code3, 3) IN (\'304\') )\n    AND DATE(b.createdate) > ${lowerLimit.billingdate}\n    AND b.demographic_no > 0\n    GROUP BY b.demographic_no HAVING COUNT(b.demographic_no) > -1\n  ) BILLING\n  ON (d.demographic_no = BILLING.demographic_no)  \n  -- Coded dx during visit encounter in last 3 years\n  LEFT JOIN(\n    SELECT ASSIGNED.demographic_no as demographic_no, observation_date as visitdate, uuid, count(ASSIGNED.demographic_no) as visitcount\n    FROM casemgmt_note note\n    INNER JOIN (\n      SELECT note_id, CODED.demo_no as demographic_no FROM casemgmt_issue_notes\n      INNER JOIN (\n        SELECT ci.id as id, ci.update_date, ci.demographic_no demo_no FROM issue i\n        INNER JOIN casemgmt_issue ci\n        ON i.issue_id = ci.issue_id\n        WHERE\n	(i.type LIKE ${dxcodesSysICD} AND LEFT(i.code, 3) IN (\'304\')) OR\n	(i.type LIKE ${dxcodesSysSnoMed} AND i.code IN (\'191816009\'))\n      ) CODED\n      ON (casemgmt_issue_notes.id = CODED.id)\n      ORDER BY CODED.demo_no\n    ) ASSIGNED\n    ON note.note_id = ASSIGNED.note_id AND\n    -- GET LAST REVISION OF NOTE\n    note.note_id= (SELECT MAX(cmn.note_id) FROM casemgmt_note cmn WHERE cmn.uuid = note.uuid) AND\n    DATE(note.observation_date) > ${lowerLimit.visitdate}\n    GROUP BY demographic_no\n    ORDER BY demographic_no\n  ) VISIT\n  ON (d.demographic_no = VISIT.demographic_no)  \n  WHERE d.patient_status LIKE ${active}\n  AND d.demographic_no > 0\n  AND d.provider_no LIKE ${provider} \n) fin\n		</query>\n	</indicatorQuery>\n	<drillDownQuery>\n		<version>03-13-2018</version>\n		<params>\n			<parameter id=\"provider\" name=\"Provider Number\" value=\"loggedInProvider\" />\n			<parameter id=\"active\" name=\"Active Patients\" value=\"\'AC\'\" />\n			<parameter id=\"dxcodesICD\" name=\"Dx Codes (ICD)\" value=\"304\" />\n                        <parameter id=\"dxcodesSysICD\" name=\"DX CodeSystem (ICD)\" value=\"\'icd9\'\" />\n                        <parameter id=\"dxcodesSnoMed\" name=\"Dx Codes (SnoMed)\" value=\"191816009\" />\n                        <parameter id=\"dxcodesSysSnoMed\" name=\"Dx CodeSystem (SnoMed)\" value=\"\'snomed%\'\" />\n			<parameter id=\"billingCode\" name=\"ICD9 Billing Code\" value=\"304\" />\n			<parameter id=\"numOfBills\" name=\"Number of ICD9 304 Bills\" value=\"2\" />\n			<parameter id=\"numOfVisits\" name=\"Number of Visit Encounters coded 304/ICD9\" value=\"2\" />\n		</params>\n		\n		<range>\n			<lowerLimit id=\"billingdate\" label=\"From Date\" name=\"Date\" value=\"DATE_SUB( NOW(), INTERVAL 3 YEAR )\" />\n			<upperLimit id=\"billingdate\" label=\"Date Today\" name=\"Date\" value=\"NOW()\" />\n			<lowerLimit id=\"visitdate\" label=\"From Date\" name=\"Date\" value=\"DATE_SUB( NOW(), INTERVAL 3 YEAR )\" />\n			<upperLimit id=\"visitdate\" label=\"Date Today\" name=\"Date\" value=\"NOW()\" />\n		</range>\n		\n		<displayColumns>\n			<column id=\"demographic\" name=\"d.demographic_no\" title=\"Patient Id\" primary=\"true\" />\n			<column id=\"name\" name=\"CONCAT( d.last_name, \', \', d.first_name )\" title=\"Patient Name\" primary=\"false\" />\n			<column id=\"dob\" name=\"DATE_FORMAT( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth), \'%m-%d-%Y\' )\" title=\"Date of Birth\" primary=\"false\" />\n			<column id=\"age\" name=\"TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )\" title=\"Age\" primary=\"false\" />\n			<column id=\"billings\" name=\"IFNULL( BILLING.billcount, \'0\')\" title=\"Billings\" primary=\"false\" />\n			<column id=\"visits\" name=\"IFNULL( VISIT.visitcount, \'0\')\" title=\"Visits\" primary=\"false\" />\n		</displayColumns>\n		\n		<exportColumns>\n			<column id=\"demographic\" name=\"d.demographic_no\" title=\"Patient Id\" primary=\"true\" />\n                        <column id=\"firstName\" name=\"d.first_name\" title=\"First Name\" primary=\"false\" />\n                        <column id=\"lastName\" name=\"d.last_name\" title=\"Last Name\" primary=\"false\" />\n			<column id=\"dob\" name=\"DATE_FORMAT( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth), \'%m-%d-%Y\' )\" title=\"Date of Birth\" primary=\"false\" />\n			<column id=\"age\" name=\"TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )\" title=\"Age\" primary=\"false\" />\n			<column id=\"billings\" name=\"IFNULL( BILLING.billcount, \'0\')\" title=\"Billings\" primary=\"false\" />\n			<column id=\"visits\" name=\"IFNULL( VISIT.visitcount, \'0\')\" title=\"Visits\" primary=\"false\" />\n		</exportColumns>\n		<query>	\n  SELECT *	\n  FROM demographic d \n  LEFT JOIN (\n    SELECT demographic_no, dxresearch_code, coding_system, count(dxresearch_code)\n    FROM dxresearch\n    WHERE status=\'A\' AND\n    (\n      (LEFT(dxresearch_code, 3) IN (\'304\') AND coding_system = ${dxcodesSysICD}) OR\n      (dxresearch_code IN (\'191816009\') AND coding_system LIKE ${dxcodesSysSnoMed})\n    )\n    GROUP BY demographic_no\n    ORDER BY demographic_no\n  ) dxr\n  ON d.demographic_no = dxr.demographic_no\n  -- Billed 304 in last 3 years\n  LEFT JOIN (\n    SELECT b.demographic_no as demographic_no, b.dx_code1 as dxcode1, b.dx_code2 as dxcode2, b.dx_code3 as dxcode3, count(b.demographic_no) as billcount\n    FROM billingmaster b\n    WHERE ( LEFT(b.dx_code1, 3) IN (\'304\') OR LEFT(b.dx_code2, 3) IN (\'304\') OR LEFT(b.dx_code3, 3) IN (\'304\') )\n    AND DATE(b.createdate) > ${lowerLimit.billingdate}\n    AND b.demographic_no > 0\n    GROUP BY b.demographic_no HAVING COUNT(b.demographic_no) > -1\n  ) BILLING\n  ON (d.demographic_no = BILLING.demographic_no)  \n  -- Coded dx during visit encounter in last 3 years\n  LEFT JOIN(\n    SELECT ASSIGNED.demographic_no as demographic_no, observation_date as visitdate, uuid, count(ASSIGNED.demographic_no) as visitcount\n    FROM casemgmt_note note\n    INNER JOIN (\n      SELECT note_id, CODED.demo_no as demographic_no FROM casemgmt_issue_notes\n      INNER JOIN (\n        SELECT ci.id as id, ci.update_date, ci.demographic_no demo_no FROM issue i\n        INNER JOIN casemgmt_issue ci\n        ON i.issue_id = ci.issue_id\n        WHERE\n	(i.type LIKE ${dxcodesSysICD} AND LEFT(i.code, 3) IN (\'304\')) OR\n	(i.type LIKE ${dxcodesSysSnoMed} AND i.code IN (\'191816009\'))\n      ) CODED\n      ON (casemgmt_issue_notes.id = CODED.id)\n      ORDER BY CODED.demo_no\n    ) ASSIGNED\n    ON note.note_id = ASSIGNED.note_id AND\n    -- GET LAST REVISION OF NOTE\n    note.note_id= (SELECT MAX(cmn.note_id) FROM casemgmt_note cmn WHERE cmn.uuid = note.uuid) AND\n    DATE(note.observation_date) > ${lowerLimit.visitdate}\n    GROUP BY demographic_no\n    ORDER BY demographic_no\n  ) VISIT\n  ON (d.demographic_no = VISIT.demographic_no)  \n-- Consider OBS here if needed  \n  WHERE d.patient_status LIKE ${active}\n  AND d.demographic_no > 0\n  AND ( dxr.dxresearch_code IS NULL AND ((BILLING.billcount IS NOT NULL AND BILLING.billcount &gt;= ${numOfBills}) OR (VISIT.visitcount IS NOT NULL AND VISIT.visitcount &gt;= ${numOfVisits})))\n  AND d.provider_no LIKE ${provider}\n  ORDER BY d.demographic_no\n		</query>\n	</drillDownQuery>\n</indicatorTemplateXML>\n','','\0',0,NULL,NULL),
(59,7,'Drug Dependence Syndrome Prevalence','CDM','Drug Dependence Syndrome','DoBC CPQI PSP Panel','2017-08-02','% of active patients in the practice coded with Drug Dependence Syndrome.','\ni) Drug dependence patients: \"Patient Status: Active\nAND has a Current Problem List/Profile item code of 191816009 OR starting with 304\"\nii) Other patients: \"Patient Status: Active\nAND does not have a Current Problem List/Profile item code of 191816009 O','<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<indicatorTemplateXML>\n	<author>OSCAR BC</author>\n	<uid></uid>\n	<heading>\n		<category>CDM</category>\n		<subCategory>Drug Dependence Syndrome</subCategory>\n		<name>Drug Dependence Syndrome Prevalence</name>\n		<definition>% of active patients in the practice coded with Drug Dependence Syndrome.</definition>\n		<framework>DoBC CPQI PSP Panel</framework>\n		<frameworkVersion>08-02-2017</frameworkVersion>\n		<notes>\ni) Drug dependence patients: \"Patient Status: Active\nAND has a Current Problem List/Profile item code of 191816009 OR starting with 304\"\nii) Other patients: \"Patient Status: Active\nAND does not have a Current Problem List/Profile item code of 191816009 OR starting with 304\"\n		</notes>\n	</heading>\n	<indicatorQuery>\n		<version>03-13-2018</version>\n		<params>\n			<!-- \n				Required parameter provider. Value options are: \n					[ an individual providerNo, or provider range ] ie: value=\"370, 1001\" \n					\"all\" ie: value=\"all\" including null.\n					\"loggedInProvider\" ie:\n				Default is \"loggedInProvider\"\n				Use this parameter in the query as ${provider}\n				This parameter should be used for fetching patient\'s assigned to a MRP.\n				ie: WHERE demographic.provider_no = ${provider}\n			-->\n			<parameter id=\"provider\" name=\"provider_no\" value=\"loggedInProvider\" />\n			<parameter id=\"pstatus\" name=\"Patient Status\" value=\"\'AC\'\" />\n			<parameter id=\"dxcodesICD\" name=\"Dx Codes (ICD)\" value=\"304\" />\n			<parameter id=\"dxcodesSysICD\" name=\"DX CodeSystem (ICD)\" value=\"\'icd9\'\" />\n			<parameter id=\"dxcodesSnoMed\" name=\"Dx Codes (SnoMed)\" value=\"191816009\" />\n			<parameter id=\"dxcodesSysSnoMed\" name=\"Dx CodeSystem (SnoMed)\" value=\"\'snomed%\'\" />\n		</params>\n		<query>\n			<!-- Indicator SQL Query here -->\nSELECT\n -- PERCENT OF TOTAL PATIENTS NOTED AS ACTIVE WITH CURRENT DRUG DEPENDENCE SYNDROME\n IF( COUNT(fin.patient) > 0, SUM( IF( dxresearch_code is not NULL , 1, 0) ) , 0 ) AS \"% Active, Current Drug Dependence Syndrome\",\n -- PERCENT OF TOTAL PATIENTS NOTED AS ACTIVE WITHOUT CURRENT DRUG DEPENDENCE SYNDROME\n IF( COUNT(fin.patient) > 0, SUM( IF( dxresearch_code is NULL , 1, 0) ) , 0 ) AS \"% Active, No Current Drug Dependence Syndrome\"\nFROM (\n SELECT d.demographic_no AS patient, d.patient_status AS pt_status, dxresearch_code\n FROM demographic d\n LEFT JOIN (\n  SELECT demographic_no, dxresearch_code, count(dxresearch_code)\n  FROM dxresearch\n  WHERE status=\'A\' AND\n  (\n   (LEFT(dxresearch_code, 3) IN (\'304\') AND coding_system = ${dxcodesSysICD}) OR\n   (dxresearch_code IN (\'191816009\') AND coding_system LIKE ${dxcodesSysSnoMed})\n   )\n  GROUP BY demographic_no\n  ORDER BY demographic_no\n ) problems\n ON d.demographic_no = problems.demographic_no\n WHERE d.provider_no LIKE ${provider} AND d.patient_status = ${pstatus}\n) fin\n		</query>\n	</indicatorQuery>\n	<drillDownQuery>\n		<version>03-13-2018</version>\n		<params>\n			<parameter id=\"provider\" name=\"provider_no\" value=\"loggedInProvider\" />	\n			<parameter id=\"pstatus\" name=\"Patient Status\" value=\"\'AC\'\" />\n			<parameter id=\"dxcodesICD\" name=\"Dx Codes (ICD)\" value=\"304\" />\n			<parameter id=\"dxcodesSysICD\" name=\"DX CodeSystem (ICD)\" value=\"\'icd9\'\" />\n			<parameter id=\"dxcodesSnoMed\" name=\"Dx Codes (SnoMed)\" value=\"191816009\" />\n			<parameter id=\"dxcodesSysSnoMed\" name=\"Dx CodeSystem (SnoMed)\" value=\"\'snomed%\'\" />\n		</params>\n		<displayColumns>\n			<column id=\"demographic\" name=\"d.demographic_no\" title=\"Patient Id\" primary=\"true\" />\n			<column id=\"name\" name=\"CONCAT( d.last_name, \', \', d.first_name )\" title=\"Patient Name\" primary=\"false\" />\n			<column id=\"dob\" name=\"DATE_FORMAT( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth), \'%m-%d-%Y\' )\" title=\"Date of Birth (mm-dd-yy)\" primary=\"false\" />\n			<column id=\"age\" name=\"TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )\" title=\"Age\" primary=\"false\" />\n			<column id=\"dxcode\" title=\"Dx System/Code\" name=\"CONCAT(MIN(dxr.coding_system),\'/\',MIN(dxr.dxresearch_code),IF( MIN(dxr.dxresearch_code) != MAX(dxr.dxresearch_code),CONCAT( \' &amp; \', MAX(dxr.coding_system), \'/\', MAX(dxr.dxresearch_code) ),\'\') )\" primary=\"false\" />\n		</displayColumns>\n		<exportColumns>\n			<column id=\"demographic\" name=\"d.demographic_no\" title=\"Patient Id\" primary=\"true\" />\n			<column id=\"firstName\" name=\"d.first_name\" title=\"First Name\" primary=\"false\" />\n			<column id=\"lastName\" name=\"d.last_name\" title=\"Last Name\" primary=\"false\" />\n			<column id=\"dob\" name=\"DATE_FORMAT( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth), \'%m-%d-%Y\' )\" title=\"Date of Birth (mm-dd-yy)\" primary=\"false\" />\n			<column id=\"age\" name=\"TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )\" title=\"Age\" primary=\"false\" />\n			<column id=\"dxcode\" title=\"Dx System/Code\" name=\"CONCAT(MIN(dxr.coding_system),\'/\',MIN(dxr.dxresearch_code),IF( MIN(dxr.dxresearch_code) != MAX(dxr.dxresearch_code),CONCAT( \' &amp; \', MAX(dxr.coding_system), \'/\', MAX(dxr.dxresearch_code) ),\'\') )\" primary=\"false\" />\n		</exportColumns>\n		<query>\n			<!-- Drilldown SQL Query here -->\nSELECT\n*			\nFROM demographic d\nLEFT JOIN dxresearch dxr\nON d.demographic_no = dxr.demographic_no\nWHERE d.patient_status=${pstatus}\nAND\n(\n (LEFT(dxr.dxresearch_code, 3) IN (\'304\') AND dxr.coding_system = ${dxcodesSysICD}) OR\n (dxr.dxresearch_code IN (\'191816009\') AND dxr.coding_system LIKE ${dxcodesSysSnoMed})\n )\nAND dxr.status = \'A\'\nAND d.provider_no LIKE ${provider}\nGROUP BY d.demographic_no\nORDER BY COUNT(d.demographic_no) DESC, d.demographic_no\n		</query>\n	</drillDownQuery>\n</indicatorTemplateXML>\n','','\0',0,NULL,NULL),
(60,7,'Age and Gender Histogram Report','General','Patient Population Histogram','DoBC CPQI PSP Panel','2017-08-02','Age and Gender Histogram report (5 year intervals)','\n		  Age and Gender Histogram report (5 year intervals)\n		','<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<indicatorTemplateXML>\n	<author>OSCAR BC</author>\n	<uid></uid>\n	<heading>\n		<category>General</category>\n		<subCategory>Patient Population Histogram</subCategory>\n		<name>Age and Gender Histogram Report</name>\n		<definition>Age and Gender Histogram report (5 year intervals)</definition>\n		<framework>DoBC CPQI PSP Panel</framework>\n		<frameworkVersion>08-02-2017</frameworkVersion>\n		<notes>\n		  Age and Gender Histogram report (5 year intervals)\n		</notes>\n	</heading>\n	<indicatorQuery>\n		<version>03-13-2018</version>\n		<params>\n			<!-- \n				Use this parameter in the query as ${provider}\n				This parameter should be used for fetching patient\'s assigned to a MRP.\n				ie: WHERE demographic.provider_no = ${provider}\n			-->\n			<parameter id=\"provider\" name=\"provider_no\" value=\"loggedInProvider\" />\n			<parameter id=\"pstatus\" name=\"Patient Status\" value=\"\'AC\'\" />\n		</params>\n		<query>\n		  <!-- Indicator SQL Query here -->\nSELECT\n	IF( COUNT(fin.patient) &gt; 0, SUM( CASE WHEN (fin.gender = \'M\' AND (0 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(fin.year,\'-\',fin.month,\'-\',fin.day) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(fin.year,\'-\',fin.month,\'-\',fin.day) ), CURDATE() ) &lt; 20 )) THEN 1 ELSE 0 END) , 0) AS \"M0-19\",\n	IF( COUNT(fin.patient) &gt; 0, SUM( CASE WHEN (fin.gender = \'M\' AND (20 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(fin.year,\'-\',fin.month,\'-\',fin.day) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(fin.year,\'-\',fin.month,\'-\',fin.day) ), CURDATE() ) &lt; 60 )) THEN 1 ELSE 0 END) , 0) AS \"M20-59\",\n	IF( COUNT(fin.patient) &gt; 0, SUM( CASE WHEN (fin.gender = \'M\' AND (60 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(fin.year,\'-\',fin.month,\'-\',fin.day) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(fin.year,\'-\',fin.month,\'-\',fin.day) ), CURDATE() ) &lt; 999 )) THEN 1 ELSE 0 END) , 0) AS \"M60+\",\n	IF( COUNT(fin.patient) &gt; 0, SUM( CASE WHEN (fin.gender = \'F\' AND (0 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(fin.year,\'-\',fin.month,\'-\',fin.day) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(fin.year,\'-\',fin.month,\'-\',fin.day) ), CURDATE() ) &lt; 20 )) THEN 1 ELSE 0 END) , 0) AS \"F0-19\",\n	IF( COUNT(fin.patient) &gt; 0, SUM( CASE WHEN (fin.gender = \'F\' AND (20 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(fin.year,\'-\',fin.month,\'-\',fin.day) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(fin.year,\'-\',fin.month,\'-\',fin.day) ), CURDATE() ) &lt; 60 )) THEN 1 ELSE 0 END) , 0) AS \"F20-59\",\n	IF( COUNT(fin.patient) &gt; 0, SUM( CASE WHEN (fin.gender = \'F\' AND (60 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(fin.year,\'-\',fin.month,\'-\',fin.day) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(fin.year,\'-\',fin.month,\'-\',fin.day) ), CURDATE() ) &lt; 999 )) THEN 1 ELSE 0 END) , 0) AS \"F60+\"\nFROM (\nSELECT\nd.demographic_no as patient, d.year_of_birth as year, d.month_of_birth as month, d.date_of_birth as day, d.sex as gender\nFROM\ndemographic d\nWHERE d.provider_no LIKE ${provider}\nAND d.patient_status LIKE ${pstatus}\n) fin;\n		</query>\n	</indicatorQuery>\n	<drillDownQuery>\n		<version>03-13-2018</version>\n		<params>\n			<parameter id=\"provider\" name=\"provider_no\" value=\"loggedInProvider\" />	\n			<parameter id=\"pstatus\" name=\"Patient Status\" value=\"\'AC\'\" />\n		</params>\n		<displayColumns>\n			<column id=\'M0-4\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'M\' AND (0 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 5 )) THEN 1 ELSE 0 END) , 0)\" title=\"M0-4\" primary=\"false\" />\n			<column id=\'M5-9\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'M\' AND (5 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 10 )) THEN 1 ELSE 0 END) , 0)\" title=\"M5-9\" primary=\"false\" />\n			<column id=\'M10-14\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'M\' AND (10 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 15 )) THEN 1 ELSE 0 END) , 0)\" title=\"M10-14\" primary=\"false\" />\n			<column id=\'M15-20\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'M\' AND (15 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 20 )) THEN 1 ELSE 0 END) , 0)\" title=\"M15-19\" primary=\"false\" />\n			<column id=\'M20-24\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'M\' AND (20 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 25 )) THEN 1 ELSE 0 END) , 0)\" title=\"M20-29\" primary=\"false\" />\n			<column id=\'M25-29\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'M\' AND (25 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 30 )) THEN 1 ELSE 0 END) , 0)\" title=\"M20-29\" primary=\"false\" />\n			<column id=\'M30-34\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'M\' AND (30 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 35 )) THEN 1 ELSE 0 END) , 0)\" title=\"M30-34\" primary=\"false\" />\n			<column id=\'M35-39\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'M\' AND (35 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 40 )) THEN 1 ELSE 0 END) , 0)\" title=\"M35-39\" primary=\"false\" />\n			<column id=\'M40-44\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'M\' AND (40 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 45 )) THEN 1 ELSE 0 END) , 0)\" title=\"M40-44\" primary=\"false\" />\n			<column id=\'M45-49\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'M\' AND (45 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 50 )) THEN 1 ELSE 0 END) , 0)\" title=\"M45-49\" primary=\"false\" />\n			<column id=\'M50-54\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'M\' AND (50 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 55 )) THEN 1 ELSE 0 END) , 0)\" title=\"M50-54\" primary=\"false\" />\n			<column id=\'M55-59\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'M\' AND (55 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 60 )) THEN 1 ELSE 0 END) , 0)\" title=\"M55-59\" primary=\"false\" />\n			<column id=\'M60-64\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'M\' AND (60 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 65 )) THEN 1 ELSE 0 END) , 0)\" title=\"M60-64\" primary=\"false\" />\n			<column id=\'M65-69\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'M\' AND (65 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 70 )) THEN 1 ELSE 0 END) , 0)\" title=\"M65-69\" primary=\"false\" />\n			<column id=\'M70-74\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'M\' AND (70 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 75 )) THEN 1 ELSE 0 END) , 0)\" title=\"M70-74\" primary=\"false\" />\n			<column id=\'M75-79\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'M\' AND (75 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 80 )) THEN 1 ELSE 0 END) , 0)\" title=\"M75-79\" primary=\"false\" />\n			<column id=\'M80-84\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'M\' AND (80 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 85 )) THEN 1 ELSE 0 END) , 0)\" title=\"M80-84\" primary=\"false\" />\n			<column id=\'M85-89\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'M\' AND (85 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 90 )) THEN 1 ELSE 0 END) , 0)\" title=\"M85-89\" primary=\"false\" />\n			<column id=\'M90-94\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'M\' AND (90 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 95 )) THEN 1 ELSE 0 END) , 0)\" title=\"M90-94\" primary=\"false\" />\n			<column id=\'M95-99\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'M\' AND (95 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 100 )) THEN 1 ELSE 0 END) , 0)\" title=\"M95-99\" primary=\"false\" />\n			<column id=\'M100-104\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'M\' AND (100 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 105 )) THEN 1 ELSE 0 END) , 0)\" title=\"M100-104\" primary=\"false\" />\n			<column id=\'M105-109\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'M\' AND (105 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 110 )) THEN 1 ELSE 0 END) , 0)\" title=\"M105-109\" primary=\"false\" />\n			<column id=\'M110-114\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'M\' AND (110 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 115 )) THEN 1 ELSE 0 END) , 0)\" title=\"M110-114\" primary=\"false\" />\n			<column id=\'M115-119\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'M\' AND (115 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 120 )) THEN 1 ELSE 0 END) , 0)\" title=\"M115-119\" primary=\"false\" />\n			<column id=\'M120-124\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'M\' AND (120 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 125 )) THEN 1 ELSE 0 END) , 0)\" title=\"M120-124\" primary=\"false\" />\n			<column id=\'M125+\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'M\' AND (125 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 999 )) THEN 1 ELSE 0 END) , 0)\" title=\"M125+\" primary=\"false\" />\n			\n			<column id=\'F0-4\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'F\' AND (0 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 5 )) THEN 1 ELSE 0 END) , 0)\" title=\"F0-4\" primary=\"false\" />\n			<column id=\'F5-9\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'F\' AND (5 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 10 )) THEN 1 ELSE 0 END) , 0)\" title=\"F5-9\" primary=\"false\" />\n			<column id=\'F10-14\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'F\' AND (10 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 15 )) THEN 1 ELSE 0 END) , 0)\" title=\"F10-14\" primary=\"false\" />\n			<column id=\'F15-20\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'F\' AND (15 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 20 )) THEN 1 ELSE 0 END) , 0)\" title=\"F15-19\" primary=\"false\" />\n			<column id=\'F20-24\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'F\' AND (20 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 25 )) THEN 1 ELSE 0 END) , 0)\" title=\"F20-29\" primary=\"false\" />\n			<column id=\'F25-29\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'F\' AND (25 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 30 )) THEN 1 ELSE 0 END) , 0)\" title=\"F20-29\" primary=\"false\" />\n			<column id=\'F30-34\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'F\' AND (30 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 35 )) THEN 1 ELSE 0 END) , 0)\" title=\"F30-34\" primary=\"false\" />\n			<column id=\'F35-39\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'F\' AND (35 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 40 )) THEN 1 ELSE 0 END) , 0)\" title=\"F35-39\" primary=\"false\" />\n			<column id=\'F40-44\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'F\' AND (40 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 45 )) THEN 1 ELSE 0 END) , 0)\" title=\"F40-44\" primary=\"false\" />\n			<column id=\'F45-49\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'F\' AND (45 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 50 )) THEN 1 ELSE 0 END) , 0)\" title=\"F45-49\" primary=\"false\" />\n			<column id=\'F50-54\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'F\' AND (50 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 55 )) THEN 1 ELSE 0 END) , 0)\" title=\"F50-54\" primary=\"false\" />\n			<column id=\'F55-59\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'F\' AND (55 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 60 )) THEN 1 ELSE 0 END) , 0)\" title=\"F55-59\" primary=\"false\" />\n			<column id=\'F60-64\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'F\' AND (60 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 65 )) THEN 1 ELSE 0 END) , 0)\" title=\"F60-64\" primary=\"false\" />\n			<column id=\'F65-69\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'F\' AND (65 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 70 )) THEN 1 ELSE 0 END) , 0)\" title=\"F65-69\" primary=\"false\" />\n			<column id=\'F70-74\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'F\' AND (70 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 75 )) THEN 1 ELSE 0 END) , 0)\" title=\"F70-74\" primary=\"false\" />\n			<column id=\'F75-79\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'F\' AND (75 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 80 )) THEN 1 ELSE 0 END) , 0)\" title=\"F75-79\" primary=\"false\" />\n			<column id=\'F80-84\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'F\' AND (80 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 85 )) THEN 1 ELSE 0 END) , 0)\" title=\"F80-84\" primary=\"false\" />\n			<column id=\'F85-89\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'F\' AND (85 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 90 )) THEN 1 ELSE 0 END) , 0)\" title=\"F85-89\" primary=\"false\" />\n			<column id=\'F90-94\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'F\' AND (90 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 95 )) THEN 1 ELSE 0 END) , 0)\" title=\"F90-94\" primary=\"false\" />\n			<column id=\'F95-99\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'F\' AND (95 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 100 )) THEN 1 ELSE 0 END) , 0)\" title=\"F95-99\" primary=\"false\" />\n			<column id=\'F100-104\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'F\' AND (100 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 105 )) THEN 1 ELSE 0 END) , 0)\" title=\"F100-104\" primary=\"false\" />\n			<column id=\'F105-109\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'F\' AND (105 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 110 )) THEN 1 ELSE 0 END) , 0)\" title=\"F105-109\" primary=\"false\" />\n			<column id=\'F110-114\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'F\' AND (110 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 115 )) THEN 1 ELSE 0 END) , 0)\" title=\"F110-114\" primary=\"false\" />\n			<column id=\'F115-119\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'F\' AND (115 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 120 )) THEN 1 ELSE 0 END) , 0)\" title=\"F115-119\" primary=\"false\" />\n			<column id=\'F120-124\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'F\' AND (120 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 125 )) THEN 1 ELSE 0 END) , 0)\" title=\"F120-124\" primary=\"false\" />\n			<column id=\'F125+\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'F\' AND (125 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 999 )) THEN 1 ELSE 0 END) , 0)\" title=\"F125+\" primary=\"false\" />\n			\n		</displayColumns>\n		<exportColumns>\n			<column id=\'M0-4\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'M\' AND (0 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 5 )) THEN 1 ELSE 0 END) , 0)\" title=\"M0-4\" primary=\"false\" />\n			<column id=\'M5-9\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'M\' AND (5 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 10 )) THEN 1 ELSE 0 END) , 0)\" title=\"M5-9\" primary=\"false\" />\n			<column id=\'M10-14\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'M\' AND (10 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 15 )) THEN 1 ELSE 0 END) , 0)\" title=\"M10-14\" primary=\"false\" />\n			<column id=\'M15-20\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'M\' AND (15 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 20 )) THEN 1 ELSE 0 END) , 0)\" title=\"M15-19\" primary=\"false\" />\n			<column id=\'M20-24\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'M\' AND (20 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 25 )) THEN 1 ELSE 0 END) , 0)\" title=\"M20-29\" primary=\"false\" />\n			<column id=\'M25-29\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'M\' AND (25 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 30 )) THEN 1 ELSE 0 END) , 0)\" title=\"M20-29\" primary=\"false\" />\n			<column id=\'M30-34\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'M\' AND (30 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 35 )) THEN 1 ELSE 0 END) , 0)\" title=\"M30-34\" primary=\"false\" />\n			<column id=\'M35-39\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'M\' AND (35 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 40 )) THEN 1 ELSE 0 END) , 0)\" title=\"M35-39\" primary=\"false\" />\n			<column id=\'M40-44\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'M\' AND (40 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 45 )) THEN 1 ELSE 0 END) , 0)\" title=\"M40-44\" primary=\"false\" />\n			<column id=\'M45-49\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'M\' AND (45 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 50 )) THEN 1 ELSE 0 END) , 0)\" title=\"M45-49\" primary=\"false\" />\n			<column id=\'M50-54\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'M\' AND (50 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 55 )) THEN 1 ELSE 0 END) , 0)\" title=\"M50-54\" primary=\"false\" />\n			<column id=\'M55-59\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'M\' AND (55 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 60 )) THEN 1 ELSE 0 END) , 0)\" title=\"M55-59\" primary=\"false\" />\n			<column id=\'M60-64\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'M\' AND (60 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 65 )) THEN 1 ELSE 0 END) , 0)\" title=\"M60-64\" primary=\"false\" />\n			<column id=\'M65-69\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'M\' AND (65 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 70 )) THEN 1 ELSE 0 END) , 0)\" title=\"M65-69\" primary=\"false\" />\n			<column id=\'M70-74\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'M\' AND (70 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 75 )) THEN 1 ELSE 0 END) , 0)\" title=\"M70-74\" primary=\"false\" />\n			<column id=\'M75-79\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'M\' AND (75 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 80 )) THEN 1 ELSE 0 END) , 0)\" title=\"M75-79\" primary=\"false\" />\n			<column id=\'M80-84\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'M\' AND (80 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 85 )) THEN 1 ELSE 0 END) , 0)\" title=\"M80-84\" primary=\"false\" />\n			<column id=\'M85-89\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'M\' AND (85 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 90 )) THEN 1 ELSE 0 END) , 0)\" title=\"M85-89\" primary=\"false\" />\n			<column id=\'M90-94\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'M\' AND (90 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 95 )) THEN 1 ELSE 0 END) , 0)\" title=\"M90-94\" primary=\"false\" />\n			<column id=\'M95-99\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'M\' AND (95 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 100 )) THEN 1 ELSE 0 END) , 0)\" title=\"M95-99\" primary=\"false\" />\n			<column id=\'M100-104\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'M\' AND (100 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 105 )) THEN 1 ELSE 0 END) , 0)\" title=\"M100-104\" primary=\"false\" />\n			<column id=\'M105-109\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'M\' AND (105 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 110 )) THEN 1 ELSE 0 END) , 0)\" title=\"M105-109\" primary=\"false\" />\n			<column id=\'M110-114\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'M\' AND (110 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 115 )) THEN 1 ELSE 0 END) , 0)\" title=\"M110-114\" primary=\"false\" />\n			<column id=\'M115-119\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'M\' AND (115 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 120 )) THEN 1 ELSE 0 END) , 0)\" title=\"M115-119\" primary=\"false\" />\n			<column id=\'M120-124\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'M\' AND (120 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 125 )) THEN 1 ELSE 0 END) , 0)\" title=\"M120-124\" primary=\"false\" />\n			<column id=\'M125+\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'M\' AND (125 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 999 )) THEN 1 ELSE 0 END) , 0)\" title=\"M125+\" primary=\"false\" />\n			\n			<column id=\'F0-4\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'F\' AND (0 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 5 )) THEN 1 ELSE 0 END) , 0)\" title=\"F0-4\" primary=\"false\" />\n			<column id=\'F5-9\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'F\' AND (5 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 10 )) THEN 1 ELSE 0 END) , 0)\" title=\"F5-9\" primary=\"false\" />\n			<column id=\'F10-14\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'F\' AND (10 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 15 )) THEN 1 ELSE 0 END) , 0)\" title=\"F10-14\" primary=\"false\" />\n			<column id=\'F15-20\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'F\' AND (15 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 20 )) THEN 1 ELSE 0 END) , 0)\" title=\"F15-19\" primary=\"false\" />\n			<column id=\'F20-24\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'F\' AND (20 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 25 )) THEN 1 ELSE 0 END) , 0)\" title=\"F20-29\" primary=\"false\" />\n			<column id=\'F25-29\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'F\' AND (25 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 30 )) THEN 1 ELSE 0 END) , 0)\" title=\"F20-29\" primary=\"false\" />\n			<column id=\'F30-34\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'F\' AND (30 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 35 )) THEN 1 ELSE 0 END) , 0)\" title=\"F30-34\" primary=\"false\" />\n			<column id=\'F35-39\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'F\' AND (35 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 40 )) THEN 1 ELSE 0 END) , 0)\" title=\"F35-39\" primary=\"false\" />\n			<column id=\'F40-44\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'F\' AND (40 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 45 )) THEN 1 ELSE 0 END) , 0)\" title=\"F40-44\" primary=\"false\" />\n			<column id=\'F45-49\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'F\' AND (45 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 50 )) THEN 1 ELSE 0 END) , 0)\" title=\"F45-49\" primary=\"false\" />\n			<column id=\'F50-54\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'F\' AND (50 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 55 )) THEN 1 ELSE 0 END) , 0)\" title=\"F50-54\" primary=\"false\" />\n			<column id=\'F55-59\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'F\' AND (55 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 60 )) THEN 1 ELSE 0 END) , 0)\" title=\"F55-59\" primary=\"false\" />\n			<column id=\'F60-64\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'F\' AND (60 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 65 )) THEN 1 ELSE 0 END) , 0)\" title=\"F60-64\" primary=\"false\" />\n			<column id=\'F65-69\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'F\' AND (65 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 70 )) THEN 1 ELSE 0 END) , 0)\" title=\"F65-69\" primary=\"false\" />\n			<column id=\'F70-74\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'F\' AND (70 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 75 )) THEN 1 ELSE 0 END) , 0)\" title=\"F70-74\" primary=\"false\" />\n			<column id=\'F75-79\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'F\' AND (75 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 80 )) THEN 1 ELSE 0 END) , 0)\" title=\"F75-79\" primary=\"false\" />\n			<column id=\'F80-84\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'F\' AND (80 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 85 )) THEN 1 ELSE 0 END) , 0)\" title=\"F80-84\" primary=\"false\" />\n			<column id=\'F85-89\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'F\' AND (85 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 90 )) THEN 1 ELSE 0 END) , 0)\" title=\"F85-89\" primary=\"false\" />\n			<column id=\'F90-94\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'F\' AND (90 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 95 )) THEN 1 ELSE 0 END) , 0)\" title=\"F90-94\" primary=\"false\" />\n			<column id=\'F95-99\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'F\' AND (95 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 100 )) THEN 1 ELSE 0 END) , 0)\" title=\"F95-99\" primary=\"false\" />\n			<column id=\'F100-104\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'F\' AND (100 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 105 )) THEN 1 ELSE 0 END) , 0)\" title=\"F100-104\" primary=\"false\" />\n			<column id=\'F105-109\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'F\' AND (105 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 110 )) THEN 1 ELSE 0 END) , 0)\" title=\"F105-109\" primary=\"false\" />\n			<column id=\'F110-114\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'F\' AND (110 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 115 )) THEN 1 ELSE 0 END) , 0)\" title=\"F110-114\" primary=\"false\" />\n			<column id=\'F115-119\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'F\' AND (115 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 120 )) THEN 1 ELSE 0 END) , 0)\" title=\"F115-119\" primary=\"false\" />\n			<column id=\'F120-124\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'F\' AND (120 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 125 )) THEN 1 ELSE 0 END) , 0)\" title=\"F120-124\" primary=\"false\" />\n			<column id=\'F125+\' name=\"IF( COUNT(d.demographic_no) &gt; 0, SUM( CASE WHEN (d.sex = \'F\' AND (125 &lt;= TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )) AND (TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() ) &lt; 999 )) THEN 1 ELSE 0 END) , 0)\" title=\"F125+\" primary=\"false\" />\n		</exportColumns>\n		<query>\n			<!-- Drilldown SQL Query here -->\nSELECT\n    d.*,\n    d.patient_status AS pt_status\nFROM demographic d\nWHERE d.provider_no LIKE ${provider}\nAND d.patient_status LIKE ${pstatus}\n		</query>\n	</drillDownQuery>\n</indicatorTemplateXML>\n','','\0',0,NULL,NULL),
(61,7,'Aggregated Active Patients Report','General','Patient Population','DoBC CPQI PSP Panel','2017-08-02','# of patients that have been seen in the last 3 years in comparison to # all active patients','\n		  i) # of active patients that have been seen in the last 3 year\n		  ii) # of active patients not seen in the last 3 years\n		','<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<indicatorTemplateXML>\n	<author>OSCAR BC</author>\n	<uid></uid>\n	<heading>\n		<category>General</category>\n		<subCategory>Patient Population</subCategory>\n		<name>Aggregated Active Patients Report</name>\n		<definition># of patients that have been seen in the last 3 years in comparison to # all active patients</definition>\n		<framework>DoBC CPQI PSP Panel</framework>\n		<frameworkVersion>08-02-2017</frameworkVersion>\n		<notes>\n		  i) # of active patients that have been seen in the last 3 year\n		  ii) # of active patients not seen in the last 3 years\n		</notes>\n	</heading>\n	<indicatorQuery>\n		<version>03-13-2018</version>\n		<params>\n			<!-- \n				Use this parameter in the query as ${provider}\n				This parameter should be used for fetching patient\'s assigned to a MRP.\n				ie: WHERE demographic.provider_no = ${provider}\n			-->\n			<parameter id=\"provider\" name=\"provider_no\" value=\"loggedInProvider\" />\n			<parameter id=\"pstatus\" name=\"Patient Status\" value=\"\'AC\'\" />\n		</params>\n		<query>\n		  <!-- Indicator SQL Query here -->\nSELECT\n	SUM(fin.THREE) AS \"% Active, Seen within 3 years\",\n	SUM(fin.ALL_PATIENTS)-SUM(fin.THREE) AS \"% Active, Not seen within 3 years\"\nFROM (\n	SELECT\n		IF( DATE_SUB(CURDATE() , INTERVAL 3 YEAR) &lt;= DATE( MAX(cmn.observation_date) ) ,1 ,0 ) AS THREE, \n		IF( TRUE, 1, 0) AS ALL_PATIENTS\n	FROM demographic d\n	LEFT JOIN casemgmt_note cmn\n	ON (  d.demographic_no = cmn.demographic_no AND cmn.signed = 1 AND cmn.provider_no != \'-1\'  )\n	WHERE d.provider_no LIKE ${provider}\n	AND d.patient_status LIKE ${pstatus}\n	GROUP BY d.demographic_no HAVING count(d.demographic_no) > -1\n) fin;\n		</query>\n	</indicatorQuery>\n	<drillDownQuery>\n		<version>03-13-2018</version>\n		<params>\n			<parameter id=\"provider\" name=\"provider_no\" value=\"loggedInProvider\" />	\n			<parameter id=\"pstatus\" name=\"Patient Status\" value=\"\'AC\'\" />\n		</params>\n		<displayColumns>\n		        <column id=\"seen3yrs\" name=\"SUM(fin.THREE)\" title=\"Active Seen Within Last 3 Years\" primary=\"false\" />\n		  	<column id=\"allActive\" name=\"SUM(fin.ALL_PATIENTS)\" title=\"Active Patient Total\" primary=\"false\" />\n		</displayColumns>\n		<exportColumns>\n		        <column id=\"seen3yrs\" name=\"SUM(fin.THREE)\" title=\"Active Seen Within Last 3 Years\" primary=\"false\" />\n		  	<column id=\"allActive\" name=\"SUM(fin.ALL_PATIENTS)\" title=\"Active Patient Total\" primary=\"false\" />\n		</exportColumns>\n		<query>\n			<!-- Drilldown SQL Query here -->\nSELECT\nfin.*\nFROM (\n	SELECT\n		IF( DATE_SUB(CURDATE() , INTERVAL 3 YEAR) &lt;= DATE( MAX(cmn.observation_date) ) ,1 ,0 ) AS THREE, \n		IF( TRUE, 1, 0) AS ALL_PATIENTS\n	FROM demographic d\n	LEFT JOIN casemgmt_note cmn\n	ON (  d.demographic_no = cmn.demographic_no AND cmn.signed = 1 AND cmn.provider_no != \'-1\'  )\n	WHERE d.provider_no LIKE ${provider}\n	AND d.patient_status LIKE ${pstatus}\n	GROUP BY d.demographic_no HAVING count(d.demographic_no) > -1\n) fin;\n		</query>\n	</drillDownQuery>\n</indicatorTemplateXML>\n','','\0',0,NULL,NULL),
(62,7,'Aggregated No Assigned Primary','General','Patient Population','DoBC CPQI PSP Panel','2017-08-02','# of active patients without an assigned primary\n		','\n		  i)  # of active patients without an assigned primary\n		  ii) # all active patients for all providers\n		','<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<indicatorTemplateXML>\n	<author>OSCAR BC</author>\n	<uid></uid>\n	<heading>\n		<category>General</category>\n		<subCategory>Patient Population</subCategory>\n		<name>Aggregated No Assigned Primary</name>\n		<definition># of active patients without an assigned primary\n		</definition>\n		<framework>DoBC CPQI PSP Panel</framework>\n		<frameworkVersion>08-02-2017</frameworkVersion>\n		<notes>\n		  i)  # of active patients without an assigned primary\n		  ii) # all active patients for all providers\n		</notes>\n	</heading>\n	<indicatorQuery>\n		<version>03-13-2018</version>\n		<params>\n			<!-- \n				Use this parameter in the query as ${provider}\n				This parameter should be used for fetching patient\'s assigned to a MRP.\n				ie: WHERE demographic.provider_no = ${provider}\n			-->\n			<parameter id=\"provider\" name=\"provider_no\" value=\"loggedInProvider\" />\n			<parameter id=\"pstatus\" name=\"Patient Status\" value=\"\'AC\'\" />\n		</params>\n		<query>\n		  <!-- Indicator SQL Query here -->\nSELECT\n	SUM(fin.NO_ASSIGNED_PRIMARY) AS \"% Active, No Assigned Primary\",\n	SUM(fin.OTHER_PATIENTS) AS \"% Active, Assigned Primary\"\nFROM (\n	SELECT\n		IF( d.provider_no IS NULL OR d.provider_no = \'\' OR p.provider_no IS NULL ,1 ,0 ) AS NO_ASSIGNED_PRIMARY,\n		IF( d.provider_no IS NOT NULL AND d.provider_no != \'\' AND p.provider_no is NOT NULL,1 ,0 ) AS OTHER_PATIENTS\n	FROM demographic d\n	LEFT JOIN provider p\n	ON d.provider_no = p.provider_no\n	WHERE d.patient_status LIKE ${pstatus}\n) fin;\n		</query>\n	</indicatorQuery>\n	<drillDownQuery>\n		<version>03-13-2018</version>\n		<params>\n			<parameter id=\"provider\" name=\"provider_no\" value=\"loggedInProvider\" />	\n			<parameter id=\"pstatus\" name=\"Patient Status\" value=\"\'AC\'\" />\n		</params>\n		<displayColumns>\n		        <column id=\"noProvider\" name=\"SUM(fin.NO_ASSIGNED_PRIMARY)\" title=\"Active Without Assigned Primary\" primary=\"false\" />\n		  	<column id=\"allActive\" name=\"SUM(fin.ALLACTIVE)\" title=\"Active Patient Total\" primary=\"false\" />\n		</displayColumns>\n		<exportColumns>\n		        <column id=\"noProvider\" name=\"SUM(fin.NO_ASSIGNED_PRIMARY)\" title=\"Active Without Contact Info\" primary=\"false\" />\n		  	<column id=\"allActive\" name=\"SUM(fin.ALLACTIVE)\" title=\"Active Patient Total\" primary=\"false\" />\n		</exportColumns>\n		<query>\n			<!-- Drilldown SQL Query here -->\nSELECT\nfin.*\nFROM (\n	SELECT\n		IF( d.provider_no IS NULL OR d.provider_no = \'\' OR p.provider_no IS NULL ,1 ,0 ) AS NO_ASSIGNED_PRIMARY,\n		IF( true, 1, 0 ) AS ALLACTIVE\n	FROM demographic d\n	LEFT JOIN provider p\n	ON d.provider_no = p.provider_no\n	WHERE d.patient_status LIKE ${pstatus}\n) fin;\n		</query>\n	</drillDownQuery>\n</indicatorTemplateXML>\n','','\0',0,NULL,NULL),
(63,7,'Aggregated Patient Contact','General','Patient Population','DoBC CPQI PSP Panel','2017-08-02','# of active patients with contact information in comparison to # all active patients\n		','\n		  i)  # of active patients without contact information\n		  ii) # of active patients with contact information\n		','<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<indicatorTemplateXML>\n	<author>OSCAR BC</author>\n	<uid></uid>\n	<heading>\n		<category>General</category>\n		<subCategory>Patient Population</subCategory>\n		<name>Aggregated Patient Contact</name>\n		<definition># of active patients with contact information in comparison to # all active patients\n		</definition>\n		<framework>DoBC CPQI PSP Panel</framework>\n		<frameworkVersion>08-02-2017</frameworkVersion>\n		<notes>\n		  i)  # of active patients without contact information\n		  ii) # of active patients with contact information\n		</notes>\n	</heading>\n	<indicatorQuery>\n		<version>03-13-2018</version>\n		<params>\n			<!-- \n				Use this parameter in the query as ${provider}\n				This parameter should be used for fetching patient\'s assigned to a MRP.\n				ie: WHERE demographic.provider_no = ${provider}\n			-->\n			<parameter id=\"provider\" name=\"provider_no\" value=\"loggedInProvider\" />\n			<parameter id=\"pstatus\" name=\"Patient Status\" value=\"\'AC\'\" />\n		</params>\n		<query>\n		  <!-- Indicator SQL Query here -->\nSELECT\n	SUM(fin.NO_CONTACT_INFO) AS \"% Active, No Contact Information\",\n	SUM(fin.HAS_CONTACT_INFO) AS \"% Active, With Contact Information\"\nFROM (\n	SELECT\n		IF( LENGTH(phone) &lt; LENGTH(\"###-###-####\") AND LENGTH(phone2) &lt; LENGTH(\"###-###-####\" ) ,1 ,0 ) AS NO_CONTACT_INFO,\n		IF( NOT(LENGTH(phone) &lt; LENGTH(\"###-###-####\") AND LENGTH(phone2) &lt; LENGTH(\"###-###-####\" )) ,1 ,0 ) AS HAS_CONTACT_INFO\n	FROM demographic d\n	WHERE d.provider_no LIKE ${provider}\n	AND d.patient_status LIKE ${pstatus}\n) fin;\n		</query>\n	</indicatorQuery>\n	<drillDownQuery>\n		<version>03-13-2018</version>\n		<params>\n			<parameter id=\"provider\" name=\"provider_no\" value=\"loggedInProvider\" />	\n			<parameter id=\"pstatus\" name=\"Patient Status\" value=\"\'AC\'\" />\n		</params>\n		<displayColumns>\n		        <column id=\"noContact\" name=\"SUM(fin.NO_CONTACT_INFO)\" title=\"Active Without Contact Info\" primary=\"false\" />\n		  	<column id=\"allActive\" name=\"SUM(fin.ALLACTIVE)\" title=\"Active Patient Total\" primary=\"false\" />\n		</displayColumns>\n		<exportColumns>\n		        <column id=\"noContact\" name=\"SUM(fin.NO_CONTACT_INFO)\" title=\"Active Without Contact Info\" primary=\"false\" />\n		  	<column id=\"allActive\" name=\"SUM(fin.ALLACTIVE)\" title=\"Active Patient Total\" primary=\"false\" />\n		</exportColumns>\n		<query>\n			<!-- Drilldown SQL Query here -->\nSELECT\nfin.*\nFROM (\n	SELECT\n		IF( LENGTH(phone) &lt; LENGTH(\"###-###-####\") AND LENGTH(phone2) &lt; LENGTH(\"###-###-####\" ) ,1 ,0 ) AS NO_CONTACT_INFO,\n		IF( true, 1, 0 ) AS ALLACTIVE\n	FROM demographic d\n	WHERE d.provider_no LIKE ${provider}\n	AND d.patient_status LIKE ${pstatus}\n	) fin\n		</query>\n	</drillDownQuery>\n</indicatorTemplateXML>\n','','\0',0,NULL,NULL),
(64,7,'No Assigned Primary','General','Patient Population','DoBC CPQI PSP Panel','2017-08-02','# of active patients without an assigned primary\n		','\n		  i)  # of active patients without an assigned primary\n		  ii) # all active patients for all providers\n		','<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<indicatorTemplateXML>\n	<author>OSCAR BC</author>\n	<uid></uid>\n	<heading>\n		<category>General</category>\n		<subCategory>Patient Population</subCategory>\n		<name>No Assigned Primary</name>\n		<definition># of active patients without an assigned primary\n		</definition>\n		<framework>DoBC CPQI PSP Panel</framework>\n		<frameworkVersion>08-02-2017</frameworkVersion>\n		<notes>\n		  i)  # of active patients without an assigned primary\n		  ii) # all active patients for all providers\n		</notes>\n	</heading>\n	<indicatorQuery>\n		<version>03-13-2018</version>\n		<params>\n			<!-- \n				Use this parameter in the query as ${provider}\n				This parameter should be used for fetching patient\'s assigned to a MRP.\n				ie: WHERE demographic.provider_no = ${provider}\n			-->\n			<parameter id=\"provider\" name=\"provider_no\" value=\"loggedInProvider\" />\n			<parameter id=\"pstatus\" name=\"Patient Status\" value=\"\'AC\'\" />\n		</params>\n		<query>\n		  <!-- Indicator SQL Query here -->\nSELECT\n	SUM(fin.NO_ASSIGNED_PRIMARY) AS \"% Active, No Assigned Primary\",\n	SUM(fin.OTHER_PATIENTS) AS \"% Active, Assigned Primary\"\nFROM (\n	SELECT\n		IF( d.provider_no IS NULL OR d.provider_no = \'\' OR p.provider_no IS NULL ,1 ,0 ) AS NO_ASSIGNED_PRIMARY,\n		IF( d.provider_no IS NOT NULL AND d.provider_no != \'\' AND p.provider_no is NOT NULL,1 ,0 ) AS OTHER_PATIENTS\n	FROM demographic d\n	LEFT JOIN provider p\n	ON d.provider_no = p.provider_no\n	WHERE d.patient_status LIKE ${pstatus}\n) fin;\n		</query>\n	</indicatorQuery>\n	<drillDownQuery>\n		<version>03-13-2018</version>\n		<params>\n			<parameter id=\"provider\" name=\"provider_no\" value=\"loggedInProvider\" />	\n			<parameter id=\"pstatus\" name=\"Patient Status\" value=\"\'AC\'\" />\n		</params>\n		<displayColumns>\n			<column id=\"demographic\" name=\"d.demographic_no\" title=\"Patient Id\" primary=\"true\" />\n			<column id=\"name\" name=\"CONCAT( d.last_name, \', \', d.first_name )\" title=\"Patient Name\" primary=\"false\" />\n			<column id=\"dob\" name=\"DATE_FORMAT( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth), \'%m-%d-%Y\' )\" title=\"Date of Birth (mm-dd-yy)\" primary=\"false\" />\n			<column id=\"age\" name=\"TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )\" title=\"Age\" primary=\"false\" />\n			<column id=\"phone\" name=\"d.phone\" title=\"Phone#\" primary=\"false\" />\n			<column id=\"provider\" name=\"d.provider_no\" title=\"Missing/Invalid Provider\" primary=\"false\" />\n		</displayColumns>\n		<exportColumns>\n		        <column id=\"demographic\" name=\"d.demographic_no\" title=\"Patient Id\" primary=\"true\" />\n		        <column id=\"firstName\" name=\"d.first_name\" title=\"First Name\" primary=\"false\" />\n                        <column id=\"lastName\" name=\"d.last_name\" title=\"Last Name\" primary=\"false\" />\n			<column id=\"dob\" name=\"DATE_FORMAT( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth), \'%m-%d-%Y\' )\" title=\"Date of Birth (mm-dd-yy)\" primary=\"false\" />\n			<column id=\"age\" name=\"TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )\" title=\"Age\" primary=\"false\" />\n			<column id=\"phone\" name=\"d.phone\" title=\"Phone#\" primary=\"false\" />\n			<column id=\"provider\" name=\"d.provider_no\" title=\"Missing/Invalid Provider\" primary=\"false\" />\n\n		</exportColumns>\n		<query>\n			<!-- Drilldown SQL Query here -->\nSELECT\nd.*\nFROM demographic d\nLEFT JOIN provider p\nON d.provider_no = p.provider_no\nWHERE d.patient_status LIKE ${pstatus}\nAND (d.provider_no IS NULL OR d.provider_no = \'\' OR p.provider_no IS NULL)\nORDER BY d.provider_no DESC;\n		</query>\n	</drillDownQuery>\n</indicatorTemplateXML>\n','','\0',0,NULL,NULL),
(65,7,'Patient Contact','General','Patient Population','DoBC CPQI PSP Panel','2017-08-02','# of active patients with contact information in comparison to # all active patients\n		','\n		  i)  # of active patients without contact information\n		  ii) # of active patients with contact information\n		','<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<indicatorTemplateXML>\n	<author>OSCAR BC</author>\n	<uid></uid>\n	<heading>\n		<category>General</category>\n		<subCategory>Patient Population</subCategory>\n		<name>Patient Contact</name>\n		<definition># of active patients with contact information in comparison to # all active patients\n		</definition>\n		<framework>DoBC CPQI PSP Panel</framework>\n		<frameworkVersion>08-02-2017</frameworkVersion>\n		<notes>\n		  i)  # of active patients without contact information\n		  ii) # of active patients with contact information\n		</notes>\n	</heading>\n	<indicatorQuery>\n		<version>03-13-2018</version>\n		<params>\n			<!-- \n				Use this parameter in the query as ${provider}\n				This parameter should be used for fetching patient\'s assigned to a MRP.\n				ie: WHERE demographic.provider_no = ${provider}\n			-->\n			<parameter id=\"provider\" name=\"provider_no\" value=\"loggedInProvider\" />\n			<parameter id=\"pstatus\" name=\"Patient Status\" value=\"\'AC\'\" />\n		</params>\n		<query>\n		  <!-- Indicator SQL Query here -->\nSELECT\n	SUM(fin.NO_CONTACT_INFO) AS \"% Active, No Contact Information\",\n	SUM(fin.HAS_CONTACT_INFO) AS \"% Active, With Contact Information\"\nFROM (\n	SELECT\n		IF( LENGTH(phone) &lt; LENGTH(\"###-###-####\") AND LENGTH(phone2) &lt; LENGTH(\"###-###-####\" ) ,1 ,0 ) AS NO_CONTACT_INFO,\n		IF( NOT(LENGTH(phone) &lt; LENGTH(\"###-###-####\") AND LENGTH(phone2) &lt; LENGTH(\"###-###-####\" )) ,1 ,0 ) AS HAS_CONTACT_INFO\n	FROM demographic d\n	WHERE d.provider_no LIKE ${provider}\n	AND d.patient_status LIKE ${pstatus}\n) fin;\n		</query>\n	</indicatorQuery>\n	<drillDownQuery>\n		<version>03-13-2018</version>\n		<params>\n			<parameter id=\"provider\" name=\"provider_no\" value=\"loggedInProvider\" />	\n			<parameter id=\"pstatus\" name=\"Patient Status\" value=\"\'AC\'\" />\n		</params>\n		<displayColumns>\n			<column id=\"demographic\" name=\"d.demographic_no\" title=\"Patient Id\" primary=\"true\" />\n			<column id=\"name\" name=\"CONCAT( d.last_name, \', \', d.first_name )\" title=\"Patient Name\" primary=\"false\" />\n			<column id=\"dob\" name=\"DATE_FORMAT( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth), \'%m-%d-%Y\' )\" title=\"Date of Birth (mm-dd-yy)\" primary=\"false\" />\n			<column id=\"age\" name=\"TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )\" title=\"Age\" primary=\"false\" />\n			<column id=\"phone\" name=\"d.phone\" title=\"Phone#\" primary=\"false\" />\n\n		</displayColumns>\n		<exportColumns>\n		        <column id=\"demographic\" name=\"d.demographic_no\" title=\"Patient Id\" primary=\"true\" />\n		  	<column id=\"firstName\" name=\"d.first_name\" title=\"First Name\" primary=\"false\" />\n                        <column id=\"lastName\" name=\"d.last_name\" title=\"Last Name\" primary=\"false\" />\n			<column id=\"dob\" name=\"DATE_FORMAT( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth), \'%m-%d-%Y\' )\" title=\"Date of Birth (mm-dd-yy)\" primary=\"false\" />\n			<column id=\"age\" name=\"TIMESTAMPDIFF(YEAR, DATE( CONCAT(d.year_of_birth,\'-\',d.month_of_birth,\'-\',d.date_of_birth) ), CURDATE() )\" title=\"Age\" primary=\"false\" />\n			<column id=\"phone\" name=\"d.phone\" title=\"Phone#\" primary=\"false\" />\n\n		</exportColumns>\n		<query>\n			<!-- Drilldown SQL Query here -->\nSELECT\nd.*\nFROM demographic d\nWHERE d.provider_no LIKE ${provider}\nAND d.patient_status LIKE ${pstatus}\nAND (LENGTH(phone) &lt; LENGTH(\"###-###-####\") AND LENGTH(phone2) &lt; LENGTH(\"###-###-####\" ));\n		</query>\n	</drillDownQuery>\n</indicatorTemplateXML>\n','','\0',0,NULL,NULL);

END$$
DELIMITER ;

CALL CREATE_DASHBOARD_TABLES();
DROP PROCEDURE CREATE_DASHBOARD_TABLES;
